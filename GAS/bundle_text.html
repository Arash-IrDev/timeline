<!-- File: bundle_text.html -->
<script type="application/json" id="bundle-text">
  /* paste the FULL JS bundle here, exactly as built (IIFE, ES2017) */
  /* no HTML comments outside this tag */
  var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__knownSymbol=(name,symbol)=>(symbol=Symbol[name])?symbol:Symbol.for("Symbol."+name),__typeError=msg=>{throw TypeError(msg)},__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__spreadProps=(a,b)=>__defProps(a,__getOwnPropDescs(b)),__objRest=(source,exclude)=>{var target={};for(var prop in source)__hasOwnProp.call(source,prop)&&exclude.indexOf(prop)<0&&(target[prop]=source[prop]);if(null!=source&&__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(source))exclude.indexOf(prop)<0&&__propIsEnum.call(source,prop)&&(target[prop]=source[prop]);return target},__publicField=(obj,key,value)=>__defNormalProp(obj,"symbol"!=typeof key?key+"":key,value),__accessCheck=(obj,member,msg)=>member.has(obj)||__typeError("Cannot "+msg),__privateGet=(obj,member,getter)=>(__accessCheck(obj,member,"read from private field"),getter?getter.call(obj):member.get(obj)),__privateAdd=(obj,member,value)=>member.has(obj)?__typeError("Cannot add the same private member more than once"):member instanceof WeakSet?member.add(obj):member.set(obj,value),__privateSet=(obj,member,value,setter)=>(__accessCheck(obj,member,"write to private field"),setter?setter.call(obj,value):member.set(obj,value),value),__privateMethod=(obj,member,method)=>(__accessCheck(obj,member,"access private method"),method),__privateWrapper=(obj,member,setter,getter)=>({set _(value){__privateSet(obj,member,value,setter)},get _(){return __privateGet(obj,member,getter)}}),__await=function(promise,isYieldStar){this[0]=promise,this[1]=isYieldStar},__yieldStar=value=>{var method,obj=value[__knownSymbol("asyncIterator")],isAwait=!1,it={};return null==obj?(obj=value[__knownSymbol("iterator")](),method=k=>it[k]=x=>obj[k](x)):(obj=obj.call(value),method=k=>it[k]=v=>{if(isAwait){if(isAwait=!1,"throw"===k)throw v;return v}return isAwait=!0,{done:!1,value:new __await(new Promise(resolve=>{var x=obj[k](v);x instanceof Object||__typeError("Object expected"),resolve(x)}),1)}}),it[__knownSymbol("iterator")]=()=>it,method("next"),"throw"in obj?method("throw"):it.throw=x=>{throw x},"return"in obj&&method("return"),it};!function(){"use strict";var _a,_constructing,_b,_c,_max,_maxSize,_dispose,_onInsert,_disposeAfter,_fetchMethod,_memoMethod,_size,_calculatedSize,_keyMap,_keyList,_valList,_next,_prev,_head,_tail,_free,_disposed,_sizes,_starts,_ttls,_hasDispose,_hasFetchMethod,_hasDisposeAfter,_hasOnInsert,_LRUCache_instances,initializeTTLTracking_fn,_updateItemAge,_statusTTL,_setItemTTL,_isStale,initializeSizeTracking_fn,_removeItemSize,_addItemSize,_requireSize,indexes_fn,rindexes_fn,isValidIndex_fn,evict_fn,backgroundFetch_fn,isBackgroundFetch_fn,connect_fn,moveToTail_fn,delete_fn,clear_fn,_epochTime,_utcTimezone,_localTimezone;function makeMap(str){const map2=Object.create(null);for(const key of str.split(","))map2[key]=1;return val=>val in map2}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=key=>111===key.charCodeAt(0)&&110===key.charCodeAt(1)&&(key.charCodeAt(2)>122||key.charCodeAt(2)<97),isModelListener=key=>key.startsWith("onUpdate:"),extend$1=Object.assign,remove$1=(arr,el)=>{const i=arr.indexOf(el);i>-1&&arr.splice(i,1)},hasOwnProperty$2=Object.prototype.hasOwnProperty,hasOwn=(val,key)=>hasOwnProperty$2.call(val,key),isArray$2=Array.isArray,isMap$1=val=>"[object Map]"===toTypeString(val),isSet=val=>"[object Set]"===toTypeString(val),isFunction=val=>"function"==typeof val,isString$1=val=>"string"==typeof val,isSymbol=val=>"symbol"==typeof val,isObject=val=>null!==val&&"object"==typeof val,isPromise=val=>(isObject(val)||isFunction(val))&&isFunction(val.then)&&isFunction(val.catch),objectToString=Object.prototype.toString,toTypeString=value=>objectToString.call(value),isPlainObject$1=val=>"[object Object]"===toTypeString(val),isIntegerKey=key=>isString$1(key)&&"NaN"!==key&&"-"!==key[0]&&""+parseInt(key,10)===key,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=fn=>{const cache2=Object.create(null);return str=>cache2[str]||(cache2[str]=fn(str))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(str=>str.replace(camelizeRE,(_,c)=>c?c.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(str=>str.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(str=>str.charAt(0).toUpperCase()+str.slice(1)),toHandlerKey=cacheStringFunction(str=>str?`on${capitalize(str)}`:""),hasChanged=(value,oldValue)=>!Object.is(value,oldValue),invokeArrayFns=(fns,...arg)=>{for(let i=0;i<fns.length;i++)fns[i](...arg)},def=(obj,key,value,writable=!1)=>{Object.defineProperty(obj,key,{configurable:!0,enumerable:!1,writable:writable,value:value})},looseToNumber=val=>{const n2=parseFloat(val);return isNaN(n2)?val:n2};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:{});function normalizeStyle(value){if(isArray$2(value)){const res={};for(let i=0;i<value.length;i++){const item=value[i],normalized=isString$1(item)?parseStringStyle(item):normalizeStyle(item);if(normalized)for(const key in normalized)res[key]=normalized[key]}return res}if(isString$1(value)||isObject(value))return value}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(cssText){const ret={};return cssText.replace(styleCommentRE,"").split(listDelimiterRE).forEach(item=>{if(item){const tmp=item.split(propertyDelimiterRE);tmp.length>1&&(ret[tmp[0].trim()]=tmp[1].trim())}}),ret}function normalizeClass(value){let res="";if(isString$1(value))res=value;else if(isArray$2(value))for(let i=0;i<value.length;i++){const normalized=normalizeClass(value[i]);normalized&&(res+=normalized+" ")}else if(isObject(value))for(const name in value)value[name]&&(res+=name+" ");return res.trim()}const isSpecialBooleanAttr=makeMap("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function includeBooleanAttr(value){return!!value||""===value}const isRef$1=val=>!(!val||!0!==val.__v_isRef),toDisplayString=val=>isString$1(val)?val:null==val?"":isArray$2(val)||isObject(val)&&(val.toString===objectToString||!isFunction(val.toString))?isRef$1(val)?toDisplayString(val.value):JSON.stringify(val,replacer,2):String(val),replacer=(_key,val)=>isRef$1(val)?replacer(_key,val.value):isMap$1(val)?{[`Map(${val.size})`]:[...val.entries()].reduce((entries,[key,val2],i)=>(entries[stringifySymbol(key,i)+" =>"]=val2,entries),{})}:isSet(val)?{[`Set(${val.size})`]:[...val.values()].map(v=>stringifySymbol(v))}:isSymbol(val)?stringifySymbol(val):!isObject(val)||isArray$2(val)||isPlainObject$1(val)?val:String(val),stringifySymbol=(v,i="")=>{var _a2;return isSymbol(v)?`Symbol(${null!=(_a2=v.description)?_a2:i})`:v};let activeEffectScope,activeSub;class EffectScope{constructor(detached=!1){this.detached=detached,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=activeEffectScope,!detached&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let i,l2;if(this._isPaused=!0,this.scopes)for(i=0,l2=this.scopes.length;i<l2;i++)this.scopes[i].pause();for(i=0,l2=this.effects.length;i<l2;i++)this.effects[i].pause()}}resume(){if(this._active&&this._isPaused){let i,l2;if(this._isPaused=!1,this.scopes)for(i=0,l2=this.scopes.length;i<l2;i++)this.scopes[i].resume();for(i=0,l2=this.effects.length;i<l2;i++)this.effects[i].resume()}}run(fn){if(this._active){const currentEffectScope=activeEffectScope;try{return activeEffectScope=this,fn()}finally{activeEffectScope=currentEffectScope}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(fromParent){if(this._active){let i,l2;for(i=0,l2=this.effects.length;i<l2;i++)this.effects[i].stop();for(i=0,l2=this.cleanups.length;i<l2;i++)this.cleanups[i]();if(this.scopes)for(i=0,l2=this.scopes.length;i<l2;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!fromParent){const last=this.parent.scopes.pop();last&&last!==this&&(this.parent.scopes[this.index]=last,last.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(detached){return new EffectScope(detached)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(fn,failSilently=!1){activeEffectScope&&activeEffectScope.cleanups.push(fn)}const pausedQueueEffects=new WeakSet;class ReactiveEffect{constructor(fn){this.fn=fn,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,activeEffectScope&&activeEffectScope.active&&activeEffectScope.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,pausedQueueEffects.has(this)&&(pausedQueueEffects.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||batch(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,cleanupEffect(this),prepareDeps(this);const prevEffect=activeSub,prevShouldTrack=shouldTrack;activeSub=this,shouldTrack=!0;try{return this.fn()}finally{cleanupDeps(this),activeSub=prevEffect,shouldTrack=prevShouldTrack,this.flags&=-3}}stop(){if(1&this.flags){for(let link=this.deps;link;link=link.nextDep)removeSub(link);this.deps=this.depsTail=void 0,cleanupEffect(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?pausedQueueEffects.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){isDirty(this)&&this.run()}get dirty(){return isDirty(this)}}let batchedSub,batchDepth=0;function batch(sub){sub.flags|=8,sub.next=batchedSub,batchedSub=sub}function startBatch(){batchDepth++}function endBatch(){if(--batchDepth>0)return;let error;for(;batchedSub;){let next,e=batchedSub;for(;e;)1&e.flags||(e.flags&=-9),e=e.next;for(e=batchedSub,batchedSub=void 0;e;){if(next=e.next,e.next=void 0,e.flags&=-9,1&e.flags)try{e.trigger()}catch(err){error||(error=err)}e=next}}if(error)throw error}function prepareDeps(sub){for(let link=sub.deps;link;link=link.nextDep)link.version=-1,link.prevActiveLink=link.dep.activeLink,link.dep.activeLink=link}function cleanupDeps(sub){let head,tail=sub.depsTail,link=tail;for(;link;){const prev=link.prevDep;-1===link.version?(link===tail&&(tail=prev),removeSub(link),removeDep(link)):head=link,link.dep.activeLink=link.prevActiveLink,link.prevActiveLink=void 0,link=prev}sub.deps=head,sub.depsTail=tail}function isDirty(sub){for(let link=sub.deps;link;link=link.nextDep)if(link.dep.version!==link.version||link.dep.computed&&(refreshComputed(link.dep.computed)||link.dep.version!==link.version))return!0;return!!sub._dirty}function refreshComputed(computed2){if(4&computed2.flags&&!(16&computed2.flags))return;if(computed2.flags&=-17,computed2.globalVersion===globalVersion)return;computed2.globalVersion=globalVersion;const dep=computed2.dep;if(computed2.flags|=2,dep.version>0&&!computed2.isSSR&&computed2.deps&&!isDirty(computed2))return void(computed2.flags&=-3);const prevSub=activeSub,prevShouldTrack=shouldTrack;activeSub=computed2,shouldTrack=!0;try{prepareDeps(computed2);const value=computed2.fn(computed2._value);(0===dep.version||hasChanged(value,computed2._value))&&(computed2._value=value,dep.version++)}catch(err){throw dep.version++,err}finally{activeSub=prevSub,shouldTrack=prevShouldTrack,cleanupDeps(computed2),computed2.flags&=-3}}function removeSub(link,soft=!1){const{dep:dep,prevSub:prevSub,nextSub:nextSub}=link;if(prevSub&&(prevSub.nextSub=nextSub,link.prevSub=void 0),nextSub&&(nextSub.prevSub=prevSub,link.nextSub=void 0),dep.subs===link&&(dep.subs=prevSub),!dep.subs&&dep.computed){dep.computed.flags&=-5;for(let l2=dep.computed.deps;l2;l2=l2.nextDep)removeSub(l2,!0)}soft||--dep.sc||!dep.map||dep.map.delete(dep.key)}function removeDep(link){const{prevDep:prevDep,nextDep:nextDep}=link;prevDep&&(prevDep.nextDep=nextDep,link.prevDep=void 0),nextDep&&(nextDep.prevDep=prevDep,link.nextDep=void 0)}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const last=trackStack.pop();shouldTrack=void 0===last||last}function cleanupEffect(e){const{cleanup:cleanup}=e;if(e.cleanup=void 0,cleanup){const prevSub=activeSub;activeSub=void 0;try{cleanup()}finally{activeSub=prevSub}}}let globalVersion=0;class Link{constructor(sub,dep){this.sub=sub,this.dep=dep,this.version=dep.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Dep{constructor(computed2){this.computed=computed2,this.version=0,this.activeLink=void 0,this.subs=void 0,this.target=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(debugInfo){if(!activeSub||!shouldTrack||activeSub===this.computed)return;let link=this.activeLink;if(void 0===link||link.sub!==activeSub)link=this.activeLink=new Link(activeSub,this),activeSub.deps?(link.prevDep=activeSub.depsTail,activeSub.depsTail.nextDep=link,activeSub.depsTail=link):activeSub.deps=activeSub.depsTail=link,addSub(link);else if(-1===link.version&&(link.version=this.version,link.nextDep)){const next=link.nextDep;next.prevDep=link.prevDep,link.prevDep&&(link.prevDep.nextDep=next),link.prevDep=activeSub.depsTail,link.nextDep=void 0,activeSub.depsTail.nextDep=link,activeSub.depsTail=link,activeSub.deps===link&&(activeSub.deps=next)}return link}trigger(debugInfo){this.version++,globalVersion++,this.notify(debugInfo)}notify(debugInfo){startBatch();try{0;for(let link=this.subs;link;link=link.prevSub)link.sub.notify()&&link.sub.dep.notify()}finally{endBatch()}}}function addSub(link){if(link.dep.sc++,4&link.sub.flags){const computed2=link.dep.computed;if(computed2&&!link.dep.subs){computed2.flags|=20;for(let l2=computed2.deps;l2;l2=l2.nextDep)addSub(l2)}const currentTail=link.dep.subs;currentTail!==link&&(link.prevSub=currentTail,currentTail&&(currentTail.nextSub=link)),link.dep.subs=link}}const targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol(""),ARRAY_ITERATE_KEY=Symbol("");function track(target,type,key){if(shouldTrack&&activeSub){let depsMap=targetMap.get(target);depsMap||targetMap.set(target,depsMap=new Map);let dep=depsMap.get(key);dep||(depsMap.set(key,dep=new Dep),dep.target=target,dep.map=depsMap,dep.key=key),dep.track()}}function trigger(target,type,key,newValue,oldValue,oldTarget){const depsMap=targetMap.get(target);if(!depsMap)return void globalVersion++;const run=dep=>{dep&&dep.trigger()};if(startBatch(),"clear"===type)depsMap.forEach(run);else{const targetIsArray=isArray$2(target),isArrayIndex=targetIsArray&&isIntegerKey(key);if(targetIsArray&&"length"===key){const newLength=Number(newValue);depsMap.forEach((dep,key2)=>{("length"===key2||key2===ARRAY_ITERATE_KEY||!isSymbol(key2)&&key2>=newLength)&&run(dep)})}else switch(void 0!==key&&run(depsMap.get(key)),isArrayIndex&&run(depsMap.get(ARRAY_ITERATE_KEY)),type){case"add":targetIsArray?isArrayIndex&&run(depsMap.get("length")):(run(depsMap.get(ITERATE_KEY)),isMap$1(target)&&run(depsMap.get(MAP_KEY_ITERATE_KEY)));break;case"delete":targetIsArray||(run(depsMap.get(ITERATE_KEY)),isMap$1(target)&&run(depsMap.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap$1(target)&&run(depsMap.get(ITERATE_KEY))}}endBatch()}function reactiveReadArray(array){const raw=toRaw(array);return raw===array?raw:(track(raw,0,ARRAY_ITERATE_KEY),isShallow(array)?raw:raw.map(toReactive))}function shallowReadArray(arr){return track(arr=toRaw(arr),0,ARRAY_ITERATE_KEY),arr}const arrayInstrumentations={__proto__:null,[Symbol.iterator](){return iterator(this,Symbol.iterator,toReactive)},concat(...args){return reactiveReadArray(this).concat(...args.map(x=>isArray$2(x)?reactiveReadArray(x):x))},entries(){return iterator(this,"entries",value=>(value[1]=toReactive(value[1]),value))},every(fn,thisArg){return apply(this,"every",fn,thisArg,void 0,arguments)},filter(fn,thisArg){return apply(this,"filter",fn,thisArg,v=>v.map(toReactive),arguments)},find(fn,thisArg){return apply(this,"find",fn,thisArg,toReactive,arguments)},findIndex(fn,thisArg){return apply(this,"findIndex",fn,thisArg,void 0,arguments)},findLast(fn,thisArg){return apply(this,"findLast",fn,thisArg,toReactive,arguments)},findLastIndex(fn,thisArg){return apply(this,"findLastIndex",fn,thisArg,void 0,arguments)},forEach(fn,thisArg){return apply(this,"forEach",fn,thisArg,void 0,arguments)},includes(...args){return searchProxy(this,"includes",args)},indexOf(...args){return searchProxy(this,"indexOf",args)},join(separator){return reactiveReadArray(this).join(separator)},lastIndexOf(...args){return searchProxy(this,"lastIndexOf",args)},map(fn,thisArg){return apply(this,"map",fn,thisArg,void 0,arguments)},pop(){return noTracking(this,"pop")},push(...args){return noTracking(this,"push",args)},reduce(fn,...args){return reduce(this,"reduce",fn,args)},reduceRight(fn,...args){return reduce(this,"reduceRight",fn,args)},shift(){return noTracking(this,"shift")},some(fn,thisArg){return apply(this,"some",fn,thisArg,void 0,arguments)},splice(...args){return noTracking(this,"splice",args)},toReversed(){return reactiveReadArray(this).toReversed()},toSorted(comparer){return reactiveReadArray(this).toSorted(comparer)},toSpliced(...args){return reactiveReadArray(this).toSpliced(...args)},unshift(...args){return noTracking(this,"unshift",args)},values(){return iterator(this,"values",toReactive)}};function iterator(self2,method,wrapValue){const arr=shallowReadArray(self2),iter2=arr[method]();return arr===self2||isShallow(self2)||(iter2._next=iter2.next,iter2.next=()=>{const result=iter2._next();return result.value&&(result.value=wrapValue(result.value)),result}),iter2}const arrayProto=Array.prototype;function apply(self2,method,fn,thisArg,wrappedRetFn,args){const arr=shallowReadArray(self2),needsWrap=arr!==self2&&!isShallow(self2),methodFn=arr[method];if(methodFn!==arrayProto[method]){const result2=methodFn.apply(self2,args);return needsWrap?toReactive(result2):result2}let wrappedFn=fn;arr!==self2&&(needsWrap?wrappedFn=function(item,index2){return fn.call(this,toReactive(item),index2,self2)}:fn.length>2&&(wrappedFn=function(item,index2){return fn.call(this,item,index2,self2)}));const result=methodFn.call(arr,wrappedFn,thisArg);return needsWrap&&wrappedRetFn?wrappedRetFn(result):result}function reduce(self2,method,fn,args){const arr=shallowReadArray(self2);let wrappedFn=fn;return arr!==self2&&(isShallow(self2)?fn.length>3&&(wrappedFn=function(acc,item,index2){return fn.call(this,acc,item,index2,self2)}):wrappedFn=function(acc,item,index2){return fn.call(this,acc,toReactive(item),index2,self2)}),arr[method](wrappedFn,...args)}function searchProxy(self2,method,args){const arr=toRaw(self2);track(arr,0,ARRAY_ITERATE_KEY);const res=arr[method](...args);return-1!==res&&!1!==res||!isProxy(args[0])?res:(args[0]=toRaw(args[0]),arr[method](...args))}function noTracking(self2,method,args=[]){pauseTracking(),startBatch();const res=toRaw(self2)[method].apply(self2,args);return endBatch(),resetTracking(),res}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(key=>"arguments"!==key&&"caller"!==key).map(key=>Symbol[key]).filter(isSymbol));function hasOwnProperty$1(key){isSymbol(key)||(key=String(key));const obj=toRaw(this);return track(obj,0,key),obj.hasOwnProperty(key)}class BaseReactiveHandler{constructor(_isReadonly=!1,_isShallow=!1){this._isReadonly=_isReadonly,this._isShallow=_isShallow}get(target,key,receiver){const isReadonly2=this._isReadonly,isShallow2=this._isShallow;if("__v_isReactive"===key)return!isReadonly2;if("__v_isReadonly"===key)return isReadonly2;if("__v_isShallow"===key)return isShallow2;if("__v_raw"===key)return receiver===(isReadonly2?isShallow2?shallowReadonlyMap:readonlyMap:isShallow2?shallowReactiveMap:reactiveMap).get(target)||Object.getPrototypeOf(target)===Object.getPrototypeOf(receiver)?target:void 0;const targetIsArray=isArray$2(target);if(!isReadonly2){let fn;if(targetIsArray&&(fn=arrayInstrumentations[key]))return fn;if("hasOwnProperty"===key)return hasOwnProperty$1}const res=Reflect.get(target,key,isRef(target)?target:receiver);return(isSymbol(key)?builtInSymbols.has(key):isNonTrackableKeys(key))?res:(isReadonly2||track(target,0,key),isShallow2?res:isRef(res)?targetIsArray&&isIntegerKey(key)?res:res.value:isObject(res)?isReadonly2?readonly(res):reactive(res):res)}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(isShallow2=!1){super(!1,isShallow2)}set(target,key,value,receiver){let oldValue=target[key];if(!this._isShallow){const isOldValueReadonly=isReadonly(oldValue);if(isShallow(value)||isReadonly(value)||(oldValue=toRaw(oldValue),value=toRaw(value)),!isArray$2(target)&&isRef(oldValue)&&!isRef(value))return!isOldValueReadonly&&(oldValue.value=value,!0)}const hadKey=isArray$2(target)&&isIntegerKey(key)?Number(key)<target.length:hasOwn(target,key),result=Reflect.set(target,key,value,isRef(target)?target:receiver);return target===toRaw(receiver)&&(hadKey?hasChanged(value,oldValue)&&trigger(target,"set",key,value):trigger(target,"add",key,value)),result}deleteProperty(target,key){const hadKey=hasOwn(target,key);target[key];const result=Reflect.deleteProperty(target,key);return result&&hadKey&&trigger(target,"delete",key,void 0),result}has(target,key){const result=Reflect.has(target,key);return isSymbol(key)&&builtInSymbols.has(key)||track(target,0,key),result}ownKeys(target){return track(target,0,isArray$2(target)?"length":ITERATE_KEY),Reflect.ownKeys(target)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(isShallow2=!1){super(!0,isShallow2)}set(target,key){return!0}deleteProperty(target,key){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=value=>value,getProto=v=>Reflect.getPrototypeOf(v);function get$1(target,key,isReadonly2=!1,isShallow2=!1){const rawTarget=toRaw(target=target.__v_raw),rawKey=toRaw(key);isReadonly2||(hasChanged(key,rawKey)&&track(rawTarget,0,key),track(rawTarget,0,rawKey));const{has:has2}=getProto(rawTarget),wrap=isShallow2?toShallow:isReadonly2?toReadonly:toReactive;return has2.call(rawTarget,key)?wrap(target.get(key)):has2.call(rawTarget,rawKey)?wrap(target.get(rawKey)):void(target!==rawTarget&&target.get(key))}function has(key,isReadonly2=!1){const target=this.__v_raw,rawTarget=toRaw(target),rawKey=toRaw(key);return isReadonly2||(hasChanged(key,rawKey)&&track(rawTarget,0,key),track(rawTarget,0,rawKey)),key===rawKey?target.has(key):target.has(key)||target.has(rawKey)}function size(target,isReadonly2=!1){return target=target.__v_raw,!isReadonly2&&track(toRaw(target),0,ITERATE_KEY),Reflect.get(target,"size",target)}function add(value,_isShallow=!1){_isShallow||isShallow(value)||isReadonly(value)||(value=toRaw(value));const target=toRaw(this);return getProto(target).has.call(target,value)||(target.add(value),trigger(target,"add",value,value)),this}function set$1(key,value,_isShallow=!1){_isShallow||isShallow(value)||isReadonly(value)||(value=toRaw(value));const target=toRaw(this),{has:has2,get:get2}=getProto(target);let hadKey=has2.call(target,key);hadKey||(key=toRaw(key),hadKey=has2.call(target,key));const oldValue=get2.call(target,key);return target.set(key,value),hadKey?hasChanged(value,oldValue)&&trigger(target,"set",key,value):trigger(target,"add",key,value),this}function deleteEntry(key){const target=toRaw(this),{has:has2,get:get2}=getProto(target);let hadKey=has2.call(target,key);hadKey||(key=toRaw(key),hadKey=has2.call(target,key)),get2&&get2.call(target,key);const result=target.delete(key);return hadKey&&trigger(target,"delete",key,void 0),result}function clear(){const target=toRaw(this),hadItems=0!==target.size,result=target.clear();return hadItems&&trigger(target,"clear",void 0,void 0),result}function createForEach(isReadonly2,isShallow2){return function(callback,thisArg){const observed=this,target=observed.__v_raw,rawTarget=toRaw(target),wrap=isShallow2?toShallow:isReadonly2?toReadonly:toReactive;return!isReadonly2&&track(rawTarget,0,ITERATE_KEY),target.forEach((value,key)=>callback.call(thisArg,wrap(value),wrap(key),observed))}}function createIterableMethod(method,isReadonly2,isShallow2){return function(...args){const target=this.__v_raw,rawTarget=toRaw(target),targetIsMap=isMap$1(rawTarget),isPair2="entries"===method||method===Symbol.iterator&&targetIsMap,isKeyOnly="keys"===method&&targetIsMap,innerIterator=target[method](...args),wrap=isShallow2?toShallow:isReadonly2?toReadonly:toReactive;return!isReadonly2&&track(rawTarget,0,isKeyOnly?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:value,done:done}=innerIterator.next();return done?{value:value,done:done}:{value:isPair2?[wrap(value[0]),wrap(value[1])]:wrap(value),done:done}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(type){return function(...args){return"delete"!==type&&("clear"===type?void 0:this)}}function createInstrumentations(){const mutableInstrumentations2={get(key){return get$1(this,key)},get size(){return size(this)},has:has,add:add,set:set$1,delete:deleteEntry,clear:clear,forEach:createForEach(!1,!1)},shallowInstrumentations2={get(key){return get$1(this,key,!1,!0)},get size(){return size(this)},has:has,add(value){return add.call(this,value,!0)},set(key,value){return set$1.call(this,key,value,!0)},delete:deleteEntry,clear:clear,forEach:createForEach(!1,!0)},readonlyInstrumentations2={get(key){return get$1(this,key,!0)},get size(){return size(this,!0)},has(key){return has.call(this,key,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},shallowReadonlyInstrumentations2={get(key){return get$1(this,key,!0,!0)},get size(){return size(this,!0)},has(key){return has.call(this,key,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(method=>{mutableInstrumentations2[method]=createIterableMethod(method,!1,!1),readonlyInstrumentations2[method]=createIterableMethod(method,!0,!1),shallowInstrumentations2[method]=createIterableMethod(method,!1,!0),shallowReadonlyInstrumentations2[method]=createIterableMethod(method,!0,!0)}),[mutableInstrumentations2,readonlyInstrumentations2,shallowInstrumentations2,shallowReadonlyInstrumentations2]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(isReadonly2,shallow){const instrumentations=shallow?isReadonly2?shallowReadonlyInstrumentations:shallowInstrumentations:isReadonly2?readonlyInstrumentations:mutableInstrumentations;return(target,key,receiver)=>"__v_isReactive"===key?!isReadonly2:"__v_isReadonly"===key?isReadonly2:"__v_raw"===key?target:Reflect.get(hasOwn(instrumentations,key)&&key in target?instrumentations:target,key,receiver)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function getTargetType(value){return value.__v_skip||!Object.isExtensible(value)?0:function(rawType){switch(rawType){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((value=>toTypeString(value).slice(8,-1))(value))}function reactive(target){return isReadonly(target)?target:createReactiveObject(target,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(target){return createReactiveObject(target,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(target){return createReactiveObject(target,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(target,isReadonly2,baseHandlers,collectionHandlers,proxyMap){if(!isObject(target))return target;if(target.__v_raw&&(!isReadonly2||!target.__v_isReactive))return target;const existingProxy=proxyMap.get(target);if(existingProxy)return existingProxy;const targetType=getTargetType(target);if(0===targetType)return target;const proxy=new Proxy(target,2===targetType?collectionHandlers:baseHandlers);return proxyMap.set(target,proxy),proxy}function isReactive(value){return isReadonly(value)?isReactive(value.__v_raw):!(!value||!value.__v_isReactive)}function isReadonly(value){return!(!value||!value.__v_isReadonly)}function isShallow(value){return!(!value||!value.__v_isShallow)}function isProxy(value){return!!value&&!!value.__v_raw}function toRaw(observed){const raw=observed&&observed.__v_raw;return raw?toRaw(raw):observed}function markRaw(value){return!hasOwn(value,"__v_skip")&&Object.isExtensible(value)&&def(value,"__v_skip",!0),value}const toReactive=value=>isObject(value)?reactive(value):value,toReadonly=value=>isObject(value)?readonly(value):value;function isRef(r){return!!r&&!0===r.__v_isRef}function ref(value){return createRef(value,!1)}function createRef(rawValue,shallow){return isRef(rawValue)?rawValue:new RefImpl(rawValue,shallow)}class RefImpl{constructor(value,isShallow2){this.dep=new Dep,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=isShallow2?value:toRaw(value),this._value=isShallow2?value:toReactive(value),this.__v_isShallow=isShallow2}get value(){return this.dep.track(),this._value}set value(newValue){const oldValue=this._rawValue,useDirectValue=this.__v_isShallow||isShallow(newValue)||isReadonly(newValue);newValue=useDirectValue?newValue:toRaw(newValue),hasChanged(newValue,oldValue)&&(this._rawValue=newValue,this._value=useDirectValue?newValue:toReactive(newValue),this.dep.trigger())}}function unref(ref2){return isRef(ref2)?ref2.value:ref2}const shallowUnwrapHandlers={get:(target,key,receiver)=>"__v_raw"===key?target:unref(Reflect.get(target,key,receiver)),set:(target,key,value,receiver)=>{const oldValue=target[key];return isRef(oldValue)&&!isRef(value)?(oldValue.value=value,!0):Reflect.set(target,key,value,receiver)}};function proxyRefs(objectWithRefs){return isReactive(objectWithRefs)?objectWithRefs:new Proxy(objectWithRefs,shallowUnwrapHandlers)}class ObjectRefImpl{constructor(_object,_key,_defaultValue){this._object=_object,this._key=_key,this._defaultValue=_defaultValue,this.__v_isRef=!0,this._value=void 0}get value(){const val=this._object[this._key];return this._value=void 0===val?this._defaultValue:val}set value(newVal){this._object[this._key]=newVal}get dep(){return function(object,key){const depMap=targetMap.get(object);return depMap&&depMap.get(key)}(toRaw(this._object),this._key)}}function propertyToRef(source,key,defaultValue){const val=source[key];return isRef(val)?val:new ObjectRefImpl(source,key,defaultValue)}class ComputedRefImpl{constructor(fn,setter,isSSR){this.fn=fn,this.setter=setter,this._value=void 0,this.dep=new Dep(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=globalVersion-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!setter,this.isSSR=isSSR}notify(){if(this.flags|=16,!(8&this.flags)&&activeSub!==this)return batch(this),!0}get value(){const link=this.dep.track();return refreshComputed(this),link&&(link.version=this.dep.version),this._value}set value(newValue){this.setter&&this.setter(newValue)}}function computed$1(getterOrOptions,debugOptions,isSSR=!1){let getter,setter;isFunction(getterOrOptions)?getter=getterOrOptions:(getter=getterOrOptions.get,setter=getterOrOptions.set);return new ComputedRefImpl(getter,setter,isSSR)}const INITIAL_WATCHER_VALUE={},cleanupMap=new WeakMap;let activeWatcher;function watch$1(source,cb,options=EMPTY_OBJ){const{immediate:immediate,deep:deep,once:once,scheduler:scheduler,augmentJob:augmentJob,call:call}=options,reactiveGetter=source2=>deep?source2:isShallow(source2)||!1===deep||0===deep?traverse(source2,1):traverse(source2);let effect2,getter,cleanup,boundCleanup,forceTrigger=!1,isMultiSource=!1;if(isRef(source)?(getter=()=>source.value,forceTrigger=isShallow(source)):isReactive(source)?(getter=()=>reactiveGetter(source),forceTrigger=!0):isArray$2(source)?(isMultiSource=!0,forceTrigger=source.some(s2=>isReactive(s2)||isShallow(s2)),getter=()=>source.map(s2=>isRef(s2)?s2.value:isReactive(s2)?reactiveGetter(s2):isFunction(s2)?call?call(s2,2):s2():void 0)):getter=isFunction(source)?cb?call?()=>call(source,2):source:()=>{if(cleanup){pauseTracking();try{cleanup()}finally{resetTracking()}}const currentEffect=activeWatcher;activeWatcher=effect2;try{return call?call(source,3,[boundCleanup]):source(boundCleanup)}finally{activeWatcher=currentEffect}}:NOOP,cb&&deep){const baseGetter=getter,depth=!0===deep?1/0:deep;getter=()=>traverse(baseGetter(),depth)}const scope=getCurrentScope(),watchHandle=()=>{effect2.stop(),scope&&remove$1(scope.effects,effect2)};if(once&&cb){const _cb=cb;cb=(...args)=>{_cb(...args),watchHandle()}}let oldValue=isMultiSource?new Array(source.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const job=immediateFirstRun=>{if(1&effect2.flags&&(effect2.dirty||immediateFirstRun))if(cb){const newValue=effect2.run();if(deep||forceTrigger||(isMultiSource?newValue.some((v,i)=>hasChanged(v,oldValue[i])):hasChanged(newValue,oldValue))){cleanup&&cleanup();const currentWatcher=activeWatcher;activeWatcher=effect2;try{const args=[newValue,oldValue===INITIAL_WATCHER_VALUE?void 0:isMultiSource&&oldValue[0]===INITIAL_WATCHER_VALUE?[]:oldValue,boundCleanup];call?call(cb,3,args):cb(...args),oldValue=newValue}finally{activeWatcher=currentWatcher}}}else effect2.run()};return augmentJob&&augmentJob(job),effect2=new ReactiveEffect(getter),effect2.scheduler=scheduler?()=>scheduler(job,!1):job,boundCleanup=fn=>function(cleanupFn,failSilently=!1,owner=activeWatcher){if(owner){let cleanups=cleanupMap.get(owner);cleanups||cleanupMap.set(owner,cleanups=[]),cleanups.push(cleanupFn)}}(fn,!1,effect2),cleanup=effect2.onStop=()=>{const cleanups=cleanupMap.get(effect2);if(cleanups){if(call)call(cleanups,4);else for(const cleanup2 of cleanups)cleanup2();cleanupMap.delete(effect2)}},cb?immediate?job(!0):oldValue=effect2.run():scheduler?scheduler(job.bind(null,!0),!0):effect2.run(),watchHandle.pause=effect2.pause.bind(effect2),watchHandle.resume=effect2.resume.bind(effect2),watchHandle.stop=watchHandle,watchHandle}function traverse(value,depth=1/0,seen){if(depth<=0||!isObject(value)||value.__v_skip)return value;if((seen=seen||new Set).has(value))return value;if(seen.add(value),depth--,isRef(value))traverse(value.value,depth,seen);else if(isArray$2(value))for(let i=0;i<value.length;i++)traverse(value[i],depth,seen);else if(isSet(value)||isMap$1(value))value.forEach(v=>{traverse(v,depth,seen)});else if(isPlainObject$1(value)){for(const key in value)traverse(value[key],depth,seen);for(const key of Object.getOwnPropertySymbols(value))Object.prototype.propertyIsEnumerable.call(value,key)&&traverse(value[key],depth,seen)}return value}function callWithErrorHandling(fn,instance,type,args){try{return args?fn(...args):fn()}catch(err){handleError(err,instance,type)}}function callWithAsyncErrorHandling(fn,instance,type,args){if(isFunction(fn)){const res=callWithErrorHandling(fn,instance,type,args);return res&&isPromise(res)&&res.catch(err=>{handleError(err,instance,type)}),res}if(isArray$2(fn)){const values=[];for(let i=0;i<fn.length;i++)values.push(callWithAsyncErrorHandling(fn[i],instance,type,args));return values}}function handleError(err,instance,type,throwInDev=!0){instance&&instance.vnode;const{errorHandler:errorHandler,throwUnhandledErrorInProduction:throwUnhandledErrorInProduction}=instance&&instance.appContext.config||EMPTY_OBJ;if(instance){let cur=instance.parent;const exposedInstance=instance.proxy,errorInfo=`https://vuejs.org/error-reference/#runtime-${type}`;for(;cur;){const errorCapturedHooks=cur.ec;if(errorCapturedHooks)for(let i=0;i<errorCapturedHooks.length;i++)if(!1===errorCapturedHooks[i](err,exposedInstance,errorInfo))return;cur=cur.parent}if(errorHandler)return pauseTracking(),callWithErrorHandling(errorHandler,null,10,[err,exposedInstance,errorInfo]),void resetTracking()}!function(err,type,contextVNode,throwInDev=!0,throwInProd=!1){if(throwInProd)throw err;console.error(err)}(err,0,0,throwInDev,throwUnhandledErrorInProduction)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(fn){const p2=currentFlushPromise||resolvedPromise;return fn?p2.then(this?fn.bind(this):fn):p2}function queueJob(job){if(!(1&job.flags)){const jobId=getId(job),lastJob=queue[queue.length-1];!lastJob||!(2&job.flags)&&jobId>=getId(lastJob)?queue.push(job):queue.splice(function(id){let start=isFlushing?flushIndex+1:0,end=queue.length;for(;start<end;){const middle=start+end>>>1,middleJob=queue[middle],middleJobId=getId(middleJob);middleJobId<id||middleJobId===id&&2&middleJob.flags?start=middle+1:end=middle}return start}(jobId),0,job),job.flags|=1,queueFlush()}}function queueFlush(){isFlushing||isFlushPending||(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function flushPreFlushCbs(instance,seen,i=(isFlushing?flushIndex+1:0)){for(;i<queue.length;i++){const cb=queue[i];if(cb&&2&cb.flags){if(instance&&cb.id!==instance.uid)continue;queue.splice(i,1),i--,4&cb.flags&&(cb.flags&=-2),cb(),4&cb.flags||(cb.flags&=-2)}}}function flushPostFlushCbs(seen){if(pendingPostFlushCbs.length){const deduped=[...new Set(pendingPostFlushCbs)].sort((a,b)=>getId(a)-getId(b));if(pendingPostFlushCbs.length=0,activePostFlushCbs)return void activePostFlushCbs.push(...deduped);for(activePostFlushCbs=deduped,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++){const cb=activePostFlushCbs[postFlushIndex];4&cb.flags&&(cb.flags&=-2),8&cb.flags||cb(),cb.flags&=-2}activePostFlushCbs=null,postFlushIndex=0}}const getId=job=>null==job.id?2&job.flags?-1:1/0:job.id;function flushJobs(seen){isFlushPending=!1,isFlushing=!0;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const job=queue[flushIndex];!job||8&job.flags||(4&job.flags&&(job.flags&=-2),callWithErrorHandling(job,job.i,job.i?15:14),4&job.flags||(job.flags&=-2))}}finally{for(;flushIndex<queue.length;flushIndex++){const job=queue[flushIndex];job&&(job.flags&=-2)}flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(instance){const prev=currentRenderingInstance;return currentRenderingInstance=instance,currentScopeId=instance&&instance.type.__scopeId||null,prev}function withCtx(fn,ctx=currentRenderingInstance,isNonScopedSlot){if(!ctx)return fn;if(fn._n)return fn;const renderFnWithContext=(...args)=>{renderFnWithContext._d&&setBlockTracking(-1);const prevInstance=setCurrentRenderingInstance(ctx);let res;try{res=fn(...args)}finally{setCurrentRenderingInstance(prevInstance),renderFnWithContext._d&&setBlockTracking(1)}return res};return renderFnWithContext._n=!0,renderFnWithContext._c=!0,renderFnWithContext._d=!0,renderFnWithContext}function withDirectives(vnode,directives){if(null===currentRenderingInstance)return vnode;const instance=getComponentPublicInstance(currentRenderingInstance),bindings=vnode.dirs||(vnode.dirs=[]);for(let i=0;i<directives.length;i++){let[dir,value,arg,modifiers=EMPTY_OBJ]=directives[i];dir&&(isFunction(dir)&&(dir={mounted:dir,updated:dir}),dir.deep&&traverse(value),bindings.push({dir:dir,instance:instance,value:value,oldValue:void 0,arg:arg,modifiers:modifiers}))}return vnode}function invokeDirectiveHook(vnode,prevVNode,instance,name){const bindings=vnode.dirs,oldBindings=prevVNode&&prevVNode.dirs;for(let i=0;i<bindings.length;i++){const binding=bindings[i];oldBindings&&(binding.oldValue=oldBindings[i].value);let hook=binding.dir[name];hook&&(pauseTracking(),callWithAsyncErrorHandling(hook,instance,8,[vnode.el,binding,vnode,prevVNode]),resetTracking())}}const TeleportEndKey=Symbol("_vte"),isTeleport=type=>type.__isTeleport,leaveCbKey=Symbol("_leaveCb"),enterCbKey=Symbol("_enterCb");const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},recursiveGetSubtree=instance=>{const subTree=instance.subTree;return subTree.component?recursiveGetSubtree(subTree.component):subTree};function findNonCommentChild(children){let child=children[0];if(children.length>1)for(const c of children)if(c.type!==Comment){child=c;break}return child}const BaseTransition={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(props,{slots:slots}){const instance=getCurrentInstance(),state=function(){const state={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{state.isMounted=!0}),onBeforeUnmount(()=>{state.isUnmounting=!0}),state}();return()=>{const children=slots.default&&getTransitionRawChildren(slots.default(),!0);if(!children||!children.length)return;const child=findNonCommentChild(children),rawProps=toRaw(props),{mode:mode}=rawProps;if(state.isLeaving)return emptyPlaceholder(child);const innerChild=getInnerChild$1(child);if(!innerChild)return emptyPlaceholder(child);let enterHooks=resolveTransitionHooks(innerChild,rawProps,state,instance,hooks=>enterHooks=hooks);innerChild.type!==Comment&&setTransitionHooks(innerChild,enterHooks);const oldChild=instance.subTree,oldInnerChild=oldChild&&getInnerChild$1(oldChild);if(oldInnerChild&&oldInnerChild.type!==Comment&&!isSameVNodeType(innerChild,oldInnerChild)&&recursiveGetSubtree(instance).type!==Comment){const leavingHooks=resolveTransitionHooks(oldInnerChild,rawProps,state,instance);if(setTransitionHooks(oldInnerChild,leavingHooks),"out-in"===mode&&innerChild.type!==Comment)return state.isLeaving=!0,leavingHooks.afterLeave=()=>{state.isLeaving=!1,8&instance.job.flags||instance.update(),delete leavingHooks.afterLeave},emptyPlaceholder(child);"in-out"===mode&&innerChild.type!==Comment&&(leavingHooks.delayLeave=(el,earlyRemove,delayedLeave)=>{getLeavingNodesForType(state,oldInnerChild)[String(oldInnerChild.key)]=oldInnerChild,el[leaveCbKey]=()=>{earlyRemove(),el[leaveCbKey]=void 0,delete enterHooks.delayedLeave},enterHooks.delayedLeave=delayedLeave})}return child}}};function getLeavingNodesForType(state,vnode){const{leavingVNodes:leavingVNodes}=state;let leavingVNodesCache=leavingVNodes.get(vnode.type);return leavingVNodesCache||(leavingVNodesCache=Object.create(null),leavingVNodes.set(vnode.type,leavingVNodesCache)),leavingVNodesCache}function resolveTransitionHooks(vnode,props,state,instance,postClone){const{appear:appear,mode:mode,persisted:persisted=!1,onBeforeEnter:onBeforeEnter,onEnter:onEnter,onAfterEnter:onAfterEnter,onEnterCancelled:onEnterCancelled,onBeforeLeave:onBeforeLeave,onLeave:onLeave,onAfterLeave:onAfterLeave,onLeaveCancelled:onLeaveCancelled,onBeforeAppear:onBeforeAppear,onAppear:onAppear,onAfterAppear:onAfterAppear,onAppearCancelled:onAppearCancelled}=props,key=String(vnode.key),leavingVNodesCache=getLeavingNodesForType(state,vnode),callHook2=(hook,args)=>{hook&&callWithAsyncErrorHandling(hook,instance,9,args)},callAsyncHook=(hook,args)=>{const done=args[1];callHook2(hook,args),isArray$2(hook)?hook.every(hook2=>hook2.length<=1)&&done():hook.length<=1&&done()},hooks={mode:mode,persisted:persisted,beforeEnter(el){let hook=onBeforeEnter;if(!state.isMounted){if(!appear)return;hook=onBeforeAppear||onBeforeEnter}el[leaveCbKey]&&el[leaveCbKey](!0);const leavingVNode=leavingVNodesCache[key];leavingVNode&&isSameVNodeType(vnode,leavingVNode)&&leavingVNode.el[leaveCbKey]&&leavingVNode.el[leaveCbKey](),callHook2(hook,[el])},enter(el){let hook=onEnter,afterHook=onAfterEnter,cancelHook=onEnterCancelled;if(!state.isMounted){if(!appear)return;hook=onAppear||onEnter,afterHook=onAfterAppear||onAfterEnter,cancelHook=onAppearCancelled||onEnterCancelled}let called=!1;const done=el[enterCbKey]=cancelled=>{called||(called=!0,callHook2(cancelled?cancelHook:afterHook,[el]),hooks.delayedLeave&&hooks.delayedLeave(),el[enterCbKey]=void 0)};hook?callAsyncHook(hook,[el,done]):done()},leave(el,remove2){const key2=String(vnode.key);if(el[enterCbKey]&&el[enterCbKey](!0),state.isUnmounting)return remove2();callHook2(onBeforeLeave,[el]);let called=!1;const done=el[leaveCbKey]=cancelled=>{called||(called=!0,remove2(),callHook2(cancelled?onLeaveCancelled:onAfterLeave,[el]),el[leaveCbKey]=void 0,leavingVNodesCache[key2]===vnode&&delete leavingVNodesCache[key2])};leavingVNodesCache[key2]=vnode,onLeave?callAsyncHook(onLeave,[el,done]):done()},clone(vnode2){const hooks2=resolveTransitionHooks(vnode2,props,state,instance,postClone);return postClone&&postClone(hooks2),hooks2}};return hooks}function emptyPlaceholder(vnode){if(isKeepAlive(vnode))return(vnode=cloneVNode(vnode)).children=null,vnode}function getInnerChild$1(vnode){if(!isKeepAlive(vnode))return isTeleport(vnode.type)&&vnode.children?findNonCommentChild(vnode.children):vnode;const{shapeFlag:shapeFlag,children:children}=vnode;if(children){if(16&shapeFlag)return children[0];if(32&shapeFlag&&isFunction(children.default))return children.default()}}function setTransitionHooks(vnode,hooks){6&vnode.shapeFlag&&vnode.component?(vnode.transition=hooks,setTransitionHooks(vnode.component.subTree,hooks)):128&vnode.shapeFlag?(vnode.ssContent.transition=hooks.clone(vnode.ssContent),vnode.ssFallback.transition=hooks.clone(vnode.ssFallback)):vnode.transition=hooks}function getTransitionRawChildren(children,keepComment=!1,parentKey){let ret=[],keyedFragmentCount=0;for(let i=0;i<children.length;i++){let child=children[i];const key=null==parentKey?child.key:String(parentKey)+String(null!=child.key?child.key:i);child.type===Fragment?(128&child.patchFlag&&keyedFragmentCount++,ret=ret.concat(getTransitionRawChildren(child.children,keepComment,key))):(keepComment||child.type!==Comment)&&ret.push(null!=key?cloneVNode(child,{key:key}):child)}if(keyedFragmentCount>1)for(let i=0;i<ret.length;i++)ret[i].patchFlag=-2;return ret}function defineComponent(options,extraOptions){return isFunction(options)?(()=>extend$1({name:options.name},extraOptions,{setup:options}))():options}function markAsyncBoundary(instance){instance.ids=[instance.ids[0]+instance.ids[2]+++"-",0,0]}function setRef(rawRef,oldRawRef,parentSuspense,vnode,isUnmount=!1){if(isArray$2(rawRef))return void rawRef.forEach((r,i)=>setRef(r,oldRawRef&&(isArray$2(oldRawRef)?oldRawRef[i]:oldRawRef),parentSuspense,vnode,isUnmount));if(isAsyncWrapper(vnode)&&!isUnmount)return;const refValue=4&vnode.shapeFlag?getComponentPublicInstance(vnode.component):vnode.el,value=isUnmount?null:refValue,{i:owner,r:ref3}=rawRef,oldRef=oldRawRef&&oldRawRef.r,refs=owner.refs===EMPTY_OBJ?owner.refs={}:owner.refs,setupState=owner.setupState,rawSetupState=toRaw(setupState),canSetSetupRef=setupState===EMPTY_OBJ?()=>!1:key=>hasOwn(rawSetupState,key);if(null!=oldRef&&oldRef!==ref3&&(isString$1(oldRef)?(refs[oldRef]=null,canSetSetupRef(oldRef)&&(setupState[oldRef]=null)):isRef(oldRef)&&(oldRef.value=null)),isFunction(ref3))callWithErrorHandling(ref3,owner,12,[value,refs]);else{const _isString=isString$1(ref3),_isRef=isRef(ref3);if(_isString||_isRef){const doSet=()=>{if(rawRef.f){const existing=_isString?canSetSetupRef(ref3)?setupState[ref3]:refs[ref3]:ref3.value;isUnmount?isArray$2(existing)&&remove$1(existing,refValue):isArray$2(existing)?existing.includes(refValue)||existing.push(refValue):_isString?(refs[ref3]=[refValue],canSetSetupRef(ref3)&&(setupState[ref3]=refs[ref3])):(ref3.value=[refValue],rawRef.k&&(refs[rawRef.k]=ref3.value))}else _isString?(refs[ref3]=value,canSetSetupRef(ref3)&&(setupState[ref3]=value)):_isRef&&(ref3.value=value,rawRef.k&&(refs[rawRef.k]=value))};value?(doSet.id=-1,queuePostRenderEffect(doSet,parentSuspense)):doSet()}}}const isAsyncWrapper=i=>!!i.type.__asyncLoader,isKeepAlive=vnode=>vnode.type.__isKeepAlive;function onActivated(hook,target){registerKeepAliveHook(hook,"a",target)}function onDeactivated(hook,target){registerKeepAliveHook(hook,"da",target)}function registerKeepAliveHook(hook,type,target=currentInstance){const wrappedHook=hook.__wdc||(hook.__wdc=()=>{let current=target;for(;current;){if(current.isDeactivated)return;current=current.parent}return hook()});if(injectHook(type,wrappedHook,target),target){let current=target.parent;for(;current&&current.parent;)isKeepAlive(current.parent.vnode)&&injectToKeepAliveRoot(wrappedHook,type,target,current),current=current.parent}}function injectToKeepAliveRoot(hook,type,target,keepAliveRoot){const injected=injectHook(type,hook,keepAliveRoot,!0);onUnmounted(()=>{remove$1(keepAliveRoot[type],injected)},target)}function injectHook(type,hook,target=currentInstance,prepend=!1){if(target){const hooks=target[type]||(target[type]=[]),wrappedHook=hook.__weh||(hook.__weh=(...args)=>{pauseTracking();const reset=setCurrentInstance(target),res=callWithAsyncErrorHandling(hook,target,type,args);return reset(),resetTracking(),res});return prepend?hooks.unshift(wrappedHook):hooks.push(wrappedHook),wrappedHook}}const createHook=lifecycle=>(hook,target=currentInstance)=>{isInSSRComponentSetup&&"sp"!==lifecycle||injectHook(lifecycle,(...args)=>hook(...args),target)},onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(hook,target=currentInstance){injectHook("ec",hook,target)}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function renderList(source,renderItem,cache2,index2){let ret;const cached=cache2,sourceIsArray=isArray$2(source);if(sourceIsArray||isString$1(source)){let needsWrap=!1;sourceIsArray&&isReactive(source)&&(needsWrap=!isShallow(source),source=shallowReadArray(source)),ret=new Array(source.length);for(let i=0,l2=source.length;i<l2;i++)ret[i]=renderItem(needsWrap?toReactive(source[i]):source[i],i,void 0,cached)}else if("number"==typeof source){ret=new Array(source);for(let i=0;i<source;i++)ret[i]=renderItem(i+1,i,void 0,cached)}else if(isObject(source))if(source[Symbol.iterator])ret=Array.from(source,(item,i)=>renderItem(item,i,void 0,cached));else{const keys=Object.keys(source);ret=new Array(keys.length);for(let i=0,l2=keys.length;i<l2;i++){const key=keys[i];ret[i]=renderItem(source[key],key,i,cached)}}else ret=[];return ret}function renderSlot(slots,name,props={},fallback,noSlotted){if(currentRenderingInstance.ce||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.ce)return"default"!==name&&(props.name=name),openBlock(),createBlock(Fragment,null,[createVNode("slot",props,fallback)],64);let slot=slots[name];slot&&slot._c&&(slot._d=!1),openBlock();const validSlotContent=slot&&ensureValidVNode(slot(props)),rendered=createBlock(Fragment,{key:(props.key||validSlotContent&&validSlotContent.key||`_${name}`)+(!validSlotContent&&fallback?"_fb":"")},validSlotContent||[],validSlotContent&&1===slots._?64:-2);return!noSlotted&&rendered.scopeId&&(rendered.slotScopeIds=[rendered.scopeId+"-s"]),slot&&slot._c&&(slot._d=!0),rendered}function ensureValidVNode(vnodes){return vnodes.some(child=>!isVNode(child)||child.type!==Comment&&!(child.type===Fragment&&!ensureValidVNode(child.children)))?vnodes:null}function toHandlers(obj,preserveCaseIfNecessary){const ret={};for(const key in obj)ret[/[A-Z]/.test(key)?`on:${key}`:toHandlerKey(key)]=obj[key];return ret}const getPublicInstance=i=>i?isStatefulComponent(i)?getComponentPublicInstance(i):getPublicInstance(i.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>getPublicInstance(i.parent),$root:i=>getPublicInstance(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>resolveMergedOptions(i),$forceUpdate:i=>i.f||(i.f=()=>{queueJob(i.update)}),$nextTick:i=>i.n||(i.n=nextTick.bind(i.proxy)),$watch:i=>instanceWatch.bind(i)}),hasSetupBinding=(state,key)=>state!==EMPTY_OBJ&&!state.__isScriptSetup&&hasOwn(state,key),PublicInstanceProxyHandlers={get({_:instance},key){if("__v_skip"===key)return!0;const{ctx:ctx,setupState:setupState,data:data,props:props,accessCache:accessCache,type:type,appContext:appContext}=instance;let normalizedProps;if("$"!==key[0]){const n2=accessCache[key];if(void 0!==n2)switch(n2){case 1:return setupState[key];case 2:return data[key];case 4:return ctx[key];case 3:return props[key]}else{if(hasSetupBinding(setupState,key))return accessCache[key]=1,setupState[key];if(data!==EMPTY_OBJ&&hasOwn(data,key))return accessCache[key]=2,data[key];if((normalizedProps=instance.propsOptions[0])&&hasOwn(normalizedProps,key))return accessCache[key]=3,props[key];if(ctx!==EMPTY_OBJ&&hasOwn(ctx,key))return accessCache[key]=4,ctx[key];shouldCacheAccess&&(accessCache[key]=0)}}const publicGetter=publicPropertiesMap[key];let cssModule,globalProperties;return publicGetter?("$attrs"===key&&track(instance.attrs,0,""),publicGetter(instance)):(cssModule=type.__cssModules)&&(cssModule=cssModule[key])?cssModule:ctx!==EMPTY_OBJ&&hasOwn(ctx,key)?(accessCache[key]=4,ctx[key]):(globalProperties=appContext.config.globalProperties,hasOwn(globalProperties,key)?globalProperties[key]:void 0)},set({_:instance},key,value){const{data:data,setupState:setupState,ctx:ctx}=instance;return hasSetupBinding(setupState,key)?(setupState[key]=value,!0):data!==EMPTY_OBJ&&hasOwn(data,key)?(data[key]=value,!0):!hasOwn(instance.props,key)&&(("$"!==key[0]||!(key.slice(1)in instance))&&(ctx[key]=value,!0))},has({_:{data:data,setupState:setupState,accessCache:accessCache,ctx:ctx,appContext:appContext,propsOptions:propsOptions}},key){let normalizedProps;return!!accessCache[key]||data!==EMPTY_OBJ&&hasOwn(data,key)||hasSetupBinding(setupState,key)||(normalizedProps=propsOptions[0])&&hasOwn(normalizedProps,key)||hasOwn(ctx,key)||hasOwn(publicPropertiesMap,key)||hasOwn(appContext.config.globalProperties,key)},defineProperty(target,key,descriptor){return null!=descriptor.get?target._.accessCache[key]=0:hasOwn(descriptor,"value")&&this.set(target,key,descriptor.value,null),Reflect.defineProperty(target,key,descriptor)}};function normalizePropsOrEmits(props){return isArray$2(props)?props.reduce((normalized,p2)=>(normalized[p2]=null,normalized),{}):props}let shouldCacheAccess=!0;function applyOptions(instance){const options=resolveMergedOptions(instance),publicThis=instance.proxy,ctx=instance.ctx;shouldCacheAccess=!1,options.beforeCreate&&callHook$1(options.beforeCreate,instance,"bc");const{data:dataOptions,computed:computedOptions,methods:methods,watch:watchOptions,provide:provideOptions,inject:injectOptions,created:created,beforeMount:beforeMount,mounted:mounted,beforeUpdate:beforeUpdate,updated:updated,activated:activated,deactivated:deactivated,beforeDestroy:beforeDestroy,beforeUnmount:beforeUnmount,destroyed:destroyed,unmounted:unmounted,render:render,renderTracked:renderTracked,renderTriggered:renderTriggered,errorCaptured:errorCaptured,serverPrefetch:serverPrefetch,expose:expose,inheritAttrs:inheritAttrs,components:components,directives:directives,filters:filters}=options;if(injectOptions&&function(injectOptions,ctx){isArray$2(injectOptions)&&(injectOptions=normalizeInject(injectOptions));for(const key in injectOptions){const opt=injectOptions[key];let injected;injected=isObject(opt)?"default"in opt?inject(opt.from||key,opt.default,!0):inject(opt.from||key):inject(opt),isRef(injected)?Object.defineProperty(ctx,key,{enumerable:!0,configurable:!0,get:()=>injected.value,set:v=>injected.value=v}):ctx[key]=injected}}(injectOptions,ctx,null),methods)for(const key in methods){const methodHandler=methods[key];isFunction(methodHandler)&&(ctx[key]=methodHandler.bind(publicThis))}if(dataOptions){const data=dataOptions.call(publicThis,publicThis);isObject(data)&&(instance.data=reactive(data))}if(shouldCacheAccess=!0,computedOptions)for(const key in computedOptions){const opt=computedOptions[key],get2=isFunction(opt)?opt.bind(publicThis,publicThis):isFunction(opt.get)?opt.get.bind(publicThis,publicThis):NOOP,set2=!isFunction(opt)&&isFunction(opt.set)?opt.set.bind(publicThis):NOOP,c=computed({get:get2,set:set2});Object.defineProperty(ctx,key,{enumerable:!0,configurable:!0,get:()=>c.value,set:v=>c.value=v})}if(watchOptions)for(const key in watchOptions)createWatcher(watchOptions[key],ctx,publicThis,key);if(provideOptions){const provides=isFunction(provideOptions)?provideOptions.call(publicThis):provideOptions;Reflect.ownKeys(provides).forEach(key=>{provide(key,provides[key])})}function registerLifecycleHook(register,hook){isArray$2(hook)?hook.forEach(_hook=>register(_hook.bind(publicThis))):hook&&register(hook.bind(publicThis))}if(created&&callHook$1(created,instance,"c"),registerLifecycleHook(onBeforeMount,beforeMount),registerLifecycleHook(onMounted,mounted),registerLifecycleHook(onBeforeUpdate,beforeUpdate),registerLifecycleHook(onUpdated,updated),registerLifecycleHook(onActivated,activated),registerLifecycleHook(onDeactivated,deactivated),registerLifecycleHook(onErrorCaptured,errorCaptured),registerLifecycleHook(onRenderTracked,renderTracked),registerLifecycleHook(onRenderTriggered,renderTriggered),registerLifecycleHook(onBeforeUnmount,beforeUnmount),registerLifecycleHook(onUnmounted,unmounted),registerLifecycleHook(onServerPrefetch,serverPrefetch),isArray$2(expose))if(expose.length){const exposed=instance.exposed||(instance.exposed={});expose.forEach(key=>{Object.defineProperty(exposed,key,{get:()=>publicThis[key],set:val=>publicThis[key]=val})})}else instance.exposed||(instance.exposed={});render&&instance.render===NOOP&&(instance.render=render),null!=inheritAttrs&&(instance.inheritAttrs=inheritAttrs),components&&(instance.components=components),directives&&(instance.directives=directives),serverPrefetch&&markAsyncBoundary(instance)}function callHook$1(hook,instance,type){callWithAsyncErrorHandling(isArray$2(hook)?hook.map(h2=>h2.bind(instance.proxy)):hook.bind(instance.proxy),instance,type)}function createWatcher(raw,ctx,publicThis,key){let getter=key.includes(".")?createPathGetter(publicThis,key):()=>publicThis[key];if(isString$1(raw)){const handler=ctx[raw];isFunction(handler)&&watch(getter,handler)}else if(isFunction(raw))watch(getter,raw.bind(publicThis));else if(isObject(raw))if(isArray$2(raw))raw.forEach(r=>createWatcher(r,ctx,publicThis,key));else{const handler=isFunction(raw.handler)?raw.handler.bind(publicThis):ctx[raw.handler];isFunction(handler)&&watch(getter,handler,raw)}}function resolveMergedOptions(instance){const base=instance.type,{mixins:mixins,extends:extendsOptions}=base,{mixins:globalMixins,optionsCache:cache2,config:{optionMergeStrategies:optionMergeStrategies}}=instance.appContext,cached=cache2.get(base);let resolved;return cached?resolved=cached:globalMixins.length||mixins||extendsOptions?(resolved={},globalMixins.length&&globalMixins.forEach(m=>mergeOptions$1(resolved,m,optionMergeStrategies,!0)),mergeOptions$1(resolved,base,optionMergeStrategies)):resolved=base,isObject(base)&&cache2.set(base,resolved),resolved}function mergeOptions$1(to,from,strats,asMixin=!1){const{mixins:mixins,extends:extendsOptions}=from;extendsOptions&&mergeOptions$1(to,extendsOptions,strats,!0),mixins&&mixins.forEach(m=>mergeOptions$1(to,m,strats,!0));for(const key in from)if(asMixin&&"expose"===key);else{const strat=internalOptionMergeStrats[key]||strats&&strats[key];to[key]=strat?strat(to[key],from[key]):from[key]}return to}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:function(to,from){if(!to)return from;if(!from)return to;const merged=extend$1(Object.create(null),to);for(const key in from)merged[key]=mergeAsArray(to[key],from[key]);return merged},provide:mergeDataFn,inject:function(to,from){return mergeObjectOptions(normalizeInject(to),normalizeInject(from))}};function mergeDataFn(to,from){return from?to?function(){return extend$1(isFunction(to)?to.call(this,this):to,isFunction(from)?from.call(this,this):from)}:from:to}function normalizeInject(raw){if(isArray$2(raw)){const res={};for(let i=0;i<raw.length;i++)res[raw[i]]=raw[i];return res}return raw}function mergeAsArray(to,from){return to?[...new Set([].concat(to,from))]:from}function mergeObjectOptions(to,from){return to?extend$1(Object.create(null),to,from):from}function mergeEmitsOrPropsOptions(to,from){return to?isArray$2(to)&&isArray$2(from)?[...new Set([...to,...from])]:extend$1(Object.create(null),normalizePropsOrEmits(to),normalizePropsOrEmits(null!=from?from:{})):from}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(render,hydrate){return function(rootComponent,rootProps=null){isFunction(rootComponent)||(rootComponent=extend$1({},rootComponent)),null==rootProps||isObject(rootProps)||(rootProps=null);const context=createAppContext(),installedPlugins=new WeakSet,pluginCleanupFns=[];let isMounted=!1;const app2=context.app={_uid:uid$1++,_component:rootComponent,_props:rootProps,_container:null,_context:context,_instance:null,version:version$1,get config(){return context.config},set config(v){},use:(plugin,...options)=>(installedPlugins.has(plugin)||(plugin&&isFunction(plugin.install)?(installedPlugins.add(plugin),plugin.install(app2,...options)):isFunction(plugin)&&(installedPlugins.add(plugin),plugin(app2,...options))),app2),mixin:mixin=>(context.mixins.includes(mixin)||context.mixins.push(mixin),app2),component:(name,component)=>component?(context.components[name]=component,app2):context.components[name],directive:(name,directive)=>directive?(context.directives[name]=directive,app2):context.directives[name],mount(rootContainer,isHydrate,namespace){if(!isMounted){const vnode=app2._ceVNode||createVNode(rootComponent,rootProps);return vnode.appContext=context,!0===namespace?namespace="svg":!1===namespace&&(namespace=void 0),isHydrate&&hydrate?hydrate(vnode,rootContainer):render(vnode,rootContainer,namespace),isMounted=!0,app2._container=rootContainer,rootContainer.__vue_app__=app2,getComponentPublicInstance(vnode.component)}},onUnmount(cleanupFn){pluginCleanupFns.push(cleanupFn)},unmount(){isMounted&&(callWithAsyncErrorHandling(pluginCleanupFns,app2._instance,16),render(null,app2._container),delete app2._container.__vue_app__)},provide:(key,value)=>(context.provides[key]=value,app2),runWithContext(fn){const lastApp=currentApp;currentApp=app2;try{return fn()}finally{currentApp=lastApp}}};return app2}}let currentApp=null;function provide(key,value){if(currentInstance){let provides=currentInstance.provides;const parentProvides=currentInstance.parent&&currentInstance.parent.provides;parentProvides===provides&&(provides=currentInstance.provides=Object.create(parentProvides)),provides[key]=value}else;}function inject(key,defaultValue,treatDefaultAsFactory=!1){const instance=currentInstance||currentRenderingInstance;if(instance||currentApp){const provides=currentApp?currentApp._context.provides:instance?null==instance.parent?instance.vnode.appContext&&instance.vnode.appContext.provides:instance.parent.provides:void 0;if(provides&&key in provides)return provides[key];if(arguments.length>1)return treatDefaultAsFactory&&isFunction(defaultValue)?defaultValue.call(instance&&instance.proxy):defaultValue}}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=obj=>Object.getPrototypeOf(obj)===internalObjectProto;function setFullProps(instance,rawProps,props,attrs){const[options,needCastKeys]=instance.propsOptions;let rawCastValues,hasAttrsChanged=!1;if(rawProps)for(let key in rawProps){if(isReservedProp(key))continue;const value=rawProps[key];let camelKey;options&&hasOwn(options,camelKey=camelize(key))?needCastKeys&&needCastKeys.includes(camelKey)?(rawCastValues||(rawCastValues={}))[camelKey]=value:props[camelKey]=value:isEmitListener(instance.emitsOptions,key)||key in attrs&&value===attrs[key]||(attrs[key]=value,hasAttrsChanged=!0)}if(needCastKeys){const rawCurrentProps=toRaw(props),castValues=rawCastValues||EMPTY_OBJ;for(let i=0;i<needCastKeys.length;i++){const key=needCastKeys[i];props[key]=resolvePropValue(options,rawCurrentProps,key,castValues[key],instance,!hasOwn(castValues,key))}}return hasAttrsChanged}function resolvePropValue(options,props,key,value,instance,isAbsent){const opt=options[key];if(null!=opt){const hasDefault=hasOwn(opt,"default");if(hasDefault&&void 0===value){const defaultValue=opt.default;if(opt.type!==Function&&!opt.skipFactory&&isFunction(defaultValue)){const{propsDefaults:propsDefaults}=instance;if(key in propsDefaults)value=propsDefaults[key];else{const reset=setCurrentInstance(instance);value=propsDefaults[key]=defaultValue.call(null,props),reset()}}else value=defaultValue;instance.ce&&instance.ce._setProp(key,value)}opt[0]&&(isAbsent&&!hasDefault?value=!1:!opt[1]||""!==value&&value!==hyphenate(key)||(value=!0))}return value}const mixinPropsCache=new WeakMap;function normalizePropsOptions(comp,appContext,asMixin=!1){const cache2=asMixin?mixinPropsCache:appContext.propsCache,cached=cache2.get(comp);if(cached)return cached;const raw=comp.props,normalized={},needCastKeys=[];let hasExtends=!1;if(!isFunction(comp)){const extendProps=raw2=>{hasExtends=!0;const[props,keys]=normalizePropsOptions(raw2,appContext,!0);extend$1(normalized,props),keys&&needCastKeys.push(...keys)};!asMixin&&appContext.mixins.length&&appContext.mixins.forEach(extendProps),comp.extends&&extendProps(comp.extends),comp.mixins&&comp.mixins.forEach(extendProps)}if(!raw&&!hasExtends)return isObject(comp)&&cache2.set(comp,EMPTY_ARR),EMPTY_ARR;if(isArray$2(raw))for(let i=0;i<raw.length;i++){const normalizedKey=camelize(raw[i]);validatePropName(normalizedKey)&&(normalized[normalizedKey]=EMPTY_OBJ)}else if(raw)for(const key in raw){const normalizedKey=camelize(key);if(validatePropName(normalizedKey)){const opt=raw[key],prop=normalized[normalizedKey]=isArray$2(opt)||isFunction(opt)?{type:opt}:extend$1({},opt),propType=prop.type;let shouldCast=!1,shouldCastTrue=!0;if(isArray$2(propType))for(let index2=0;index2<propType.length;++index2){const type=propType[index2],typeName=isFunction(type)&&type.name;if("Boolean"===typeName){shouldCast=!0;break}"String"===typeName&&(shouldCastTrue=!1)}else shouldCast=isFunction(propType)&&"Boolean"===propType.name;prop[0]=shouldCast,prop[1]=shouldCastTrue,(shouldCast||hasOwn(prop,"default"))&&needCastKeys.push(normalizedKey)}}const res=[normalized,needCastKeys];return isObject(comp)&&cache2.set(comp,res),res}function validatePropName(key){return"$"!==key[0]&&!isReservedProp(key)}const isInternalKey=key=>"_"===key[0]||"$stable"===key,normalizeSlotValue=value=>isArray$2(value)?value.map(normalizeVNode):[normalizeVNode(value)],normalizeSlot$1=(key,rawSlot,ctx)=>{if(rawSlot._n)return rawSlot;const normalized=withCtx((...args)=>normalizeSlotValue(rawSlot(...args)),ctx);return normalized._c=!1,normalized},normalizeObjectSlots=(rawSlots,slots,instance)=>{const ctx=rawSlots._ctx;for(const key in rawSlots){if(isInternalKey(key))continue;const value=rawSlots[key];if(isFunction(value))slots[key]=normalizeSlot$1(0,value,ctx);else if(null!=value){const normalized=normalizeSlotValue(value);slots[key]=()=>normalized}}},normalizeVNodeSlots=(instance,children)=>{const normalized=normalizeSlotValue(children);instance.slots.default=()=>normalized},assignSlots=(slots,children,optimized)=>{for(const key in children)(optimized||"_"!==key)&&(slots[key]=children[key])},queuePostRenderEffect=function(fn,suspense){suspense&&suspense.pendingBranch?isArray$2(fn)?suspense.effects.push(...fn):suspense.effects.push(fn):(isArray$2(cb=fn)?pendingPostFlushCbs.push(...cb):activePostFlushCbs&&-1===cb.id?activePostFlushCbs.splice(postFlushIndex+1,0,cb):1&cb.flags||(pendingPostFlushCbs.push(cb),cb.flags|=1),queueFlush());var cb};function createRenderer(options){return function(options){getGlobalThis().__VUE__=!0;const{insert:hostInsert,remove:hostRemove,patchProp:hostPatchProp,createElement:hostCreateElement,createText:hostCreateText,createComment:hostCreateComment,setText:hostSetText,setElementText:hostSetElementText,parentNode:hostParentNode,nextSibling:hostNextSibling,setScopeId:hostSetScopeId=NOOP,insertStaticContent:hostInsertStaticContent}=options,patch=(n1,n2,container,anchor=null,parentComponent=null,parentSuspense=null,namespace=void 0,slotScopeIds=null,optimized=!!n2.dynamicChildren)=>{if(n1===n2)return;n1&&!isSameVNodeType(n1,n2)&&(anchor=getNextHostNode(n1),unmount(n1,parentComponent,parentSuspense,!0),n1=null),-2===n2.patchFlag&&(optimized=!1,n2.dynamicChildren=null);const{type:type,ref:ref3,shapeFlag:shapeFlag}=n2;switch(type){case Text$1:processText(n1,n2,container,anchor);break;case Comment:processCommentNode(n1,n2,container,anchor);break;case Static:null==n1&&mountStaticNode(n2,container,anchor,namespace);break;case Fragment:processFragment(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);break;default:1&shapeFlag?processElement(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):6&shapeFlag?processComponent(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):(64&shapeFlag||128&shapeFlag)&&type.process(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,internals)}null!=ref3&&parentComponent&&setRef(ref3,n1&&n1.ref,parentSuspense,n2||n1,!n2)},processText=(n1,n2,container,anchor)=>{if(null==n1)hostInsert(n2.el=hostCreateText(n2.children),container,anchor);else{const el=n2.el=n1.el;n2.children!==n1.children&&hostSetText(el,n2.children)}},processCommentNode=(n1,n2,container,anchor)=>{null==n1?hostInsert(n2.el=hostCreateComment(n2.children||""),container,anchor):n2.el=n1.el},mountStaticNode=(n2,container,anchor,namespace)=>{[n2.el,n2.anchor]=hostInsertStaticContent(n2.children,container,anchor,namespace,n2.el,n2.anchor)},moveStaticNode=({el:el,anchor:anchor},container,nextSibling)=>{let next;for(;el&&el!==anchor;)next=hostNextSibling(el),hostInsert(el,container,nextSibling),el=next;hostInsert(anchor,container,nextSibling)},removeStaticNode=({el:el,anchor:anchor})=>{let next;for(;el&&el!==anchor;)next=hostNextSibling(el),hostRemove(el),el=next;hostRemove(anchor)},processElement=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{"svg"===n2.type?namespace="svg":"math"===n2.type&&(namespace="mathml"),null==n1?mountElement(n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):patchElement(n1,n2,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)},mountElement=(vnode,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{let el,vnodeHook;const{props:props,shapeFlag:shapeFlag,transition:transition,dirs:dirs}=vnode;if(el=vnode.el=hostCreateElement(vnode.type,namespace,props&&props.is,props),8&shapeFlag?hostSetElementText(el,vnode.children):16&shapeFlag&&mountChildren(vnode.children,el,null,parentComponent,parentSuspense,resolveChildrenNamespace(vnode,namespace),slotScopeIds,optimized),dirs&&invokeDirectiveHook(vnode,null,parentComponent,"created"),setScopeId(el,vnode,vnode.scopeId,slotScopeIds,parentComponent),props){for(const key in props)"value"===key||isReservedProp(key)||hostPatchProp(el,key,null,props[key],namespace,parentComponent);"value"in props&&hostPatchProp(el,"value",null,props.value,namespace),(vnodeHook=props.onVnodeBeforeMount)&&invokeVNodeHook(vnodeHook,parentComponent,vnode)}dirs&&invokeDirectiveHook(vnode,null,parentComponent,"beforeMount");const needCallTransitionHooks=function(parentSuspense,transition){return(!parentSuspense||parentSuspense&&!parentSuspense.pendingBranch)&&transition&&!transition.persisted}(parentSuspense,transition);needCallTransitionHooks&&transition.beforeEnter(el),hostInsert(el,container,anchor),((vnodeHook=props&&props.onVnodeMounted)||needCallTransitionHooks||dirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,vnode),needCallTransitionHooks&&transition.enter(el),dirs&&invokeDirectiveHook(vnode,null,parentComponent,"mounted")},parentSuspense)},setScopeId=(el,vnode,scopeId,slotScopeIds,parentComponent)=>{if(scopeId&&hostSetScopeId(el,scopeId),slotScopeIds)for(let i=0;i<slotScopeIds.length;i++)hostSetScopeId(el,slotScopeIds[i]);if(parentComponent){let subTree=parentComponent.subTree;if(vnode===subTree||isSuspense(subTree.type)&&(subTree.ssContent===vnode||subTree.ssFallback===vnode)){const parentVNode=parentComponent.vnode;setScopeId(el,parentVNode,parentVNode.scopeId,parentVNode.slotScopeIds,parentComponent.parent)}}},mountChildren=(children,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,start=0)=>{for(let i=start;i<children.length;i++){const child=children[i]=optimized?cloneIfMounted(children[i]):normalizeVNode(children[i]);patch(null,child,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)}},patchElement=(n1,n2,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{const el=n2.el=n1.el;let{patchFlag:patchFlag,dynamicChildren:dynamicChildren,dirs:dirs}=n2;patchFlag|=16&n1.patchFlag;const oldProps=n1.props||EMPTY_OBJ,newProps=n2.props||EMPTY_OBJ;let vnodeHook;if(parentComponent&&toggleRecurse(parentComponent,!1),(vnodeHook=newProps.onVnodeBeforeUpdate)&&invokeVNodeHook(vnodeHook,parentComponent,n2,n1),dirs&&invokeDirectiveHook(n2,n1,parentComponent,"beforeUpdate"),parentComponent&&toggleRecurse(parentComponent,!0),(oldProps.innerHTML&&null==newProps.innerHTML||oldProps.textContent&&null==newProps.textContent)&&hostSetElementText(el,""),dynamicChildren?patchBlockChildren(n1.dynamicChildren,dynamicChildren,el,parentComponent,parentSuspense,resolveChildrenNamespace(n2,namespace),slotScopeIds):optimized||patchChildren(n1,n2,el,null,parentComponent,parentSuspense,resolveChildrenNamespace(n2,namespace),slotScopeIds,!1),patchFlag>0){if(16&patchFlag)patchProps(el,oldProps,newProps,parentComponent,namespace);else if(2&patchFlag&&oldProps.class!==newProps.class&&hostPatchProp(el,"class",null,newProps.class,namespace),4&patchFlag&&hostPatchProp(el,"style",oldProps.style,newProps.style,namespace),8&patchFlag){const propsToUpdate=n2.dynamicProps;for(let i=0;i<propsToUpdate.length;i++){const key=propsToUpdate[i],prev=oldProps[key],next=newProps[key];next===prev&&"value"!==key||hostPatchProp(el,key,prev,next,namespace,parentComponent)}}1&patchFlag&&n1.children!==n2.children&&hostSetElementText(el,n2.children)}else optimized||null!=dynamicChildren||patchProps(el,oldProps,newProps,parentComponent,namespace);((vnodeHook=newProps.onVnodeUpdated)||dirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,n2,n1),dirs&&invokeDirectiveHook(n2,n1,parentComponent,"updated")},parentSuspense)},patchBlockChildren=(oldChildren,newChildren,fallbackContainer,parentComponent,parentSuspense,namespace,slotScopeIds)=>{for(let i=0;i<newChildren.length;i++){const oldVNode=oldChildren[i],newVNode=newChildren[i],container=oldVNode.el&&(oldVNode.type===Fragment||!isSameVNodeType(oldVNode,newVNode)||70&oldVNode.shapeFlag)?hostParentNode(oldVNode.el):fallbackContainer;patch(oldVNode,newVNode,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,!0)}},patchProps=(el,oldProps,newProps,parentComponent,namespace)=>{if(oldProps!==newProps){if(oldProps!==EMPTY_OBJ)for(const key in oldProps)isReservedProp(key)||key in newProps||hostPatchProp(el,key,oldProps[key],null,namespace,parentComponent);for(const key in newProps){if(isReservedProp(key))continue;const next=newProps[key],prev=oldProps[key];next!==prev&&"value"!==key&&hostPatchProp(el,key,prev,next,namespace,parentComponent)}"value"in newProps&&hostPatchProp(el,"value",oldProps.value,newProps.value,namespace)}},processFragment=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{const fragmentStartAnchor=n2.el=n1?n1.el:hostCreateText(""),fragmentEndAnchor=n2.anchor=n1?n1.anchor:hostCreateText("");let{patchFlag:patchFlag,dynamicChildren:dynamicChildren,slotScopeIds:fragmentSlotScopeIds}=n2;fragmentSlotScopeIds&&(slotScopeIds=slotScopeIds?slotScopeIds.concat(fragmentSlotScopeIds):fragmentSlotScopeIds),null==n1?(hostInsert(fragmentStartAnchor,container,anchor),hostInsert(fragmentEndAnchor,container,anchor),mountChildren(n2.children||[],container,fragmentEndAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)):patchFlag>0&&64&patchFlag&&dynamicChildren&&n1.dynamicChildren?(patchBlockChildren(n1.dynamicChildren,dynamicChildren,container,parentComponent,parentSuspense,namespace,slotScopeIds),(null!=n2.key||parentComponent&&n2===parentComponent.subTree)&&traverseStaticChildren(n1,n2,!0)):patchChildren(n1,n2,container,fragmentEndAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)},processComponent=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{n2.slotScopeIds=slotScopeIds,null==n1?512&n2.shapeFlag?parentComponent.ctx.activate(n2,container,anchor,namespace,optimized):mountComponent(n2,container,anchor,parentComponent,parentSuspense,namespace,optimized):updateComponent(n1,n2,optimized)},mountComponent=(initialVNode,container,anchor,parentComponent,parentSuspense,namespace,optimized)=>{const instance=initialVNode.component=function(vnode,parent,suspense){const type=vnode.type,appContext=(parent?parent.appContext:vnode.appContext)||emptyAppContext,instance={uid:uid++,vnode:vnode,type:type,parent:parent,appContext:appContext,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:parent?parent.provides:Object.create(appContext.provides),ids:parent?parent.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(type,appContext),emitsOptions:normalizeEmitsOptions(type,appContext),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:type.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:suspense,suspenseId:suspense?suspense.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};instance.ctx={_:instance},instance.root=parent?parent.root:instance,instance.emit=emit.bind(null,instance),vnode.ce&&vnode.ce(instance);return instance}(initialVNode,parentComponent,parentSuspense);if(isKeepAlive(initialVNode)&&(instance.ctx.renderer=internals),function(instance,isSSR=!1,optimized=!1){isSSR&&setInSSRSetupState(isSSR);const{props:props,children:children}=instance.vnode,isStateful=isStatefulComponent(instance);(function(instance,rawProps,isStateful,isSSR=!1){const props={},attrs=createInternalObject();instance.propsDefaults=Object.create(null),setFullProps(instance,rawProps,props,attrs);for(const key in instance.propsOptions[0])key in props||(props[key]=void 0);isStateful?instance.props=isSSR?props:shallowReactive(props):instance.type.props?instance.props=props:instance.props=attrs,instance.attrs=attrs})(instance,props,isStateful,isSSR),((instance,children,optimized)=>{const slots=instance.slots=createInternalObject();if(32&instance.vnode.shapeFlag){const type=children._;type?(assignSlots(slots,children,optimized),optimized&&def(slots,"_",type,!0)):normalizeObjectSlots(children,slots)}else children&&normalizeVNodeSlots(instance,children)})(instance,children,optimized);const setupResult=isStateful?function(instance,isSSR){const Component2=instance.type;instance.accessCache=Object.create(null),instance.proxy=new Proxy(instance.ctx,PublicInstanceProxyHandlers);const{setup:setup}=Component2;if(setup){const setupContext=instance.setupContext=setup.length>1?function(instance){const expose=exposed=>{instance.exposed=exposed||{}};return{attrs:new Proxy(instance.attrs,attrsProxyHandlers),slots:instance.slots,emit:instance.emit,expose:expose}}(instance):null,reset=setCurrentInstance(instance);pauseTracking();const setupResult=callWithErrorHandling(setup,instance,0,[instance.props,setupContext]);if(resetTracking(),reset(),isPromise(setupResult)){if(isAsyncWrapper(instance)||markAsyncBoundary(instance),setupResult.then(unsetCurrentInstance,unsetCurrentInstance),isSSR)return setupResult.then(resolvedResult=>{handleSetupResult(instance,resolvedResult,isSSR)}).catch(e=>{handleError(e,instance,0)});instance.asyncDep=setupResult}else handleSetupResult(instance,setupResult,isSSR)}else finishComponentSetup(instance,isSSR)}(instance,isSSR):void 0;isSSR&&setInSSRSetupState(!1)}(instance,!1,optimized),instance.asyncDep){if(parentSuspense&&parentSuspense.registerDep(instance,setupRenderEffect,optimized),!initialVNode.el){const placeholder=instance.subTree=createVNode(Comment);processCommentNode(null,placeholder,container,anchor)}}else setupRenderEffect(instance,initialVNode,container,anchor,parentSuspense,namespace,optimized)},updateComponent=(n1,n2,optimized)=>{const instance=n2.component=n1.component;if(function(prevVNode,nextVNode,optimized){const{props:prevProps,children:prevChildren,component:component}=prevVNode,{props:nextProps,children:nextChildren,patchFlag:patchFlag}=nextVNode,emits=component.emitsOptions;if(nextVNode.dirs||nextVNode.transition)return!0;if(!(optimized&&patchFlag>=0))return!(!prevChildren&&!nextChildren||nextChildren&&nextChildren.$stable)||prevProps!==nextProps&&(prevProps?!nextProps||hasPropsChanged(prevProps,nextProps,emits):!!nextProps);if(1024&patchFlag)return!0;if(16&patchFlag)return prevProps?hasPropsChanged(prevProps,nextProps,emits):!!nextProps;if(8&patchFlag){const dynamicProps=nextVNode.dynamicProps;for(let i=0;i<dynamicProps.length;i++){const key=dynamicProps[i];if(nextProps[key]!==prevProps[key]&&!isEmitListener(emits,key))return!0}}return!1}(n1,n2,optimized)){if(instance.asyncDep&&!instance.asyncResolved)return void updateComponentPreRender(instance,n2,optimized);instance.next=n2,instance.update()}else n2.el=n1.el,instance.vnode=n2},setupRenderEffect=(instance,initialVNode,container,anchor,parentSuspense,namespace,optimized)=>{const componentUpdateFn=()=>{if(instance.isMounted){let{next:next,bu:bu,u:u,parent:parent,vnode:vnode}=instance;{const nonHydratedAsyncRoot=locateNonHydratedAsyncRoot(instance);if(nonHydratedAsyncRoot)return next&&(next.el=vnode.el,updateComponentPreRender(instance,next,optimized)),void nonHydratedAsyncRoot.asyncDep.then(()=>{instance.isUnmounted||componentUpdateFn()})}let vnodeHook,originNext=next;toggleRecurse(instance,!1),next?(next.el=vnode.el,updateComponentPreRender(instance,next,optimized)):next=vnode,bu&&invokeArrayFns(bu),(vnodeHook=next.props&&next.props.onVnodeBeforeUpdate)&&invokeVNodeHook(vnodeHook,parent,next,vnode),toggleRecurse(instance,!0);const nextTree=renderComponentRoot(instance),prevTree=instance.subTree;instance.subTree=nextTree,patch(prevTree,nextTree,hostParentNode(prevTree.el),getNextHostNode(prevTree),instance,parentSuspense,namespace),next.el=nextTree.el,null===originNext&&function({vnode:vnode,parent:parent},el){for(;parent;){const root=parent.subTree;if(root.suspense&&root.suspense.activeBranch===vnode&&(root.el=vnode.el),root!==vnode)break;(vnode=parent.vnode).el=el,parent=parent.parent}}(instance,nextTree.el),u&&queuePostRenderEffect(u,parentSuspense),(vnodeHook=next.props&&next.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(vnodeHook,parent,next,vnode),parentSuspense)}else{let vnodeHook;const{el:el,props:props}=initialVNode,{bm:bm,m:m,parent:parent,root:root,type:type}=instance,isAsyncWrapperVNode=isAsyncWrapper(initialVNode);if(toggleRecurse(instance,!1),bm&&invokeArrayFns(bm),!isAsyncWrapperVNode&&(vnodeHook=props&&props.onVnodeBeforeMount)&&invokeVNodeHook(vnodeHook,parent,initialVNode),toggleRecurse(instance,!0),el&&hydrateNode){const hydrateSubTree=()=>{instance.subTree=renderComponentRoot(instance),hydrateNode(el,instance.subTree,instance,parentSuspense,null)};isAsyncWrapperVNode&&type.__asyncHydrate?type.__asyncHydrate(el,instance,hydrateSubTree):hydrateSubTree()}else{root.ce&&root.ce._injectChildStyle(type);const subTree=instance.subTree=renderComponentRoot(instance);patch(null,subTree,container,anchor,instance,parentSuspense,namespace),initialVNode.el=subTree.el}if(m&&queuePostRenderEffect(m,parentSuspense),!isAsyncWrapperVNode&&(vnodeHook=props&&props.onVnodeMounted)){const scopedInitialVNode=initialVNode;queuePostRenderEffect(()=>invokeVNodeHook(vnodeHook,parent,scopedInitialVNode),parentSuspense)}(256&initialVNode.shapeFlag||parent&&isAsyncWrapper(parent.vnode)&&256&parent.vnode.shapeFlag)&&instance.a&&queuePostRenderEffect(instance.a,parentSuspense),instance.isMounted=!0,initialVNode=container=anchor=null}};instance.scope.on();const effect2=instance.effect=new ReactiveEffect(componentUpdateFn);instance.scope.off();const update=instance.update=effect2.run.bind(effect2),job=instance.job=effect2.runIfDirty.bind(effect2);job.i=instance,job.id=instance.uid,effect2.scheduler=()=>queueJob(job),toggleRecurse(instance,!0),update()},updateComponentPreRender=(instance,nextVNode,optimized)=>{nextVNode.component=instance;const prevProps=instance.vnode.props;instance.vnode=nextVNode,instance.next=null,function(instance,rawProps,rawPrevProps,optimized){const{props:props,attrs:attrs,vnode:{patchFlag:patchFlag}}=instance,rawCurrentProps=toRaw(props),[options]=instance.propsOptions;let hasAttrsChanged=!1;if(!(optimized||patchFlag>0)||16&patchFlag){let kebabKey;setFullProps(instance,rawProps,props,attrs)&&(hasAttrsChanged=!0);for(const key in rawCurrentProps)rawProps&&(hasOwn(rawProps,key)||(kebabKey=hyphenate(key))!==key&&hasOwn(rawProps,kebabKey))||(options?!rawPrevProps||void 0===rawPrevProps[key]&&void 0===rawPrevProps[kebabKey]||(props[key]=resolvePropValue(options,rawCurrentProps,key,void 0,instance,!0)):delete props[key]);if(attrs!==rawCurrentProps)for(const key in attrs)rawProps&&hasOwn(rawProps,key)||(delete attrs[key],hasAttrsChanged=!0)}else if(8&patchFlag){const propsToUpdate=instance.vnode.dynamicProps;for(let i=0;i<propsToUpdate.length;i++){let key=propsToUpdate[i];if(isEmitListener(instance.emitsOptions,key))continue;const value=rawProps[key];if(options)if(hasOwn(attrs,key))value!==attrs[key]&&(attrs[key]=value,hasAttrsChanged=!0);else{const camelizedKey=camelize(key);props[camelizedKey]=resolvePropValue(options,rawCurrentProps,camelizedKey,value,instance,!1)}else value!==attrs[key]&&(attrs[key]=value,hasAttrsChanged=!0)}}hasAttrsChanged&&trigger(instance.attrs,"set","")}(instance,nextVNode.props,prevProps,optimized),((instance,children,optimized)=>{const{vnode:vnode,slots:slots}=instance;let needDeletionCheck=!0,deletionComparisonTarget=EMPTY_OBJ;if(32&vnode.shapeFlag){const type=children._;type?optimized&&1===type?needDeletionCheck=!1:assignSlots(slots,children,optimized):(needDeletionCheck=!children.$stable,normalizeObjectSlots(children,slots)),deletionComparisonTarget=children}else children&&(normalizeVNodeSlots(instance,children),deletionComparisonTarget={default:1});if(needDeletionCheck)for(const key in slots)isInternalKey(key)||null!=deletionComparisonTarget[key]||delete slots[key]})(instance,nextVNode.children,optimized),pauseTracking(),flushPreFlushCbs(instance),resetTracking()},patchChildren=(n1,n2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized=!1)=>{const c1=n1&&n1.children,prevShapeFlag=n1?n1.shapeFlag:0,c2=n2.children,{patchFlag:patchFlag,shapeFlag:shapeFlag}=n2;if(patchFlag>0){if(128&patchFlag)return void patchKeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized);if(256&patchFlag)return void patchUnkeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)}8&shapeFlag?(16&prevShapeFlag&&unmountChildren(c1,parentComponent,parentSuspense),c2!==c1&&hostSetElementText(container,c2)):16&prevShapeFlag?16&shapeFlag?patchKeyedChildren(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):unmountChildren(c1,parentComponent,parentSuspense,!0):(8&prevShapeFlag&&hostSetElementText(container,""),16&shapeFlag&&mountChildren(c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized))},patchUnkeyedChildren=(c1,c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{c2=c2||EMPTY_ARR;const oldLength=(c1=c1||EMPTY_ARR).length,newLength=c2.length,commonLength=Math.min(oldLength,newLength);let i;for(i=0;i<commonLength;i++){const nextChild=c2[i]=optimized?cloneIfMounted(c2[i]):normalizeVNode(c2[i]);patch(c1[i],nextChild,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)}oldLength>newLength?unmountChildren(c1,parentComponent,parentSuspense,!0,!1,commonLength):mountChildren(c2,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized,commonLength)},patchKeyedChildren=(c1,c2,container,parentAnchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized)=>{let i=0;const l2=c2.length;let e1=c1.length-1,e2=l2-1;for(;i<=e1&&i<=e2;){const n1=c1[i],n2=c2[i]=optimized?cloneIfMounted(c2[i]):normalizeVNode(c2[i]);if(!isSameVNodeType(n1,n2))break;patch(n1,n2,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),i++}for(;i<=e1&&i<=e2;){const n1=c1[e1],n2=c2[e2]=optimized?cloneIfMounted(c2[e2]):normalizeVNode(c2[e2]);if(!isSameVNodeType(n1,n2))break;patch(n1,n2,container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),e1--,e2--}if(i>e1){if(i<=e2){const nextPos=e2+1,anchor=nextPos<l2?c2[nextPos].el:parentAnchor;for(;i<=e2;)patch(null,c2[i]=optimized?cloneIfMounted(c2[i]):normalizeVNode(c2[i]),container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),i++}}else if(i>e2)for(;i<=e1;)unmount(c1[i],parentComponent,parentSuspense,!0),i++;else{const s1=i,s2=i,keyToNewIndexMap=new Map;for(i=s2;i<=e2;i++){const nextChild=c2[i]=optimized?cloneIfMounted(c2[i]):normalizeVNode(c2[i]);null!=nextChild.key&&keyToNewIndexMap.set(nextChild.key,i)}let j,patched=0;const toBePatched=e2-s2+1;let moved=!1,maxNewIndexSoFar=0;const newIndexToOldIndexMap=new Array(toBePatched);for(i=0;i<toBePatched;i++)newIndexToOldIndexMap[i]=0;for(i=s1;i<=e1;i++){const prevChild=c1[i];if(patched>=toBePatched){unmount(prevChild,parentComponent,parentSuspense,!0);continue}let newIndex;if(null!=prevChild.key)newIndex=keyToNewIndexMap.get(prevChild.key);else for(j=s2;j<=e2;j++)if(0===newIndexToOldIndexMap[j-s2]&&isSameVNodeType(prevChild,c2[j])){newIndex=j;break}void 0===newIndex?unmount(prevChild,parentComponent,parentSuspense,!0):(newIndexToOldIndexMap[newIndex-s2]=i+1,newIndex>=maxNewIndexSoFar?maxNewIndexSoFar=newIndex:moved=!0,patch(prevChild,c2[newIndex],container,null,parentComponent,parentSuspense,namespace,slotScopeIds,optimized),patched++)}const increasingNewIndexSequence=moved?function(arr){const p2=arr.slice(),result=[0];let i,j,u,v,c;const len=arr.length;for(i=0;i<len;i++){const arrI=arr[i];if(0!==arrI){if(j=result[result.length-1],arr[j]<arrI){p2[i]=j,result.push(i);continue}for(u=0,v=result.length-1;u<v;)c=u+v>>1,arr[result[c]]<arrI?u=c+1:v=c;arrI<arr[result[u]]&&(u>0&&(p2[i]=result[u-1]),result[u]=i)}}u=result.length,v=result[u-1];for(;u-- >0;)result[u]=v,v=p2[v];return result}(newIndexToOldIndexMap):EMPTY_ARR;for(j=increasingNewIndexSequence.length-1,i=toBePatched-1;i>=0;i--){const nextIndex=s2+i,nextChild=c2[nextIndex],anchor=nextIndex+1<l2?c2[nextIndex+1].el:parentAnchor;0===newIndexToOldIndexMap[i]?patch(null,nextChild,container,anchor,parentComponent,parentSuspense,namespace,slotScopeIds,optimized):moved&&(j<0||i!==increasingNewIndexSequence[j]?move(nextChild,container,anchor,2):j--)}}},move=(vnode,container,anchor,moveType,parentSuspense=null)=>{const{el:el,type:type,transition:transition,children:children,shapeFlag:shapeFlag}=vnode;if(6&shapeFlag)return void move(vnode.component.subTree,container,anchor,moveType);if(128&shapeFlag)return void vnode.suspense.move(container,anchor,moveType);if(64&shapeFlag)return void type.move(vnode,container,anchor,internals);if(type===Fragment){hostInsert(el,container,anchor);for(let i=0;i<children.length;i++)move(children[i],container,anchor,moveType);return void hostInsert(vnode.anchor,container,anchor)}if(type===Static)return void moveStaticNode(vnode,container,anchor);if(2!==moveType&&1&shapeFlag&&transition)if(0===moveType)transition.beforeEnter(el),hostInsert(el,container,anchor),queuePostRenderEffect(()=>transition.enter(el),parentSuspense);else{const{leave:leave,delayLeave:delayLeave,afterLeave:afterLeave}=transition,remove22=()=>hostInsert(el,container,anchor),performLeave=()=>{leave(el,()=>{remove22(),afterLeave&&afterLeave()})};delayLeave?delayLeave(el,remove22,performLeave):performLeave()}else hostInsert(el,container,anchor)},unmount=(vnode,parentComponent,parentSuspense,doRemove=!1,optimized=!1)=>{const{type:type,props:props,ref:ref3,children:children,dynamicChildren:dynamicChildren,shapeFlag:shapeFlag,patchFlag:patchFlag,dirs:dirs,cacheIndex:cacheIndex}=vnode;if(-2===patchFlag&&(optimized=!1),null!=ref3&&setRef(ref3,null,parentSuspense,vnode,!0),null!=cacheIndex&&(parentComponent.renderCache[cacheIndex]=void 0),256&shapeFlag)return void parentComponent.ctx.deactivate(vnode);const shouldInvokeDirs=1&shapeFlag&&dirs,shouldInvokeVnodeHook=!isAsyncWrapper(vnode);let vnodeHook;if(shouldInvokeVnodeHook&&(vnodeHook=props&&props.onVnodeBeforeUnmount)&&invokeVNodeHook(vnodeHook,parentComponent,vnode),6&shapeFlag)unmountComponent(vnode.component,parentSuspense,doRemove);else{if(128&shapeFlag)return void vnode.suspense.unmount(parentSuspense,doRemove);shouldInvokeDirs&&invokeDirectiveHook(vnode,null,parentComponent,"beforeUnmount"),64&shapeFlag?vnode.type.remove(vnode,parentComponent,parentSuspense,internals,doRemove):dynamicChildren&&!dynamicChildren.hasOnce&&(type!==Fragment||patchFlag>0&&64&patchFlag)?unmountChildren(dynamicChildren,parentComponent,parentSuspense,!1,!0):(type===Fragment&&384&patchFlag||!optimized&&16&shapeFlag)&&unmountChildren(children,parentComponent,parentSuspense),doRemove&&remove2(vnode)}(shouldInvokeVnodeHook&&(vnodeHook=props&&props.onVnodeUnmounted)||shouldInvokeDirs)&&queuePostRenderEffect(()=>{vnodeHook&&invokeVNodeHook(vnodeHook,parentComponent,vnode),shouldInvokeDirs&&invokeDirectiveHook(vnode,null,parentComponent,"unmounted")},parentSuspense)},remove2=vnode=>{const{type:type,el:el,anchor:anchor,transition:transition}=vnode;if(type===Fragment)return void removeFragment(el,anchor);if(type===Static)return void removeStaticNode(vnode);const performRemove=()=>{hostRemove(el),transition&&!transition.persisted&&transition.afterLeave&&transition.afterLeave()};if(1&vnode.shapeFlag&&transition&&!transition.persisted){const{leave:leave,delayLeave:delayLeave}=transition,performLeave=()=>leave(el,performRemove);delayLeave?delayLeave(vnode.el,performRemove,performLeave):performLeave()}else performRemove()},removeFragment=(cur,end)=>{let next;for(;cur!==end;)next=hostNextSibling(cur),hostRemove(cur),cur=next;hostRemove(end)},unmountComponent=(instance,parentSuspense,doRemove)=>{const{bum:bum,scope:scope,job:job,subTree:subTree,um:um,m:m,a:a}=instance;invalidateMount(m),invalidateMount(a),bum&&invokeArrayFns(bum),scope.stop(),job&&(job.flags|=8,unmount(subTree,instance,parentSuspense,doRemove)),um&&queuePostRenderEffect(um,parentSuspense),queuePostRenderEffect(()=>{instance.isUnmounted=!0},parentSuspense),parentSuspense&&parentSuspense.pendingBranch&&!parentSuspense.isUnmounted&&instance.asyncDep&&!instance.asyncResolved&&instance.suspenseId===parentSuspense.pendingId&&(parentSuspense.deps--,0===parentSuspense.deps&&parentSuspense.resolve())},unmountChildren=(children,parentComponent,parentSuspense,doRemove=!1,optimized=!1,start=0)=>{for(let i=start;i<children.length;i++)unmount(children[i],parentComponent,parentSuspense,doRemove,optimized)},getNextHostNode=vnode=>{if(6&vnode.shapeFlag)return getNextHostNode(vnode.component.subTree);if(128&vnode.shapeFlag)return vnode.suspense.next();const el=hostNextSibling(vnode.anchor||vnode.el),teleportEnd=el&&el[TeleportEndKey];return teleportEnd?hostNextSibling(teleportEnd):el};let isFlushing2=!1;const render=(vnode,container,namespace)=>{null==vnode?container._vnode&&unmount(container._vnode,null,null,!0):patch(container._vnode||null,vnode,container,null,null,null,namespace),container._vnode=vnode,isFlushing2||(isFlushing2=!0,flushPreFlushCbs(),flushPostFlushCbs(),isFlushing2=!1)},internals={p:patch,um:unmount,m:move,r:remove2,mt:mountComponent,mc:mountChildren,pc:patchChildren,pbc:patchBlockChildren,n:getNextHostNode,o:options};let hydrate,hydrateNode;return{render:render,hydrate:hydrate,createApp:createAppAPI(render,hydrate)}}(options)}function resolveChildrenNamespace({type:type,props:props},currentNamespace){return"svg"===currentNamespace&&"foreignObject"===type||"mathml"===currentNamespace&&"annotation-xml"===type&&props&&props.encoding&&props.encoding.includes("html")?void 0:currentNamespace}function toggleRecurse({effect:effect2,job:job},allowed){allowed?(effect2.flags|=32,job.flags|=4):(effect2.flags&=-33,job.flags&=-5)}function traverseStaticChildren(n1,n2,shallow=!1){const ch1=n1.children,ch2=n2.children;if(isArray$2(ch1)&&isArray$2(ch2))for(let i=0;i<ch1.length;i++){const c1=ch1[i];let c2=ch2[i];1&c2.shapeFlag&&!c2.dynamicChildren&&((c2.patchFlag<=0||32===c2.patchFlag)&&(c2=ch2[i]=cloneIfMounted(ch2[i]),c2.el=c1.el),shallow||-2===c2.patchFlag||traverseStaticChildren(c1,c2)),c2.type===Text$1&&(c2.el=c1.el)}}function locateNonHydratedAsyncRoot(instance){const subComponent=instance.subTree.component;if(subComponent)return subComponent.asyncDep&&!subComponent.asyncResolved?subComponent:locateNonHydratedAsyncRoot(subComponent)}function invalidateMount(hooks){if(hooks)for(let i=0;i<hooks.length;i++)hooks[i].flags|=8}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey);function watchEffect(effect2,options){return doWatch(effect2,null,options)}function watch(source,cb,options){return doWatch(source,cb,options)}function doWatch(source,cb,options=EMPTY_OBJ){const{immediate:immediate,deep:deep,flush:flush,once:once}=options,baseWatchOptions=extend$1({},options);let ssrCleanup;if(isInSSRComponentSetup)if("sync"===flush){const ctx=useSSRContext();ssrCleanup=ctx.__watcherHandles||(ctx.__watcherHandles=[])}else{if(cb&&!immediate){const watchStopHandle=()=>{};return watchStopHandle.stop=NOOP,watchStopHandle.resume=NOOP,watchStopHandle.pause=NOOP,watchStopHandle}baseWatchOptions.once=!0}const instance=currentInstance;baseWatchOptions.call=(fn,type,args)=>callWithAsyncErrorHandling(fn,instance,type,args);let isPre=!1;"post"===flush?baseWatchOptions.scheduler=job=>{queuePostRenderEffect(job,instance&&instance.suspense)}:"sync"!==flush&&(isPre=!0,baseWatchOptions.scheduler=(job,isFirstRun)=>{isFirstRun?job():queueJob(job)}),baseWatchOptions.augmentJob=job=>{cb&&(job.flags|=4),isPre&&(job.flags|=2,instance&&(job.id=instance.uid,job.i=instance))};const watchHandle=watch$1(source,cb,baseWatchOptions);return ssrCleanup&&ssrCleanup.push(watchHandle),watchHandle}function instanceWatch(source,value,options){const publicThis=this.proxy,getter=isString$1(source)?source.includes(".")?createPathGetter(publicThis,source):()=>publicThis[source]:source.bind(publicThis,publicThis);let cb;isFunction(value)?cb=value:(cb=value.handler,options=value);const reset=setCurrentInstance(this),res=doWatch(getter,cb.bind(publicThis),options);return reset(),res}function createPathGetter(ctx,path){const segments=path.split(".");return()=>{let cur=ctx;for(let i=0;i<segments.length&&cur;i++)cur=cur[segments[i]];return cur}}const getModelModifiers=(props,modelName)=>"modelValue"===modelName||"model-value"===modelName?props.modelModifiers:props[`${modelName}Modifiers`]||props[`${camelize(modelName)}Modifiers`]||props[`${hyphenate(modelName)}Modifiers`];function emit(instance,event,...rawArgs){if(instance.isUnmounted)return;const props=instance.vnode.props||EMPTY_OBJ;let args=rawArgs;const isModelListener2=event.startsWith("update:"),modifiers=isModelListener2&&getModelModifiers(props,event.slice(7));let handlerName;modifiers&&(modifiers.trim&&(args=rawArgs.map(a=>isString$1(a)?a.trim():a)),modifiers.number&&(args=rawArgs.map(looseToNumber)));let handler=props[handlerName=toHandlerKey(event)]||props[handlerName=toHandlerKey(camelize(event))];!handler&&isModelListener2&&(handler=props[handlerName=toHandlerKey(hyphenate(event))]),handler&&callWithAsyncErrorHandling(handler,instance,6,args);const onceHandler=props[handlerName+"Once"];if(onceHandler){if(instance.emitted){if(instance.emitted[handlerName])return}else instance.emitted={};instance.emitted[handlerName]=!0,callWithAsyncErrorHandling(onceHandler,instance,6,args)}}function normalizeEmitsOptions(comp,appContext,asMixin=!1){const cache2=appContext.emitsCache,cached=cache2.get(comp);if(void 0!==cached)return cached;const raw=comp.emits;let normalized={},hasExtends=!1;if(!isFunction(comp)){const extendEmits=raw2=>{const normalizedFromExtend=normalizeEmitsOptions(raw2,appContext,!0);normalizedFromExtend&&(hasExtends=!0,extend$1(normalized,normalizedFromExtend))};!asMixin&&appContext.mixins.length&&appContext.mixins.forEach(extendEmits),comp.extends&&extendEmits(comp.extends),comp.mixins&&comp.mixins.forEach(extendEmits)}return raw||hasExtends?(isArray$2(raw)?raw.forEach(key=>normalized[key]=null):extend$1(normalized,raw),isObject(comp)&&cache2.set(comp,normalized),normalized):(isObject(comp)&&cache2.set(comp,null),null)}function isEmitListener(options,key){return!(!options||!isOn(key))&&(key=key.slice(2).replace(/Once$/,""),hasOwn(options,key[0].toLowerCase()+key.slice(1))||hasOwn(options,hyphenate(key))||hasOwn(options,key))}function renderComponentRoot(instance){const{type:Component2,vnode:vnode,proxy:proxy,withProxy:withProxy,propsOptions:[propsOptions],slots:slots,attrs:attrs,emit:emit2,render:render,renderCache:renderCache,props:props,data:data,setupState:setupState,ctx:ctx,inheritAttrs:inheritAttrs}=instance,prev=setCurrentRenderingInstance(instance);let result,fallthroughAttrs;try{if(4&vnode.shapeFlag){const proxyToUse=withProxy||proxy,thisProxy=proxyToUse;result=normalizeVNode(render.call(thisProxy,proxyToUse,renderCache,props,setupState,data,ctx)),fallthroughAttrs=attrs}else{const render2=Component2;0,result=normalizeVNode(render2.length>1?render2(props,{attrs:attrs,slots:slots,emit:emit2}):render2(props,null)),fallthroughAttrs=Component2.props?attrs:getFunctionalFallthrough(attrs)}}catch(err){blockStack.length=0,handleError(err,instance,1),result=createVNode(Comment)}let root=result;if(fallthroughAttrs&&!1!==inheritAttrs){const keys=Object.keys(fallthroughAttrs),{shapeFlag:shapeFlag}=root;keys.length&&7&shapeFlag&&(propsOptions&&keys.some(isModelListener)&&(fallthroughAttrs=filterModelListeners(fallthroughAttrs,propsOptions)),root=cloneVNode(root,fallthroughAttrs,!1,!0))}return vnode.dirs&&(root=cloneVNode(root,null,!1,!0),root.dirs=root.dirs?root.dirs.concat(vnode.dirs):vnode.dirs),vnode.transition&&setTransitionHooks(root,vnode.transition),result=root,setCurrentRenderingInstance(prev),result}const getFunctionalFallthrough=attrs=>{let res;for(const key in attrs)("class"===key||"style"===key||isOn(key))&&((res||(res={}))[key]=attrs[key]);return res},filterModelListeners=(attrs,props)=>{const res={};for(const key in attrs)isModelListener(key)&&key.slice(9)in props||(res[key]=attrs[key]);return res};function hasPropsChanged(prevProps,nextProps,emitsOptions){const nextKeys=Object.keys(nextProps);if(nextKeys.length!==Object.keys(prevProps).length)return!0;for(let i=0;i<nextKeys.length;i++){const key=nextKeys[i];if(nextProps[key]!==prevProps[key]&&!isEmitListener(emitsOptions,key))return!0}return!1}const isSuspense=type=>type.__isSuspense;const Fragment=Symbol.for("v-fgt"),Text$1=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(disableTracking=!1){blockStack.push(currentBlock=disableTracking?null:[])}let isBlockTreeEnabled=1;function setBlockTracking(value){isBlockTreeEnabled+=value,value<0&&currentBlock&&(currentBlock.hasOnce=!0)}function setupBlock(vnode){return vnode.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null,isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(vnode),vnode}function createElementBlock(type,props,children,patchFlag,dynamicProps,shapeFlag){return setupBlock(createBaseVNode(type,props,children,patchFlag,dynamicProps,shapeFlag,!0))}function createBlock(type,props,children,patchFlag,dynamicProps){return setupBlock(createVNode(type,props,children,patchFlag,dynamicProps,!0))}function isVNode(value){return!!value&&!0===value.__v_isVNode}function isSameVNodeType(n1,n2){return n1.type===n2.type&&n1.key===n2.key}const normalizeKey=({key:key})=>null!=key?key:null,normalizeRef=({ref:ref3,ref_key:ref_key,ref_for:ref_for})=>("number"==typeof ref3&&(ref3=""+ref3),null!=ref3?isString$1(ref3)||isRef(ref3)||isFunction(ref3)?{i:currentRenderingInstance,r:ref3,k:ref_key,f:!!ref_for}:ref3:null);function createBaseVNode(type,props=null,children=null,patchFlag=0,dynamicProps=null,shapeFlag=(type===Fragment?0:1),isBlockNode=!1,needFullChildrenNormalization=!1){const vnode={__v_isVNode:!0,__v_skip:!0,type:type,props:props,key:props&&normalizeKey(props),ref:props&&normalizeRef(props),scopeId:currentScopeId,slotScopeIds:null,children:children,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:shapeFlag,patchFlag:patchFlag,dynamicProps:dynamicProps,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return needFullChildrenNormalization?(normalizeChildren(vnode,children),128&shapeFlag&&type.normalize(vnode)):children&&(vnode.shapeFlag|=isString$1(children)?8:16),isBlockTreeEnabled>0&&!isBlockNode&&currentBlock&&(vnode.patchFlag>0||6&shapeFlag)&&32!==vnode.patchFlag&&currentBlock.push(vnode),vnode}const createVNode=function(type,props=null,children=null,patchFlag=0,dynamicProps=null,isBlockNode=!1){type&&type!==NULL_DYNAMIC_COMPONENT||(type=Comment);if(isVNode(type)){const cloned=cloneVNode(type,props,!0);return children&&normalizeChildren(cloned,children),isBlockTreeEnabled>0&&!isBlockNode&&currentBlock&&(6&cloned.shapeFlag?currentBlock[currentBlock.indexOf(type)]=cloned:currentBlock.push(cloned)),cloned.patchFlag=-2,cloned}value=type,isFunction(value)&&"__vccOpts"in value&&(type=type.__vccOpts);var value;if(props){props=function(props){return props?isProxy(props)||isInternalObject(props)?extend$1({},props):props:null}(props);let{class:klass,style:style}=props;klass&&!isString$1(klass)&&(props.class=normalizeClass(klass)),isObject(style)&&(isProxy(style)&&!isArray$2(style)&&(style=extend$1({},style)),props.style=normalizeStyle(style))}const shapeFlag=isString$1(type)?1:isSuspense(type)?128:isTeleport(type)?64:isObject(type)?4:isFunction(type)?2:0;return createBaseVNode(type,props,children,patchFlag,dynamicProps,shapeFlag,isBlockNode,!0)};function cloneVNode(vnode,extraProps,mergeRef=!1,cloneTransition=!1){const{props:props,ref:ref3,patchFlag:patchFlag,children:children,transition:transition}=vnode,mergedProps=extraProps?mergeProps(props||{},extraProps):props,cloned={__v_isVNode:!0,__v_skip:!0,type:vnode.type,props:mergedProps,key:mergedProps&&normalizeKey(mergedProps),ref:extraProps&&extraProps.ref?mergeRef&&ref3?isArray$2(ref3)?ref3.concat(normalizeRef(extraProps)):[ref3,normalizeRef(extraProps)]:normalizeRef(extraProps):ref3,scopeId:vnode.scopeId,slotScopeIds:vnode.slotScopeIds,children:children,target:vnode.target,targetStart:vnode.targetStart,targetAnchor:vnode.targetAnchor,staticCount:vnode.staticCount,shapeFlag:vnode.shapeFlag,patchFlag:extraProps&&vnode.type!==Fragment?-1===patchFlag?16:16|patchFlag:patchFlag,dynamicProps:vnode.dynamicProps,dynamicChildren:vnode.dynamicChildren,appContext:vnode.appContext,dirs:vnode.dirs,transition:transition,component:vnode.component,suspense:vnode.suspense,ssContent:vnode.ssContent&&cloneVNode(vnode.ssContent),ssFallback:vnode.ssFallback&&cloneVNode(vnode.ssFallback),el:vnode.el,anchor:vnode.anchor,ctx:vnode.ctx,ce:vnode.ce};return transition&&cloneTransition&&setTransitionHooks(cloned,transition.clone(cloned)),cloned}function createTextVNode(text=" ",flag=0){return createVNode(Text$1,null,text,flag)}function createCommentVNode(text="",asBlock=!1){return asBlock?(openBlock(),createBlock(Comment,null,text)):createVNode(Comment,null,text)}function normalizeVNode(child){return null==child||"boolean"==typeof child?createVNode(Comment):isArray$2(child)?createVNode(Fragment,null,child.slice()):isVNode(child)?cloneIfMounted(child):createVNode(Text$1,null,String(child))}function cloneIfMounted(child){return null===child.el&&-1!==child.patchFlag||child.memo?child:cloneVNode(child)}function normalizeChildren(vnode,children){let type=0;const{shapeFlag:shapeFlag}=vnode;if(null==children)children=null;else if(isArray$2(children))type=16;else if("object"==typeof children){if(65&shapeFlag){const slot=children.default;return void(slot&&(slot._c&&(slot._d=!1),normalizeChildren(vnode,slot()),slot._c&&(slot._d=!0)))}{type=32;const slotFlag=children._;slotFlag||isInternalObject(children)?3===slotFlag&&currentRenderingInstance&&(1===currentRenderingInstance.slots._?children._=1:(children._=2,vnode.patchFlag|=1024)):children._ctx=currentRenderingInstance}}else isFunction(children)?(children={default:children,_ctx:currentRenderingInstance},type=32):(children=String(children),64&shapeFlag?(type=16,children=[createTextVNode(children)]):type=8);vnode.children=children,vnode.shapeFlag|=type}function mergeProps(...args){const ret={};for(let i=0;i<args.length;i++){const toMerge=args[i];for(const key in toMerge)if("class"===key)ret.class!==toMerge.class&&(ret.class=normalizeClass([ret.class,toMerge.class]));else if("style"===key)ret.style=normalizeStyle([ret.style,toMerge.style]);else if(isOn(key)){const existing=ret[key],incoming=toMerge[key];!incoming||existing===incoming||isArray$2(existing)&&existing.includes(incoming)||(ret[key]=existing?[].concat(existing,incoming):incoming)}else""!==key&&(ret[key]=toMerge[key])}return ret}function invokeVNodeHook(hook,instance,vnode,prevVNode=null){callWithAsyncErrorHandling(hook,instance,7,[vnode,prevVNode])}const emptyAppContext=createAppContext();let uid=0;let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const g=getGlobalThis(),registerGlobalSetter=(key,setter)=>{let setters;return(setters=g[key])||(setters=g[key]=[]),setters.push(setter),v=>{setters.length>1?setters.forEach(set2=>set2(v)):setters[0](v)}};internalSetCurrentInstance=registerGlobalSetter("__VUE_INSTANCE_SETTERS__",v=>currentInstance=v),setInSSRSetupState=registerGlobalSetter("__VUE_SSR_SETTERS__",v=>isInSSRComponentSetup=v)}const setCurrentInstance=instance=>{const prev=currentInstance;return internalSetCurrentInstance(instance),instance.scope.on(),()=>{instance.scope.off(),internalSetCurrentInstance(prev)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(instance){return 4&instance.vnode.shapeFlag}let compile,isInSSRComponentSetup=!1;function handleSetupResult(instance,setupResult,isSSR){isFunction(setupResult)?instance.type.__ssrInlineRender?instance.ssrRender=setupResult:instance.render=setupResult:isObject(setupResult)&&(instance.setupState=proxyRefs(setupResult)),finishComponentSetup(instance,isSSR)}function finishComponentSetup(instance,isSSR,skipOptions){const Component2=instance.type;if(!instance.render){if(!isSSR&&compile&&!Component2.render){const template=Component2.template||resolveMergedOptions(instance).template;if(template){const{isCustomElement:isCustomElement,compilerOptions:compilerOptions}=instance.appContext.config,{delimiters:delimiters,compilerOptions:componentCompilerOptions}=Component2,finalCompilerOptions=extend$1(extend$1({isCustomElement:isCustomElement,delimiters:delimiters},compilerOptions),componentCompilerOptions);Component2.render=compile(template,finalCompilerOptions)}}instance.render=Component2.render||NOOP}{const reset=setCurrentInstance(instance);pauseTracking();try{applyOptions(instance)}finally{resetTracking(),reset()}}}const attrsProxyHandlers={get:(target,key)=>(track(target,0,""),target[key])};function getComponentPublicInstance(instance){return instance.exposed?instance.exposeProxy||(instance.exposeProxy=new Proxy(proxyRefs(markRaw(instance.exposed)),{get:(target,key)=>key in target?target[key]:key in publicPropertiesMap?publicPropertiesMap[key](instance):void 0,has:(target,key)=>key in target||key in publicPropertiesMap})):instance.proxy}const computed=(getterOrOptions,debugOptions)=>computed$1(getterOrOptions,0,isInSSRComponentSetup);function h(type,propsOrChildren,children){const l2=arguments.length;return 2===l2?isObject(propsOrChildren)&&!isArray$2(propsOrChildren)?isVNode(propsOrChildren)?createVNode(type,null,[propsOrChildren]):createVNode(type,propsOrChildren):createVNode(type,null,propsOrChildren):(l2>3?children=Array.prototype.slice.call(arguments,2):3===l2&&isVNode(children)&&(children=[children]),createVNode(type,propsOrChildren,children))}const version$1="3.5.10";let policy;const tt="undefined"!=typeof window&&window.trustedTypes;if(tt)try{policy=tt.createPolicy("vue",{createHTML:val=>val})}catch(e){}const unsafeToTrustedHTML=policy?val=>policy.createHTML(val):val=>val,doc="undefined"!=typeof document?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(child,parent,anchor)=>{parent.insertBefore(child,anchor||null)},remove:child=>{const parent=child.parentNode;parent&&parent.removeChild(child)},createElement:(tag,namespace,is,props)=>{const el="svg"===namespace?doc.createElementNS("http://www.w3.org/2000/svg",tag):"mathml"===namespace?doc.createElementNS("http://www.w3.org/1998/Math/MathML",tag):is?doc.createElement(tag,{is:is}):doc.createElement(tag);return"select"===tag&&props&&null!=props.multiple&&el.setAttribute("multiple",props.multiple),el},createText:text=>doc.createTextNode(text),createComment:text=>doc.createComment(text),setText:(node,text)=>{node.nodeValue=text},setElementText:(el,text)=>{el.textContent=text},parentNode:node=>node.parentNode,nextSibling:node=>node.nextSibling,querySelector:selector=>doc.querySelector(selector),setScopeId(el,id){el.setAttribute(id,"")},insertStaticContent(content,parent,anchor,namespace,start,end){const before=anchor?anchor.previousSibling:parent.lastChild;if(start&&(start===end||start.nextSibling))for(;parent.insertBefore(start.cloneNode(!0),anchor),start!==end&&(start=start.nextSibling););else{templateContainer.innerHTML=unsafeToTrustedHTML("svg"===namespace?`<svg>${content}</svg>`:"mathml"===namespace?`<math>${content}</math>`:content);const template=templateContainer.content;if("svg"===namespace||"mathml"===namespace){const wrapper=template.firstChild;for(;wrapper.firstChild;)template.appendChild(wrapper.firstChild);template.removeChild(wrapper)}parent.insertBefore(template,anchor)}return[before?before.nextSibling:parent.firstChild,anchor?anchor.previousSibling:parent.lastChild]}},TRANSITION="transition",vtcKey=Symbol("_vtc"),DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=extend$1({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),Transition=(t=>(t.displayName="Transition",t.props=TransitionPropsValidators,t))((props,{slots:slots})=>h(BaseTransition,function(rawProps){const baseProps={};for(const key in rawProps)key in DOMTransitionPropsValidators||(baseProps[key]=rawProps[key]);if(!1===rawProps.css)return baseProps;const{name:name="v",type:type,duration:duration,enterFromClass:enterFromClass=`${name}-enter-from`,enterActiveClass:enterActiveClass=`${name}-enter-active`,enterToClass:enterToClass=`${name}-enter-to`,appearFromClass:appearFromClass=enterFromClass,appearActiveClass:appearActiveClass=enterActiveClass,appearToClass:appearToClass=enterToClass,leaveFromClass:leaveFromClass=`${name}-leave-from`,leaveActiveClass:leaveActiveClass=`${name}-leave-active`,leaveToClass:leaveToClass=`${name}-leave-to`}=rawProps,durations=function(duration){if(null==duration)return null;if(isObject(duration))return[NumberOf(duration.enter),NumberOf(duration.leave)];{const n2=NumberOf(duration);return[n2,n2]}}(duration),enterDuration=durations&&durations[0],leaveDuration=durations&&durations[1],{onBeforeEnter:onBeforeEnter,onEnter:onEnter,onEnterCancelled:onEnterCancelled,onLeave:onLeave,onLeaveCancelled:onLeaveCancelled,onBeforeAppear:onBeforeAppear=onBeforeEnter,onAppear:onAppear=onEnter,onAppearCancelled:onAppearCancelled=onEnterCancelled}=baseProps,finishEnter=(el,isAppear,done)=>{removeTransitionClass(el,isAppear?appearToClass:enterToClass),removeTransitionClass(el,isAppear?appearActiveClass:enterActiveClass),done&&done()},finishLeave=(el,done)=>{el._isLeaving=!1,removeTransitionClass(el,leaveFromClass),removeTransitionClass(el,leaveToClass),removeTransitionClass(el,leaveActiveClass),done&&done()},makeEnterHook=isAppear=>(el,done)=>{const hook=isAppear?onAppear:onEnter,resolve=()=>finishEnter(el,isAppear,done);callHook(hook,[el,resolve]),nextFrame(()=>{removeTransitionClass(el,isAppear?appearFromClass:enterFromClass),addTransitionClass(el,isAppear?appearToClass:enterToClass),hasExplicitCallback(hook)||whenTransitionEnds(el,type,enterDuration,resolve)})};return extend$1(baseProps,{onBeforeEnter(el){callHook(onBeforeEnter,[el]),addTransitionClass(el,enterFromClass),addTransitionClass(el,enterActiveClass)},onBeforeAppear(el){callHook(onBeforeAppear,[el]),addTransitionClass(el,appearFromClass),addTransitionClass(el,appearActiveClass)},onEnter:makeEnterHook(!1),onAppear:makeEnterHook(!0),onLeave(el,done){el._isLeaving=!0;const resolve=()=>finishLeave(el,done);addTransitionClass(el,leaveFromClass),addTransitionClass(el,leaveActiveClass),document.body.offsetHeight,nextFrame(()=>{el._isLeaving&&(removeTransitionClass(el,leaveFromClass),addTransitionClass(el,leaveToClass),hasExplicitCallback(onLeave)||whenTransitionEnds(el,type,leaveDuration,resolve))}),callHook(onLeave,[el,resolve])},onEnterCancelled(el){finishEnter(el,!1),callHook(onEnterCancelled,[el])},onAppearCancelled(el){finishEnter(el,!0),callHook(onAppearCancelled,[el])},onLeaveCancelled(el){finishLeave(el),callHook(onLeaveCancelled,[el])}})}(props),slots)),callHook=(hook,args=[])=>{isArray$2(hook)?hook.forEach(h2=>h2(...args)):hook&&hook(...args)},hasExplicitCallback=hook=>!!hook&&(isArray$2(hook)?hook.some(h2=>h2.length>1):hook.length>1);function NumberOf(val){const res=(val=>{const n2=isString$1(val)?Number(val):NaN;return isNaN(n2)?val:n2})(val);return res}function addTransitionClass(el,cls){cls.split(/\s+/).forEach(c=>c&&el.classList.add(c)),(el[vtcKey]||(el[vtcKey]=new Set)).add(cls)}function removeTransitionClass(el,cls){cls.split(/\s+/).forEach(c=>c&&el.classList.remove(c));const _vtc=el[vtcKey];_vtc&&(_vtc.delete(cls),_vtc.size||(el[vtcKey]=void 0))}function nextFrame(cb){requestAnimationFrame(()=>{requestAnimationFrame(cb)})}let endId=0;function whenTransitionEnds(el,expectedType,explicitTimeout,resolve){const id=el._endId=++endId,resolveIfNotStale=()=>{id===el._endId&&resolve()};if(null!=explicitTimeout)return setTimeout(resolveIfNotStale,explicitTimeout);const{type:type,timeout:timeout,propCount:propCount}=function(el,expectedType){const styles=window.getComputedStyle(el),getStyleProperties=key=>(styles[key]||"").split(", "),transitionDelays=getStyleProperties(`${TRANSITION}Delay`),transitionDurations=getStyleProperties(`${TRANSITION}Duration`),transitionTimeout=getTimeout(transitionDelays,transitionDurations),animationDelays=getStyleProperties("animationDelay"),animationDurations=getStyleProperties("animationDuration"),animationTimeout=getTimeout(animationDelays,animationDurations);let type=null,timeout=0,propCount=0;expectedType===TRANSITION?transitionTimeout>0&&(type=TRANSITION,timeout=transitionTimeout,propCount=transitionDurations.length):"animation"===expectedType?animationTimeout>0&&(type="animation",timeout=animationTimeout,propCount=animationDurations.length):(timeout=Math.max(transitionTimeout,animationTimeout),type=timeout>0?transitionTimeout>animationTimeout?TRANSITION:"animation":null,propCount=type?type===TRANSITION?transitionDurations.length:animationDurations.length:0);const hasTransform=type===TRANSITION&&/\b(transform|all)(,|$)/.test(getStyleProperties(`${TRANSITION}Property`).toString());return{type:type,timeout:timeout,propCount:propCount,hasTransform:hasTransform}}(el,expectedType);if(!type)return resolve();const endEvent=type+"end";let ended=0;const end=()=>{el.removeEventListener(endEvent,onEnd),resolveIfNotStale()},onEnd=e=>{e.target===el&&++ended>=propCount&&end()};setTimeout(()=>{ended<propCount&&end()},timeout+1),el.addEventListener(endEvent,onEnd)}function getTimeout(delays,durations){for(;delays.length<durations.length;)delays=delays.concat(delays);return Math.max(...durations.map((d,i)=>toMs(d)+toMs(delays[i])))}function toMs(s2){return"auto"===s2?0:1e3*Number(s2.slice(0,-1).replace(",","."))}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(el,{value:value},{transition:transition}){el[vShowOriginalDisplay]="none"===el.style.display?"":el.style.display,transition&&value?transition.beforeEnter(el):setDisplay(el,value)},mounted(el,{value:value},{transition:transition}){transition&&value&&transition.enter(el)},updated(el,{value:value,oldValue:oldValue},{transition:transition}){!value!=!oldValue&&(transition?value?(transition.beforeEnter(el),setDisplay(el,!0),transition.enter(el)):transition.leave(el,()=>{setDisplay(el,!1)}):setDisplay(el,value))},beforeUnmount(el,{value:value}){setDisplay(el,value)}};function setDisplay(el,value){el.style.display=value?el[vShowOriginalDisplay]:"none",el[vShowHidden]=!value}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;const importantRE=/\s*!important$/;function setStyle(style,name,val){if(isArray$2(val))val.forEach(v=>setStyle(style,name,v));else if(null==val&&(val=""),name.startsWith("--"))style.setProperty(name,val);else{const prefixed=function(style,rawName){const cached=prefixCache[rawName];if(cached)return cached;let name=camelize(rawName);if("filter"!==name&&name in style)return prefixCache[rawName]=name;name=capitalize(name);for(let i=0;i<prefixes.length;i++){const prefixed=prefixes[i]+name;if(prefixed in style)return prefixCache[rawName]=prefixed}return rawName}(style,name);importantRE.test(val)?style.setProperty(hyphenate(prefixed),val.replace(importantRE,""),"important"):style[prefixed]=val}}const prefixes=["Webkit","Moz","ms"],prefixCache={};const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(el,key,value,isSVG,instance,isBoolean=isSpecialBooleanAttr(key)){isSVG&&key.startsWith("xlink:")?null==value?el.removeAttributeNS(xlinkNS,key.slice(6,key.length)):el.setAttributeNS(xlinkNS,key,value):null==value||isBoolean&&!includeBooleanAttr(value)?el.removeAttribute(key):el.setAttribute(key,isBoolean?"":isSymbol(value)?String(value):value)}function patchDOMProp(el,key,value,parentComponent){if("innerHTML"===key||"textContent"===key)return void(null!=value&&(el[key]="innerHTML"===key?unsafeToTrustedHTML(value):value));const tag=el.tagName;if("value"===key&&"PROGRESS"!==tag&&!tag.includes("-")){const oldValue="OPTION"===tag?el.getAttribute("value")||"":el.value,newValue=null==value?"checkbox"===el.type?"on":"":String(value);return oldValue===newValue&&"_value"in el||(el.value=newValue),null==value&&el.removeAttribute(key),void(el._value=value)}let needRemove=!1;if(""===value||null==value){const type=typeof el[key];"boolean"===type?value=includeBooleanAttr(value):null==value&&"string"===type?(value="",needRemove=!0):"number"===type&&(value=0,needRemove=!0)}try{el[key]=value}catch(e){}needRemove&&el.removeAttribute(key)}const veiKey=Symbol("_vei");function patchEvent(el,rawName,prevValue,nextValue,instance=null){const invokers=el[veiKey]||(el[veiKey]={}),existingInvoker=invokers[rawName];if(nextValue&&existingInvoker)existingInvoker.value=nextValue;else{const[name,options]=function(name){let options;if(optionsModifierRE.test(name)){let m;for(options={};m=name.match(optionsModifierRE);)name=name.slice(0,name.length-m[0].length),options[m[0].toLowerCase()]=!0}const event=":"===name[2]?name.slice(3):hyphenate(name.slice(2));return[event,options]}(rawName);if(nextValue){const invoker=invokers[rawName]=function(initialValue,instance){const invoker=e=>{if(e._vts){if(e._vts<=invoker.attached)return}else e._vts=Date.now();callWithAsyncErrorHandling(function(e,value){if(isArray$2(value)){const originalStop=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{originalStop.call(e),e._stopped=!0},value.map(fn=>e2=>!e2._stopped&&fn&&fn(e2))}return value}(e,invoker.value),instance,5,[e])};return invoker.value=initialValue,invoker.attached=getNow(),invoker}(nextValue,instance);!function(el,event,handler,options){el.addEventListener(event,handler,options)}(el,name,invoker,options)}else existingInvoker&&(!function(el,event,handler,options){el.removeEventListener(event,handler,options)}(el,name,existingInvoker,options),invokers[rawName]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());const isNativeOn=key=>111===key.charCodeAt(0)&&110===key.charCodeAt(1)&&key.charCodeAt(2)>96&&key.charCodeAt(2)<123;const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,modifiers)=>systemModifiers.some(m=>e[`${m}Key`]&&!modifiers.includes(m))},withModifiers=(fn,modifiers)=>{const cache2=fn._withMods||(fn._withMods={}),cacheKey=modifiers.join(".");return cache2[cacheKey]||(cache2[cacheKey]=(event,...args)=>{for(let i=0;i<modifiers.length;i++){const guard=modifierGuards[modifiers[i]];if(guard&&guard(event,modifiers))return}return fn(event,...args)})},rendererOptions=extend$1({patchProp:(el,key,prevValue,nextValue,namespace,parentComponent)=>{const isSVG="svg"===namespace;"class"===key?function(el,value,isSVG){const transitionClasses=el[vtcKey];transitionClasses&&(value=(value?[value,...transitionClasses]:[...transitionClasses]).join(" ")),null==value?el.removeAttribute("class"):isSVG?el.setAttribute("class",value):el.className=value}(el,nextValue,isSVG):"style"===key?function(el,prev,next){const style=el.style,isCssString=isString$1(next);let hasControlledDisplay=!1;if(next&&!isCssString){if(prev)if(isString$1(prev))for(const prevStyle of prev.split(";")){const key=prevStyle.slice(0,prevStyle.indexOf(":")).trim();null==next[key]&&setStyle(style,key,"")}else for(const key in prev)null==next[key]&&setStyle(style,key,"");for(const key in next)"display"===key&&(hasControlledDisplay=!0),setStyle(style,key,next[key])}else if(isCssString){if(prev!==next){const cssVarText=style[CSS_VAR_TEXT];cssVarText&&(next+=";"+cssVarText),style.cssText=next,hasControlledDisplay=displayRE.test(next)}}else prev&&el.removeAttribute("style");vShowOriginalDisplay in el&&(el[vShowOriginalDisplay]=hasControlledDisplay?style.display:"",el[vShowHidden]&&(style.display="none"))}(el,prevValue,nextValue):isOn(key)?isModelListener(key)||patchEvent(el,key,0,nextValue,parentComponent):("."===key[0]?(key=key.slice(1),1):"^"===key[0]?(key=key.slice(1),0):function(el,key,value,isSVG){if(isSVG)return"innerHTML"===key||"textContent"===key||!!(key in el&&isNativeOn(key)&&isFunction(value));if("spellcheck"===key||"draggable"===key||"translate"===key)return!1;if("form"===key)return!1;if("list"===key&&"INPUT"===el.tagName)return!1;if("type"===key&&"TEXTAREA"===el.tagName)return!1;if("width"===key||"height"===key){const tag=el.tagName;if("IMG"===tag||"VIDEO"===tag||"CANVAS"===tag||"SOURCE"===tag)return!1}if(isNativeOn(key)&&isString$1(value))return!1;return key in el}(el,key,nextValue,isSVG))?(patchDOMProp(el,key,nextValue),el.tagName.includes("-")||"value"!==key&&"checked"!==key&&"selected"!==key||patchAttr(el,key,nextValue,isSVG,0,"value"!==key)):!el._isVueCE||!/[A-Z]/.test(key)&&isString$1(nextValue)?("true-value"===key?el._trueValue=nextValue:"false-value"===key&&(el._falseValue=nextValue),patchAttr(el,key,nextValue,isSVG)):patchDOMProp(el,camelize(key),nextValue)}},nodeOps);let renderer;let activePinia;const setActivePinia=pinia2=>activePinia=pinia2,piniaSymbol=Symbol();function isPlainObject(o){return o&&"object"==typeof o&&"[object Object]"===Object.prototype.toString.call(o)&&"function"!=typeof o.toJSON}var MutationType,MutationType2;(MutationType2=MutationType||(MutationType={})).direct="direct",MutationType2.patchObject="patch object",MutationType2.patchFunction="patch function";const noop$2=()=>{};function addSubscription(subscriptions,callback,detached,onCleanup=noop$2){subscriptions.push(callback);const removeSubscription=()=>{const idx=subscriptions.indexOf(callback);idx>-1&&(subscriptions.splice(idx,1),onCleanup())};return!detached&&getCurrentScope()&&onScopeDispose(removeSubscription),removeSubscription}function triggerSubscriptions(subscriptions,...args){subscriptions.slice().forEach(callback=>{callback(...args)})}const fallbackRunWithContext=fn=>fn(),ACTION_MARKER=Symbol(),ACTION_NAME=Symbol();function mergeReactiveObjects(target,patchToApply){target instanceof Map&&patchToApply instanceof Map?patchToApply.forEach((value,key)=>target.set(key,value)):target instanceof Set&&patchToApply instanceof Set&&patchToApply.forEach(target.add,target);for(const key in patchToApply){if(!patchToApply.hasOwnProperty(key))continue;const subPatch=patchToApply[key],targetValue=target[key];isPlainObject(targetValue)&&isPlainObject(subPatch)&&target.hasOwnProperty(key)&&!isRef(subPatch)&&!isReactive(subPatch)?target[key]=mergeReactiveObjects(targetValue,subPatch):target[key]=subPatch}return target}const skipHydrateSymbol=Symbol();function shouldHydrate(obj){return!isPlainObject(obj)||!obj.hasOwnProperty(skipHydrateSymbol)}const{assign:assign$1}=Object;function isComputed(o){return!(!isRef(o)||!o.effect)}function createOptionsStore(id,options,pinia2,hot){const{state:state,actions:actions,getters:getters}=options,initialState=pinia2.state.value[id];let store;return store=createSetupStore(id,function(){initialState||(pinia2.state.value[id]=state?state():{});const localState=function(object){const ret=isArray$2(object)?new Array(object.length):{};for(const key in object)ret[key]=propertyToRef(object,key);return ret}(pinia2.state.value[id]);return assign$1(localState,actions,Object.keys(getters||{}).reduce((computedGetters,name)=>(computedGetters[name]=markRaw(computed(()=>{setActivePinia(pinia2);const store2=pinia2._s.get(id);return getters[name].call(store2,store2)})),computedGetters),{}))},options,pinia2,hot,!0),store}function createSetupStore($id,setup,options={},pinia2,hot,isOptionsStore){let scope;const optionsForPlugin=assign$1({actions:{}},options),$subscribeOptions={deep:!0};let isListening,isSyncListening,subscriptions=[],actionSubscriptions=[];const initialState=pinia2.state.value[$id];let activeListener;function $patch(partialStateOrMutator){let subscriptionMutation;isListening=isSyncListening=!1,"function"==typeof partialStateOrMutator?(partialStateOrMutator(pinia2.state.value[$id]),subscriptionMutation={type:MutationType.patchFunction,storeId:$id,events:undefined}):(mergeReactiveObjects(pinia2.state.value[$id],partialStateOrMutator),subscriptionMutation={type:MutationType.patchObject,payload:partialStateOrMutator,storeId:$id,events:undefined});const myListenerId=activeListener=Symbol();nextTick().then(()=>{activeListener===myListenerId&&(isListening=!0)}),isSyncListening=!0,triggerSubscriptions(subscriptions,subscriptionMutation,pinia2.state.value[$id])}isOptionsStore||initialState||(pinia2.state.value[$id]={}),ref({});const $reset=isOptionsStore?function(){const{state:state}=options,newState=state?state():{};this.$patch($state=>{assign$1($state,newState)})}:noop$2;const action=(fn,name="")=>{if(ACTION_MARKER in fn)return fn[ACTION_NAME]=name,fn;const wrappedAction=function(){setActivePinia(pinia2);const args=Array.from(arguments),afterCallbackList=[],onErrorCallbackList=[];let ret;triggerSubscriptions(actionSubscriptions,{args:args,name:wrappedAction[ACTION_NAME],store:store,after:function(callback){afterCallbackList.push(callback)},onError:function(callback){onErrorCallbackList.push(callback)}});try{ret=fn.apply(this&&this.$id===$id?this:store,args)}catch(error){throw triggerSubscriptions(onErrorCallbackList,error),error}return ret instanceof Promise?ret.then(value=>(triggerSubscriptions(afterCallbackList,value),value)).catch(error=>(triggerSubscriptions(onErrorCallbackList,error),Promise.reject(error))):(triggerSubscriptions(afterCallbackList,ret),ret)};return wrappedAction[ACTION_MARKER]=!0,wrappedAction[ACTION_NAME]=name,wrappedAction},store=reactive({_p:pinia2,$id:$id,$onAction:addSubscription.bind(null,actionSubscriptions),$patch:$patch,$reset:$reset,$subscribe(callback,options2={}){const removeSubscription=addSubscription(subscriptions,callback,options2.detached,()=>stopWatcher()),stopWatcher=scope.run(()=>watch(()=>pinia2.state.value[$id],state=>{("sync"===options2.flush?isSyncListening:isListening)&&callback({storeId:$id,type:MutationType.direct,events:undefined},state)},assign$1({},$subscribeOptions,options2)));return removeSubscription},$dispose:function(){scope.stop(),subscriptions=[],actionSubscriptions=[],pinia2._s.delete($id)}});pinia2._s.set($id,store);const setupStore=(pinia2._a&&pinia2._a.runWithContext||fallbackRunWithContext)(()=>pinia2._e.run(()=>(scope=effectScope()).run(()=>setup({action:action}))));for(const key in setupStore){const prop=setupStore[key];if(isRef(prop)&&!isComputed(prop)||isReactive(prop))isOptionsStore||(initialState&&shouldHydrate(prop)&&(isRef(prop)?prop.value=initialState[key]:mergeReactiveObjects(prop,initialState[key])),pinia2.state.value[$id][key]=prop);else if("function"==typeof prop){const actionValue=action(prop,key);setupStore[key]=actionValue,optionsForPlugin.actions[key]=prop}}return assign$1(store,setupStore),assign$1(toRaw(store),setupStore),Object.defineProperty(store,"$state",{get:()=>pinia2.state.value[$id],set:state=>{$patch($state=>{assign$1($state,state)})}}),pinia2._p.forEach(extender=>{assign$1(store,scope.run(()=>extender({store:store,app:pinia2._a,pinia:pinia2,options:optionsForPlugin})))}),initialState&&isOptionsStore&&options.hydrate&&options.hydrate(store.$state,initialState),isListening=!0,isSyncListening=!0,store}function defineStore(idOrOptions,setup,setupOptions){let id,options;const isSetupStore="function"==typeof setup;function useStore(pinia2,hot){(pinia2=pinia2||(!!(currentInstance||currentRenderingInstance||currentApp)?inject(piniaSymbol,null):null))&&setActivePinia(pinia2),(pinia2=activePinia)._s.has(id)||(isSetupStore?createSetupStore(id,setup,options,pinia2):createOptionsStore(id,options,pinia2));return pinia2._s.get(id)}return"string"==typeof idOrOptions?(id=idOrOptions,options=isSetupStore?setupOptions:setup):(options=idOrOptions,id=idOrOptions.id),useStore.$id=id,useStore}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n2=Array(a);e<a;e++)n2[e]=r[e];return n2}function asyncGeneratorStep(n2,t,e,r,o,a,c){try{var i=n2[a](c),u=i.value}catch(n3){return void e(n3)}i.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(n2){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n2.apply(t,e);function _next2(n3){asyncGeneratorStep(a,r,o,_next2,_throw,"next",n3)}function _throw(n3){asyncGeneratorStep(a,r,o,_next2,_throw,"throw",n3)}_next2(void 0)})}}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e){t&&(r=t);var n2=0,F=function(){};return{s:F,n:function(){return n2>=r.length?{done:!0}:{done:!1,value:r[n2++]}},e:function(r2){throw r2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){t=t.call(r)},n:function(){var r2=t.next();return a=r2.done,r2},e:function(r2){u=!0,o=r2},f:function(){try{a||null==t.return||t.return()}finally{if(u)throw o}}}}function _defineProperty(e,r,t){return(r=function(t){var i=function(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof i?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r2){return Object.getOwnPropertyDescriptor(e,r2).enumerable})),t.push.apply(t,o)}return t}function _objectSpread2(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r2){_defineProperty(e,r2,t[r2])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r2){Object.defineProperty(e,r2,Object.getOwnPropertyDescriptor(t,r2))})}return e}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},n2=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r2,n3,o2,i2){var c2=n3&&n3.prototype instanceof Generator?n3:Generator,u2=Object.create(c2.prototype);return _regeneratorDefine(u2,"_invoke",function(r3,n4,o3){var i3,c3,u3,f2=0,p2=o3||[],y=!1,G={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t2,r4){return i3=t2,c3=0,u3=e,G.n=r4,a}};function d(r4,n5){for(c3=r4,u3=n5,t=0;!y&&f2&&!o4&&t<p2.length;t++){var o4,i4=p2[t],d2=G.p,l2=i4[2];r4>3?(o4=l2===n5)&&(u3=i4[(c3=i4[4])?5:(c3=3,3)],i4[4]=i4[5]=e):i4[0]<=d2&&((o4=r4<2&&d2<i4[1])?(c3=0,G.v=n5,G.n=i4[1]):d2<l2&&(o4=r4<3||i4[0]>n5||n5>l2)&&(i4[4]=r4,i4[5]=n5,G.n=l2,c3=0))}if(o4||r4>1)return a;throw y=!0,n5}return function(o4,p3,l2){if(f2>1)throw TypeError("Generator is already running");for(y&&1===p3&&d(p3,l2),c3=p3,u3=l2;(t=c3<2?e:u3)||!y;){i3||(c3?c3<3?(c3>1&&(G.n=-1),d(c3,u3)):G.n=u3:G.v=u3);try{if(f2=2,i3){if(c3||(o4="next"),t=i3[o4]){if(!(t=t.call(i3,u3)))throw TypeError("iterator result is not an object");if(!t.done)return t;u3=t.value,c3<2&&(c3=0)}else 1===c3&&(t=i3.return)&&t.call(i3),c3<2&&(u3=TypeError("The iterator does not provide a '"+o4+"' method"),c3=1);i3=e}else if((t=(y=G.n<0)?u3:r3.call(n4,G))!==a)break}catch(t2){i3=e,c3=1,u3=t2}finally{f2=1}}return{value:t,done:y}}}(r2,o2,i2),!0),u2}var a={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}t=Object.getPrototypeOf;var c=[][n2]?t(t([][n2]())):(_regeneratorDefine(t={},n2,function(){return this}),t),u=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(c);function f(e2){return Object.setPrototypeOf?Object.setPrototypeOf(e2,GeneratorFunctionPrototype):(e2.__proto__=GeneratorFunctionPrototype,_regeneratorDefine(e2,o,"GeneratorFunction")),e2.prototype=Object.create(u),e2}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_regeneratorDefine(u,"constructor",GeneratorFunctionPrototype),_regeneratorDefine(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",_regeneratorDefine(GeneratorFunctionPrototype,o,"GeneratorFunction"),_regeneratorDefine(u),_regeneratorDefine(u,o,"Generator"),_regeneratorDefine(u,n2,function(){return this}),_regeneratorDefine(u,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:i,m:f}})()}function _regeneratorDefine(e,r,n2,t){var i=Object.defineProperty;try{i({},"",{})}catch(e2){i=0}(_regeneratorDefine=function(e2,r2,n3,t2){function o(r3,n4){_regeneratorDefine(e2,r3,function(e3){return this._invoke(r3,n4,e3)})}r2?i?i(e2,r2,{value:n3,enumerable:!t2,configurable:!t2,writable:!t2}):e2[r2]=n3:(o("next",0),o("throw",1),o("return",2))})(e,r,n2,t)}function _slicedToArray(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,l2){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n2,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l2){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l2);f=!0);}catch(r2){o=!0,n2=r2}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n2}}return a}}(r,e)||_unsupportedIterableToArray(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(r){return function(r){if(Array.isArray(r))return _arrayLikeToArray(r)}(r)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||_unsupportedIterableToArray(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _typeof(o){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o2){return typeof o2}:function(o2){return o2&&"function"==typeof Symbol&&o2.constructor===Symbol&&o2!==Symbol.prototype?"symbol":typeof o2})(o)}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}var equivalentPaths=function(p1,p2){return!(!p1||!p2)&&p1.join(",")===p2.join(",")};class LuxonError extends Error{}class InvalidDateTimeError extends LuxonError{constructor(reason){super(`Invalid DateTime: ${reason.toMessage()}`)}}class InvalidIntervalError extends LuxonError{constructor(reason){super(`Invalid Interval: ${reason.toMessage()}`)}}class InvalidDurationError extends LuxonError{constructor(reason){super(`Invalid Duration: ${reason.toMessage()}`)}}class ConflictingSpecificationError extends LuxonError{}class InvalidUnitError extends LuxonError{constructor(unit){super(`Invalid unit ${unit}`)}}class InvalidArgumentError extends LuxonError{}class ZoneIsAbstractError extends LuxonError{constructor(){super("Zone is an abstract class")}}const n="numeric",s="short",l="long",DATE_SHORT={year:n,month:n,day:n},DATE_MED={year:n,month:s,day:n},DATE_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s},DATE_FULL={year:n,month:l,day:n},DATE_HUGE={year:n,month:l,day:n,weekday:l},TIME_SIMPLE={hour:n,minute:n},TIME_WITH_SECONDS={hour:n,minute:n,second:n},TIME_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,timeZoneName:s},TIME_WITH_LONG_OFFSET={hour:n,minute:n,second:n,timeZoneName:l},TIME_24_SIMPLE={hour:n,minute:n,hourCycle:"h23"},TIME_24_WITH_SECONDS={hour:n,minute:n,second:n,hourCycle:"h23"},TIME_24_WITH_SHORT_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:s},TIME_24_WITH_LONG_OFFSET={hour:n,minute:n,second:n,hourCycle:"h23",timeZoneName:l},DATETIME_SHORT={year:n,month:n,day:n,hour:n,minute:n},DATETIME_SHORT_WITH_SECONDS={year:n,month:n,day:n,hour:n,minute:n,second:n},DATETIME_MED={year:n,month:s,day:n,hour:n,minute:n},DATETIME_MED_WITH_SECONDS={year:n,month:s,day:n,hour:n,minute:n,second:n},DATETIME_MED_WITH_WEEKDAY={year:n,month:s,day:n,weekday:s,hour:n,minute:n},DATETIME_FULL={year:n,month:l,day:n,hour:n,minute:n,timeZoneName:s},DATETIME_FULL_WITH_SECONDS={year:n,month:l,day:n,hour:n,minute:n,second:n,timeZoneName:s},DATETIME_HUGE={year:n,month:l,day:n,weekday:l,hour:n,minute:n,timeZoneName:l},DATETIME_HUGE_WITH_SECONDS={year:n,month:l,day:n,weekday:l,hour:n,minute:n,second:n,timeZoneName:l};class Zone{get type(){throw new ZoneIsAbstractError}get name(){throw new ZoneIsAbstractError}get ianaName(){return this.name}get isUniversal(){throw new ZoneIsAbstractError}offsetName(ts,opts){throw new ZoneIsAbstractError}formatOffset(ts,format){throw new ZoneIsAbstractError}offset(ts){throw new ZoneIsAbstractError}equals(otherZone){throw new ZoneIsAbstractError}get isValid(){throw new ZoneIsAbstractError}}let singleton$1=null;class SystemZone extends Zone{static get instance(){return null===singleton$1&&(singleton$1=new SystemZone),singleton$1}get type(){return"system"}get name(){return(new Intl.DateTimeFormat).resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(ts,{format:format,locale:locale}){return parseZoneInfo(ts,format,locale)}formatOffset(ts,format){return formatOffset(this.offset(ts),format)}offset(ts){return-new Date(ts).getTimezoneOffset()}equals(otherZone){return"system"===otherZone.type}get isValid(){return!0}}const dtfCache=new Map;const typeToPos={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};const ianaZoneCache=new Map;class IANAZone extends Zone{static create(name){let zone=ianaZoneCache.get(name);return void 0===zone&&ianaZoneCache.set(name,zone=new IANAZone(name)),zone}static resetCache(){ianaZoneCache.clear(),dtfCache.clear()}static isValidSpecifier(s2){return this.isValidZone(s2)}static isValidZone(zone){if(!zone)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:zone}).format(),!0}catch(e){return!1}}constructor(name){super(),this.zoneName=name,this.valid=IANAZone.isValidZone(name)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(ts,{format:format,locale:locale}){return parseZoneInfo(ts,format,locale,this.name)}formatOffset(ts,format){return formatOffset(this.offset(ts),format)}offset(ts){if(!this.valid)return NaN;const date=new Date(ts);if(isNaN(date))return NaN;const dtf=function(zoneName){let dtf=dtfCache.get(zoneName);return void 0===dtf&&(dtf=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:zoneName,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),dtfCache.set(zoneName,dtf)),dtf}(this.name);let[year2,month,day,adOrBc,hour,minute,second]=dtf.formatToParts?function(dtf,date){const formatted=dtf.formatToParts(date),filled=[];for(let i=0;i<formatted.length;i++){const{type:type,value:value}=formatted[i],pos=typeToPos[type];"era"===type?filled[pos]=value:isUndefined(pos)||(filled[pos]=parseInt(value,10))}return filled}(dtf,date):function(dtf,date){const formatted=dtf.format(date).replace(/\u200E/g,""),parsed=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(formatted),[,fMonth,fDay,fYear,fadOrBc,fHour,fMinute,fSecond]=parsed;return[fYear,fMonth,fDay,fadOrBc,fHour,fMinute,fSecond]}(dtf,date);"BC"===adOrBc&&(year2=1-Math.abs(year2));let asTS=+date;const over=asTS%1e3;return asTS-=over>=0?over:1e3+over,(objToLocalTS({year:year2,month:month,day:day,hour:24===hour?0:hour,minute:minute,second:second,millisecond:0})-asTS)/6e4}equals(otherZone){return"iana"===otherZone.type&&otherZone.name===this.name}get isValid(){return this.valid}}let intlLFCache={};const intlDTCache=new Map;function getCachedDTF(locString,opts={}){const key=JSON.stringify([locString,opts]);let dtf=intlDTCache.get(key);return void 0===dtf&&(dtf=new Intl.DateTimeFormat(locString,opts),intlDTCache.set(key,dtf)),dtf}const intlNumCache=new Map;const intlRelCache=new Map;let sysLocaleCache=null;const intlResolvedOptionsCache=new Map;function getCachedIntResolvedOptions(locString){let opts=intlResolvedOptionsCache.get(locString);return void 0===opts&&(opts=new Intl.DateTimeFormat(locString).resolvedOptions(),intlResolvedOptionsCache.set(locString,opts)),opts}const weekInfoCache=new Map;function listStuff(loc,length,englishFn,intlFn){const mode=loc.listingMode();return"error"===mode?null:"en"===mode?englishFn(length):intlFn(length)}class PolyNumberFormatter{constructor(intl,forceSimple,opts){this.padTo=opts.padTo||0,this.floor=opts.floor||!1;const _a2=opts,{padTo:padTo,floor:floor}=_a2,otherOpts=__objRest(_a2,["padTo","floor"]);if(!forceSimple||Object.keys(otherOpts).length>0){const intlOpts=__spreadValues({useGrouping:!1},opts);opts.padTo>0&&(intlOpts.minimumIntegerDigits=opts.padTo),this.inf=function(locString,opts={}){const key=JSON.stringify([locString,opts]);let inf=intlNumCache.get(key);return void 0===inf&&(inf=new Intl.NumberFormat(locString,opts),intlNumCache.set(key,inf)),inf}(intl,intlOpts)}}format(i){if(this.inf){const fixed=this.floor?Math.floor(i):i;return this.inf.format(fixed)}return padStart$1(this.floor?Math.floor(i):roundTo(i,3),this.padTo)}}class PolyDateFormatter{constructor(dt,intl,opts){let z;if(this.opts=opts,this.originalZone=void 0,this.opts.timeZone)this.dt=dt;else if("fixed"===dt.zone.type){const gmtOffset=dt.offset/60*-1,offsetZ=gmtOffset>=0?`Etc/GMT+${gmtOffset}`:`Etc/GMT${gmtOffset}`;0!==dt.offset&&IANAZone.create(offsetZ).valid?(z=offsetZ,this.dt=dt):(z="UTC",this.dt=0===dt.offset?dt:dt.setZone("UTC").plus({minutes:dt.offset}),this.originalZone=dt.zone)}else"system"===dt.zone.type?this.dt=dt:"iana"===dt.zone.type?(this.dt=dt,z=dt.zone.name):(z="UTC",this.dt=dt.setZone("UTC").plus({minutes:dt.offset}),this.originalZone=dt.zone);const intlOpts=__spreadValues({},this.opts);intlOpts.timeZone=intlOpts.timeZone||z,this.dtf=getCachedDTF(intl,intlOpts)}format(){return this.originalZone?this.formatToParts().map(({value:value})=>value).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const parts=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?parts.map(part=>{if("timeZoneName"===part.type){const offsetName=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return __spreadProps(__spreadValues({},part),{value:offsetName})}return part}):parts}resolvedOptions(){return this.dtf.resolvedOptions()}}class PolyRelFormatter{constructor(intl,isEnglish,opts){this.opts=__spreadValues({style:"long"},opts),!isEnglish&&hasRelative()&&(this.rtf=function(locString,opts={}){const _a2=opts,{base:base}=_a2,cacheKeyOpts=__objRest(_a2,["base"]),key=JSON.stringify([locString,cacheKeyOpts]);let inf=intlRelCache.get(key);return void 0===inf&&(inf=new Intl.RelativeTimeFormat(locString,opts),intlRelCache.set(key,inf)),inf}(intl,opts))}format(count,unit){return this.rtf?this.rtf.format(count,unit):function(unit,count,numeric="always",narrow=!1){const units={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},lastable=-1===["hours","minutes","seconds"].indexOf(unit);if("auto"===numeric&&lastable){const isDay="days"===unit;switch(count){case 1:return isDay?"tomorrow":`next ${units[unit][0]}`;case-1:return isDay?"yesterday":`last ${units[unit][0]}`;case 0:return isDay?"today":`this ${units[unit][0]}`}}const isInPast=Object.is(count,-0)||count<0,fmtValue=Math.abs(count),singular=1===fmtValue,lilUnits=units[unit],fmtUnit=narrow?singular?lilUnits[1]:lilUnits[2]||lilUnits[1]:singular?units[unit][0]:unit;return isInPast?`${fmtValue} ${fmtUnit} ago`:`in ${fmtValue} ${fmtUnit}`}(unit,count,this.opts.numeric,"long"!==this.opts.style)}formatToParts(count,unit){return this.rtf?this.rtf.formatToParts(count,unit):[]}}const fallbackWeekSettings={firstDay:1,minimalDays:4,weekend:[6,7]};class Locale{static fromOpts(opts){return Locale.create(opts.locale,opts.numberingSystem,opts.outputCalendar,opts.weekSettings,opts.defaultToEN)}static create(locale,numberingSystem,outputCalendar,weekSettings,defaultToEN=!1){const specifiedLocale=locale||Settings.defaultLocale,localeR=specifiedLocale||(defaultToEN?"en-US":sysLocaleCache||(sysLocaleCache=(new Intl.DateTimeFormat).resolvedOptions().locale,sysLocaleCache)),numberingSystemR=numberingSystem||Settings.defaultNumberingSystem,outputCalendarR=outputCalendar||Settings.defaultOutputCalendar,weekSettingsR=validateWeekSettings(weekSettings)||Settings.defaultWeekSettings;return new Locale(localeR,numberingSystemR,outputCalendarR,weekSettingsR,specifiedLocale)}static resetCache(){sysLocaleCache=null,intlDTCache.clear(),intlNumCache.clear(),intlRelCache.clear(),intlResolvedOptionsCache.clear(),weekInfoCache.clear()}static fromObject({locale:locale,numberingSystem:numberingSystem,outputCalendar:outputCalendar,weekSettings:weekSettings}={}){return Locale.create(locale,numberingSystem,outputCalendar,weekSettings)}constructor(locale,numbering,outputCalendar,weekSettings,specifiedLocale){const[parsedLocale,parsedNumberingSystem,parsedOutputCalendar]=function(localeStr){const xIndex=localeStr.indexOf("-x-");-1!==xIndex&&(localeStr=localeStr.substring(0,xIndex));const uIndex=localeStr.indexOf("-u-");if(-1===uIndex)return[localeStr];{let options,selectedStr;try{options=getCachedDTF(localeStr).resolvedOptions(),selectedStr=localeStr}catch(e){const smaller=localeStr.substring(0,uIndex);options=getCachedDTF(smaller).resolvedOptions(),selectedStr=smaller}const{numberingSystem:numberingSystem,calendar:calendar}=options;return[selectedStr,numberingSystem,calendar]}}(locale);this.locale=parsedLocale,this.numberingSystem=numbering||parsedNumberingSystem||null,this.outputCalendar=outputCalendar||parsedOutputCalendar||null,this.weekSettings=weekSettings,this.intl=function(localeStr,numberingSystem,outputCalendar){return outputCalendar||numberingSystem?(localeStr.includes("-u-")||(localeStr+="-u"),outputCalendar&&(localeStr+=`-ca-${outputCalendar}`),numberingSystem&&(localeStr+=`-nu-${numberingSystem}`),localeStr):localeStr}(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=specifiedLocale,this.fastNumbersCached=null}get fastNumbers(){var loc;return null==this.fastNumbersCached&&(this.fastNumbersCached=(!(loc=this).numberingSystem||"latn"===loc.numberingSystem)&&("latn"===loc.numberingSystem||!loc.locale||loc.locale.startsWith("en")||"latn"===getCachedIntResolvedOptions(loc.locale).numberingSystem)),this.fastNumbersCached}listingMode(){const isActuallyEn=this.isEnglish(),hasNoWeirdness=!(null!==this.numberingSystem&&"latn"!==this.numberingSystem||null!==this.outputCalendar&&"gregory"!==this.outputCalendar);return isActuallyEn&&hasNoWeirdness?"en":"intl"}clone(alts){return alts&&0!==Object.getOwnPropertyNames(alts).length?Locale.create(alts.locale||this.specifiedLocale,alts.numberingSystem||this.numberingSystem,alts.outputCalendar||this.outputCalendar,validateWeekSettings(alts.weekSettings)||this.weekSettings,alts.defaultToEN||!1):this}redefaultToEN(alts={}){return this.clone(__spreadProps(__spreadValues({},alts),{defaultToEN:!0}))}redefaultToSystem(alts={}){return this.clone(__spreadProps(__spreadValues({},alts),{defaultToEN:!1}))}months(length,format=!1){return listStuff(this,length,months,()=>{const intl=format?{month:length,day:"numeric"}:{month:length},formatStr=format?"format":"standalone";return this.monthsCache[formatStr][length]||(this.monthsCache[formatStr][length]=function(f){const ms=[];for(let i=1;i<=12;i++){const dt=DateTime$1.utc(2009,i,1);ms.push(f(dt))}return ms}(dt=>this.extract(dt,intl,"month"))),this.monthsCache[formatStr][length]})}weekdays(length,format=!1){return listStuff(this,length,weekdays,()=>{const intl=format?{weekday:length,year:"numeric",month:"long",day:"numeric"}:{weekday:length},formatStr=format?"format":"standalone";return this.weekdaysCache[formatStr][length]||(this.weekdaysCache[formatStr][length]=function(f){const ms=[];for(let i=1;i<=7;i++){const dt=DateTime$1.utc(2016,11,13+i);ms.push(f(dt))}return ms}(dt=>this.extract(dt,intl,"weekday"))),this.weekdaysCache[formatStr][length]})}meridiems(){return listStuff(this,void 0,()=>meridiems,()=>{if(!this.meridiemCache){const intl={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[DateTime$1.utc(2016,11,13,9),DateTime$1.utc(2016,11,13,19)].map(dt=>this.extract(dt,intl,"dayperiod"))}return this.meridiemCache})}eras(length){return listStuff(this,length,eras,()=>{const intl={era:length};return this.eraCache[length]||(this.eraCache[length]=[DateTime$1.utc(-40,1,1),DateTime$1.utc(2017,1,1)].map(dt=>this.extract(dt,intl,"era"))),this.eraCache[length]})}extract(dt,intlOpts,field){const matching=this.dtFormatter(dt,intlOpts).formatToParts().find(m=>m.type.toLowerCase()===field);return matching?matching.value:null}numberFormatter(opts={}){return new PolyNumberFormatter(this.intl,opts.forceSimple||this.fastNumbers,opts)}dtFormatter(dt,intlOpts={}){return new PolyDateFormatter(dt,this.intl,intlOpts)}relFormatter(opts={}){return new PolyRelFormatter(this.intl,this.isEnglish(),opts)}listFormatter(opts={}){return function(locString,opts={}){const key=JSON.stringify([locString,opts]);let dtf=intlLFCache[key];return dtf||(dtf=new Intl.ListFormat(locString,opts),intlLFCache[key]=dtf),dtf}(this.intl,opts)}isEnglish(){return"en"===this.locale||"en-us"===this.locale.toLowerCase()||getCachedIntResolvedOptions(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:hasLocaleWeekInfo()?function(locString){let data=weekInfoCache.get(locString);if(!data){const locale=new Intl.Locale(locString);data="getWeekInfo"in locale?locale.getWeekInfo():locale.weekInfo,"minimalDays"in data||(data=__spreadValues(__spreadValues({},fallbackWeekSettings),data)),weekInfoCache.set(locString,data)}return data}(this.locale):fallbackWeekSettings}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(other){return this.locale===other.locale&&this.numberingSystem===other.numberingSystem&&this.outputCalendar===other.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let singleton=null;class FixedOffsetZone extends Zone{static get utcInstance(){return null===singleton&&(singleton=new FixedOffsetZone(0)),singleton}static instance(offset2){return 0===offset2?FixedOffsetZone.utcInstance:new FixedOffsetZone(offset2)}static parseSpecifier(s2){if(s2){const r=s2.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new FixedOffsetZone(signedOffset(r[1],r[2]))}return null}constructor(offset2){super(),this.fixed=offset2}get type(){return"fixed"}get name(){return 0===this.fixed?"UTC":`UTC${formatOffset(this.fixed,"narrow")}`}get ianaName(){return 0===this.fixed?"Etc/UTC":`Etc/GMT${formatOffset(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(ts,format){return formatOffset(this.fixed,format)}get isUniversal(){return!0}offset(){return this.fixed}equals(otherZone){return"fixed"===otherZone.type&&otherZone.fixed===this.fixed}get isValid(){return!0}}class InvalidZone extends Zone{constructor(zoneName){super(),this.zoneName=zoneName}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function normalizeZone(input,defaultZone2){if(isUndefined(input)||null===input)return defaultZone2;if(input instanceof Zone)return input;if("string"==typeof input){const lowered=input.toLowerCase();return"default"===lowered?defaultZone2:"local"===lowered||"system"===lowered?SystemZone.instance:"utc"===lowered||"gmt"===lowered?FixedOffsetZone.utcInstance:FixedOffsetZone.parseSpecifier(lowered)||IANAZone.create(input)}return isNumber$1(input)?FixedOffsetZone.instance(input):"object"==typeof input&&"offset"in input&&"function"==typeof input.offset?input:new InvalidZone(input)}const numberingSystems={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},numberingSystemsUTF16={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},hanidecChars=numberingSystems.hanidec.replace(/[\[|\]]/g,"").split("");const digitRegexCache=new Map;function digitRegex({numberingSystem:numberingSystem},append=""){const ns=numberingSystem||"latn";let appendCache=digitRegexCache.get(ns);void 0===appendCache&&(appendCache=new Map,digitRegexCache.set(ns,appendCache));let regex=appendCache.get(append);return void 0===regex&&(regex=new RegExp(`${numberingSystems[ns]}${append}`),appendCache.set(append,regex)),regex}let throwOnInvalid,now=()=>Date.now(),defaultZone="system",defaultLocale=null,defaultNumberingSystem=null,defaultOutputCalendar=null,twoDigitCutoffYear=60,defaultWeekSettings=null;class Settings{static get now(){return now}static set now(n2){now=n2}static set defaultZone(zone){defaultZone=zone}static get defaultZone(){return normalizeZone(defaultZone,SystemZone.instance)}static get defaultLocale(){return defaultLocale}static set defaultLocale(locale){defaultLocale=locale}static get defaultNumberingSystem(){return defaultNumberingSystem}static set defaultNumberingSystem(numberingSystem){defaultNumberingSystem=numberingSystem}static get defaultOutputCalendar(){return defaultOutputCalendar}static set defaultOutputCalendar(outputCalendar){defaultOutputCalendar=outputCalendar}static get defaultWeekSettings(){return defaultWeekSettings}static set defaultWeekSettings(weekSettings){defaultWeekSettings=validateWeekSettings(weekSettings)}static get twoDigitCutoffYear(){return twoDigitCutoffYear}static set twoDigitCutoffYear(cutoffYear){twoDigitCutoffYear=cutoffYear%100}static get throwOnInvalid(){return throwOnInvalid}static set throwOnInvalid(t){throwOnInvalid=t}static resetCaches(){Locale.resetCache(),IANAZone.resetCache(),DateTime$1.resetCache(),digitRegexCache.clear()}}class Invalid{constructor(reason,explanation){this.reason=reason,this.explanation=explanation}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const nonLeapLadder=[0,31,59,90,120,151,181,212,243,273,304,334],leapLadder=[0,31,60,91,121,152,182,213,244,274,305,335];function unitOutOfRange(unit,value){return new Invalid("unit out of range",`you specified ${value} (of type ${typeof value}) as a ${unit}, which is invalid`)}function dayOfWeek(year2,month,day){const d=new Date(Date.UTC(year2,month-1,day));year2<100&&year2>=0&&d.setUTCFullYear(d.getUTCFullYear()-1900);const js=d.getUTCDay();return 0===js?7:js}function computeOrdinal(year2,month,day){return day+(isLeapYear$1(year2)?leapLadder:nonLeapLadder)[month-1]}function uncomputeOrdinal(year2,ordinal){const table=isLeapYear$1(year2)?leapLadder:nonLeapLadder,month0=table.findIndex(i=>i<ordinal);return{month:month0+1,day:ordinal-table[month0]}}function isoWeekdayToLocal(isoWeekday,startOfWeek){return(isoWeekday-startOfWeek+7)%7+1}function gregorianToWeek(gregObj,minDaysInFirstWeek=4,startOfWeek=1){const{year:year2,month:month,day:day}=gregObj,ordinal=computeOrdinal(year2,month,day),weekday=isoWeekdayToLocal(dayOfWeek(year2,month,day),startOfWeek);let weekYear,weekNumber=Math.floor((ordinal-weekday+14-minDaysInFirstWeek)/7);return weekNumber<1?(weekYear=year2-1,weekNumber=weeksInWeekYear(weekYear,minDaysInFirstWeek,startOfWeek)):weekNumber>weeksInWeekYear(year2,minDaysInFirstWeek,startOfWeek)?(weekYear=year2+1,weekNumber=1):weekYear=year2,__spreadValues({weekYear:weekYear,weekNumber:weekNumber,weekday:weekday},timeObject(gregObj))}function weekToGregorian(weekData,minDaysInFirstWeek=4,startOfWeek=1){const{weekYear:weekYear,weekNumber:weekNumber,weekday:weekday}=weekData,weekdayOfJan4=isoWeekdayToLocal(dayOfWeek(weekYear,1,minDaysInFirstWeek),startOfWeek),yearInDays=daysInYear(weekYear);let year2,ordinal=7*weekNumber+weekday-weekdayOfJan4-7+minDaysInFirstWeek;ordinal<1?(year2=weekYear-1,ordinal+=daysInYear(year2)):ordinal>yearInDays?(year2=weekYear+1,ordinal-=daysInYear(weekYear)):year2=weekYear;const{month:month,day:day}=uncomputeOrdinal(year2,ordinal);return __spreadValues({year:year2,month:month,day:day},timeObject(weekData))}function gregorianToOrdinal(gregData){const{year:year2,month:month,day:day}=gregData,ordinal=computeOrdinal(year2,month,day);return __spreadValues({year:year2,ordinal:ordinal},timeObject(gregData))}function ordinalToGregorian(ordinalData){const{year:year2,ordinal:ordinal}=ordinalData,{month:month,day:day}=uncomputeOrdinal(year2,ordinal);return __spreadValues({year:year2,month:month,day:day},timeObject(ordinalData))}function usesLocalWeekValues(obj,loc){if(!isUndefined(obj.localWeekday)||!isUndefined(obj.localWeekNumber)||!isUndefined(obj.localWeekYear)){if(!isUndefined(obj.weekday)||!isUndefined(obj.weekNumber)||!isUndefined(obj.weekYear))throw new ConflictingSpecificationError("Cannot mix locale-based week fields with ISO-based week fields");return isUndefined(obj.localWeekday)||(obj.weekday=obj.localWeekday),isUndefined(obj.localWeekNumber)||(obj.weekNumber=obj.localWeekNumber),isUndefined(obj.localWeekYear)||(obj.weekYear=obj.localWeekYear),delete obj.localWeekday,delete obj.localWeekNumber,delete obj.localWeekYear,{minDaysInFirstWeek:loc.getMinDaysInFirstWeek(),startOfWeek:loc.getStartOfWeek()}}return{minDaysInFirstWeek:4,startOfWeek:1}}function hasInvalidGregorianData(obj){const validYear=isInteger(obj.year),validMonth=integerBetween(obj.month,1,12),validDay=integerBetween(obj.day,1,daysInMonth(obj.year,obj.month));return validYear?validMonth?!validDay&&unitOutOfRange("day",obj.day):unitOutOfRange("month",obj.month):unitOutOfRange("year",obj.year)}function hasInvalidTimeData(obj){const{hour:hour,minute:minute,second:second,millisecond:millisecond}=obj,validHour=integerBetween(hour,0,23)||24===hour&&0===minute&&0===second&&0===millisecond,validMinute=integerBetween(minute,0,59),validSecond=integerBetween(second,0,59),validMillisecond=integerBetween(millisecond,0,999);return validHour?validMinute?validSecond?!validMillisecond&&unitOutOfRange("millisecond",millisecond):unitOutOfRange("second",second):unitOutOfRange("minute",minute):unitOutOfRange("hour",hour)}function isUndefined(o){return void 0===o}function isNumber$1(o){return"number"==typeof o}function isInteger(o){return"number"==typeof o&&o%1==0}function hasRelative(){try{return"undefined"!=typeof Intl&&!!Intl.RelativeTimeFormat}catch(e){return!1}}function hasLocaleWeekInfo(){try{return"undefined"!=typeof Intl&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch(e){return!1}}function bestBy(arr,by,compare2){if(0!==arr.length)return arr.reduce((best,next)=>{const pair=[by(next),next];return best&&compare2(best[0],pair[0])===best[0]?best:pair},null)[1]}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}function validateWeekSettings(settings){if(null==settings)return null;if("object"!=typeof settings)throw new InvalidArgumentError("Week settings must be an object");if(!integerBetween(settings.firstDay,1,7)||!integerBetween(settings.minimalDays,1,7)||!Array.isArray(settings.weekend)||settings.weekend.some(v=>!integerBetween(v,1,7)))throw new InvalidArgumentError("Invalid week settings");return{firstDay:settings.firstDay,minimalDays:settings.minimalDays,weekend:Array.from(settings.weekend)}}function integerBetween(thing,bottom,top){return isInteger(thing)&&thing>=bottom&&thing<=top}function padStart$1(input,n2=2){let padded;return padded=input<0?"-"+(""+-input).padStart(n2,"0"):(""+input).padStart(n2,"0"),padded}function parseInteger(string2){return isUndefined(string2)||null===string2||""===string2?void 0:parseInt(string2,10)}function parseFloating(string2){return isUndefined(string2)||null===string2||""===string2?void 0:parseFloat(string2)}function parseMillis(fraction){if(!isUndefined(fraction)&&null!==fraction&&""!==fraction){const f=1e3*parseFloat("0."+fraction);return Math.floor(f)}}function roundTo(number,digits,towardZero=!1){const factor=10**digits;return(towardZero?Math.trunc:Math.round)(number*factor)/factor}function isLeapYear$1(year2){return year2%4==0&&(year2%100!=0||year2%400==0)}function daysInYear(year2){return isLeapYear$1(year2)?366:365}function daysInMonth(year2,month){const modMonth=(x=month-1)-(n2=12)*Math.floor(x/n2)+1;var x,n2;return 2===modMonth?isLeapYear$1(year2+(month-modMonth)/12)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][modMonth-1]}function objToLocalTS(obj){let d=Date.UTC(obj.year,obj.month-1,obj.day,obj.hour,obj.minute,obj.second,obj.millisecond);return obj.year<100&&obj.year>=0&&(d=new Date(d),d.setUTCFullYear(obj.year,obj.month-1,obj.day)),+d}function firstWeekOffset(year2,minDaysInFirstWeek,startOfWeek){return-isoWeekdayToLocal(dayOfWeek(year2,1,minDaysInFirstWeek),startOfWeek)+minDaysInFirstWeek-1}function weeksInWeekYear(weekYear,minDaysInFirstWeek=4,startOfWeek=1){const weekOffset=firstWeekOffset(weekYear,minDaysInFirstWeek,startOfWeek),weekOffsetNext=firstWeekOffset(weekYear+1,minDaysInFirstWeek,startOfWeek);return(daysInYear(weekYear)-weekOffset+weekOffsetNext)/7}function untruncateYear(year2){return year2>99?year2:year2>Settings.twoDigitCutoffYear?1900+year2:2e3+year2}function parseZoneInfo(ts,offsetFormat,locale,timeZone=null){const date=new Date(ts),intlOpts={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};timeZone&&(intlOpts.timeZone=timeZone);const modified=__spreadValues({timeZoneName:offsetFormat},intlOpts),parsed=new Intl.DateTimeFormat(locale,modified).formatToParts(date).find(m=>"timezonename"===m.type.toLowerCase());return parsed?parsed.value:null}function signedOffset(offHourStr,offMinuteStr){let offHour=parseInt(offHourStr,10);Number.isNaN(offHour)&&(offHour=0);const offMin=parseInt(offMinuteStr,10)||0;return 60*offHour+(offHour<0||Object.is(offHour,-0)?-offMin:offMin)}function asNumber(value){const numericValue=Number(value);if("boolean"==typeof value||""===value||Number.isNaN(numericValue))throw new InvalidArgumentError(`Invalid unit value ${value}`);return numericValue}function normalizeObject(obj,normalizer){const normalized={};for(const u in obj)if(hasOwnProperty(obj,u)){const v=obj[u];if(null==v)continue;normalized[normalizer(u)]=asNumber(v)}return normalized}function formatOffset(offset2,format){const hours=Math.trunc(Math.abs(offset2/60)),minutes=Math.trunc(Math.abs(offset2%60)),sign=offset2>=0?"+":"-";switch(format){case"short":return`${sign}${padStart$1(hours,2)}:${padStart$1(minutes,2)}`;case"narrow":return`${sign}${hours}${minutes>0?`:${minutes}`:""}`;case"techie":return`${sign}${padStart$1(hours,2)}${padStart$1(minutes,2)}`;default:throw new RangeError(`Value format ${format} is out of range for property format`)}}function timeObject(obj){return function(obj,keys){return keys.reduce((a,k)=>(a[k]=obj[k],a),{})}(obj,["hour","minute","second","millisecond"])}const monthsLong=["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsNarrow=["J","F","M","A","M","J","J","A","S","O","N","D"];function months(length){switch(length){case"narrow":return[...monthsNarrow];case"short":return[...monthsShort];case"long":return[...monthsLong];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const weekdaysLong=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekdaysShort=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],weekdaysNarrow=["M","T","W","T","F","S","S"];function weekdays(length){switch(length){case"narrow":return[...weekdaysNarrow];case"short":return[...weekdaysShort];case"long":return[...weekdaysLong];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const meridiems=["AM","PM"],erasLong=["Before Christ","Anno Domini"],erasShort=["BC","AD"],erasNarrow=["B","A"];function eras(length){switch(length){case"narrow":return[...erasNarrow];case"short":return[...erasShort];case"long":return[...erasLong];default:return null}}function stringifyTokens(splits,tokenToString){let s2="";for(const token of splits)token.literal?s2+=token.val:s2+=tokenToString(token.val);return s2}const macroTokenToFormatOpts={D:DATE_SHORT,DD:DATE_MED,DDD:DATE_FULL,DDDD:DATE_HUGE,t:TIME_SIMPLE,tt:TIME_WITH_SECONDS,ttt:TIME_WITH_SHORT_OFFSET,tttt:TIME_WITH_LONG_OFFSET,T:TIME_24_SIMPLE,TT:TIME_24_WITH_SECONDS,TTT:TIME_24_WITH_SHORT_OFFSET,TTTT:TIME_24_WITH_LONG_OFFSET,f:DATETIME_SHORT,ff:DATETIME_MED,fff:DATETIME_FULL,ffff:DATETIME_HUGE,F:DATETIME_SHORT_WITH_SECONDS,FF:DATETIME_MED_WITH_SECONDS,FFF:DATETIME_FULL_WITH_SECONDS,FFFF:DATETIME_HUGE_WITH_SECONDS};class Formatter{static create(locale,opts={}){return new Formatter(locale,opts)}static parseFormat(fmt){let current=null,currentFull="",bracketed=!1;const splits=[];for(let i=0;i<fmt.length;i++){const c=fmt.charAt(i);"'"===c?(currentFull.length>0&&splits.push({literal:bracketed||/^\s+$/.test(currentFull),val:currentFull}),current=null,currentFull="",bracketed=!bracketed):bracketed||c===current?currentFull+=c:(currentFull.length>0&&splits.push({literal:/^\s+$/.test(currentFull),val:currentFull}),currentFull=c,current=c)}return currentFull.length>0&&splits.push({literal:bracketed||/^\s+$/.test(currentFull),val:currentFull}),splits}static macroTokenToFormatOpts(token){return macroTokenToFormatOpts[token]}constructor(locale,formatOpts){this.opts=formatOpts,this.loc=locale,this.systemLoc=null}formatWithSystemDefault(dt,opts){null===this.systemLoc&&(this.systemLoc=this.loc.redefaultToSystem());return this.systemLoc.dtFormatter(dt,__spreadValues(__spreadValues({},this.opts),opts)).format()}dtFormatter(dt,opts={}){return this.loc.dtFormatter(dt,__spreadValues(__spreadValues({},this.opts),opts))}formatDateTime(dt,opts){return this.dtFormatter(dt,opts).format()}formatDateTimeParts(dt,opts){return this.dtFormatter(dt,opts).formatToParts()}formatInterval(interval,opts){return this.dtFormatter(interval.start,opts).dtf.formatRange(interval.start.toJSDate(),interval.end.toJSDate())}resolvedOptions(dt,opts){return this.dtFormatter(dt,opts).resolvedOptions()}num(n2,p2=0){if(this.opts.forceSimple)return padStart$1(n2,p2);const opts=__spreadValues({},this.opts);return p2>0&&(opts.padTo=p2),this.loc.numberFormatter(opts).format(n2)}formatDateTimeFromString(dt,fmt){const knownEnglish="en"===this.loc.listingMode(),useDateTimeFormatter=this.loc.outputCalendar&&"gregory"!==this.loc.outputCalendar,string2=(opts,extract)=>this.loc.extract(dt,opts,extract),formatOffset2=opts=>dt.isOffsetFixed&&0===dt.offset&&opts.allowZ?"Z":dt.isValid?dt.zone.formatOffset(dt.ts,opts.format):"",meridiem=()=>knownEnglish?function(dt){return meridiems[dt.hour<12?0:1]}(dt):string2({hour:"numeric",hourCycle:"h12"},"dayperiod"),month=(length,standalone)=>knownEnglish?function(dt,length){return months(length)[dt.month-1]}(dt,length):string2(standalone?{month:length}:{month:length,day:"numeric"},"month"),weekday=(length,standalone)=>knownEnglish?function(dt,length){return weekdays(length)[dt.weekday-1]}(dt,length):string2(standalone?{weekday:length}:{weekday:length,month:"long",day:"numeric"},"weekday"),maybeMacro=token=>{const formatOpts=Formatter.macroTokenToFormatOpts(token);return formatOpts?this.formatWithSystemDefault(dt,formatOpts):token},era=length=>knownEnglish?function(dt,length){return eras(length)[dt.year<0?0:1]}(dt,length):string2({era:length},"era");return stringifyTokens(Formatter.parseFormat(fmt),token=>{switch(token){case"S":return this.num(dt.millisecond);case"u":case"SSS":return this.num(dt.millisecond,3);case"s":return this.num(dt.second);case"ss":return this.num(dt.second,2);case"uu":return this.num(Math.floor(dt.millisecond/10),2);case"uuu":return this.num(Math.floor(dt.millisecond/100));case"m":return this.num(dt.minute);case"mm":return this.num(dt.minute,2);case"h":return this.num(dt.hour%12==0?12:dt.hour%12);case"hh":return this.num(dt.hour%12==0?12:dt.hour%12,2);case"H":return this.num(dt.hour);case"HH":return this.num(dt.hour,2);case"Z":return formatOffset2({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return formatOffset2({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return formatOffset2({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return dt.zone.offsetName(dt.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return dt.zone.offsetName(dt.ts,{format:"long",locale:this.loc.locale});case"z":return dt.zoneName;case"a":return meridiem();case"d":return useDateTimeFormatter?string2({day:"numeric"},"day"):this.num(dt.day);case"dd":return useDateTimeFormatter?string2({day:"2-digit"},"day"):this.num(dt.day,2);case"c":case"E":return this.num(dt.weekday);case"ccc":return weekday("short",!0);case"cccc":return weekday("long",!0);case"ccccc":return weekday("narrow",!0);case"EEE":return weekday("short",!1);case"EEEE":return weekday("long",!1);case"EEEEE":return weekday("narrow",!1);case"L":return useDateTimeFormatter?string2({month:"numeric",day:"numeric"},"month"):this.num(dt.month);case"LL":return useDateTimeFormatter?string2({month:"2-digit",day:"numeric"},"month"):this.num(dt.month,2);case"LLL":return month("short",!0);case"LLLL":return month("long",!0);case"LLLLL":return month("narrow",!0);case"M":return useDateTimeFormatter?string2({month:"numeric"},"month"):this.num(dt.month);case"MM":return useDateTimeFormatter?string2({month:"2-digit"},"month"):this.num(dt.month,2);case"MMM":return month("short",!1);case"MMMM":return month("long",!1);case"MMMMM":return month("narrow",!1);case"y":return useDateTimeFormatter?string2({year:"numeric"},"year"):this.num(dt.year);case"yy":return useDateTimeFormatter?string2({year:"2-digit"},"year"):this.num(dt.year.toString().slice(-2),2);case"yyyy":return useDateTimeFormatter?string2({year:"numeric"},"year"):this.num(dt.year,4);case"yyyyyy":return useDateTimeFormatter?string2({year:"numeric"},"year"):this.num(dt.year,6);case"G":return era("short");case"GG":return era("long");case"GGGGG":return era("narrow");case"kk":return this.num(dt.weekYear.toString().slice(-2),2);case"kkkk":return this.num(dt.weekYear,4);case"W":return this.num(dt.weekNumber);case"WW":return this.num(dt.weekNumber,2);case"n":return this.num(dt.localWeekNumber);case"nn":return this.num(dt.localWeekNumber,2);case"ii":return this.num(dt.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(dt.localWeekYear,4);case"o":return this.num(dt.ordinal);case"ooo":return this.num(dt.ordinal,3);case"q":return this.num(dt.quarter);case"qq":return this.num(dt.quarter,2);case"X":return this.num(Math.floor(dt.ts/1e3));case"x":return this.num(dt.ts);default:return maybeMacro(token)}})}formatDurationFromString(dur,fmt){const tokenToField=token=>{switch(token[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},tokens=Formatter.parseFormat(fmt),realTokens=tokens.reduce((found,{literal:literal,val:val})=>literal?found:found.concat(val),[]);return stringifyTokens(tokens,(lildur=>token=>{const mapped=tokenToField(token);return mapped?this.num(lildur.get(mapped),token.length):token})(dur.shiftTo(...realTokens.map(tokenToField).filter(t=>t))))}}const ianaRegex=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function combineRegexes(...regexes){const full2=regexes.reduce((f,r)=>f+r.source,"");return RegExp(`^${full2}$`)}function combineExtractors(...extractors){return m=>extractors.reduce(([mergedVals,mergedZone,cursor],ex)=>{const[val,zone,next]=ex(m,cursor);return[__spreadValues(__spreadValues({},mergedVals),val),zone||mergedZone,next]},[{},null,1]).slice(0,2)}function parse$3(s2,...patterns){if(null==s2)return[null,null];for(const[regex,extractor]of patterns){const m=regex.exec(s2);if(m)return extractor(m)}return[null,null]}function simpleParse(...keys){return(match2,cursor)=>{const ret={};let i;for(i=0;i<keys.length;i++)ret[keys[i]]=parseInteger(match2[cursor+i]);return[ret,null,cursor+i]}}const offsetRegex=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,isoTimeBaseRegex=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,isoTimeRegex=RegExp(`${isoTimeBaseRegex.source}${`(?:${offsetRegex.source}?(?:\\[(${ianaRegex.source})\\])?)?`}`),isoTimeExtensionRegex=RegExp(`(?:T${isoTimeRegex.source})?`),extractISOWeekData=simpleParse("weekYear","weekNumber","weekDay"),extractISOOrdinalData=simpleParse("year","ordinal"),sqlTimeRegex=RegExp(`${isoTimeBaseRegex.source} ?(?:${offsetRegex.source}|(${ianaRegex.source}))?`),sqlTimeExtensionRegex=RegExp(`(?: ${sqlTimeRegex.source})?`);function int$2(match2,pos,fallback){const m=match2[pos];return isUndefined(m)?fallback:parseInteger(m)}function extractISOTime(match2,cursor){return[{hours:int$2(match2,cursor,0),minutes:int$2(match2,cursor+1,0),seconds:int$2(match2,cursor+2,0),milliseconds:parseMillis(match2[cursor+3])},null,cursor+4]}function extractISOOffset(match2,cursor){const local=!match2[cursor]&&!match2[cursor+1],fullOffset=signedOffset(match2[cursor+1],match2[cursor+2]);return[{},local?null:FixedOffsetZone.instance(fullOffset),cursor+3]}function extractIANAZone(match2,cursor){return[{},match2[cursor]?IANAZone.create(match2[cursor]):null,cursor+1]}const isoTimeOnly=RegExp(`^T?${isoTimeBaseRegex.source}$`),isoDuration=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function extractISODuration(match2){const[s2,yearStr,monthStr,weekStr,dayStr,hourStr,minuteStr,secondStr,millisecondsStr]=match2,hasNegativePrefix="-"===s2[0],negativeSeconds=secondStr&&"-"===secondStr[0],maybeNegate=(num,force=!1)=>void 0!==num&&(force||num&&hasNegativePrefix)?-num:num;return[{years:maybeNegate(parseFloating(yearStr)),months:maybeNegate(parseFloating(monthStr)),weeks:maybeNegate(parseFloating(weekStr)),days:maybeNegate(parseFloating(dayStr)),hours:maybeNegate(parseFloating(hourStr)),minutes:maybeNegate(parseFloating(minuteStr)),seconds:maybeNegate(parseFloating(secondStr),"-0"===secondStr),milliseconds:maybeNegate(parseMillis(millisecondsStr),negativeSeconds)}]}const obsOffsets={GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){const result={year:2===yearStr.length?untruncateYear(parseInteger(yearStr)):parseInteger(yearStr),month:monthsShort.indexOf(monthStr)+1,day:parseInteger(dayStr),hour:parseInteger(hourStr),minute:parseInteger(minuteStr)};return secondStr&&(result.second=parseInteger(secondStr)),weekdayStr&&(result.weekday=weekdayStr.length>3?weekdaysLong.indexOf(weekdayStr)+1:weekdaysShort.indexOf(weekdayStr)+1),result}const rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function extractRFC2822(match2){const[,weekdayStr,dayStr,monthStr,yearStr,hourStr,minuteStr,secondStr,obsOffset,milOffset,offHourStr,offMinuteStr]=match2,result=fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr);let offset2;return offset2=obsOffset?obsOffsets[obsOffset]:milOffset?0:signedOffset(offHourStr,offMinuteStr),[result,new FixedOffsetZone(offset2)]}const rfc1123=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,rfc850=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,ascii=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function extractRFC1123Or850(match2){const[,weekdayStr,dayStr,monthStr,yearStr,hourStr,minuteStr,secondStr]=match2;return[fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr),FixedOffsetZone.utcInstance]}function extractASCII(match2){const[,weekdayStr,monthStr,dayStr,hourStr,minuteStr,secondStr,yearStr]=match2;return[fromStrings(weekdayStr,yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr),FixedOffsetZone.utcInstance]}const isoYmdWithTimeExtensionRegex=combineRegexes(/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,isoTimeExtensionRegex),isoWeekWithTimeExtensionRegex=combineRegexes(/(\d{4})-?W(\d\d)(?:-?(\d))?/,isoTimeExtensionRegex),isoOrdinalWithTimeExtensionRegex=combineRegexes(/(\d{4})-?(\d{3})/,isoTimeExtensionRegex),isoTimeCombinedRegex=combineRegexes(isoTimeRegex),extractISOYmdTimeAndOffset=combineExtractors(function(match2,cursor){return[{year:int$2(match2,cursor),month:int$2(match2,cursor+1,1),day:int$2(match2,cursor+2,1)},null,cursor+3]},extractISOTime,extractISOOffset,extractIANAZone),extractISOWeekTimeAndOffset=combineExtractors(extractISOWeekData,extractISOTime,extractISOOffset,extractIANAZone),extractISOOrdinalDateAndTime=combineExtractors(extractISOOrdinalData,extractISOTime,extractISOOffset,extractIANAZone),extractISOTimeAndOffset=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);const extractISOTimeOnly=combineExtractors(extractISOTime);const sqlYmdWithTimeExtensionRegex=combineRegexes(/(\d{4})-(\d\d)-(\d\d)/,sqlTimeExtensionRegex),sqlTimeCombinedRegex=combineRegexes(sqlTimeRegex),extractISOTimeOffsetAndIANAZone=combineExtractors(extractISOTime,extractISOOffset,extractIANAZone);const lowOrderMatrix={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},casualMatrix=__spreadValues({years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6}},lowOrderMatrix),accurateMatrix=__spreadValues({years:{quarters:4,months:12,weeks:52.1775,days:365.2425,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:30.436875/7,days:30.436875,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3}},lowOrderMatrix),orderedUnits$1=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],reverseUnits=orderedUnits$1.slice(0).reverse();function clone$3(dur,alts,clear2=!1){const conf={values:clear2?alts.values:__spreadValues(__spreadValues({},dur.values),alts.values||{}),loc:dur.loc.clone(alts.loc),conversionAccuracy:alts.conversionAccuracy||dur.conversionAccuracy,matrix:alts.matrix||dur.matrix};return new Duration$1(conf)}function durationToMillis(matrix,vals){var _a2;let sum=null!=(_a2=vals.milliseconds)?_a2:0;for(const unit of reverseUnits.slice(1))vals[unit]&&(sum+=vals[unit]*matrix[unit].milliseconds);return sum}function normalizeValues(matrix,vals){const factor=durationToMillis(matrix,vals)<0?-1:1;orderedUnits$1.reduceRight((previous,current)=>{if(isUndefined(vals[current]))return previous;if(previous){const previousVal=vals[previous]*factor,conv=matrix[current][previous],rollUp=Math.floor(previousVal/conv);vals[current]+=rollUp*factor,vals[previous]-=rollUp*conv*factor}return current},null),orderedUnits$1.reduce((previous,current)=>{if(isUndefined(vals[current]))return previous;if(previous){const fraction=vals[previous]%1;vals[previous]-=fraction,vals[current]+=fraction*matrix[previous][current]}return current},null)}let Duration$1=class Duration2{constructor(config){const accurate="longterm"===config.conversionAccuracy||!1;let matrix=accurate?accurateMatrix:casualMatrix;config.matrix&&(matrix=config.matrix),this.values=config.values,this.loc=config.loc||Locale.create(),this.conversionAccuracy=accurate?"longterm":"casual",this.invalid=config.invalid||null,this.matrix=matrix,this.isLuxonDuration=!0}static fromMillis(count,opts){return Duration2.fromObject({milliseconds:count},opts)}static fromObject(obj,opts={}){if(null==obj||"object"!=typeof obj)throw new InvalidArgumentError("Duration.fromObject: argument expected to be an object, got "+(null===obj?"null":typeof obj));return new Duration2({values:normalizeObject(obj,Duration2.normalizeUnit),loc:Locale.fromObject(opts),conversionAccuracy:opts.conversionAccuracy,matrix:opts.matrix})}static fromDurationLike(durationLike){if(isNumber$1(durationLike))return Duration2.fromMillis(durationLike);if(Duration2.isDuration(durationLike))return durationLike;if("object"==typeof durationLike)return Duration2.fromObject(durationLike);throw new InvalidArgumentError(`Unknown duration argument ${durationLike} of type ${typeof durationLike}`)}static fromISO(text,opts){const[parsed]=parse$3(text,[isoDuration,extractISODuration]);return parsed?Duration2.fromObject(parsed,opts):Duration2.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`)}static fromISOTime(text,opts){const[parsed]=parse$3(text,[isoTimeOnly,extractISOTimeOnly]);return parsed?Duration2.fromObject(parsed,opts):Duration2.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`)}static invalid(reason,explanation=null){if(!reason)throw new InvalidArgumentError("need to specify a reason the Duration is invalid");const invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidDurationError(invalid);return new Duration2({invalid:invalid})}static normalizeUnit(unit){const normalized={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[unit?unit.toLowerCase():unit];if(!normalized)throw new InvalidUnitError(unit);return normalized}static isDuration(o){return o&&o.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(fmt,opts={}){const fmtOpts=__spreadProps(__spreadValues({},opts),{floor:!1!==opts.round&&!1!==opts.floor});return this.isValid?Formatter.create(this.loc,fmtOpts).formatDurationFromString(this,fmt):"Invalid Duration"}toHuman(opts={}){if(!this.isValid)return"Invalid Duration";const l2=orderedUnits$1.map(unit=>{const val=this.values[unit];return isUndefined(val)?null:this.loc.numberFormatter(__spreadProps(__spreadValues({style:"unit",unitDisplay:"long"},opts),{unit:unit.slice(0,-1)})).format(val)}).filter(n2=>n2);return this.loc.listFormatter(__spreadValues({type:"conjunction",style:opts.listStyle||"narrow"},opts)).format(l2)}toObject(){return this.isValid?__spreadValues({},this.values):{}}toISO(){if(!this.isValid)return null;let s2="P";return 0!==this.years&&(s2+=this.years+"Y"),0===this.months&&0===this.quarters||(s2+=this.months+3*this.quarters+"M"),0!==this.weeks&&(s2+=this.weeks+"W"),0!==this.days&&(s2+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(s2+="T"),0!==this.hours&&(s2+=this.hours+"H"),0!==this.minutes&&(s2+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(s2+=roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===s2&&(s2+="T0S"),s2}toISOTime(opts={}){if(!this.isValid)return null;const millis=this.toMillis();if(millis<0||millis>=864e5)return null;opts=__spreadProps(__spreadValues({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},opts),{includeOffset:!1});return DateTime$1.fromMillis(millis,{zone:"UTC"}).toISOTime(opts)}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?durationToMillis(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(duration){if(!this.isValid)return this;const dur=Duration2.fromDurationLike(duration),result={};for(const k of orderedUnits$1)(hasOwnProperty(dur.values,k)||hasOwnProperty(this.values,k))&&(result[k]=dur.get(k)+this.get(k));return clone$3(this,{values:result},!0)}minus(duration){if(!this.isValid)return this;const dur=Duration2.fromDurationLike(duration);return this.plus(dur.negate())}mapUnits(fn){if(!this.isValid)return this;const result={};for(const k of Object.keys(this.values))result[k]=asNumber(fn(this.values[k],k));return clone$3(this,{values:result},!0)}get(unit){return this[Duration2.normalizeUnit(unit)]}set(values){if(!this.isValid)return this;return clone$3(this,{values:__spreadValues(__spreadValues({},this.values),normalizeObject(values,Duration2.normalizeUnit))})}reconfigure({locale:locale,numberingSystem:numberingSystem,conversionAccuracy:conversionAccuracy,matrix:matrix}={}){return clone$3(this,{loc:this.loc.clone({locale:locale,numberingSystem:numberingSystem}),matrix:matrix,conversionAccuracy:conversionAccuracy})}as(unit){return this.isValid?this.shiftTo(unit).get(unit):NaN}normalize(){if(!this.isValid)return this;const vals=this.toObject();return normalizeValues(this.matrix,vals),clone$3(this,{values:vals},!0)}rescale(){if(!this.isValid)return this;return clone$3(this,{values:function(vals){const newVals={};for(const[key,value]of Object.entries(vals))0!==value&&(newVals[key]=value);return newVals}(this.normalize().shiftToAll().toObject())},!0)}shiftTo(...units){if(!this.isValid)return this;if(0===units.length)return this;units=units.map(u=>Duration2.normalizeUnit(u));const built={},accumulated={},vals=this.toObject();let lastUnit;for(const k of orderedUnits$1)if(units.indexOf(k)>=0){lastUnit=k;let own=0;for(const ak in accumulated)own+=this.matrix[ak][k]*accumulated[ak],accumulated[ak]=0;isNumber$1(vals[k])&&(own+=vals[k]);const i=Math.trunc(own);built[k]=i,accumulated[k]=(1e3*own-1e3*i)/1e3}else isNumber$1(vals[k])&&(accumulated[k]=vals[k]);for(const key in accumulated)0!==accumulated[key]&&(built[lastUnit]+=key===lastUnit?accumulated[key]:accumulated[key]/this.matrix[lastUnit][key]);return normalizeValues(this.matrix,built),clone$3(this,{values:built},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const negated={};for(const k of Object.keys(this.values))negated[k]=0===this.values[k]?0:-this.values[k];return clone$3(this,{values:negated},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(other){if(!this.isValid||!other.isValid)return!1;if(!this.loc.equals(other.loc))return!1;function eq(v1,v2){return void 0===v1||0===v1?void 0===v2||0===v2:v1===v2}for(const u of orderedUnits$1)if(!eq(this.values[u],other.values[u]))return!1;return!0}};const INVALID$1="Invalid Interval";class Interval{constructor(config){this.s=config.start,this.e=config.end,this.invalid=config.invalid||null,this.isLuxonInterval=!0}static invalid(reason,explanation=null){if(!reason)throw new InvalidArgumentError("need to specify a reason the Interval is invalid");const invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidIntervalError(invalid);return new Interval({invalid:invalid})}static fromDateTimes(start,end){const builtStart=friendlyDateTime(start),builtEnd=friendlyDateTime(end),validateError=function(start,end){return start&&start.isValid?end&&end.isValid?end<start?Interval.invalid("end before start",`The end of an interval must be after its start, but you had start=${start.toISO()} and end=${end.toISO()}`):null:Interval.invalid("missing or invalid end"):Interval.invalid("missing or invalid start")}(builtStart,builtEnd);return null==validateError?new Interval({start:builtStart,end:builtEnd}):validateError}static after(start,duration){const dur=Duration$1.fromDurationLike(duration),dt=friendlyDateTime(start);return Interval.fromDateTimes(dt,dt.plus(dur))}static before(end,duration){const dur=Duration$1.fromDurationLike(duration),dt=friendlyDateTime(end);return Interval.fromDateTimes(dt.minus(dur),dt)}static fromISO(text,opts){const[s2,e]=(text||"").split("/",2);if(s2&&e){let start,startIsValid,end,endIsValid;try{start=DateTime$1.fromISO(s2,opts),startIsValid=start.isValid}catch(e2){startIsValid=!1}try{end=DateTime$1.fromISO(e,opts),endIsValid=end.isValid}catch(e2){endIsValid=!1}if(startIsValid&&endIsValid)return Interval.fromDateTimes(start,end);if(startIsValid){const dur=Duration$1.fromISO(e,opts);if(dur.isValid)return Interval.after(start,dur)}else if(endIsValid){const dur=Duration$1.fromISO(s2,opts);if(dur.isValid)return Interval.before(end,dur)}}return Interval.invalid("unparsable",`the input "${text}" can't be parsed as ISO 8601`)}static isInterval(o){return o&&o.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return null===this.invalidReason}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(unit="milliseconds"){return this.isValid?this.toDuration(unit).get(unit):NaN}count(unit="milliseconds",opts){if(!this.isValid)return NaN;const start=this.start.startOf(unit,opts);let end;return end=(null==opts?void 0:opts.useLocaleWeeks)?this.end.reconfigure({locale:start.locale}):this.end,end=end.startOf(unit,opts),Math.floor(end.diff(start,unit).get(unit))+(end.valueOf()!==this.end.valueOf())}hasSame(unit){return!!this.isValid&&(this.isEmpty()||this.e.minus(1).hasSame(this.s,unit))}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(dateTime){return!!this.isValid&&this.s>dateTime}isBefore(dateTime){return!!this.isValid&&this.e<=dateTime}contains(dateTime){return!!this.isValid&&(this.s<=dateTime&&this.e>dateTime)}set({start:start,end:end}={}){return this.isValid?Interval.fromDateTimes(start||this.s,end||this.e):this}splitAt(...dateTimes){if(!this.isValid)return[];const sorted=dateTimes.map(friendlyDateTime).filter(d=>this.contains(d)).sort((a,b)=>a.toMillis()-b.toMillis()),results=[];let{s:s2}=this,i=0;for(;s2<this.e;){const added=sorted[i]||this.e,next=+added>+this.e?this.e:added;results.push(Interval.fromDateTimes(s2,next)),s2=next,i+=1}return results}splitBy(duration){const dur=Duration$1.fromDurationLike(duration);if(!this.isValid||!dur.isValid||0===dur.as("milliseconds"))return[];let next,{s:s2}=this,idx=1;const results=[];for(;s2<this.e;){const added=this.start.plus(dur.mapUnits(x=>x*idx));next=+added>+this.e?this.e:added,results.push(Interval.fromDateTimes(s2,next)),s2=next,idx+=1}return results}divideEqually(numberOfParts){return this.isValid?this.splitBy(this.length()/numberOfParts).slice(0,numberOfParts):[]}overlaps(other){return this.e>other.s&&this.s<other.e}abutsStart(other){return!!this.isValid&&+this.e===+other.s}abutsEnd(other){return!!this.isValid&&+other.e===+this.s}engulfs(other){return!!this.isValid&&(this.s<=other.s&&this.e>=other.e)}equals(other){return!(!this.isValid||!other.isValid)&&(this.s.equals(other.s)&&this.e.equals(other.e))}intersection(other){if(!this.isValid)return this;const s2=this.s>other.s?this.s:other.s,e=this.e<other.e?this.e:other.e;return s2>=e?null:Interval.fromDateTimes(s2,e)}union(other){if(!this.isValid)return this;const s2=this.s<other.s?this.s:other.s,e=this.e>other.e?this.e:other.e;return Interval.fromDateTimes(s2,e)}static merge(intervals){const[found,final]=intervals.sort((a,b)=>a.s-b.s).reduce(([sofar,current],item)=>current?current.overlaps(item)||current.abutsStart(item)?[sofar,current.union(item)]:[sofar.concat([current]),item]:[sofar,item],[[],null]);return final&&found.push(final),found}static xor(intervals){let start=null,currentCount=0;const results=[],ends=intervals.map(i=>[{time:i.s,type:"s"},{time:i.e,type:"e"}]),arr=Array.prototype.concat(...ends).sort((a,b)=>a.time-b.time);for(const i of arr)currentCount+="s"===i.type?1:-1,1===currentCount?start=i.time:(start&&+start!==+i.time&&results.push(Interval.fromDateTimes(start,i.time)),start=null);return Interval.merge(results)}difference(...intervals){return Interval.xor([this].concat(intervals)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:INVALID$1}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(formatOpts=DATE_SHORT,opts={}){return this.isValid?Formatter.create(this.s.loc.clone(opts),formatOpts).formatInterval(this):INVALID$1}toISO(opts){return this.isValid?`${this.s.toISO(opts)}/${this.e.toISO(opts)}`:INVALID$1}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:INVALID$1}toISOTime(opts){return this.isValid?`${this.s.toISOTime(opts)}/${this.e.toISOTime(opts)}`:INVALID$1}toFormat(dateFormat,{separator:separator=" – "}={}){return this.isValid?`${this.s.toFormat(dateFormat)}${separator}${this.e.toFormat(dateFormat)}`:INVALID$1}toDuration(unit,opts){return this.isValid?this.e.diff(this.s,unit,opts):Duration$1.invalid(this.invalidReason)}mapEndpoints(mapFn){return Interval.fromDateTimes(mapFn(this.s),mapFn(this.e))}}class Info{static hasDST(zone=Settings.defaultZone){const proto=DateTime$1.now().setZone(zone).set({month:12});return!zone.isUniversal&&proto.offset!==proto.set({month:6}).offset}static isValidIANAZone(zone){return IANAZone.isValidZone(zone)}static normalizeZone(input){return normalizeZone(input,Settings.defaultZone)}static getStartOfWeek({locale:locale=null,locObj:locObj=null}={}){return(locObj||Locale.create(locale)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:locale=null,locObj:locObj=null}={}){return(locObj||Locale.create(locale)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:locale=null,locObj:locObj=null}={}){return(locObj||Locale.create(locale)).getWeekendDays().slice()}static months(length="long",{locale:locale=null,numberingSystem:numberingSystem=null,locObj:locObj=null,outputCalendar:outputCalendar="gregory"}={}){return(locObj||Locale.create(locale,numberingSystem,outputCalendar)).months(length)}static monthsFormat(length="long",{locale:locale=null,numberingSystem:numberingSystem=null,locObj:locObj=null,outputCalendar:outputCalendar="gregory"}={}){return(locObj||Locale.create(locale,numberingSystem,outputCalendar)).months(length,!0)}static weekdays(length="long",{locale:locale=null,numberingSystem:numberingSystem=null,locObj:locObj=null}={}){return(locObj||Locale.create(locale,numberingSystem,null)).weekdays(length)}static weekdaysFormat(length="long",{locale:locale=null,numberingSystem:numberingSystem=null,locObj:locObj=null}={}){return(locObj||Locale.create(locale,numberingSystem,null)).weekdays(length,!0)}static meridiems({locale:locale=null}={}){return Locale.create(locale).meridiems()}static eras(length="short",{locale:locale=null}={}){return Locale.create(locale,null,"gregory").eras(length)}static features(){return{relative:hasRelative(),localeWeek:hasLocaleWeekInfo()}}}function dayDiff(earlier,later){const utcDayStart=dt=>dt.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),ms=utcDayStart(later)-utcDayStart(earlier);return Math.floor(Duration$1.fromMillis(ms).as("days"))}function diff(earlier,later,units,opts){let[cursor,results,highWater,lowestOrder]=function(cursor,later,units){const differs=[["years",(a,b)=>b.year-a.year],["quarters",(a,b)=>b.quarter-a.quarter+4*(b.year-a.year)],["months",(a,b)=>b.month-a.month+12*(b.year-a.year)],["weeks",(a,b)=>{const days=dayDiff(a,b);return(days-days%7)/7}],["days",dayDiff]],results={},earlier=cursor;let lowestOrder,highWater;for(const[unit,differ]of differs)units.indexOf(unit)>=0&&(lowestOrder=unit,results[unit]=differ(cursor,later),highWater=earlier.plus(results),highWater>later?(results[unit]--,(cursor=earlier.plus(results))>later&&(highWater=cursor,results[unit]--,cursor=earlier.plus(results))):cursor=highWater);return[cursor,results,highWater,lowestOrder]}(earlier,later,units);const remainingMillis=later-cursor,lowerOrderUnits=units.filter(u=>["hours","minutes","seconds","milliseconds"].indexOf(u)>=0);0===lowerOrderUnits.length&&(highWater<later&&(highWater=cursor.plus({[lowestOrder]:1})),highWater!==cursor&&(results[lowestOrder]=(results[lowestOrder]||0)+remainingMillis/(highWater-cursor)));const duration=Duration$1.fromObject(results,opts);return lowerOrderUnits.length>0?Duration$1.fromMillis(remainingMillis,opts).shiftTo(...lowerOrderUnits).plus(duration):duration}function intUnit(regex,post=i=>i){return{regex:regex,deser:([s2])=>post(function(str){let value=parseInt(str,10);if(isNaN(value)){value="";for(let i=0;i<str.length;i++){const code=str.charCodeAt(i);if(-1!==str[i].search(numberingSystems.hanidec))value+=hanidecChars.indexOf(str[i]);else for(const key in numberingSystemsUTF16){const[min,max]=numberingSystemsUTF16[key];code>=min&&code<=max&&(value+=code-min)}}return parseInt(value,10)}return value}(s2))}}const spaceOrNBSP=`[ ${String.fromCharCode(160)}]`,spaceOrNBSPRegExp=new RegExp(spaceOrNBSP,"g");function fixListRegex(s2){return s2.replace(/\./g,"\\.?").replace(spaceOrNBSPRegExp,spaceOrNBSP)}function stripInsensitivities(s2){return s2.replace(/\./g,"").replace(spaceOrNBSPRegExp," ").toLowerCase()}function oneOf(strings,startIndex){return null===strings?null:{regex:RegExp(strings.map(fixListRegex).join("|")),deser:([s2])=>strings.findIndex(i=>stripInsensitivities(s2)===stripInsensitivities(i))+startIndex}}function offset(regex,groups){return{regex:regex,deser:([,h2,m])=>signedOffset(h2,m),groups:groups}}function simple(regex){return{regex:regex,deser:([s2])=>s2}}const partTypeStyleToTokenVal={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};let dummyDateTimeCache=null;function expandMacroTokens(tokens,locale){return Array.prototype.concat(...tokens.map(t=>function(token,locale){if(token.literal)return token;const tokens=formatOptsToTokens(Formatter.macroTokenToFormatOpts(token.val),locale);return null==tokens||tokens.includes(void 0)?token:tokens}(t,locale)))}class TokenParser{constructor(locale,format){if(this.locale=locale,this.format=format,this.tokens=expandMacroTokens(Formatter.parseFormat(format),locale),this.units=this.tokens.map(t=>function(token,loc){const one=digitRegex(loc),two=digitRegex(loc,"{2}"),three=digitRegex(loc,"{3}"),four=digitRegex(loc,"{4}"),six=digitRegex(loc,"{6}"),oneOrTwo=digitRegex(loc,"{1,2}"),oneToThree=digitRegex(loc,"{1,3}"),oneToSix=digitRegex(loc,"{1,6}"),oneToNine=digitRegex(loc,"{1,9}"),twoToFour=digitRegex(loc,"{2,4}"),fourToSix=digitRegex(loc,"{4,6}"),literal=t=>{return{regex:RegExp((value=t.val,value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"))),deser:([s2])=>s2,literal:!0};var value},unit=(t=>{if(token.literal)return literal(t);switch(t.val){case"G":return oneOf(loc.eras("short"),0);case"GG":return oneOf(loc.eras("long"),0);case"y":return intUnit(oneToSix);case"yy":case"kk":return intUnit(twoToFour,untruncateYear);case"yyyy":case"kkkk":return intUnit(four);case"yyyyy":return intUnit(fourToSix);case"yyyyyy":return intUnit(six);case"M":case"L":case"d":case"H":case"h":case"m":case"q":case"s":case"W":return intUnit(oneOrTwo);case"MM":case"LL":case"dd":case"HH":case"hh":case"mm":case"qq":case"ss":case"WW":return intUnit(two);case"MMM":return oneOf(loc.months("short",!0),1);case"MMMM":return oneOf(loc.months("long",!0),1);case"LLL":return oneOf(loc.months("short",!1),1);case"LLLL":return oneOf(loc.months("long",!1),1);case"o":case"S":return intUnit(oneToThree);case"ooo":case"SSS":return intUnit(three);case"u":return simple(oneToNine);case"uu":return simple(oneOrTwo);case"uuu":case"E":case"c":return intUnit(one);case"a":return oneOf(loc.meridiems(),0);case"EEE":return oneOf(loc.weekdays("short",!1),1);case"EEEE":return oneOf(loc.weekdays("long",!1),1);case"ccc":return oneOf(loc.weekdays("short",!0),1);case"cccc":return oneOf(loc.weekdays("long",!0),1);case"Z":case"ZZ":return offset(new RegExp(`([+-]${oneOrTwo.source})(?::(${two.source}))?`),2);case"ZZZ":return offset(new RegExp(`([+-]${oneOrTwo.source})(${two.source})?`),2);case"z":return simple(/[a-z_+-/]{1,256}?/i);case" ":return simple(/[^\S\n\r]/);default:return literal(t)}})(token)||{invalidReason:"missing Intl.DateTimeFormat.formatToParts support"};return unit.token=token,unit}(t,locale)),this.disqualifyingUnit=this.units.find(t=>t.invalidReason),!this.disqualifyingUnit){const[regexString,handlers]=[`^${(units=this.units).map(u=>u.regex).reduce((f,r)=>`${f}(${r.source})`,"")}$`,units];this.regex=RegExp(regexString,"i"),this.handlers=handlers}var units}explainFromTokens(input){if(this.isValid){const[rawMatches,matches]=function(input,regex,handlers){const matches=input.match(regex);if(matches){const all={};let matchIndex=1;for(const i in handlers)if(hasOwnProperty(handlers,i)){const h2=handlers[i],groups=h2.groups?h2.groups+1:1;!h2.literal&&h2.token&&(all[h2.token.val[0]]=h2.deser(matches.slice(matchIndex,matchIndex+groups))),matchIndex+=groups}return[matches,all]}return[matches,{}]}(input,this.regex,this.handlers),[result,zone,specificOffset]=matches?function(matches){let specificOffset,zone=null;return isUndefined(matches.z)||(zone=IANAZone.create(matches.z)),isUndefined(matches.Z)||(zone||(zone=new FixedOffsetZone(matches.Z)),specificOffset=matches.Z),isUndefined(matches.q)||(matches.M=3*(matches.q-1)+1),isUndefined(matches.h)||(matches.h<12&&1===matches.a?matches.h+=12:12===matches.h&&0===matches.a&&(matches.h=0)),0===matches.G&&matches.y&&(matches.y=-matches.y),isUndefined(matches.u)||(matches.S=parseMillis(matches.u)),[Object.keys(matches).reduce((r,k)=>{const f=(token=>{switch(token){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}})(k);return f&&(r[f]=matches[k]),r},{}),zone,specificOffset]}(matches):[null,null,void 0];if(hasOwnProperty(matches,"a")&&hasOwnProperty(matches,"H"))throw new ConflictingSpecificationError("Can't include meridiem when specifying 24-hour format");return{input:input,tokens:this.tokens,regex:this.regex,rawMatches:rawMatches,matches:matches,result:result,zone:zone,specificOffset:specificOffset}}return{input:input,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function explainFromTokens(locale,input,format){return new TokenParser(locale,format).explainFromTokens(input)}function formatOptsToTokens(formatOpts,locale){if(!formatOpts)return null;const df=Formatter.create(locale,formatOpts).dtFormatter((dummyDateTimeCache||(dummyDateTimeCache=DateTime$1.fromMillis(1555555555555)),dummyDateTimeCache)),parts=df.formatToParts(),resolvedOpts=df.resolvedOptions();return parts.map(p2=>function(part,formatOpts,resolvedOpts){const{type:type,value:value}=part;if("literal"===type){const isSpace=/^\s+$/.test(value);return{literal:!isSpace,val:isSpace?" ":value}}const style=formatOpts[type];let actualType=type;"hour"===type&&(actualType=null!=formatOpts.hour12?formatOpts.hour12?"hour12":"hour24":null!=formatOpts.hourCycle?"h11"===formatOpts.hourCycle||"h12"===formatOpts.hourCycle?"hour12":"hour24":resolvedOpts.hour12?"hour12":"hour24");let val=partTypeStyleToTokenVal[actualType];if("object"==typeof val&&(val=val[style]),val)return{literal:!1,val:val}}(p2,formatOpts,resolvedOpts))}const INVALID="Invalid DateTime";function unsupportedZone(zone){return new Invalid("unsupported zone",`the zone "${zone.name}" is not supported`)}function possiblyCachedWeekData(dt){return null===dt.weekData&&(dt.weekData=gregorianToWeek(dt.c)),dt.weekData}function possiblyCachedLocalWeekData(dt){return null===dt.localWeekData&&(dt.localWeekData=gregorianToWeek(dt.c,dt.loc.getMinDaysInFirstWeek(),dt.loc.getStartOfWeek())),dt.localWeekData}function clone$2(inst,alts){const current={ts:inst.ts,zone:inst.zone,c:inst.c,o:inst.o,loc:inst.loc,invalid:inst.invalid};return new DateTime$1(__spreadProps(__spreadValues(__spreadValues({},current),alts),{old:current}))}function fixOffset(localTS,o,tz){let utcGuess=localTS-60*o*1e3;const o2=tz.offset(utcGuess);if(o===o2)return[utcGuess,o];utcGuess-=60*(o2-o)*1e3;const o3=tz.offset(utcGuess);return o2===o3?[utcGuess,o2]:[localTS-60*Math.min(o2,o3)*1e3,Math.max(o2,o3)]}function tsToObj(ts,offset2){const d=new Date(ts+=60*offset2*1e3);return{year:d.getUTCFullYear(),month:d.getUTCMonth()+1,day:d.getUTCDate(),hour:d.getUTCHours(),minute:d.getUTCMinutes(),second:d.getUTCSeconds(),millisecond:d.getUTCMilliseconds()}}function objToTS(obj,offset2,zone){return fixOffset(objToLocalTS(obj),offset2,zone)}function adjustTime(inst,dur){const oPre=inst.o,year2=inst.c.year+Math.trunc(dur.years),month=inst.c.month+Math.trunc(dur.months)+3*Math.trunc(dur.quarters),c=__spreadProps(__spreadValues({},inst.c),{year:year2,month:month,day:Math.min(inst.c.day,daysInMonth(year2,month))+Math.trunc(dur.days)+7*Math.trunc(dur.weeks)}),millisToAdd=Duration$1.fromObject({years:dur.years-Math.trunc(dur.years),quarters:dur.quarters-Math.trunc(dur.quarters),months:dur.months-Math.trunc(dur.months),weeks:dur.weeks-Math.trunc(dur.weeks),days:dur.days-Math.trunc(dur.days),hours:dur.hours,minutes:dur.minutes,seconds:dur.seconds,milliseconds:dur.milliseconds}).as("milliseconds"),localTS=objToLocalTS(c);let[ts,o]=fixOffset(localTS,oPre,inst.zone);return 0!==millisToAdd&&(ts+=millisToAdd,o=inst.zone.offset(ts)),{ts:ts,o:o}}function parseDataToDateTime(parsed,parsedZone,opts,format,text,specificOffset){const{setZone:setZone,zone:zone}=opts;if(parsed&&0!==Object.keys(parsed).length||parsedZone){const interpretationZone=parsedZone||zone,inst=DateTime$1.fromObject(parsed,__spreadProps(__spreadValues({},opts),{zone:interpretationZone,specificOffset:specificOffset}));return setZone?inst:inst.setZone(zone)}return DateTime$1.invalid(new Invalid("unparsable",`the input "${text}" can't be parsed as ${format}`))}function toTechFormat(dt,format,allowZ=!0){return dt.isValid?Formatter.create(Locale.create("en-US"),{allowZ:allowZ,forceSimple:!0}).formatDateTimeFromString(dt,format):null}function toISODate(o,extended){const longFormat=o.c.year>9999||o.c.year<0;let c="";return longFormat&&o.c.year>=0&&(c+="+"),c+=padStart$1(o.c.year,longFormat?6:4),extended?(c+="-",c+=padStart$1(o.c.month),c+="-",c+=padStart$1(o.c.day)):(c+=padStart$1(o.c.month),c+=padStart$1(o.c.day)),c}function toISOTime(o,extended,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone){let c=padStart$1(o.c.hour);return extended?(c+=":",c+=padStart$1(o.c.minute),0===o.c.millisecond&&0===o.c.second&&suppressSeconds||(c+=":")):c+=padStart$1(o.c.minute),0===o.c.millisecond&&0===o.c.second&&suppressSeconds||(c+=padStart$1(o.c.second),0===o.c.millisecond&&suppressMilliseconds||(c+=".",c+=padStart$1(o.c.millisecond,3))),includeOffset&&(o.isOffsetFixed&&0===o.offset&&!extendedZone?c+="Z":o.o<0?(c+="-",c+=padStart$1(Math.trunc(-o.o/60)),c+=":",c+=padStart$1(Math.trunc(-o.o%60))):(c+="+",c+=padStart$1(Math.trunc(o.o/60)),c+=":",c+=padStart$1(Math.trunc(o.o%60)))),extendedZone&&(c+="["+o.zone.ianaName+"]"),c}const defaultUnitValues={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},defaultWeekUnitValues={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},defaultOrdinalUnitValues={ordinal:1,hour:0,minute:0,second:0,millisecond:0},orderedUnits=["year","month","day","hour","minute","second","millisecond"],orderedWeekUnits=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],orderedOrdinalUnits=["year","ordinal","hour","minute","second","millisecond"];function normalizeUnitWithLocalWeeks(unit){switch(unit.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return function(unit){const normalized={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[unit.toLowerCase()];if(!normalized)throw new InvalidUnitError(unit);return normalized}(unit)}}function quickDT(obj,opts){const zone=normalizeZone(opts.zone,Settings.defaultZone);if(!zone.isValid)return DateTime$1.invalid(unsupportedZone(zone));const loc=Locale.fromObject(opts);let ts,o;if(isUndefined(obj.year))ts=Settings.now();else{for(const u of orderedUnits)isUndefined(obj[u])&&(obj[u]=defaultUnitValues[u]);const invalid=hasInvalidGregorianData(obj)||hasInvalidTimeData(obj);if(invalid)return DateTime$1.invalid(invalid);const offsetProvis=function(zone){if(void 0===zoneOffsetTs&&(zoneOffsetTs=Settings.now()),"iana"!==zone.type)return zone.offset(zoneOffsetTs);const zoneName=zone.name;let offsetGuess=zoneOffsetGuessCache.get(zoneName);return void 0===offsetGuess&&(offsetGuess=zone.offset(zoneOffsetTs),zoneOffsetGuessCache.set(zoneName,offsetGuess)),offsetGuess}(zone);[ts,o]=objToTS(obj,offsetProvis,zone)}return new DateTime$1({ts:ts,zone:zone,loc:loc,o:o})}function diffRelative(start,end,opts){const round=!!isUndefined(opts.round)||opts.round,format=(c,unit)=>{c=roundTo(c,round||opts.calendary?0:2,!0);return end.loc.clone(opts).relFormatter(opts).format(c,unit)},differ=unit=>opts.calendary?end.hasSame(start,unit)?0:end.startOf(unit).diff(start.startOf(unit),unit).get(unit):end.diff(start,unit).get(unit);if(opts.unit)return format(differ(opts.unit),opts.unit);for(const unit of opts.units){const count=differ(unit);if(Math.abs(count)>=1)return format(count,unit)}return format(start>end?-0:0,opts.units[opts.units.length-1])}function lastOpts(argList){let args,opts={};return argList.length>0&&"object"==typeof argList[argList.length-1]?(opts=argList[argList.length-1],args=Array.from(argList).slice(0,argList.length-1)):args=Array.from(argList),[opts,args]}let zoneOffsetTs;const zoneOffsetGuessCache=new Map;let DateTime$1=class DateTime2{constructor(config){const zone=config.zone||Settings.defaultZone;let invalid=config.invalid||(Number.isNaN(config.ts)?new Invalid("invalid input"):null)||(zone.isValid?null:unsupportedZone(zone));this.ts=isUndefined(config.ts)?Settings.now():config.ts;let c=null,o=null;if(!invalid){if(config.old&&config.old.ts===this.ts&&config.old.zone.equals(zone))[c,o]=[config.old.c,config.old.o];else{const ot=isNumber$1(config.o)&&!config.old?config.o:zone.offset(this.ts);c=tsToObj(this.ts,ot),invalid=Number.isNaN(c.year)?new Invalid("invalid input"):null,c=invalid?null:c,o=invalid?null:ot}}this._zone=zone,this.loc=config.loc||Locale.create(),this.invalid=invalid,this.weekData=null,this.localWeekData=null,this.c=c,this.o=o,this.isLuxonDateTime=!0}static now(){return new DateTime2({})}static local(){const[opts,args]=lastOpts(arguments),[year2,month,day,hour,minute,second,millisecond]=args;return quickDT({year:year2,month:month,day:day,hour:hour,minute:minute,second:second,millisecond:millisecond},opts)}static utc(){const[opts,args]=lastOpts(arguments),[year2,month,day,hour,minute,second,millisecond]=args;return opts.zone=FixedOffsetZone.utcInstance,quickDT({year:year2,month:month,day:day,hour:hour,minute:minute,second:second,millisecond:millisecond},opts)}static fromJSDate(date,options={}){const ts=(o=date,"[object Date]"===Object.prototype.toString.call(o)?date.valueOf():NaN);var o;if(Number.isNaN(ts))return DateTime2.invalid("invalid input");const zoneToUse=normalizeZone(options.zone,Settings.defaultZone);return zoneToUse.isValid?new DateTime2({ts:ts,zone:zoneToUse,loc:Locale.fromObject(options)}):DateTime2.invalid(unsupportedZone(zoneToUse))}static fromMillis(milliseconds,options={}){if(isNumber$1(milliseconds))return milliseconds<-864e13||milliseconds>864e13?DateTime2.invalid("Timestamp out of range"):new DateTime2({ts:milliseconds,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options)});throw new InvalidArgumentError(`fromMillis requires a numerical input, but received a ${typeof milliseconds} with value ${milliseconds}`)}static fromSeconds(seconds,options={}){if(isNumber$1(seconds))return new DateTime2({ts:1e3*seconds,zone:normalizeZone(options.zone,Settings.defaultZone),loc:Locale.fromObject(options)});throw new InvalidArgumentError("fromSeconds requires a numerical input")}static fromObject(obj,opts={}){obj=obj||{};const zoneToUse=normalizeZone(opts.zone,Settings.defaultZone);if(!zoneToUse.isValid)return DateTime2.invalid(unsupportedZone(zoneToUse));const loc=Locale.fromObject(opts),normalized=normalizeObject(obj,normalizeUnitWithLocalWeeks),{minDaysInFirstWeek:minDaysInFirstWeek,startOfWeek:startOfWeek}=usesLocalWeekValues(normalized,loc),tsNow=Settings.now(),offsetProvis=isUndefined(opts.specificOffset)?zoneToUse.offset(tsNow):opts.specificOffset,containsOrdinal=!isUndefined(normalized.ordinal),containsGregorYear=!isUndefined(normalized.year),containsGregorMD=!isUndefined(normalized.month)||!isUndefined(normalized.day),containsGregor=containsGregorYear||containsGregorMD,definiteWeekDef=normalized.weekYear||normalized.weekNumber;if((containsGregor||containsOrdinal)&&definiteWeekDef)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(containsGregorMD&&containsOrdinal)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");const useWeekData=definiteWeekDef||normalized.weekday&&!containsGregor;let units,defaultValues,objNow=tsToObj(tsNow,offsetProvis);useWeekData?(units=orderedWeekUnits,defaultValues=defaultWeekUnitValues,objNow=gregorianToWeek(objNow,minDaysInFirstWeek,startOfWeek)):containsOrdinal?(units=orderedOrdinalUnits,defaultValues=defaultOrdinalUnitValues,objNow=gregorianToOrdinal(objNow)):(units=orderedUnits,defaultValues=defaultUnitValues);let foundFirst=!1;for(const u of units){isUndefined(normalized[u])?normalized[u]=foundFirst?defaultValues[u]:objNow[u]:foundFirst=!0}const higherOrderInvalid=useWeekData?function(obj,minDaysInFirstWeek=4,startOfWeek=1){const validYear=isInteger(obj.weekYear),validWeek=integerBetween(obj.weekNumber,1,weeksInWeekYear(obj.weekYear,minDaysInFirstWeek,startOfWeek)),validWeekday=integerBetween(obj.weekday,1,7);return validYear?validWeek?!validWeekday&&unitOutOfRange("weekday",obj.weekday):unitOutOfRange("week",obj.weekNumber):unitOutOfRange("weekYear",obj.weekYear)}(normalized,minDaysInFirstWeek,startOfWeek):containsOrdinal?function(obj){const validYear=isInteger(obj.year),validOrdinal=integerBetween(obj.ordinal,1,daysInYear(obj.year));return validYear?!validOrdinal&&unitOutOfRange("ordinal",obj.ordinal):unitOutOfRange("year",obj.year)}(normalized):hasInvalidGregorianData(normalized),invalid=higherOrderInvalid||hasInvalidTimeData(normalized);if(invalid)return DateTime2.invalid(invalid);const gregorian=useWeekData?weekToGregorian(normalized,minDaysInFirstWeek,startOfWeek):containsOrdinal?ordinalToGregorian(normalized):normalized,[tsFinal,offsetFinal]=objToTS(gregorian,offsetProvis,zoneToUse),inst=new DateTime2({ts:tsFinal,zone:zoneToUse,o:offsetFinal,loc:loc});return normalized.weekday&&containsGregor&&obj.weekday!==inst.weekday?DateTime2.invalid("mismatched weekday",`you can't specify both a weekday of ${normalized.weekday} and a date of ${inst.toISO()}`):inst.isValid?inst:DateTime2.invalid(inst.invalid)}static fromISO(text,opts={}){const[vals,parsedZone]=parse$3(text,[isoYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[isoWeekWithTimeExtensionRegex,extractISOWeekTimeAndOffset],[isoOrdinalWithTimeExtensionRegex,extractISOOrdinalDateAndTime],[isoTimeCombinedRegex,extractISOTimeAndOffset]);return parseDataToDateTime(vals,parsedZone,opts,"ISO 8601",text)}static fromRFC2822(text,opts={}){const[vals,parsedZone]=parse$3(function(s2){return s2.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}(text),[rfc2822,extractRFC2822]);return parseDataToDateTime(vals,parsedZone,opts,"RFC 2822",text)}static fromHTTP(text,opts={}){const[vals,parsedZone]=parse$3(text,[rfc1123,extractRFC1123Or850],[rfc850,extractRFC1123Or850],[ascii,extractASCII]);return parseDataToDateTime(vals,parsedZone,opts,"HTTP",opts)}static fromFormat(text,fmt,opts={}){if(isUndefined(text)||isUndefined(fmt))throw new InvalidArgumentError("fromFormat requires an input string and a format");const{locale:locale=null,numberingSystem:numberingSystem=null}=opts,localeToUse=Locale.fromOpts({locale:locale,numberingSystem:numberingSystem,defaultToEN:!0}),[vals,parsedZone,specificOffset,invalid]=function(locale,input,format){const{result:result,zone:zone,specificOffset:specificOffset,invalidReason:invalidReason}=explainFromTokens(locale,input,format);return[result,zone,specificOffset,invalidReason]}(localeToUse,text,fmt);return invalid?DateTime2.invalid(invalid):parseDataToDateTime(vals,parsedZone,opts,`format ${fmt}`,text,specificOffset)}static fromString(text,fmt,opts={}){return DateTime2.fromFormat(text,fmt,opts)}static fromSQL(text,opts={}){const[vals,parsedZone]=parse$3(text,[sqlYmdWithTimeExtensionRegex,extractISOYmdTimeAndOffset],[sqlTimeCombinedRegex,extractISOTimeOffsetAndIANAZone]);return parseDataToDateTime(vals,parsedZone,opts,"SQL",text)}static invalid(reason,explanation=null){if(!reason)throw new InvalidArgumentError("need to specify a reason the DateTime is invalid");const invalid=reason instanceof Invalid?reason:new Invalid(reason,explanation);if(Settings.throwOnInvalid)throw new InvalidDateTimeError(invalid);return new DateTime2({invalid:invalid})}static isDateTime(o){return o&&o.isLuxonDateTime||!1}static parseFormatForOpts(formatOpts,localeOpts={}){const tokenList=formatOptsToTokens(formatOpts,Locale.fromObject(localeOpts));return tokenList?tokenList.map(t=>t?t.val:null).join(""):null}static expandFormat(fmt,localeOpts={}){return expandMacroTokens(Formatter.parseFormat(fmt),Locale.fromObject(localeOpts)).map(t=>t.val).join("")}static resetCache(){zoneOffsetTs=void 0,zoneOffsetGuessCache.clear()}get(unit){return this[unit]}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?possiblyCachedWeekData(this).weekYear:NaN}get weekNumber(){return this.isValid?possiblyCachedWeekData(this).weekNumber:NaN}get weekday(){return this.isValid?possiblyCachedWeekData(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?possiblyCachedLocalWeekData(this).weekday:NaN}get localWeekNumber(){return this.isValid?possiblyCachedLocalWeekData(this).weekNumber:NaN}get localWeekYear(){return this.isValid?possiblyCachedLocalWeekData(this).weekYear:NaN}get ordinal(){return this.isValid?gregorianToOrdinal(this.c).ordinal:NaN}get monthShort(){return this.isValid?Info.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Info.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Info.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Info.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return!this.isOffsetFixed&&(this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset)}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const localTS=objToLocalTS(this.c),oEarlier=this.zone.offset(localTS-864e5),oLater=this.zone.offset(localTS+864e5),o1=this.zone.offset(localTS-6e4*oEarlier),o2=this.zone.offset(localTS-6e4*oLater);if(o1===o2)return[this];const ts1=localTS-6e4*o1,ts2=localTS-6e4*o2,c1=tsToObj(ts1,o1),c2=tsToObj(ts2,o2);return c1.hour===c2.hour&&c1.minute===c2.minute&&c1.second===c2.second&&c1.millisecond===c2.millisecond?[clone$2(this,{ts:ts1}),clone$2(this,{ts:ts2})]:[this]}get isInLeapYear(){return isLeapYear$1(this.year)}get daysInMonth(){return daysInMonth(this.year,this.month)}get daysInYear(){return this.isValid?daysInYear(this.year):NaN}get weeksInWeekYear(){return this.isValid?weeksInWeekYear(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?weeksInWeekYear(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(opts={}){const{locale:locale,numberingSystem:numberingSystem,calendar:calendar}=Formatter.create(this.loc.clone(opts),opts).resolvedOptions(this);return{locale:locale,numberingSystem:numberingSystem,outputCalendar:calendar}}toUTC(offset2=0,opts={}){return this.setZone(FixedOffsetZone.instance(offset2),opts)}toLocal(){return this.setZone(Settings.defaultZone)}setZone(zone,{keepLocalTime:keepLocalTime=!1,keepCalendarTime:keepCalendarTime=!1}={}){if((zone=normalizeZone(zone,Settings.defaultZone)).equals(this.zone))return this;if(zone.isValid){let newTS=this.ts;if(keepLocalTime||keepCalendarTime){const offsetGuess=zone.offset(this.ts),asObj=this.toObject();[newTS]=objToTS(asObj,offsetGuess,zone)}return clone$2(this,{ts:newTS,zone:zone})}return DateTime2.invalid(unsupportedZone(zone))}reconfigure({locale:locale,numberingSystem:numberingSystem,outputCalendar:outputCalendar}={}){return clone$2(this,{loc:this.loc.clone({locale:locale,numberingSystem:numberingSystem,outputCalendar:outputCalendar})})}setLocale(locale){return this.reconfigure({locale:locale})}set(values){if(!this.isValid)return this;const normalized=normalizeObject(values,normalizeUnitWithLocalWeeks),{minDaysInFirstWeek:minDaysInFirstWeek,startOfWeek:startOfWeek}=usesLocalWeekValues(normalized,this.loc),settingWeekStuff=!isUndefined(normalized.weekYear)||!isUndefined(normalized.weekNumber)||!isUndefined(normalized.weekday),containsOrdinal=!isUndefined(normalized.ordinal),containsGregorYear=!isUndefined(normalized.year),containsGregorMD=!isUndefined(normalized.month)||!isUndefined(normalized.day),containsGregor=containsGregorYear||containsGregorMD,definiteWeekDef=normalized.weekYear||normalized.weekNumber;if((containsGregor||containsOrdinal)&&definiteWeekDef)throw new ConflictingSpecificationError("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(containsGregorMD&&containsOrdinal)throw new ConflictingSpecificationError("Can't mix ordinal dates with month/day");let mixed;settingWeekStuff?mixed=weekToGregorian(__spreadValues(__spreadValues({},gregorianToWeek(this.c,minDaysInFirstWeek,startOfWeek)),normalized),minDaysInFirstWeek,startOfWeek):isUndefined(normalized.ordinal)?(mixed=__spreadValues(__spreadValues({},this.toObject()),normalized),isUndefined(normalized.day)&&(mixed.day=Math.min(daysInMonth(mixed.year,mixed.month),mixed.day))):mixed=ordinalToGregorian(__spreadValues(__spreadValues({},gregorianToOrdinal(this.c)),normalized));const[ts,o]=objToTS(mixed,this.o,this.zone);return clone$2(this,{ts:ts,o:o})}plus(duration){if(!this.isValid)return this;return clone$2(this,adjustTime(this,Duration$1.fromDurationLike(duration)))}minus(duration){if(!this.isValid)return this;return clone$2(this,adjustTime(this,Duration$1.fromDurationLike(duration).negate()))}startOf(unit,{useLocaleWeeks:useLocaleWeeks=!1}={}){if(!this.isValid)return this;const o={},normalizedUnit=Duration$1.normalizeUnit(unit);switch(normalizedUnit){case"years":o.month=1;case"quarters":case"months":o.day=1;case"weeks":case"days":o.hour=0;case"hours":o.minute=0;case"minutes":o.second=0;case"seconds":o.millisecond=0}if("weeks"===normalizedUnit)if(useLocaleWeeks){const startOfWeek=this.loc.getStartOfWeek(),{weekday:weekday}=this;weekday<startOfWeek&&(o.weekNumber=this.weekNumber-1),o.weekday=startOfWeek}else o.weekday=1;if("quarters"===normalizedUnit){const q=Math.ceil(this.month/3);o.month=3*(q-1)+1}return this.set(o)}endOf(unit,opts){return this.isValid?this.plus({[unit]:1}).startOf(unit,opts).minus(1):this}toFormat(fmt,opts={}){return this.isValid?Formatter.create(this.loc.redefaultToEN(opts)).formatDateTimeFromString(this,fmt):INVALID}toLocaleString(formatOpts=DATE_SHORT,opts={}){return this.isValid?Formatter.create(this.loc.clone(opts),formatOpts).formatDateTime(this):INVALID}toLocaleParts(opts={}){return this.isValid?Formatter.create(this.loc.clone(opts),opts).formatDateTimeParts(this):[]}toISO({format:format="extended",suppressSeconds:suppressSeconds=!1,suppressMilliseconds:suppressMilliseconds=!1,includeOffset:includeOffset=!0,extendedZone:extendedZone=!1}={}){if(!this.isValid)return null;const ext="extended"===format;let c=toISODate(this,ext);return c+="T",c+=toISOTime(this,ext,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone),c}toISODate({format:format="extended"}={}){return this.isValid?toISODate(this,"extended"===format):null}toISOWeekDate(){return toTechFormat(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:suppressMilliseconds=!1,suppressSeconds:suppressSeconds=!1,includeOffset:includeOffset=!0,includePrefix:includePrefix=!1,extendedZone:extendedZone=!1,format:format="extended"}={}){if(!this.isValid)return null;return(includePrefix?"T":"")+toISOTime(this,"extended"===format,suppressSeconds,suppressMilliseconds,includeOffset,extendedZone)}toRFC2822(){return toTechFormat(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return toTechFormat(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?toISODate(this,!0):null}toSQLTime({includeOffset:includeOffset=!0,includeZone:includeZone=!1,includeOffsetSpace:includeOffsetSpace=!0}={}){let fmt="HH:mm:ss.SSS";return(includeZone||includeOffset)&&(includeOffsetSpace&&(fmt+=" "),includeZone?fmt+="z":includeOffset&&(fmt+="ZZ")),toTechFormat(this,fmt,!0)}toSQL(opts={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(opts)}`:null}toString(){return this.isValid?this.toISO():INVALID}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(opts={}){if(!this.isValid)return{};const base=__spreadValues({},this.c);return opts.includeConfig&&(base.outputCalendar=this.outputCalendar,base.numberingSystem=this.loc.numberingSystem,base.locale=this.loc.locale),base}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(otherDateTime,unit="milliseconds",opts={}){if(!this.isValid||!otherDateTime.isValid)return Duration$1.invalid("created by diffing an invalid DateTime");const durOpts=__spreadValues({locale:this.locale,numberingSystem:this.numberingSystem},opts),units=(thing=unit,Array.isArray(thing)?thing:[thing]).map(Duration$1.normalizeUnit),otherIsLater=otherDateTime.valueOf()>this.valueOf(),diffed=diff(otherIsLater?this:otherDateTime,otherIsLater?otherDateTime:this,units,durOpts);var thing;return otherIsLater?diffed.negate():diffed}diffNow(unit="milliseconds",opts={}){return this.diff(DateTime2.now(),unit,opts)}until(otherDateTime){return this.isValid?Interval.fromDateTimes(this,otherDateTime):this}hasSame(otherDateTime,unit,opts){if(!this.isValid)return!1;const inputMs=otherDateTime.valueOf(),adjustedToZone=this.setZone(otherDateTime.zone,{keepLocalTime:!0});return adjustedToZone.startOf(unit,opts)<=inputMs&&inputMs<=adjustedToZone.endOf(unit,opts)}equals(other){return this.isValid&&other.isValid&&this.valueOf()===other.valueOf()&&this.zone.equals(other.zone)&&this.loc.equals(other.loc)}toRelative(options={}){if(!this.isValid)return null;const base=options.base||DateTime2.fromObject({},{zone:this.zone}),padding=options.padding?this<base?-options.padding:options.padding:0;let units=["years","months","days","hours","minutes","seconds"],unit=options.unit;return Array.isArray(options.unit)&&(units=options.unit,unit=void 0),diffRelative(base,this.plus(padding),__spreadProps(__spreadValues({},options),{numeric:"always",units:units,unit:unit}))}toRelativeCalendar(options={}){return this.isValid?diffRelative(options.base||DateTime2.fromObject({},{zone:this.zone}),this,__spreadProps(__spreadValues({},options),{numeric:"auto",units:["years","months","days"],calendary:!0})):null}static min(...dateTimes){if(!dateTimes.every(DateTime2.isDateTime))throw new InvalidArgumentError("min requires all arguments be DateTimes");return bestBy(dateTimes,i=>i.valueOf(),Math.min)}static max(...dateTimes){if(!dateTimes.every(DateTime2.isDateTime))throw new InvalidArgumentError("max requires all arguments be DateTimes");return bestBy(dateTimes,i=>i.valueOf(),Math.max)}static fromFormatExplain(text,fmt,options={}){const{locale:locale=null,numberingSystem:numberingSystem=null}=options;return explainFromTokens(Locale.fromOpts({locale:locale,numberingSystem:numberingSystem,defaultToEN:!0}),text,fmt)}static fromStringExplain(text,fmt,options={}){return DateTime2.fromFormatExplain(text,fmt,options)}static buildFormatParser(fmt,options={}){const{locale:locale=null,numberingSystem:numberingSystem=null}=options,localeToUse=Locale.fromOpts({locale:locale,numberingSystem:numberingSystem,defaultToEN:!0});return new TokenParser(localeToUse,fmt)}static fromFormatParser(text,formatParser,opts={}){if(isUndefined(text)||isUndefined(formatParser))throw new InvalidArgumentError("fromFormatParser requires an input string and a format parser");const{locale:locale=null,numberingSystem:numberingSystem=null}=opts,localeToUse=Locale.fromOpts({locale:locale,numberingSystem:numberingSystem,defaultToEN:!0});if(!localeToUse.equals(formatParser.locale))throw new InvalidArgumentError(`fromFormatParser called with a locale of ${localeToUse}, but the format parser was created for ${formatParser.locale}`);const{result:result,zone:zone,specificOffset:specificOffset,invalidReason:invalidReason}=formatParser.explainFromTokens(text);return invalidReason?DateTime2.invalid(invalidReason):parseDataToDateTime(result,zone,opts,`format ${formatParser.format}`,text,specificOffset)}static get DATE_SHORT(){return DATE_SHORT}static get DATE_MED(){return DATE_MED}static get DATE_MED_WITH_WEEKDAY(){return DATE_MED_WITH_WEEKDAY}static get DATE_FULL(){return DATE_FULL}static get DATE_HUGE(){return DATE_HUGE}static get TIME_SIMPLE(){return TIME_SIMPLE}static get TIME_WITH_SECONDS(){return TIME_WITH_SECONDS}static get TIME_WITH_SHORT_OFFSET(){return TIME_WITH_SHORT_OFFSET}static get TIME_WITH_LONG_OFFSET(){return TIME_WITH_LONG_OFFSET}static get TIME_24_SIMPLE(){return TIME_24_SIMPLE}static get TIME_24_WITH_SECONDS(){return TIME_24_WITH_SECONDS}static get TIME_24_WITH_SHORT_OFFSET(){return TIME_24_WITH_SHORT_OFFSET}static get TIME_24_WITH_LONG_OFFSET(){return TIME_24_WITH_LONG_OFFSET}static get DATETIME_SHORT(){return DATETIME_SHORT}static get DATETIME_SHORT_WITH_SECONDS(){return DATETIME_SHORT_WITH_SECONDS}static get DATETIME_MED(){return DATETIME_MED}static get DATETIME_MED_WITH_SECONDS(){return DATETIME_MED_WITH_SECONDS}static get DATETIME_MED_WITH_WEEKDAY(){return DATETIME_MED_WITH_WEEKDAY}static get DATETIME_FULL(){return DATETIME_FULL}static get DATETIME_FULL_WITH_SECONDS(){return DATETIME_FULL_WITH_SECONDS}static get DATETIME_HUGE(){return DATETIME_HUGE}static get DATETIME_HUGE_WITH_SECONDS(){return DATETIME_HUGE_WITH_SECONDS}};function friendlyDateTime(dateTimeish){if(DateTime$1.isDateTime(dateTimeish))return dateTimeish;if(dateTimeish&&dateTimeish.valueOf&&isNumber$1(dateTimeish.valueOf()))return DateTime$1.fromJSDate(dateTimeish);if(dateTimeish&&"object"==typeof dateTimeish)return DateTime$1.fromObject(dateTimeish);throw new InvalidArgumentError(`Unknown datetime argument: ${dateTimeish}, of type ${typeof dateTimeish}`)}const MILLISECOND_AMOUNT_REGEX=/(milliseconds|ms)/i,SECOND_AMOUNT_REGEX=/(seconds|second|secs|sec|s)/i,MINUTE_AMOUNT_REGEX=/(minutes|minute|mins|min)/i,HOUR_AMOUNT_REGEX=/(hours|hour|h)/i,DAY_AMOUNT_REGEX=/(?:(week\s*|work\s*|business\s*)?(days|day|d))/i,WEEK_AMOUNT_REGEX=/(weeks|week|w)/i,MONTH_AMOUNT_REGEX=/(months|month)/i,YEAR_AMOUNT_REGEX=/(years|year|y)/i,AMOUNT_REGEX=new RegExp(`(\\d+\\W*)(${MILLISECOND_AMOUNT_REGEX.source}|${SECOND_AMOUNT_REGEX.source}|${MINUTE_AMOUNT_REGEX.source}|${HOUR_AMOUNT_REGEX.source}|${DAY_AMOUNT_REGEX.source}|${WEEK_AMOUNT_REGEX.source}|${MONTH_AMOUNT_REGEX.source}|${YEAR_AMOUNT_REGEX.source})(?:\\s*,\\s*|\\s*)`,"g"),EVENT_ID_REGEX=/(?:\W|^)(!\w+)/,RELATIVE_TIME_REGEX=new RegExp(`(by|before|after)?(\\s*${EVENT_ID_REGEX.source}\\s*)?(?:plus|\\+)?\\s*(${AMOUNT_REGEX.source})*`),HUMAN_MONTH_REGEX=new RegExp(`(?:(${/january|february|march|april|may|june|july|august|september|october|november|december/.source})|(${/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/.source}))`),DAY_FIRST_MONTH_REGEX=new RegExp(`(([0-3]?[0-9])\\s+${HUMAN_MONTH_REGEX.source})`),MONTH_FIRST_MONTH_REGEX=new RegExp(`(${HUMAN_MONTH_REGEX.source}\\s+([0-3]?[0-9](?!\\d)))`),TIME_REGEX=/((1|2|3|4|5|6|7|8|9|10|11|12)(:\d{2})?([ap]m)|([012]?[0-9])(:\d{2})?)/,CASUAL_MONTH_REGEX=new RegExp(`(?:(?:${DAY_FIRST_MONTH_REGEX.source}|${MONTH_FIRST_MONTH_REGEX.source}),?(?:\\s+(\\d{4}),?)?(?:\\s+${TIME_REGEX.source})?)|(${HUMAN_MONTH_REGEX.source}(?:\\s+(\\d{1,4}))?)`),NOW_REGEX=/now/,DATE_REGEX=new RegExp(`(\\d{1,5}(\\/\\d{1,5}(\\/\\d{1,5}(?:(?:,|\\s)+${TIME_REGEX.source})?)?)?)`),START_OR_END_TIME_REGEX=new RegExp(`(${/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2,}(?:\.\d*)?Z/.source})|(${NOW_REGEX.source})|${TIME_REGEX.source}|(${DATE_REGEX.source})|(${RELATIVE_TIME_REGEX.source})|${CASUAL_MONTH_REGEX.source}`),RECURRENCE_AMOUNT_REGEX=new RegExp(`(?:(\\d+|other)?\\s*)(${MILLISECOND_AMOUNT_REGEX.source}|${SECOND_AMOUNT_REGEX.source}|${MINUTE_AMOUNT_REGEX.source}|${HOUR_AMOUNT_REGEX.source}|${DAY_AMOUNT_REGEX.source}|${WEEK_AMOUNT_REGEX.source}|${MONTH_AMOUNT_REGEX.source}|${YEAR_AMOUNT_REGEX.source})`,"g");new RegExp(`(\\s+(?:(?:(?:un)?til)|(?:to)|(?:\\|))\\s+(${START_OR_END_TIME_REGEX.source}))?`);const RECURRENCE_REGEX=new RegExp("\\s*every[^:]+"),DATE_RANGE_REGEX=new RegExp(`((${START_OR_END_TIME_REGEX.source})(?:(?:(?:\\s*-\\s*)|(?:\\s+to\\s+))(${START_OR_END_TIME_REGEX.source}))?)(${RECURRENCE_REGEX.source})?\\s*:`),EVENT_START_REGEX=new RegExp(`^(\\s*)${DATE_RANGE_REGEX.source}(.*)`,"i");let index=0;++index;const datePartMatchIndex=++index,from_matchIndex=++index;++index;const from_nowMatchIndex=++index,from_timeOnlyMatchIndex=++index,from_timeOnlyMeridiemHourMatchIndex=++index,from_timeOnlyMeridiemMinuteMatchIndex=++index,from_timeOnlyMeridiemMeridiemMatchIndex=++index,from_timeOnly24HourHourMatchIndex=++index,from_timeOnly24HourMinuteMatchIndex=++index,from_slashDateFullMatchIndex=++index;++index,++index,++index;const from_slashDateTimeMatchIndex=++index,from_slashDateTimeMeridiemHourMatchIndex=++index,from_slashDateTimeMeridiemMinuteMatchIndex=++index,from_slashDateTimeMeridiemMeridiemMatchIndex=++index,from_slashDateTime24HourHourMatchIndex=++index,from_slashDateTime24HourMinuteMatchIndex=++index,from_relativeMatchIndex=++index,from_beforeOrAfterMatchIndex=++index;++index;const from_relativeEventIdMatchIndex=++index;++index,++index,++index,++index,++index,++index,++index,++index,++index,++index,++index,++index,++index;const from_dayFirstCasualMonthDayMatchIndex=++index,from_dayFirstCasualMonthMonthFullMatchIndex=++index,from_dayFirstCasualMonthMonthAbbrMatchIndex=++index;++index;const from_monthFirstCasualMonthMonthFullMatchIndex=++index,from_monthFirstCasualMonthMonthAbbrMatchIndex=++index,from_monthFirstCasualMonthDayMatchIndex=++index,from_casualMonthAndDayYearMatchIndex=++index,from_casualMonthTimeMatchIndex=++index,from_casualMonthTimeMeridiemHourMatchIndex=++index,from_casualMonthTimeMeridiemMinuteMatchIndex=++index,from_casualMonthTimeMeridiemMeridiemMatchIndex=++index,from_casualMonthTime24HourHourMatchIndex=++index,from_casualMonthTime24HourMinuteMatchIndex=++index;++index;const from_casualMonthMonthFullMatchIndex=++index,from_casualMonthMonthAbbrMatchIndex=++index,from_casualMonthYearMatchIndex=++index,to_matchIndex=++index;++index;const to_nowMatchIndex=++index,to_timeOnlyMatchIndex=++index,to_timeOnlyMeridiemHourMatchIndex=++index,to_timeOnlyMeridiemMinuteMatchIndex=++index,to_timeOnlyMeridiemMeridiemMatchIndex=++index,to_timeOnly24HourHourMatchIndex=++index,to_timeOnly24HourMinuteMatchIndex=++index,to_slashDateFullMatchIndex=++index;++index,++index,++index;const to_slashDateTimeMatchIndex=++index,to_slashDateTimeMeridiemHourMatchIndex=++index,to_slashDateTimeMeridiemMinuteMatchIndex=++index,to_slashDateTimeMeridiemMeridiemMatchIndex=++index,to_slashDateTime24HourHourMatchIndex=++index,to_slashDateTime24HourMinuteMatchIndex=++index,to_relativeMatchIndex=++index;++index,++index;const to_relativeEventIdMatchIndex=++index;++index,++index,++index,++index,++index,++index,++index,++index,++index,++index,++index,++index,++index;const to_dayFirstCasualMonthDayMatchIndex=++index,to_dayFirstCasualMonthMonthFullMatchIndex=++index,to_dayFirstCasualMonthMonthAbbrMatchIndex=++index;++index;const to_monthFirstCasualMonthMonthFullMatchIndex=++index,to_monthFirstCasualMonthMonthAbbrMatchIndex=++index,to_monthFirstCasualMonthDayMatchIndex=++index,to_casualMonthAndDayYearMatchIndex=++index,to_casualMonthTimeMatchIndex=++index,to_casualMonthTimeMeridiemHourMatchIndex=++index,to_casualMonthTimeMeridiemMinuteMatchIndex=++index,to_casualMonthTimeMeridiemMeridiemMatchIndex=++index,to_casualMonthTime24HourHourMatchIndex=++index,to_casualMonthTime24HourMinuteMatchIndex=++index;++index;const to_casualMonthMonthFullMatchIndex=++index,to_casualMonthMonthAbbrMatchIndex=++index,to_casualMonthYearMatchIndex=++index,recurrence_recurrenceMatchIndex=++index,eventTextMatchIndex=++index,COMMENT_REGEX=/^\s*\/\/.*/,TAG_REGEX=/(?:^|\s)#(?!\d+(?:\s|$))(\w+)/g,GROUP_START_REGEX=/^(\s*)(group|section)(?:\s|$)/i,GROUP_END_REGEX=/^(\s*)end(?:Group|Section)?/i,LIST_ITEM_REGEX=/^\s*- .*/,CHECKLIST_ITEM_REGEX=/^\s*- (\[(x|X| )?\]).*/,COMPLETION_REGEX=/^\s*(\[(x|X| )?\]).*/,EDTF_DATE_REGEX=new RegExp(`(\\d{4}(-\\d{2}(-\\d{2}(?:\\s+${TIME_REGEX.source})?)?)?)`),EDTF_START_OR_END_REGEX=new RegExp(`(?:${EDTF_DATE_REGEX.source}|(${RELATIVE_TIME_REGEX.source})|(${NOW_REGEX.source}))`);new RegExp(`(\\s+(?:(?:(?:un)?til)|(?:to)|(?:\\|))\\s+${EDTF_START_OR_END_REGEX.source})?`);const EDTF_RANGE_REGEX=new RegExp(`(${EDTF_START_OR_END_REGEX.source}(\\s*/\\s*${EDTF_START_OR_END_REGEX.source})?)(${RECURRENCE_REGEX.source})?\\s*:`),EDTF_START_REGEX=new RegExp(`^(\\s*)${EDTF_RANGE_REGEX.source}(.*)`,"i");let edtfIndex=0;++edtfIndex;const edtfDatePartMatchIndex=++edtfIndex,from_edtfDateIndex=++edtfIndex,from_edtfDateMonthPart=++edtfIndex,from_edtfDateDayPart=++edtfIndex,from_edtfDateTimePartMatchIndex=++edtfIndex,from_edtfDateTimeMeridiemHourMatchIndex=++edtfIndex,from_edtfDateTimeMeridiemMinuteMatchIndex=++edtfIndex,from_edtfDateTimeMeridiemMeridiemMatchIndex=++edtfIndex,from_edtfDateTime24HourHourMatchIndex=++edtfIndex,from_edtfDateTime24HourMinuteMatchIndex=++edtfIndex,from_edtfRelativeMatchIndex=++edtfIndex,from_edtfBeforeOrAfterMatchIndex=++edtfIndex;++edtfIndex;const from_edtfRelativeEventIdMatchIndex=++edtfIndex;++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex;const from_edtfNowMatchIndex=++edtfIndex,to_edtfIndex=++edtfIndex,to_edtfDateIndex=++edtfIndex,to_edtfDateMonthPart=++edtfIndex,to_edtfDateDayPart=++edtfIndex,to_edtfDateTimePartMatchIndex=++edtfIndex,to_edtfDateTimeMeridiemHourMatchIndex=++edtfIndex,to_edtfDateTimeMeridiemMinuteMatchIndex=++edtfIndex,to_edtfDateTimeMeridiemMeridiemMatchIndex=++edtfIndex,to_edtfDateTime24HourHourMatchIndex=++edtfIndex,to_edtfDateTime24HourMinuteMatchIndex=++edtfIndex,to_edtfRelativeMatchIndex=++edtfIndex,to_edtfBeforeOrAfterMatchIndex=++edtfIndex;++edtfIndex;const to_edtfRelativeEventIdMatchIndex=++edtfIndex;++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex,++edtfIndex;const to_edtfNowMatchIndex=++edtfIndex,edtf_recurrenceMatchIndex=++edtfIndex,edtfEventTextMatchIndex=++edtfIndex,BCE_START_REGEX=new RegExp("^\\s*(\\d{1,5})\\s?(BCE|BC|AD|CE)?(?:\\s?[–-]\\s?(\\d{1,5})\\s?(BCE|BC|AD|CE)?)?(?=\\s*:)(.*)","i");let BCEIndex=-1;const BCEDatePartMatchIndex=++BCEIndex,fromYear_BCEDateIndex=++BCEIndex,fromYearNotation_BCEDateIndex=++BCEIndex,toYear_BCEDateIndex=++BCEIndex,toYearNotation_BCEDateIndex=++BCEIndex,BCEEventTextMatchIndex=++BCEIndex;function addHttpIfNeeded$1(s2){return s2.startsWith("http://")||s2.startsWith("https://")||s2.startsWith("/")?s2:`http://${s2}`}class RelativeDate{static diffFromString(raw){var _a2,_b2,_c2,_d,_e,_f,_g,_h;const matches=raw.matchAll(AMOUNT_REGEX);let match2=matches.next();const diffObj={};for(;match2.value;){const value=match2.value,amount=parseInt(value[1]);value[3]?diffObj.milliseconds=(null!=(_a2=diffObj.milliseconds)?_a2:0)+amount:value[4]?diffObj.seconds=(null!=(_b2=diffObj.seconds)?_b2:0)+amount:value[5]?diffObj.minutes=(null!=(_c2=diffObj.minutes)?_c2:0)+amount:value[6]?diffObj.hours=(null!=(_d=diffObj.hours)?_d:0)+amount:value[7]||(value[8]?diffObj.days=(null!=(_e=diffObj.days)?_e:0)+amount:value[9]?diffObj.weeks=(null!=(_f=diffObj.weeks)?_f:0)+amount:value[10]?diffObj.months=(null!=(_g=diffObj.months)?_g:0)+amount:value[11]&&(diffObj.years=(null!=(_h=diffObj.years)?_h:0)+amount)),match2=matches.next()}return diffObj}static from(raw,priorDate,before=!1){const matches=raw.matchAll(AMOUNT_REGEX);let match2=matches.next();const plusOrMinus=before?"minus":"plus";for(;match2.value;){const value=match2.value,amount=parseInt(value[1]);value[3]?priorDate=priorDate[plusOrMinus]({milliseconds:amount}):value[4]?priorDate=priorDate[plusOrMinus]({seconds:amount}):value[5]?priorDate=priorDate[plusOrMinus]({minutes:amount}):value[6]?priorDate=priorDate[plusOrMinus]({hours:amount}):value[7]?priorDate=before?removeWeekdays(amount,priorDate):addWeekdays(amount,priorDate):value[8]?priorDate=priorDate[plusOrMinus]({days:amount}):value[9]?priorDate=priorDate[plusOrMinus]({weeks:amount}):value[10]?priorDate=priorDate[plusOrMinus]({months:amount}):value[11]&&(priorDate=priorDate[plusOrMinus]({years:amount})),match2=matches.next()}return priorDate}}function removeWeekdays(amount,fromDate){const currentWeekday=fromDate.weekday-1,lessThisWeek=amount-currentWeekday;if(lessThisWeek<=0)return fromDate.minus({days:amount});const firstWeek=currentWeekday,remainder=lessThisWeek%5,days=7*~~(lessThisWeek/5),lastWeek=remainder?2+remainder:0;return fromDate.minus({days:firstWeek+days+lastWeek})}function addWeekdays(amount,toDate){const thisWeek=6-toDate.weekday,lessThisWeek=amount-thisWeek;if(lessThisWeek<=0)return toDate.plus({days:amount});{const numWorkDaysInWeek=5,firstWeek=thisWeek,remainder=lessThisWeek%numWorkDaysInWeek,days=~~(lessThisWeek/numWorkDaysInWeek)*7,lastWeek=remainder?2+remainder:0;return toDate.plus({days:firstWeek+days+lastWeek})}}class DateRangePart{constructor({from:from,to:to,originalString:originalString,dateRangeInText:dateRangeInText,eventText:eventText,definition:definition,isRelative:isRelative,recurrence:recurrence}){this.fromDateTime=from,this.toDateTime=to,this.originalString=originalString,this.dateRangeInText=dateRangeInText,this.eventText=eventText,this.recurrence=null==recurrence?void 0:recurrence.recurrence,this.recurrenceRangeInText=null==recurrence?void 0:recurrence.range,this.definition=definition,this.isRelative=isRelative}}const LINK_REGEX=/\[([^\]\<\>]+)\]\(((https?:\/\/)?[\w\d./\&\?=\-#:,_]+)\)/g,LOCATION_REGEX=/\[([^\]]+)\]\((location|map)\)/g,IMAGE_REGEX=/!\[([^\]\<\>]*)\]\(((https?:\/\/)?[\w\d./\&\?=\-#:,_]+)\)/,AT_REGEX=/@([\w\d\/]+)/g,PERCENT_REGEX=/(?:\s|^)(\d{1,3})%(?:\s|$)/;var BlockType,BlockType2,RangeType,RangeType2;(BlockType2=BlockType||(BlockType={})).TEXT="text",BlockType2.LIST_ITEM="listItem",BlockType2.CHECKBOX="checkbox",BlockType2.IMAGE="image";class Block{constructor(raw){this.raw=raw,raw.startsWith("- []")?(this.type=BlockType.CHECKBOX,this.value=!1,this.raw=raw.substring(4).trim()):raw.startsWith("- [ ]")?(this.type=BlockType.CHECKBOX,this.value=!1,this.raw=raw.substring(5).trim()):raw.startsWith("- [x]")?(this.type=BlockType.CHECKBOX,this.value=!0,this.raw=raw.substring(5).trim()):raw.startsWith("- ")?(this.type=BlockType.LIST_ITEM,this.raw=raw.substring(2)):this.type=BlockType.TEXT}}class Image{constructor(altText,link){this.type="image",this.altText=altText,this.link=link}}class EventDescription{constructor(lines,matchedListItems,completed){this.tags=[],this.supplemental=[],this.locations=[],this.matchedListItems=matchedListItems;for(let i=0;i<lines.length;i++){let line=lines[i];if(!line.match(COMMENT_REGEX)){if(0===i&&(line=line.replace(IMAGE_REGEX,(match2,altText,link)=>(this.supplemental.push(new Image(altText,addHttpIfNeeded$1(link))),""))),line=line.replace(LOCATION_REGEX,(match2,locationString)=>(this.locations.push(locationString),"")),line=line.replace(TAG_REGEX,(match2,tag)=>(this.tags.includes(tag)||this.tags.push(tag),"")),0===i&&(line=line.replace(EVENT_ID_REGEX,(match2,id)=>this.id?id:(this.id=id.substring(1),""))),!this.percent){const percent=line.match(PERCENT_REGEX);percent&&(this.percent=parseInt(percent[0]))}lines[i]=line}}this.eventDescription=lines[0],this.supplemental=this.supplemental.concat(lines.slice(1).filter(l2=>!l2.match(COMMENT_REGEX)&&!!l2.trim()).map(raw=>{const image=(raw=raw.replace(TAG_REGEX,(match2,tag)=>(this.tags.includes(tag)||this.tags.push(tag),""))).match(IMAGE_REGEX);return image?new Image(image[1],addHttpIfNeeded$1(image[2])):new Block(raw.trim())})),this.completed=completed}}(RangeType2=RangeType||(RangeType={})).Comment="comment",RangeType2.CheckboxItemIndicator="checkboxItemIndicator",RangeType2.listItemIndicator="listItemIndicator",RangeType2.ListItemContents="listItemContents",RangeType2.Tag="tag",RangeType2.tagDefinition="tagDefinition",RangeType2.Title="title",RangeType2.View="view",RangeType2.Viewer="viewer",RangeType2.Description="description",RangeType2.Section="section",RangeType2.DateRange="dateRange",RangeType2.DateRangeColon="dateRangeColon",RangeType2.Event="event",RangeType2.Edit="edit",RangeType2.Editor="editor",RangeType2.Recurrence="recurrence",RangeType2.FrontmatterDelimiter="frontMatterDelimiter",RangeType2.HeaderKey="headerKey",RangeType2.HeaderKeyColon="headerKeyColon",RangeType2.HeaderValue="headerValue",RangeType2.PropertyKey="propertyKey",RangeType2.PropertyKeyColon="propertyKeyColon",RangeType2.PropertyValue="propertyValue",RangeType2.EventDefinition="eventDefinition",RangeType2.SectionDefinition="sectionDefinition";const toDateRangeIso=dr=>({fromDateTimeIso:dr.fromDateTime.toISO(),toDateTimeIso:dr.toDateTime.toISO()}),toDateRange=dr=>({fromDateTime:DateTime$1.fromISO(dr.fromDateTimeIso,{setZone:!0}),toDateTime:DateTime$1.fromISO(dr.toDateTimeIso,{setZone:!0})});function isEvent(eventy){return!eventy.children}class EventGroup{constructor(){this.propOrder=[],this.tags=[],this.title="",this.children=[]}}let Event$1=class{constructor(firstLine,properties,propOrder,dateRange,rangeInText,dateRangeInText,eventDescription,dateText){this.firstLine={full:firstLine,datePart:dateText,rest:dateRange.eventText,restTrimmed:eventDescription.eventDescription},this.properties=properties,this.propOrder=propOrder,this.textRanges={whole:rangeInText,datePart:dateRangeInText,definition:dateRangeInText,recurrence:dateRange.recurrenceRangeInText},this.dateRangeIso=toDateRangeIso(dateRange),this.recurrence=dateRange.recurrence,this.tags=eventDescription.tags,this.supplemental=eventDescription.supplemental,this.matchedListItems=eventDescription.matchedListItems,this.id=("string"==typeof properties.id?properties.id:void 0)||eventDescription.id,this.percent=eventDescription.percent,this.completed=eventDescription.completed,this.isRelative=dateRange.isRelative}};function*iter$1(eventy,path=[]){if(yield{eventy:eventy,path:path},eventy&&function(eventy){return!isEvent(eventy)}(eventy))for(let i=0;i<eventy.children.length;i++)yield*__yieldStar(iter$1(eventy.children[i],[...path,i]))}const push=(node,onto,path,tail)=>{if(path&&path.length){const{tail:newTail,path:newPath}=push(node,onto.children[path[0]],path.slice(1),tail);return{path:[path[0],...newPath],tail:newTail}}return onto.children.push(node),isEvent(node)?{path:[onto.children.length-1],tail:node}:{path:[onto.children.length-1,node.children.length],tail:tail}},get=(root,path)=>{if(!path.length)return root;const arr=root;return!arr.children.length||arr.children.length-1<path[0]?void 0:get(arr.children[path[0]],path.slice(1))};function getTimeFromRegExpMatch(eventStartMatches,meridiemHourIndex,meridiemMinuteIndex,meridiemIndex,time24HourHourIndex,time24HourMinuteIndex){const timeMeridiemHour=eventStartMatches[meridiemHourIndex],timeMeridiemMinute=eventStartMatches[meridiemMinuteIndex]||":00";let timeMeridiem=eventStartMatches[meridiemIndex];if(!timeMeridiem){const int2=parseInt(timeMeridiemHour);isNaN(int2)&&(timeMeridiem="am"),timeMeridiem=int2<9||12===int2?"pm":"am"}if(timeMeridiemHour)return{dateTimeIso:DateTime$1.fromFormat(`${timeMeridiemHour}${timeMeridiemMinute}${timeMeridiem}`,"h:mma").toISO(),granularity:":00"===timeMeridiemMinute?"hour":"minute"};const time24HourHour=eventStartMatches[time24HourHourIndex],time24HourMinute=eventStartMatches[time24HourMinuteIndex]||":00";return{dateTimeIso:DateTime$1.fromFormat(`${time24HourHour}${time24HourMinute}`,(2===time24HourHour.length&&"0"===time24HourHour[0]?"HH":"H")+":mm").toISO(),granularity:":00"===time24HourMinute?"hour":"minute"}}function fromCasualDate(eventStartMatches,context,monthFirstCasualMonthMonthFullMatchIndex,monthFirstCasualMonthDayMatchIndex,casualMonthAndDayYearMatchIndex,monthFirstCasualMonthMonthAbbrMatchIndex,dayFirstCasualMonthDayMatchIndex,dayFirstCasualMonthMonthFullMatchIndex,dayFirstCasualMonthMonthAbbrMatchIndex,casualMonthYearMatchIndex,casualMonthMonthFullMatchIndex,casualMonthMonthAbbrMatchIndex,timeMatch){let month=eventStartMatches[monthFirstCasualMonthMonthFullMatchIndex],day=eventStartMatches[monthFirstCasualMonthDayMatchIndex],year2=eventStartMatches[casualMonthAndDayYearMatchIndex]||`${context.zonedNow.year}`,date=month&&day&&parseAsCasualDayFullMonth(`${year2} ${month} ${parseInt(day)}`,context);if(month=eventStartMatches[monthFirstCasualMonthMonthAbbrMatchIndex],date=date||month&&day&&parseAsCasualDayAbbrMonth(`${year2} ${month} ${parseInt(day)}`,context),day=eventStartMatches[dayFirstCasualMonthDayMatchIndex],month=eventStartMatches[dayFirstCasualMonthMonthFullMatchIndex],date=date||month&&day&&parseAsCasualDayFullMonth(`${year2} ${month} ${parseInt(day)}`,context),month=eventStartMatches[dayFirstCasualMonthMonthAbbrMatchIndex],date=date||month&&day&&parseAsCasualDayAbbrMonth(`${year2} ${month} ${parseInt(day)}`,context),date){if(timeMatch){const dt=DateTime$1.fromISO(date.dateTimeIso,{setZone:!0,zone:context.timezone}),timeMatchIso=DateTime$1.fromISO(timeMatch.dateTimeIso,{setZone:!0,zone:context.timezone});date.dateTimeIso=dt.set({hour:timeMatchIso.hour,minute:timeMatchIso.minute}).toISO(),date.granularity=timeMatch.granularity}return date}return year2=eventStartMatches[casualMonthYearMatchIndex]||`${context.zonedNow.year}`,month=eventStartMatches[casualMonthMonthFullMatchIndex],month?{dateTimeIso:DateTime$1.fromFormat(`${year2} ${month}`,"y MMMM",{setZone:!0,zone:context.timezone}).toISO(),granularity:"month"}:(month=eventStartMatches[casualMonthMonthAbbrMatchIndex],month?{dateTimeIso:DateTime$1.fromFormat(`${year2} ${month}`,"y MMM",{setZone:!0,zone:context.timezone}).toISO(),granularity:"month"}:void 0)}function parseAsCasualDayFullMonth(s2,context){return{dateTimeIso:DateTime$1.fromFormat(s2,"y MMMM d",{setZone:!0,zone:context.timezone}).toISO(),granularity:"day"}}function parseAsCasualDayAbbrMonth(s2,context){return{dateTimeIso:DateTime$1.fromFormat(s2,"y MMM d",{setZone:!0,zone:context.timezone}).toISO(),granularity:"day"}}function parseSlashDate(s2,fullFormat,context){var _a2,_b2;fullFormat="string"==typeof fullFormat&&fullFormat||"M/d/y";const cacheKey=JSON.stringify({s:s2,fullFormat:fullFormat}),cached=null==(_a2=context.cache)?void 0:_a2.zone(context.timezone).slashDate.get(cacheKey);if(cached)return cached;const formatsAndGranularities=[[fullFormat,"day"],["M/y","month"],["y","year"]];for(const f of formatsAndGranularities){let dateTime=DateTime$1.fromFormat(s2,f[0],{setZone:!0,zone:context.timezone});if(dateTime.isValid){const gdt={dateTimeIso:dateTime.toISO(),granularity:f[1]};return null==(_b2=context.cache)||_b2.zone(context.timezone).slashDate.set(cacheKey,gdt),gdt}}}function roundDateUp(granularDateTime,context){var _a2;const cacheKey=JSON.stringify(granularDateTime),cached=null==(_a2=context.cache)?void 0:_a2.zone(context.timezone).roundDateUp.get(cacheKey);if(cached)return cached;const cacheAndReturn2=s2=>{var _a3;return null==(_a3=context.cache)||_a3.zone(context.timezone).roundDateUp.set(cacheKey,s2),s2},dt=DateTime$1.fromISO(granularDateTime.dateTimeIso,{setZone:!0,zone:context.timezone});return dt.isValid?["instant","hour","minute","second"].includes(granularDateTime.granularity)?cacheAndReturn2(granularDateTime.dateTimeIso):cacheAndReturn2(dt.plus({[granularDateTime.granularity]:1}).toISO()):cacheAndReturn2(granularDateTime.dateTimeIso)}function getYearNotationToDatetime(year2,yearNotation,context){return"string"==typeof year2&&(year2=parseInt(year2)),!yearNotation||"BCE"!==yearNotation&&"BC"!==yearNotation||(year2=-(year2-1)),DateTime$1.fromObject({year:year2},{zone:context.timezone})}const ALL_WEEKDAYS=["MO","TU","WE","TH","FR","SA","SU"];class Weekday{constructor(weekday,n2){if(0===n2)throw new Error("Can't create weekday with n == 0");this.weekday=weekday,this.n=n2}static fromStr(str){return new Weekday(ALL_WEEKDAYS.indexOf(str))}nth(n2){return this.n===n2?this:new Weekday(this.weekday,n2)}equals(other){return this.weekday===other.weekday&&this.n===other.n}toString(){let s2=ALL_WEEKDAYS[this.weekday];return this.n&&(s2=(this.n>0?"+":"")+String(this.n)+s2),s2}getJsWeekday(){return 6===this.weekday?0:this.weekday+1}}const isPresent=function(value){return null!=value},isNumber=function(value){return"number"==typeof value},isWeekdayStr=function(value){return"string"==typeof value&&ALL_WEEKDAYS.includes(value)},isArray$1=Array.isArray,range=function(start,end=start){1===arguments.length&&(end=start,start=0);const rang=[];for(let i=start;i<end;i++)rang.push(i);return rang},repeat=function(value,times){let i=0;const array=[];if(isArray$1(value))for(;i<times;i++)array[i]=[].concat(value);else for(;i<times;i++)array[i]=value;return array},toArray=function(item){return isArray$1(item)?item:[item]};function padStart(item,targetLength,padString=" "){const str=String(item);return targetLength|=0,str.length>targetLength?String(str):((targetLength-=str.length)>padString.length&&(padString+=repeat(padString,targetLength/padString.length)),padString.slice(0,targetLength)+String(str))}const pymod=function(a,b){const r=a%b;return r*b<0?r+b:r},divmod=function(a,b){return{div:Math.floor(a/b),mod:pymod(a,b)}},empty$1=function(obj){return!isPresent(obj)||0===obj.length},notEmpty=function(obj){return!empty$1(obj)},includes=function(arr,val){return notEmpty(arr)&&-1!==arr.indexOf(val)},datetime=function(y,m,d,h2=0,i=0,s2=0){return new Date(Date.UTC(y,m-1,d,h2,i,s2))},MONTH_DAYS=[31,28,31,30,31,30,31,31,30,31,30,31],ORDINAL_BASE=datetime(1970,1,1),PY_WEEKDAYS=[6,0,1,2,3,4,5],isLeapYear=function(year2){return year2%4==0&&year2%100!=0||year2%400==0},isDate=function(value){return value instanceof Date},isValidDate=function(value){return isDate(value)&&!isNaN(value.getTime())},toOrdinal=function(date){return function(date1,date2){const differencems=date1.getTime()-date2.getTime();return Math.round(differencems/864e5)}(date,ORDINAL_BASE)},fromOrdinal=function(ordinal){return new Date(ORDINAL_BASE.getTime()+864e5*ordinal)},getMonthDays=function(date){const month=date.getUTCMonth();return 1===month&&isLeapYear(date.getUTCFullYear())?29:MONTH_DAYS[month]},getWeekday=function(date){return PY_WEEKDAYS[date.getUTCDay()]},monthRange=function(year2,month){const date=datetime(year2,month+1,1);return[getWeekday(date),getMonthDays(date)]},combine=function(date,time){return time=time||date,new Date(Date.UTC(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),time.getHours(),time.getMinutes(),time.getSeconds(),time.getMilliseconds()))},clone$1=function(date){return new Date(date.getTime())},cloneDates=function(dates){const clones=[];for(let i=0;i<dates.length;i++)clones.push(clone$1(dates[i]));return clones},sort=function(dates){dates.sort(function(a,b){return a.getTime()-b.getTime()})},timeToUntilString=function(time,utc=!0){const date=new Date(time);return[padStart(date.getUTCFullYear().toString(),4,"0"),padStart(date.getUTCMonth()+1,2,"0"),padStart(date.getUTCDate(),2,"0"),"T",padStart(date.getUTCHours(),2,"0"),padStart(date.getUTCMinutes(),2,"0"),padStart(date.getUTCSeconds(),2,"0"),utc?"Z":""].join("")},untilStringToDate=function(until){const bits=/^(\d{4})(\d{2})(\d{2})(T(\d{2})(\d{2})(\d{2})Z?)?$/.exec(until);if(!bits)throw new Error(`Invalid UNTIL value: ${until}`);return new Date(Date.UTC(parseInt(bits[1],10),parseInt(bits[2],10)-1,parseInt(bits[3],10),parseInt(bits[5],10)||0,parseInt(bits[6],10)||0,parseInt(bits[7],10)||0))},dateTZtoISO8601=function(date,timeZone){return date.toLocaleString("sv-SE",{timeZone:timeZone}).replace(" ","T")+"Z"};class IterResult{constructor(method,args){this.minDate=null,this.maxDate=null,this._result=[],this.total=0,this.method=method,this.args=args,"between"===method?(this.maxDate=args.inc?args.before:new Date(args.before.getTime()-1),this.minDate=args.inc?args.after:new Date(args.after.getTime()+1)):"before"===method?this.maxDate=args.inc?args.dt:new Date(args.dt.getTime()-1):"after"===method&&(this.minDate=args.inc?args.dt:new Date(args.dt.getTime()+1))}accept(date){++this.total;const tooEarly=this.minDate&&date<this.minDate,tooLate=this.maxDate&&date>this.maxDate;if("between"===this.method){if(tooEarly)return!0;if(tooLate)return!1}else if("before"===this.method){if(tooLate)return!1}else if("after"===this.method)return!!tooEarly||(this.add(date),!1);return this.add(date)}add(date){return this._result.push(date),!0}getValue(){const res=this._result;switch(this.method){case"all":case"between":return res;default:return res.length?res[res.length-1]:null}}clone(){return new IterResult(this.method,this.args)}}class CallbackIterResult extends IterResult{constructor(method,args,iterator2){super(method,args),this.iterator=iterator2}add(date){return!!this.iterator(date,this._result.length)&&(this._result.push(date),!0)}}const ENGLISH={dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],tokens:{SKIP:/^[ \r\n\t]+|^\.$/,number:/^[1-9][0-9]*/,numberAsText:/^(one|two|three)/i,every:/^every/i,"day(s)":/^days?/i,"weekday(s)":/^(weekdays?|business\s+days?|work\s+days?)/i,"week(s)":/^(weeks?|wks?|weekly)/i,"hour(s)":/^(hours?|hrs?|hourly)/i,"minute(s)":/^(minutes?|mins?)/i,"month(s)":/^(months?|monthly)/i,"year(s)":/^(years?|yearly|annually)/i,on:/^(on|in)/i,at:/^(at|@)/i,the:/^the/i,first:/^first/i,second:/^second/i,third:/^third/i,nth:/^([1-9][0-9]*)(\.|th|nd|rd|st)/i,last:/^last/i,for:/^(for|x)/i,"time(s)":/^times?/i,until:/^((un)?til)|\|/i,monday:/^(mo\.?(n\.?(days?)?)?)/i,tuesday:/^(tu\.?(e\.?(s\.?(days?)?)?)?)/i,wednesday:/^(we\.?(d\.?(n\.?(esdays?)?)?)?)/i,thursday:/^(th\.?(u\.?(r\.?(s\.?(days?)?)?)?)?)/i,friday:/^(fr\.?(i\.?(days?)?)?)/i,saturday:/^(sa\.?(t\.?(urdays?)?)?)/i,sunday:/^(su\.?(n\.?(days?)?)?)/i,january:/^(jan\.?(uary)?)/i,february:/^(feb\.?(ruary)?)/i,march:/^(mar\.?(ch)?)/i,april:/^(apr\.?(il)?)/i,may:/^may/i,june:/^(june?|jun\.)/i,july:/^(july?|jul\.)/i,august:/^(aug(ust)?|aug\.)/i,september:/^(sep(t(ember)?)?|sept\.|sep\.)/i,october:/^(oct(ober)?|oct\.)/i,november:/^(nov(ember)?|nov\.)/i,december:/^(dec(ember)?|dec\.)/i,comma:/^(,\s*|(and|or|&)\s*)+/i}},contains=function(arr,val){return-1!==arr.indexOf(val)},defaultGetText=id=>id.toString(),defaultDateFormatter=(year2,month,day)=>`${month} ${day}, ${year2}`;class ToText{constructor(rrule2,gettext=defaultGetText,language=ENGLISH,dateFormatter=defaultDateFormatter){if(this.text=[],this.language=language||ENGLISH,this.gettext=gettext,this.dateFormatter=dateFormatter,this.rrule=rrule2,this.options=rrule2.options,this.origOptions=rrule2.origOptions,this.origOptions.bymonthday){const bymonthday=[].concat(this.options.bymonthday),bynmonthday=[].concat(this.options.bynmonthday);bymonthday.sort((a,b)=>a-b),bynmonthday.sort((a,b)=>b-a),this.bymonthday=bymonthday.concat(bynmonthday),this.bymonthday.length||(this.bymonthday=null)}if(isPresent(this.origOptions.byweekday)){const byweekday=isArray$1(this.origOptions.byweekday)?this.origOptions.byweekday:[this.origOptions.byweekday],days=String(byweekday);this.byweekday={allWeeks:byweekday.filter(function(weekday){return!weekday.n}),someWeeks:byweekday.filter(function(weekday){return Boolean(weekday.n)}),isWeekdays:-1!==days.indexOf("MO")&&-1!==days.indexOf("TU")&&-1!==days.indexOf("WE")&&-1!==days.indexOf("TH")&&-1!==days.indexOf("FR")&&-1===days.indexOf("SA")&&-1===days.indexOf("SU"),isEveryDay:-1!==days.indexOf("MO")&&-1!==days.indexOf("TU")&&-1!==days.indexOf("WE")&&-1!==days.indexOf("TH")&&-1!==days.indexOf("FR")&&-1!==days.indexOf("SA")&&-1!==days.indexOf("SU")};const sortWeekDays=function(a,b){return a.weekday-b.weekday};this.byweekday.allWeeks.sort(sortWeekDays),this.byweekday.someWeeks.sort(sortWeekDays),this.byweekday.allWeeks.length||(this.byweekday.allWeeks=null),this.byweekday.someWeeks.length||(this.byweekday.someWeeks=null)}else this.byweekday=null}static isFullyConvertible(rrule2){if(!(rrule2.options.freq in ToText.IMPLEMENTED))return!1;if(rrule2.origOptions.until&&rrule2.origOptions.count)return!1;for(const key in rrule2.origOptions){if(contains(["dtstart","tzid","wkst","freq"],key))return!0;if(!contains(ToText.IMPLEMENTED[rrule2.options.freq],key))return!1}return!0}isFullyConvertible(){return ToText.isFullyConvertible(this.rrule)}toString(){const gettext=this.gettext;if(!(this.options.freq in ToText.IMPLEMENTED))return gettext("RRule error: Unable to fully convert this rrule to text");if(this.text=[gettext("every")],this[RRule$1.FREQUENCIES[this.options.freq]](),this.options.until){this.add(gettext("until"));const until=this.options.until;this.add(this.dateFormatter(until.getUTCFullYear(),this.language.monthNames[until.getUTCMonth()],until.getUTCDate()))}else this.options.count&&this.add(gettext("for")).add(this.options.count.toString()).add(this.plural(this.options.count)?gettext("times"):gettext("time"));return this.isFullyConvertible()||this.add(gettext("(~ approximate)")),this.text.join("")}HOURLY(){const gettext=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?gettext("hours"):gettext("hour"))}MINUTELY(){const gettext=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?gettext("minutes"):gettext("minute"))}DAILY(){const gettext=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()),this.byweekday&&this.byweekday.isWeekdays?this.add(this.plural(this.options.interval)?gettext("weekdays"):gettext("weekday")):this.add(this.plural(this.options.interval)?gettext("days"):gettext("day")),this.origOptions.bymonth&&(this.add(gettext("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday?this._byweekday():this.origOptions.byhour&&this._byhour()}WEEKLY(){const gettext=this.gettext;1!==this.options.interval&&this.add(this.options.interval.toString()).add(this.plural(this.options.interval)?gettext("weeks"):gettext("week")),this.byweekday&&this.byweekday.isWeekdays?1===this.options.interval?this.add(this.plural(this.options.interval)?gettext("weekdays"):gettext("weekday")):this.add(gettext("on")).add(gettext("weekdays")):this.byweekday&&this.byweekday.isEveryDay?this.plural(this.options.interval)?this.add(gettext("on")).add(gettext("every")).add(gettext("day")):this.add(gettext("day")):(1===this.options.interval&&this.add(gettext("week")),this.origOptions.bymonth&&(this.add(gettext("in")),this._bymonth()),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.origOptions.byhour&&this._byhour())}MONTHLY(){const gettext=this.gettext;this.origOptions.bymonth?(1!==this.options.interval&&(this.add(this.options.interval.toString()).add(gettext("months")),this.plural(this.options.interval)&&this.add(gettext("in"))),this._bymonth()):(1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?gettext("months"):gettext("month"))),this.bymonthday?this._bymonthday():this.byweekday&&this.byweekday.isWeekdays?this.add(gettext("on")).add(gettext("weekdays")):this.byweekday&&this._byweekday()}YEARLY(){const gettext=this.gettext;this.origOptions.bymonth?(1!==this.options.interval&&(this.add(this.options.interval.toString()),this.add(gettext("years"))),this._bymonth()):(1!==this.options.interval&&this.add(this.options.interval.toString()),this.add(this.plural(this.options.interval)?gettext("years"):gettext("year"))),this.bymonthday?this._bymonthday():this.byweekday&&this._byweekday(),this.options.byyearday&&this.add(gettext("on the")).add(this.list(this.options.byyearday,this.nth,gettext("and"))).add(gettext("day")),this.options.byweekno&&this.add(gettext("in")).add(this.plural(this.options.byweekno.length)?gettext("weeks"):gettext("week")).add(this.list(this.options.byweekno,void 0,gettext("and")))}_bymonthday(){const gettext=this.gettext;this.byweekday&&this.byweekday.allWeeks?this.add(gettext("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext,gettext("or"))).add(gettext("the")).add(this.list(this.bymonthday,this.nth,gettext("or"))):this.add(gettext("on the")).add(this.list(this.bymonthday,this.nth,gettext("and")))}_byweekday(){const gettext=this.gettext;this.byweekday.allWeeks&&!this.byweekday.isWeekdays&&this.add(gettext("on")).add(this.list(this.byweekday.allWeeks,this.weekdaytext)),this.byweekday.someWeeks&&(this.byweekday.allWeeks&&this.add(gettext("and")),this.add(gettext("on the")).add(this.list(this.byweekday.someWeeks,this.weekdaytext,gettext("and"))))}_byhour(){const gettext=this.gettext;this.add(gettext("at")).add(this.list(this.origOptions.byhour,void 0,gettext("and")))}_bymonth(){this.add(this.list(this.options.bymonth,this.monthtext,this.gettext("and")))}nth(n2){let nth;n2=parseInt(n2.toString(),10);const gettext=this.gettext;if(-1===n2)return gettext("last");const npos=Math.abs(n2);switch(npos){case 1:case 21:case 31:nth=npos+gettext("st");break;case 2:case 22:nth=npos+gettext("nd");break;case 3:case 23:nth=npos+gettext("rd");break;default:nth=npos+gettext("th")}return n2<0?nth+" "+gettext("last"):nth}monthtext(m){return this.language.monthNames[m-1]}weekdaytext(wday){const weekday=isNumber(wday)?(wday+1)%7:wday.getJsWeekday();return(wday.n?this.nth(wday.n)+" ":"")+this.language.dayNames[weekday]}plural(n2){return n2%100!=1}add(s2){return this.text.push(" "),this.text.push(s2),this}list(arr,callback,finalDelim,delim=","){isArray$1(arr)||(arr=[arr]);callback=callback||function(o){return o.toString()};const realCallback=arg=>callback&&callback.call(this,arg);return finalDelim?function(array,delimiter,finalDelimiter){let list="";for(let i=0;i<array.length;i++)0!==i&&(i===array.length-1?list+=" "+finalDelimiter+" ":list+=delimiter+" "),list+=array[i];return list}(arr.map(realCallback),delim,finalDelim):arr.map(realCallback).join(delim+" ")}}let Parser$1=class{constructor(rules){this.done=!0,this.rules=rules}start(text){return this.text=text,this.done=!1,this.nextSymbol()}isDone(){return this.done&&null===this.symbol}nextSymbol(){let best,bestSymbol;this.symbol=null,this.value=null;do{if(this.done)return!1;let rule;best=null;for(const name in this.rules){rule=this.rules[name];const match2=rule.exec(this.text);match2&&(null===best||match2[0].length>best[0].length)&&(best=match2,bestSymbol=name)}if(null!=best&&(this.text=this.text.substr(best[0].length),""===this.text&&(this.done=!0)),null==best)return this.done=!0,this.symbol=null,void(this.value=null)}while("SKIP"===bestSymbol);return this.symbol=bestSymbol,this.value=best,!0}accept(name){if(this.symbol===name){if(this.value){const v=this.value;return this.nextSymbol(),v}return this.nextSymbol(),!0}return!1}acceptNumber(){return this.accept("number")}expect(name){if(this.accept(name))return!0;throw new Error("expected "+name+" but found "+this.symbol)}};function parseText(text,language=ENGLISH){const options={},ttr=new Parser$1(language.tokens);return ttr.start(text)?(function(){ttr.expect("every");const n2=ttr.acceptNumber();n2&&(options.interval=parseInt(n2[0],10));if(ttr.isDone())throw new Error("Unexpected end");switch(ttr.symbol){case"day(s)":if(options.freq=RRule$1.DAILY,ttr.nextSymbol(),!ttr.isDone()){if(ttr.accept("on")){const m=decodeM();m&&(options.bymonth=[m],ttr.nextSymbol())}AT(),F()}break;case"weekday(s)":options.freq=RRule$1.WEEKLY,options.byweekday=[RRule$1.MO,RRule$1.TU,RRule$1.WE,RRule$1.TH,RRule$1.FR],ttr.nextSymbol(),AT(),F();break;case"week(s)":options.freq=RRule$1.WEEKLY,ttr.nextSymbol()&&(ON(),AT(),F());break;case"hour(s)":options.freq=RRule$1.HOURLY,ttr.nextSymbol()&&(ON(),F());break;case"minute(s)":options.freq=RRule$1.MINUTELY,ttr.nextSymbol()&&(ON(),F());break;case"month(s)":options.freq=RRule$1.MONTHLY,ttr.nextSymbol()&&(ON(),F());break;case"year(s)":options.freq=RRule$1.YEARLY,ttr.nextSymbol()&&(ON(),F());break;case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":options.freq=RRule$1.WEEKLY;const key=ttr.symbol.substr(0,2).toUpperCase();if(options.byweekday=[RRule$1[key]],!ttr.nextSymbol())return;for(;ttr.accept("comma");){if(ttr.isDone())throw new Error("Unexpected end");const wkd=decodeWKD();if(!wkd)throw new Error("Unexpected symbol "+ttr.symbol+", expected weekday");options.byweekday.push(RRule$1[wkd]),ttr.nextSymbol()}AT(),function(){ttr.accept("on"),ttr.accept("the");let nth=decodeNTH();if(!nth)return;options.bymonthday=[nth],ttr.nextSymbol();for(;ttr.accept("comma");){if(nth=decodeNTH(),!nth)throw new Error("Unexpected symbol "+ttr.symbol+"; expected monthday");options.bymonthday.push(nth),ttr.nextSymbol()}}(),F();break;case"january":case"february":case"march":case"april":case"may":case"june":case"july":case"august":case"september":case"october":case"november":case"december":if(options.freq=RRule$1.YEARLY,options.bymonth=[decodeM()],!ttr.nextSymbol())return;for(;ttr.accept("comma");){if(ttr.isDone())throw new Error("Unexpected end");const m=decodeM();if(!m)throw new Error("Unexpected symbol "+ttr.symbol+", expected month");options.bymonth.push(m),ttr.nextSymbol()}ON(),F();break;default:throw new Error(`Unknown symbol: ${ttr.symbol}`)}}(),options.byweekday&&Array.isArray(options.byweekday)&&(options.byweekday=[...new Set(options.byweekday)]),options.bymonth&&Array.isArray(options.bymonth)&&(options.bymonth=[...new Set(options.bymonth)]),options):null;function ON(){const on=ttr.accept("on"),the=ttr.accept("the");if(!on&&!the)return;if(ttr.accept("every")){return void(ttr.accept("day(s)")&&(options.byweekday=[RRule$1.MO,RRule$1.TU,RRule$1.WE,RRule$1.TH,RRule$1.FR,RRule$1.SA,RRule$1.SU]))}do{const nth=decodeNTH(),wkd=decodeWKD(),m=decodeM();if(nth)wkd?(ttr.nextSymbol(),options.byweekday||(options.byweekday=[]),options.byweekday.push(RRule$1[wkd].nth(nth))):(options.bymonthday||(options.bymonthday=[]),options.bymonthday.push(nth),ttr.accept("day(s)"));else if(wkd)ttr.nextSymbol(),options.byweekday||(options.byweekday=[]),options.byweekday.push(RRule$1[wkd]);else if("weekday(s)"===ttr.symbol)ttr.nextSymbol(),options.byweekday||(options.byweekday=[RRule$1.MO,RRule$1.TU,RRule$1.WE,RRule$1.TH,RRule$1.FR]);else if("week(s)"===ttr.symbol){ttr.nextSymbol();let n2=ttr.acceptNumber();if(!n2)throw new Error("Unexpected symbol "+ttr.symbol+", expected week number");for(options.byweekno=[parseInt(n2[0],10)];ttr.accept("comma");){if(n2=ttr.acceptNumber(),!n2)throw new Error("Unexpected symbol "+ttr.symbol+"; expected monthday");options.byweekno.push(parseInt(n2[0],10))}}else{if(!m)return;ttr.nextSymbol(),options.bymonth||(options.bymonth=[]),options.bymonth.push(m)}}while(ttr.accept("comma")||ttr.accept("the")||ttr.accept("on"))}function AT(){if(ttr.accept("at"))do{let n2=ttr.acceptNumber();if(!n2)throw new Error("Unexpected symbol "+ttr.symbol+", expected hour");for(options.byhour=[parseInt(n2[0],10)];ttr.accept("comma");){if(n2=ttr.acceptNumber(),!n2)throw new Error("Unexpected symbol "+ttr.symbol+"; expected hour");options.byhour.push(parseInt(n2[0],10))}}while(ttr.accept("comma")||ttr.accept("at"))}function decodeM(){switch(ttr.symbol){case"january":return 1;case"february":return 2;case"march":return 3;case"april":return 4;case"may":return 5;case"june":return 6;case"july":return 7;case"august":return 8;case"september":return 9;case"october":return 10;case"november":return 11;case"december":return 12;default:return!1}}function decodeWKD(){switch(ttr.symbol){case"monday":case"tuesday":case"wednesday":case"thursday":case"friday":case"saturday":case"sunday":return ttr.symbol.substr(0,2).toUpperCase();default:return!1}}function decodeNTH(){switch(ttr.symbol){case"last":return ttr.nextSymbol(),-1;case"first":return ttr.nextSymbol(),1;case"second":return ttr.nextSymbol(),ttr.accept("last")?-2:2;case"third":return ttr.nextSymbol(),ttr.accept("last")?-3:3;case"nth":const v=parseInt(ttr.value[1],10);if(v<-366||v>366)throw new Error("Nth out of range: "+v);return ttr.nextSymbol(),ttr.accept("last")?-v:v;default:return!1}}function F(){if("until"===ttr.symbol){const date="now"===ttr.text.trim()?Date.now():Date.parse(ttr.text);if(!date)throw new Error("Cannot parse until date:"+ttr.text);options.until=new Date(date)}else ttr.accept("for")&&(options.count=parseInt(ttr.value[0],10),ttr.expect("number"))}}var Frequency,Frequency2;function freqIsDailyOrGreater(freq){return freq<Frequency.HOURLY}(Frequency2=Frequency||(Frequency={}))[Frequency2.YEARLY=0]="YEARLY",Frequency2[Frequency2.MONTHLY=1]="MONTHLY",Frequency2[Frequency2.WEEKLY=2]="WEEKLY",Frequency2[Frequency2.DAILY=3]="DAILY",Frequency2[Frequency2.HOURLY=4]="HOURLY",Frequency2[Frequency2.MINUTELY=5]="MINUTELY",Frequency2[Frequency2.SECONDLY=6]="SECONDLY";const common=["count","until","interval","byweekday","bymonthday","bymonth"];ToText.IMPLEMENTED=[],ToText.IMPLEMENTED[Frequency.HOURLY]=common,ToText.IMPLEMENTED[Frequency.MINUTELY]=common,ToText.IMPLEMENTED[Frequency.DAILY]=["byhour"].concat(common),ToText.IMPLEMENTED[Frequency.WEEKLY]=common,ToText.IMPLEMENTED[Frequency.MONTHLY]=common,ToText.IMPLEMENTED[Frequency.YEARLY]=["byweekno","byyearday"].concat(common);const{isFullyConvertible:isFullyConvertible}=ToText;let Time$1=class{constructor(hour,minute,second,millisecond){this.hour=hour,this.minute=minute,this.second=second,this.millisecond=millisecond||0}getHours(){return this.hour}getMinutes(){return this.minute}getSeconds(){return this.second}getMilliseconds(){return this.millisecond}getTime(){return 1e3*(60*this.hour*60+60*this.minute+this.second)+this.millisecond}};class DateTime extends Time$1{constructor(year2,month,day,hour,minute,second,millisecond){super(hour,minute,second,millisecond),this.year=year2,this.month=month,this.day=day}static fromDate(date){return new this(date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds(),date.valueOf()%1e3)}getWeekday(){return getWeekday(new Date(this.getTime()))}getTime(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond)).getTime()}getDay(){return this.day}getMonth(){return this.month}getYear(){return this.year}addYears(years){this.year+=years}addMonths(months2){if(this.month+=months2,this.month>12){const yearDiv=Math.floor(this.month/12),monthMod=pymod(this.month,12);this.month=monthMod,this.year+=yearDiv,0===this.month&&(this.month=12,--this.year)}}addWeekly(days,wkst){wkst>this.getWeekday()?this.day+=-(this.getWeekday()+1+(6-wkst))+7*days:this.day+=-(this.getWeekday()-wkst)+7*days,this.fixDay()}addDaily(days){this.day+=days,this.fixDay()}addHours(hours,filtered,byhour){for(filtered&&(this.hour+=Math.floor((23-this.hour)/hours)*hours);;){this.hour+=hours;const{div:dayDiv,mod:hourMod}=divmod(this.hour,24);if(dayDiv&&(this.hour=hourMod,this.addDaily(dayDiv)),empty$1(byhour)||includes(byhour,this.hour))break}}addMinutes(minutes,filtered,byhour,byminute){for(filtered&&(this.minute+=Math.floor((1439-(60*this.hour+this.minute))/minutes)*minutes);;){this.minute+=minutes;const{div:hourDiv,mod:minuteMod}=divmod(this.minute,60);if(hourDiv&&(this.minute=minuteMod,this.addHours(hourDiv,!1,byhour)),(empty$1(byhour)||includes(byhour,this.hour))&&(empty$1(byminute)||includes(byminute,this.minute)))break}}addSeconds(seconds,filtered,byhour,byminute,bysecond){for(filtered&&(this.second+=Math.floor((86399-(3600*this.hour+60*this.minute+this.second))/seconds)*seconds);;){this.second+=seconds;const{div:minuteDiv,mod:secondMod}=divmod(this.second,60);if(minuteDiv&&(this.second=secondMod,this.addMinutes(minuteDiv,!1,byhour,byminute)),(empty$1(byhour)||includes(byhour,this.hour))&&(empty$1(byminute)||includes(byminute,this.minute))&&(empty$1(bysecond)||includes(bysecond,this.second)))break}}fixDay(){if(this.day<=28)return;let daysinmonth=monthRange(this.year,this.month-1)[1];if(!(this.day<=daysinmonth))for(;this.day>daysinmonth;){if(this.day-=daysinmonth,++this.month,13===this.month&&(this.month=1,++this.year,this.year>9999))return;daysinmonth=monthRange(this.year,this.month-1)[1]}}add(options,filtered){const{freq:freq,interval:interval,wkst:wkst,byhour:byhour,byminute:byminute,bysecond:bysecond}=options;switch(freq){case Frequency.YEARLY:return this.addYears(interval);case Frequency.MONTHLY:return this.addMonths(interval);case Frequency.WEEKLY:return this.addWeekly(interval,wkst);case Frequency.DAILY:return this.addDaily(interval);case Frequency.HOURLY:return this.addHours(interval,filtered,byhour);case Frequency.MINUTELY:return this.addMinutes(interval,filtered,byhour,byminute);case Frequency.SECONDLY:return this.addSeconds(interval,filtered,byhour,byminute,bysecond)}}}function initializeOptions$1(options){const invalid=[],keys=Object.keys(options);for(const key of keys)includes(defaultKeys,key)||invalid.push(key),isDate(options[key])&&!isValidDate(options[key])&&invalid.push(key);if(invalid.length)throw new Error("Invalid options: "+invalid.join(", "));return Object.assign({},options)}function parseString(rfcString){const options=rfcString.split("\n").map(parseLine).filter(x=>null!==x);return Object.assign(Object.assign({},options[0]),options[1])}function parseDtstart(line){const options={},dtstartWithZone=/DTSTART(?:;TZID=([^:=]+?))?(?::|=)([^;\s]+)/i.exec(line);if(!dtstartWithZone)return options;const[,tzid,dtstart]=dtstartWithZone;return tzid&&(options.tzid=tzid),options.dtstart=untilStringToDate(dtstart),options}function parseLine(rfcString){if(!(rfcString=rfcString.replace(/^\s+|\s+$/,"")).length)return null;const header=/^([A-Z]+?)[:;]/.exec(rfcString.toUpperCase());if(!header)return parseRrule(rfcString);const[,key]=header;switch(key.toUpperCase()){case"RRULE":case"EXRULE":return parseRrule(rfcString);case"DTSTART":return parseDtstart(rfcString);default:throw new Error(`Unsupported RFC prop ${key} in ${rfcString}`)}}function parseRrule(line){const options=parseDtstart(line.replace(/^RRULE:/i,""));return line.replace(/^(?:RRULE|EXRULE):/i,"").split(";").forEach(attr=>{const[key,value]=attr.split("=");switch(key.toUpperCase()){case"FREQ":options.freq=Frequency[value.toUpperCase()];break;case"WKST":options.wkst=Days[value.toUpperCase()];break;case"COUNT":case"INTERVAL":case"BYSETPOS":case"BYMONTH":case"BYMONTHDAY":case"BYYEARDAY":case"BYWEEKNO":case"BYHOUR":case"BYMINUTE":case"BYSECOND":const num=function(value){if(-1!==value.indexOf(",")){return value.split(",").map(parseIndividualNumber)}return parseIndividualNumber(value)}(value),optionKey=key.toLowerCase();options[optionKey]=num;break;case"BYWEEKDAY":case"BYDAY":options.byweekday=function(value){const days=value.split(",");return days.map(day=>{if(2===day.length)return Days[day];const parts=day.match(/^([+-]?\d{1,2})([A-Z]{2})$/);if(!parts||parts.length<3)throw new SyntaxError(`Invalid weekday string: ${day}`);const n2=Number(parts[1]),wdaypart=parts[2],wday=Days[wdaypart].weekday;return new Weekday(wday,n2)})}(value);break;case"DTSTART":case"TZID":const dtstart=parseDtstart(line);options.tzid=dtstart.tzid,options.dtstart=dtstart.dtstart;break;case"UNTIL":options.until=untilStringToDate(value);break;case"BYEASTER":options.byeaster=Number(value);break;default:throw new Error("Unknown RRULE property '"+key+"'")}}),options}function parseIndividualNumber(value){return/^[+-]?\d+$/.test(value)?Number(value):value}class DateWithZone{constructor(date,tzid){if(isNaN(date.getTime()))throw new RangeError("Invalid date passed to DateWithZone");this.date=date,this.tzid=tzid}get isUTC(){return!this.tzid||"UTC"===this.tzid.toUpperCase()}toString(){const datestr=timeToUntilString(this.date.getTime(),this.isUTC);return this.isUTC?`:${datestr}`:`;TZID=${this.tzid}:${datestr}`}getTime(){return this.date.getTime()}rezonedDate(){return this.isUTC?this.date:function(date,timeZone){const localTimeZone=Intl.DateTimeFormat().resolvedOptions().timeZone,dateInLocalTZ=new Date(dateTZtoISO8601(date,localTimeZone)),tzOffset=new Date(dateTZtoISO8601(date,null!=timeZone?timeZone:"UTC")).getTime()-dateInLocalTZ.getTime();return new Date(date.getTime()-tzOffset)}(this.date,this.tzid)}}function optionsToString(options){const rrule2=[];let dtstart="";const keys=Object.keys(options),defaultKeys2=Object.keys(DEFAULT_OPTIONS$1);for(let i=0;i<keys.length;i++){if("tzid"===keys[i])continue;if(!includes(defaultKeys2,keys[i]))continue;let key=keys[i].toUpperCase();const value=options[keys[i]];let outValue="";if(isPresent(value)&&(!isArray$1(value)||value.length)){switch(key){case"FREQ":outValue=RRule$1.FREQUENCIES[options.freq];break;case"WKST":outValue=isNumber(value)?new Weekday(value).toString():value.toString();break;case"BYWEEKDAY":key="BYDAY",outValue=toArray(value).map(wday=>wday instanceof Weekday?wday:isArray$1(wday)?new Weekday(wday[0],wday[1]):new Weekday(wday)).toString();break;case"DTSTART":dtstart=buildDtstart(value,options.tzid);break;case"UNTIL":outValue=timeToUntilString(value,!options.tzid);break;default:if(isArray$1(value)){const strValues=[];for(let j=0;j<value.length;j++)strValues[j]=String(value[j]);outValue=strValues.toString()}else outValue=String(value)}outValue&&rrule2.push([key,outValue])}}const rules=rrule2.map(([key,value])=>`${key}=${value.toString()}`).join(";");let ruleString="";return""!==rules&&(ruleString=`RRULE:${rules}`),[dtstart,ruleString].filter(x=>!!x).join("\n")}function buildDtstart(dtstart,tzid){return dtstart?"DTSTART"+new DateWithZone(new Date(dtstart),tzid).toString():""}function argsMatch(left,right){return Array.isArray(left)?!!Array.isArray(right)&&(left.length===right.length&&left.every((date,i)=>date.getTime()===right[i].getTime())):left instanceof Date?right instanceof Date&&left.getTime()===right.getTime():left===right}class Cache{constructor(){this.all=!1,this.before=[],this.after=[],this.between=[]}_cacheAdd(what,value,args){value&&(value=value instanceof Date?clone$1(value):cloneDates(value)),"all"===what?this.all=value:(args._value=value,this[what].push(args))}_cacheGet(what,args){let cached=!1;const argsKeys=args?Object.keys(args):[],findCacheDiff=function(item){for(let i=0;i<argsKeys.length;i++){const key=argsKeys[i];if(!argsMatch(args[key],item[key]))return!0}return!1},cachedObject=this[what];if("all"===what)cached=this.all;else if(isArray$1(cachedObject))for(let i=0;i<cachedObject.length;i++){const item=cachedObject[i];if(!argsKeys.length||!findCacheDiff(item)){cached=item._value;break}}if(!cached&&this.all){const iterResult=new IterResult(what,args);for(let i=0;i<this.all.length&&iterResult.accept(this.all[i]);i++);cached=iterResult.getValue(),this._cacheAdd(what,cached,args)}return isArray$1(cached)?cloneDates(cached):cached instanceof Date?clone$1(cached):cached}}const M365MASK=[...repeat(1,31),...repeat(2,28),...repeat(3,31),...repeat(4,30),...repeat(5,31),...repeat(6,30),...repeat(7,31),...repeat(8,31),...repeat(9,30),...repeat(10,31),...repeat(11,30),...repeat(12,31),...repeat(1,7)],M366MASK=[...repeat(1,31),...repeat(2,29),...repeat(3,31),...repeat(4,30),...repeat(5,31),...repeat(6,30),...repeat(7,31),...repeat(8,31),...repeat(9,30),...repeat(10,31),...repeat(11,30),...repeat(12,31),...repeat(1,7)],M28=range(1,29),M29=range(1,30),M30=range(1,31),M31=range(1,32),MDAY366MASK=[...M31,...M29,...M31,...M30,...M31,...M30,...M31,...M31,...M30,...M31,...M30,...M31,...M31.slice(0,7)],MDAY365MASK=[...M31,...M28,...M31,...M30,...M31,...M30,...M31,...M31,...M30,...M31,...M30,...M31,...M31.slice(0,7)],NM28=range(-28,0),NM29=range(-29,0),NM30=range(-30,0),NM31=range(-31,0),NMDAY366MASK=[...NM31,...NM29,...NM31,...NM30,...NM31,...NM30,...NM31,...NM31,...NM30,...NM31,...NM30,...NM31,...NM31.slice(0,7)],NMDAY365MASK=[...NM31,...NM28,...NM31,...NM30,...NM31,...NM30,...NM31,...NM31,...NM30,...NM31,...NM30,...NM31,...NM31.slice(0,7)],M366RANGE=[0,31,60,91,121,152,182,213,244,274,305,335,366],M365RANGE=[0,31,59,90,120,151,181,212,243,273,304,334,365],WDAYMASK=function(){let wdaymask=[];for(let i=0;i<55;i++)wdaymask=wdaymask.concat(range(7));return wdaymask}();function rebuildYear(year2,options){const firstyday=datetime(year2,1,1),yearlen=isLeapYear(year2)?366:365,nextyearlen=isLeapYear(year2+1)?366:365,yearordinal=toOrdinal(firstyday),yearweekday=getWeekday(firstyday),result=Object.assign(Object.assign({yearlen:yearlen,nextyearlen:nextyearlen,yearordinal:yearordinal,yearweekday:yearweekday},function(year2){const yearlen=isLeapYear(year2)?366:365,firstyday=datetime(year2,1,1),wday=getWeekday(firstyday);if(365===yearlen)return{mmask:M365MASK,mdaymask:MDAY365MASK,nmdaymask:NMDAY365MASK,wdaymask:WDAYMASK.slice(wday),mrange:M365RANGE};return{mmask:M366MASK,mdaymask:MDAY366MASK,nmdaymask:NMDAY366MASK,wdaymask:WDAYMASK.slice(wday),mrange:M366RANGE}}(year2)),{wnomask:null});if(empty$1(options.byweekno))return result;let firstwkst,wyearlen;result.wnomask=repeat(0,yearlen+7);let no1wkst=firstwkst=pymod(7-yearweekday+options.wkst,7);no1wkst>=4?(no1wkst=0,wyearlen=result.yearlen+pymod(yearweekday-options.wkst,7)):wyearlen=yearlen-no1wkst;const div=Math.floor(wyearlen/7),mod=pymod(wyearlen,7),numweeks=Math.floor(div+mod/4);for(let j=0;j<options.byweekno.length;j++){let i,n2=options.byweekno[j];if(n2<0&&(n2+=numweeks+1),n2>0&&n2<=numweeks){n2>1?(i=no1wkst+7*(n2-1),no1wkst!==firstwkst&&(i-=7-firstwkst)):i=no1wkst;for(let k=0;k<7&&(result.wnomask[i]=1,i++,result.wdaymask[i]!==options.wkst);k++);}}if(includes(options.byweekno,1)){let i=no1wkst+7*numweeks;if(no1wkst!==firstwkst&&(i-=7-firstwkst),i<yearlen)for(let j=0;j<7&&(result.wnomask[i]=1,i+=1,result.wdaymask[i]!==options.wkst);j++);}if(no1wkst){let lnumweeks;if(includes(options.byweekno,-1))lnumweeks=-1;else{const lyearweekday=getWeekday(datetime(year2-1,1,1));let lno1wkst=pymod(7-lyearweekday.valueOf()+options.wkst,7);const lyearlen=isLeapYear(year2-1)?366:365;let weekst;lno1wkst>=4?(lno1wkst=0,weekst=lyearlen+pymod(lyearweekday-options.wkst,7)):weekst=yearlen-no1wkst,lnumweeks=Math.floor(52+pymod(weekst,7)/4)}if(includes(options.byweekno,lnumweeks))for(let i=0;i<no1wkst;i++)result.wnomask[i]=1}return result}class Iterinfo{constructor(options){this.options=options}rebuild(year2,month){const options=this.options;if(year2!==this.lastyear&&(this.yearinfo=rebuildYear(year2,options)),notEmpty(options.bynweekday)&&(month!==this.lastmonth||year2!==this.lastyear)){const{yearlen:yearlen,mrange:mrange,wdaymask:wdaymask}=this.yearinfo;this.monthinfo=function(year2,month,yearlen,mrange,wdaymask,options){const result={lastyear:year2,lastmonth:month,nwdaymask:[]};let ranges=[];if(options.freq===RRule$1.YEARLY)if(empty$1(options.bymonth))ranges=[[0,yearlen]];else for(let j=0;j<options.bymonth.length;j++)month=options.bymonth[j],ranges.push(mrange.slice(month-1,month+1));else options.freq===RRule$1.MONTHLY&&(ranges=[mrange.slice(month-1,month+1)]);if(empty$1(ranges))return result;result.nwdaymask=repeat(0,yearlen);for(let j=0;j<ranges.length;j++){const rang=ranges[j],first=rang[0],last=rang[1]-1;for(let k=0;k<options.bynweekday.length;k++){let i;const[wday,n2]=options.bynweekday[k];n2<0?(i=last+7*(n2+1),i-=pymod(wdaymask[i]-wday,7)):(i=first+7*(n2-1),i+=pymod(7-wdaymask[i]+wday,7)),first<=i&&i<=last&&(result.nwdaymask[i]=1)}}return result}(year2,month,yearlen,mrange,wdaymask,options)}isPresent(options.byeaster)&&(this.eastermask=function(y,offset2=0){const a=y%19,b=Math.floor(y/100),c=y%100,d=Math.floor(b/4),e=b%4,f=Math.floor((b+8)/25),g=Math.floor((b-f+1)/3),h2=Math.floor(19*a+b-d-g+15)%30,i=Math.floor(c/4),k=c%4,l2=Math.floor(32+2*e+2*i-h2-k)%7,m=Math.floor((a+11*h2+22*l2)/451),month=Math.floor((h2+l2-7*m+114)/31),day=(h2+l2-7*m+114)%31+1,date=Date.UTC(y,month-1,day+offset2),yearStart=Date.UTC(y,0,1);return[Math.ceil((date-yearStart)/864e5)]}(year2,options.byeaster))}get lastyear(){return this.monthinfo?this.monthinfo.lastyear:null}get lastmonth(){return this.monthinfo?this.monthinfo.lastmonth:null}get yearlen(){return this.yearinfo.yearlen}get yearordinal(){return this.yearinfo.yearordinal}get mrange(){return this.yearinfo.mrange}get wdaymask(){return this.yearinfo.wdaymask}get mmask(){return this.yearinfo.mmask}get wnomask(){return this.yearinfo.wnomask}get nwdaymask(){return this.monthinfo?this.monthinfo.nwdaymask:[]}get nextyearlen(){return this.yearinfo.nextyearlen}get mdaymask(){return this.yearinfo.mdaymask}get nmdaymask(){return this.yearinfo.nmdaymask}ydayset(){return[range(this.yearlen),0,this.yearlen]}mdayset(_,month){const start=this.mrange[month-1],end=this.mrange[month],set2=repeat(null,this.yearlen);for(let i=start;i<end;i++)set2[i]=i;return[set2,start,end]}wdayset(year2,month,day){const set2=repeat(null,this.yearlen+7);let i=toOrdinal(datetime(year2,month,day))-this.yearordinal;const start=i;for(let j=0;j<7&&(set2[i]=i,++i,this.wdaymask[i]!==this.options.wkst);j++);return[set2,start,i]}ddayset(year2,month,day){const set2=repeat(null,this.yearlen),i=toOrdinal(datetime(year2,month,day))-this.yearordinal;return set2[i]=i,[set2,i,i+1]}htimeset(hour,_,second,millisecond){let set2=[];return this.options.byminute.forEach(minute=>{set2=set2.concat(this.mtimeset(hour,minute,second,millisecond))}),sort(set2),set2}mtimeset(hour,minute,_,millisecond){const set2=this.options.bysecond.map(second=>new Time$1(hour,minute,second,millisecond));return sort(set2),set2}stimeset(hour,minute,second,millisecond){return[new Time$1(hour,minute,second,millisecond)]}getdayset(freq){switch(freq){case Frequency.YEARLY:return this.ydayset.bind(this);case Frequency.MONTHLY:return this.mdayset.bind(this);case Frequency.WEEKLY:return this.wdayset.bind(this);case Frequency.DAILY:default:return this.ddayset.bind(this)}}gettimeset(freq){switch(freq){case Frequency.HOURLY:return this.htimeset.bind(this);case Frequency.MINUTELY:return this.mtimeset.bind(this);case Frequency.SECONDLY:return this.stimeset.bind(this)}}}function buildPoslist(bysetpos,timeset,start,end,ii,dayset){const poslist=[];for(let j=0;j<bysetpos.length;j++){let daypos,timepos;const pos=bysetpos[j];pos<0?(daypos=Math.floor(pos/timeset.length),timepos=pymod(pos,timeset.length)):(daypos=Math.floor((pos-1)/timeset.length),timepos=pymod(pos-1,timeset.length));const tmp=[];for(let k=start;k<end;k++){const val=dayset[k];isPresent(val)&&tmp.push(val)}let i;i=daypos<0?tmp.slice(daypos)[0]:tmp[daypos];const time=timeset[timepos],date=fromOrdinal(ii.yearordinal+i),res=combine(date,time);includes(poslist,res)||poslist.push(res)}return sort(poslist),poslist}function iter(iterResult,options){const{dtstart:dtstart,freq:freq,interval:interval,until:until,bysetpos:bysetpos}=options;let count=options.count;if(0===count||0===interval)return emitResult(iterResult);const counterDate=DateTime.fromDate(dtstart),ii=new Iterinfo(options);ii.rebuild(counterDate.year,counterDate.month);let timeset=function(ii,counterDate,options){const{freq:freq,byhour:byhour,byminute:byminute,bysecond:bysecond}=options;if(freqIsDailyOrGreater(freq))return function(opts){const millisecondModulo=opts.dtstart.getTime()%1e3;if(!freqIsDailyOrGreater(opts.freq))return[];const timeset=[];return opts.byhour.forEach(hour=>{opts.byminute.forEach(minute=>{opts.bysecond.forEach(second=>{timeset.push(new Time$1(hour,minute,second,millisecondModulo))})})}),timeset}(options);if(freq>=RRule$1.HOURLY&&notEmpty(byhour)&&!includes(byhour,counterDate.hour)||freq>=RRule$1.MINUTELY&&notEmpty(byminute)&&!includes(byminute,counterDate.minute)||freq>=RRule$1.SECONDLY&&notEmpty(bysecond)&&!includes(bysecond,counterDate.second))return[];return ii.gettimeset(freq)(counterDate.hour,counterDate.minute,counterDate.second,counterDate.millisecond)}(ii,counterDate,options);for(;;){const[dayset,start,end]=ii.getdayset(freq)(counterDate.year,counterDate.month,counterDate.day),filtered=removeFilteredDays(dayset,start,end,ii,options);if(notEmpty(bysetpos)){const poslist=buildPoslist(bysetpos,timeset,start,end,ii,dayset);for(let j=0;j<poslist.length;j++){const res=poslist[j];if(until&&res>until)return emitResult(iterResult);if(res>=dtstart){const rezonedDate=rezoneIfNeeded(res,options);if(!iterResult.accept(rezonedDate))return emitResult(iterResult);if(count&&(--count,!count))return emitResult(iterResult)}}}else for(let j=start;j<end;j++){const currentDay=dayset[j];if(!isPresent(currentDay))continue;const date=fromOrdinal(ii.yearordinal+currentDay);for(let k=0;k<timeset.length;k++){const time=timeset[k],res=combine(date,time);if(until&&res>until)return emitResult(iterResult);if(res>=dtstart){const rezonedDate=rezoneIfNeeded(res,options);if(!iterResult.accept(rezonedDate))return emitResult(iterResult);if(count&&(--count,!count))return emitResult(iterResult)}}}if(0===options.interval)return emitResult(iterResult);if(counterDate.add(options,filtered),counterDate.year>9999)return emitResult(iterResult);freqIsDailyOrGreater(freq)||(timeset=ii.gettimeset(freq)(counterDate.hour,counterDate.minute,counterDate.second,0)),ii.rebuild(counterDate.year,counterDate.month)}}function isFiltered(ii,currentDay,options){const{bymonth:bymonth,byweekno:byweekno,byweekday:byweekday,byeaster:byeaster,bymonthday:bymonthday,bynmonthday:bynmonthday,byyearday:byyearday}=options;return notEmpty(bymonth)&&!includes(bymonth,ii.mmask[currentDay])||notEmpty(byweekno)&&!ii.wnomask[currentDay]||notEmpty(byweekday)&&!includes(byweekday,ii.wdaymask[currentDay])||notEmpty(ii.nwdaymask)&&!ii.nwdaymask[currentDay]||null!==byeaster&&!includes(ii.eastermask,currentDay)||(notEmpty(bymonthday)||notEmpty(bynmonthday))&&!includes(bymonthday,ii.mdaymask[currentDay])&&!includes(bynmonthday,ii.nmdaymask[currentDay])||notEmpty(byyearday)&&(currentDay<ii.yearlen&&!includes(byyearday,currentDay+1)&&!includes(byyearday,-ii.yearlen+currentDay)||currentDay>=ii.yearlen&&!includes(byyearday,currentDay+1-ii.yearlen)&&!includes(byyearday,-ii.nextyearlen+currentDay-ii.yearlen))}function rezoneIfNeeded(date,options){return new DateWithZone(date,options.tzid).rezonedDate()}function emitResult(iterResult){return iterResult.getValue()}function removeFilteredDays(dayset,start,end,ii,options){let filtered=!1;for(let dayCounter=start;dayCounter<end;dayCounter++){const currentDay=dayset[dayCounter];filtered=isFiltered(ii,currentDay,options),filtered&&(dayset[currentDay]=null)}return filtered}const Days={MO:new Weekday(0),TU:new Weekday(1),WE:new Weekday(2),TH:new Weekday(3),FR:new Weekday(4),SA:new Weekday(5),SU:new Weekday(6)},DEFAULT_OPTIONS$1={freq:Frequency.YEARLY,dtstart:null,interval:1,wkst:Days.MO,count:null,until:null,tzid:null,bysetpos:null,bymonth:null,bymonthday:null,bynmonthday:null,byyearday:null,byweekno:null,byweekday:null,bynweekday:null,byhour:null,byminute:null,bysecond:null,byeaster:null},defaultKeys=Object.keys(DEFAULT_OPTIONS$1);let RRule$1=class RRule2{constructor(options={},noCache=!1){this._cache=noCache?null:new Cache,this.origOptions=initializeOptions$1(options);const{parsedOptions:parsedOptions}=function(options){const opts=Object.assign(Object.assign({},DEFAULT_OPTIONS$1),initializeOptions$1(options));if(isPresent(opts.byeaster)&&(opts.freq=RRule$1.YEARLY),!isPresent(opts.freq)||!RRule$1.FREQUENCIES[opts.freq])throw new Error(`Invalid frequency: ${opts.freq} ${options.freq}`);if(opts.dtstart||(opts.dtstart=new Date((new Date).setMilliseconds(0))),isPresent(opts.wkst)?isNumber(opts.wkst)||(opts.wkst=opts.wkst.weekday):opts.wkst=RRule$1.MO.weekday,isPresent(opts.bysetpos)){isNumber(opts.bysetpos)&&(opts.bysetpos=[opts.bysetpos]);for(let i=0;i<opts.bysetpos.length;i++){const v=opts.bysetpos[i];if(0===v||!(v>=-366&&v<=366))throw new Error("bysetpos must be between 1 and 366, or between -366 and -1")}}if(!(Boolean(opts.byweekno)||notEmpty(opts.byweekno)||notEmpty(opts.byyearday)||Boolean(opts.bymonthday)||notEmpty(opts.bymonthday)||isPresent(opts.byweekday)||isPresent(opts.byeaster)))switch(opts.freq){case RRule$1.YEARLY:opts.bymonth||(opts.bymonth=opts.dtstart.getUTCMonth()+1),opts.bymonthday=opts.dtstart.getUTCDate();break;case RRule$1.MONTHLY:opts.bymonthday=opts.dtstart.getUTCDate();break;case RRule$1.WEEKLY:opts.byweekday=[getWeekday(opts.dtstart)]}if(isPresent(opts.bymonth)&&!isArray$1(opts.bymonth)&&(opts.bymonth=[opts.bymonth]),isPresent(opts.byyearday)&&!isArray$1(opts.byyearday)&&isNumber(opts.byyearday)&&(opts.byyearday=[opts.byyearday]),isPresent(opts.bymonthday))if(isArray$1(opts.bymonthday)){const bymonthday=[],bynmonthday=[];for(let i=0;i<opts.bymonthday.length;i++){const v=opts.bymonthday[i];v>0?bymonthday.push(v):v<0&&bynmonthday.push(v)}opts.bymonthday=bymonthday,opts.bynmonthday=bynmonthday}else opts.bymonthday<0?(opts.bynmonthday=[opts.bymonthday],opts.bymonthday=[]):(opts.bynmonthday=[],opts.bymonthday=[opts.bymonthday]);else opts.bymonthday=[],opts.bynmonthday=[];if(isPresent(opts.byweekno)&&!isArray$1(opts.byweekno)&&(opts.byweekno=[opts.byweekno]),isPresent(opts.byweekday))if(isNumber(opts.byweekday))opts.byweekday=[opts.byweekday],opts.bynweekday=null;else if(isWeekdayStr(opts.byweekday))opts.byweekday=[Weekday.fromStr(opts.byweekday).weekday],opts.bynweekday=null;else if(opts.byweekday instanceof Weekday)!opts.byweekday.n||opts.freq>RRule$1.MONTHLY?(opts.byweekday=[opts.byweekday.weekday],opts.bynweekday=null):(opts.bynweekday=[[opts.byweekday.weekday,opts.byweekday.n]],opts.byweekday=null);else{const byweekday=[],bynweekday=[];for(let i=0;i<opts.byweekday.length;i++){const wday=opts.byweekday[i];isNumber(wday)?byweekday.push(wday):isWeekdayStr(wday)?byweekday.push(Weekday.fromStr(wday).weekday):!wday.n||opts.freq>RRule$1.MONTHLY?byweekday.push(wday.weekday):bynweekday.push([wday.weekday,wday.n])}opts.byweekday=notEmpty(byweekday)?byweekday:null,opts.bynweekday=notEmpty(bynweekday)?bynweekday:null}else opts.bynweekday=null;return isPresent(opts.byhour)?isNumber(opts.byhour)&&(opts.byhour=[opts.byhour]):opts.byhour=opts.freq<RRule$1.HOURLY?[opts.dtstart.getUTCHours()]:null,isPresent(opts.byminute)?isNumber(opts.byminute)&&(opts.byminute=[opts.byminute]):opts.byminute=opts.freq<RRule$1.MINUTELY?[opts.dtstart.getUTCMinutes()]:null,isPresent(opts.bysecond)?isNumber(opts.bysecond)&&(opts.bysecond=[opts.bysecond]):opts.bysecond=opts.freq<RRule$1.SECONDLY?[opts.dtstart.getUTCSeconds()]:null,{parsedOptions:opts}}(options);this.options=parsedOptions}static parseText(text,language){return parseText(text,language)}static fromText(text,language){return function(text,language=ENGLISH){return new RRule$1(parseText(text,language)||void 0)}(text,language)}static fromString(str){return new RRule2(RRule2.parseString(str)||void 0)}_iter(iterResult){return iter(iterResult,this.options)}_cacheGet(what,args){return!!this._cache&&this._cache._cacheGet(what,args)}_cacheAdd(what,value,args){if(this._cache)return this._cache._cacheAdd(what,value,args)}all(iterator2){if(iterator2)return this._iter(new CallbackIterResult("all",{},iterator2));let result=this._cacheGet("all");return!1===result&&(result=this._iter(new IterResult("all",{})),this._cacheAdd("all",result)),result}between(after,before,inc=!1,iterator2){if(!isValidDate(after)||!isValidDate(before))throw new Error("Invalid date passed in to RRule.between");const args={before:before,after:after,inc:inc};if(iterator2)return this._iter(new CallbackIterResult("between",args,iterator2));let result=this._cacheGet("between",args);return!1===result&&(result=this._iter(new IterResult("between",args)),this._cacheAdd("between",result,args)),result}before(dt,inc=!1){if(!isValidDate(dt))throw new Error("Invalid date passed in to RRule.before");const args={dt:dt,inc:inc};let result=this._cacheGet("before",args);return!1===result&&(result=this._iter(new IterResult("before",args)),this._cacheAdd("before",result,args)),result}after(dt,inc=!1){if(!isValidDate(dt))throw new Error("Invalid date passed in to RRule.after");const args={dt:dt,inc:inc};let result=this._cacheGet("after",args);return!1===result&&(result=this._iter(new IterResult("after",args)),this._cacheAdd("after",result,args)),result}count(){return this.all().length}toString(){return optionsToString(this.origOptions)}toText(gettext,language,dateFormatter){return function(rrule2,gettext,language,dateFormatter){return new ToText(rrule2,gettext,language,dateFormatter).toString()}(this,gettext,language,dateFormatter)}isFullyConvertibleToText(){return isFullyConvertible(this)}clone(){return new RRule2(this.origOptions)}};RRule$1.FREQUENCIES=["YEARLY","MONTHLY","WEEKLY","DAILY","HOURLY","MINUTELY","SECONDLY"],RRule$1.YEARLY=Frequency.YEARLY,RRule$1.MONTHLY=Frequency.MONTHLY,RRule$1.WEEKLY=Frequency.WEEKLY,RRule$1.DAILY=Frequency.DAILY,RRule$1.HOURLY=Frequency.HOURLY,RRule$1.MINUTELY=Frequency.MINUTELY,RRule$1.SECONDLY=Frequency.SECONDLY,RRule$1.MO=Days.MO,RRule$1.TU=Days.TU,RRule$1.WE=Days.WE,RRule$1.TH=Days.TH,RRule$1.FR=Days.FR,RRule$1.SA=Days.SA,RRule$1.SU=Days.SU,RRule$1.parseString=parseString,RRule$1.optionsToString=optionsToString;const DEFAULT_OPTIONS={dtstart:null,cache:!1,unfold:!1,forceset:!1,compatible:!1,tzid:null};function parseInput(s2,options){const rrulevals=[];let rdatevals=[];const exrulevals=[];let exdatevals=[];const parsedDtstart=parseDtstart(s2),{dtstart:dtstart}=parsedDtstart;let{tzid:tzid}=parsedDtstart;const lines=function(s2,unfold=!1){if(s2=s2&&s2.trim(),!s2)throw new Error("Invalid empty string");if(!unfold)return s2.split(/\s/);const lines=s2.split("\n");let i=0;for(;i<lines.length;){const line=lines[i]=lines[i].replace(/\s+$/g,"");line?i>0&&" "===line[0]?(lines[i-1]+=line.slice(1),lines.splice(i,1)):i+=1:lines.splice(i,1)}return lines}(s2,options.unfold);return lines.forEach(line=>{var _a2;if(!line)return;const{name:name,parms:parms,value:value}=function(line){const{name:name,value:value}=function(line){if(-1===line.indexOf(":"))return{name:"RRULE",value:line};const[name,value]=function(str,sep,num){const splits=str.split(sep);return splits.slice(0,num).concat([splits.slice(num).join(sep)])}(line,":",1);return{name:name,value:value}}(line),parms=name.split(";");if(!parms)throw new Error("empty property name");return{name:parms[0].toUpperCase(),parms:parms.slice(1),value:value}}(line);switch(name.toUpperCase()){case"RRULE":if(parms.length)throw new Error(`unsupported RRULE parm: ${parms.join(",")}`);rrulevals.push(parseString(line));break;case"RDATE":const[,rdateTzid]=null!==(_a2=/RDATE(?:;TZID=([^:=]+))?/i.exec(line))&&void 0!==_a2?_a2:[];rdateTzid&&!tzid&&(tzid=rdateTzid),rdatevals=rdatevals.concat(parseRDate(value,parms));break;case"EXRULE":if(parms.length)throw new Error(`unsupported EXRULE parm: ${parms.join(",")}`);exrulevals.push(parseString(value));break;case"EXDATE":exdatevals=exdatevals.concat(parseRDate(value,parms));break;case"DTSTART":break;default:throw new Error("unsupported property: "+name)}}),{dtstart:dtstart,tzid:tzid,rrulevals:rrulevals,rdatevals:rdatevals,exrulevals:exrulevals,exdatevals:exdatevals}}function rrulestr(s2,options={}){return function(s2,options){const{rrulevals:rrulevals,rdatevals:rdatevals,exrulevals:exrulevals,exdatevals:exdatevals,dtstart:dtstart,tzid:tzid}=parseInput(s2,options),noCache=!1===options.cache;if(options.compatible&&(options.forceset=!0,options.unfold=!0),options.forceset||rrulevals.length>1||rdatevals.length||exrulevals.length||exdatevals.length){const rset=new RRuleSet(noCache);return rset.dtstart(dtstart),rset.tzid(tzid||void 0),rrulevals.forEach(val2=>{rset.rrule(new RRule$1(groomRruleOptions(val2,dtstart,tzid),noCache))}),rdatevals.forEach(date=>{rset.rdate(date)}),exrulevals.forEach(val2=>{rset.exrule(new RRule$1(groomRruleOptions(val2,dtstart,tzid),noCache))}),exdatevals.forEach(date=>{rset.exdate(date)}),options.compatible&&options.dtstart&&rset.rdate(dtstart),rset}const val=rrulevals[0]||{};return new RRule$1(groomRruleOptions(val,val.dtstart||options.dtstart||dtstart,val.tzid||options.tzid||tzid),noCache)}(s2,function(options){const invalid=[],keys=Object.keys(options),defaultKeys2=Object.keys(DEFAULT_OPTIONS);if(keys.forEach(function(key){includes(defaultKeys2,key)||invalid.push(key)}),invalid.length)throw new Error("Invalid options: "+invalid.join(", "));return Object.assign(Object.assign({},DEFAULT_OPTIONS),options)}(options))}function groomRruleOptions(val,dtstart,tzid){return Object.assign(Object.assign({},val),{dtstart:dtstart,tzid:tzid})}function parseRDate(rdateval,parms){return function(parms){parms.forEach(parm=>{if(!/(VALUE=DATE(-TIME)?)|(TZID=)/.test(parm))throw new Error("unsupported RDATE/EXDATE parm: "+parm)})}(parms),rdateval.split(",").map(datestr=>untilStringToDate(datestr))}function createGetterSetter(fieldName){return field=>{if(void 0!==field&&(this[`_${fieldName}`]=field),void 0!==this[`_${fieldName}`])return this[`_${fieldName}`];for(let i=0;i<this._rrule.length;i++){const field2=this._rrule[i].origOptions[fieldName];if(field2)return field2}}}class RRuleSet extends RRule$1{constructor(noCache=!1){super({},noCache),this.dtstart=createGetterSetter.apply(this,["dtstart"]),this.tzid=createGetterSetter.apply(this,["tzid"]),this._rrule=[],this._rdate=[],this._exrule=[],this._exdate=[]}_iter(iterResult){return function(iterResult,_rrule,_exrule,_rdate,_exdate,tzid){const _exdateHash={},_accept=iterResult.accept;function evalExdate(after,before){_exrule.forEach(function(rrule2){rrule2.between(after,before,!0).forEach(function(date){_exdateHash[Number(date)]=!0})})}_exdate.forEach(function(date){const zonedDate=new DateWithZone(date,tzid).rezonedDate();_exdateHash[Number(zonedDate)]=!0}),iterResult.accept=function(date){const dt=Number(date);return isNaN(dt)?_accept.call(this,date):!(!_exdateHash[dt]&&(evalExdate(new Date(dt-1),new Date(dt+1)),!_exdateHash[dt]))||(_exdateHash[dt]=!0,_accept.call(this,date))},"between"===iterResult.method&&(evalExdate(iterResult.args.after,iterResult.args.before),iterResult.accept=function(date){const dt=Number(date);return!!_exdateHash[dt]||(_exdateHash[dt]=!0,_accept.call(this,date))});for(let i=0;i<_rdate.length;i++){const zonedDate=new DateWithZone(_rdate[i],tzid).rezonedDate();if(!iterResult.accept(new Date(zonedDate.getTime())))break}_rrule.forEach(function(rrule2){iter(iterResult,rrule2.options)});const res=iterResult._result;switch(sort(res),iterResult.method){case"all":case"between":return res;case"before":return res.length&&res[res.length-1]||null;default:return res.length&&res[0]||null}}(iterResult,this._rrule,this._exrule,this._rdate,this._exdate,this.tzid())}rrule(rrule2){_addRule(rrule2,this._rrule)}exrule(rrule2){_addRule(rrule2,this._exrule)}rdate(date){_addDate(date,this._rdate)}exdate(date){_addDate(date,this._exdate)}rrules(){return this._rrule.map(e=>rrulestr(e.toString()))}exrules(){return this._exrule.map(e=>rrulestr(e.toString()))}rdates(){return this._rdate.map(e=>new Date(e.getTime()))}exdates(){return this._exdate.map(e=>new Date(e.getTime()))}valueOf(){let result=[];return!this._rrule.length&&this._dtstart&&(result=result.concat(optionsToString({dtstart:this._dtstart}))),this._rrule.forEach(function(rrule2){result=result.concat(rrule2.toString().split("\n"))}),this._exrule.forEach(function(exrule){result=result.concat(exrule.toString().split("\n").map(line=>line.replace(/^RRULE:/,"EXRULE:")).filter(line=>!/^DTSTART/.test(line)))}),this._rdate.length&&result.push(rdatesToString("RDATE",this._rdate,this.tzid())),this._exdate.length&&result.push(rdatesToString("EXDATE",this._exdate,this.tzid())),result}toString(){return this.valueOf().join("\n")}clone(){const rrs=new RRuleSet(!!this._cache);return this._rrule.forEach(rule=>rrs.rrule(rule.clone())),this._exrule.forEach(rule=>rrs.exrule(rule.clone())),this._rdate.forEach(date=>rrs.rdate(new Date(date.getTime()))),this._exdate.forEach(date=>rrs.exdate(new Date(date.getTime()))),rrs}}function _addRule(rrule2,collection){if(!(rrule2 instanceof RRule$1))throw new TypeError(String(rrule2)+" is not RRule instance");includes(collection.map(String),String(rrule2))||collection.push(rrule2)}function _addDate(date,collection){if(!(date instanceof Date))throw new TypeError(String(date)+" is not Date instance");includes(collection.map(Number),Number(date))||(collection.push(date),sort(collection))}function rdatesToString(param,rdates,tzid){const isUTC=!tzid||"UTC"===tzid.toUpperCase();return`${isUTC?`${param}:`:`${param};TZID=${tzid}:`}${rdates.map(rdate=>timeToUntilString(rdate.valueOf(),isUTC)).join(",")}`}const rrule=Object.freeze(Object.defineProperty({__proto__:null,ALL_WEEKDAYS:ALL_WEEKDAYS,get Frequency(){return Frequency},RRule:RRule$1,RRuleSet:RRuleSet,Weekday:Weekday,datetime:datetime,rrulestr:rrulestr},Symbol.toStringTag,{value:"Module"})),{RRule:RRule}=rrule;function makeRecurrenceSerializable(recurrence){var _a2,_b2,_c2,_d;const until=recurrence.until&&null!=(_b2=null==(_a2=DateTime$1.fromJSDate(recurrence.until))?void 0:_a2.toISO())?_b2:void 0,dtstart=recurrence.dtstart&&null!=(_d=null==(_c2=DateTime$1.fromJSDate(recurrence.dtstart))?void 0:_c2.toISO())?_d:void 0;return __spreadProps(__spreadValues({},recurrence),{until:until,dtstart:dtstart})}const checkEdtfRecurrence=(line,i,lengthAtIndex,eventStartLineRegexMatch,context)=>{const recurrenceMatch=eventStartLineRegexMatch[edtf_recurrenceMatchIndex];if(!recurrenceMatch)return;const recurrenceMatchTrimmed=recurrenceMatch.trim(),indexInString=eventStartLineRegexMatch[0].indexOf(recurrenceMatchTrimmed),from=lengthAtIndex[i]+indexInString,to=lengthAtIndex[i]+indexInString+recurrenceMatchTrimmed.length,range2={type:RangeType.Recurrence,from:from,to:to,content:recurrenceMatch};try{return{recurrence:makeRecurrenceSerializable(RRule.parseText(recurrenceMatch)),range:range2}}catch(e){return void context.parseMessages.push({type:"error",message:"Cannot parse recurrence",pos:[from,to]})}},checkRecurrence=(line,i,lengthAtIndex,eventStartLineRegexMatch,context)=>{const recurrenceMatch=eventStartLineRegexMatch[recurrence_recurrenceMatchIndex];if(!recurrenceMatch)return;const recurrenceMatchTrimmed=recurrenceMatch.trim(),indexInString=eventStartLineRegexMatch[0].indexOf(recurrenceMatchTrimmed),from=lengthAtIndex[i]+indexInString,to=lengthAtIndex[i]+indexInString+recurrenceMatchTrimmed.length,range2={type:RangeType.Recurrence,from:from,to:to,content:recurrenceMatch};try{return{recurrence:makeRecurrenceSerializable(RRule.parseText(recurrenceMatch)),range:range2}}catch(e){return void context.parseMessages.push({type:"error",message:"Cannot parse recurrence",pos:[from,to]})}};function getDateRangeFromCasualRegexMatch(line,i,lengthAtIndex,context){var _a2,_b2,_c2;const eventStartLineRegexMatch=line.match(EVENT_START_REGEX);if(!eventStartLineRegexMatch)return;const datePart=eventStartLineRegexMatch[datePartMatchIndex],indexOfDateRange=line.indexOf(datePart),dateRangeInText={type:RangeType.DateRange,from:lengthAtIndex[i]+indexOfDateRange,to:lengthAtIndex[i]+indexOfDateRange+datePart.length};context.ranges.push(dateRangeInText);const colonIndex=line.indexOf(":",indexOfDateRange+datePart.length),colonRange=rangeType=>({type:rangeType,from:lengthAtIndex[i]+colonIndex,to:lengthAtIndex[i]+colonIndex+1}),cached=null==(_a2=context.cache)?void 0:_a2.zone(context.timezone).ranges.get(datePart);if(cached){const recurrence2=checkRecurrence(0,i,lengthAtIndex,eventStartLineRegexMatch,context);recurrence2&&context.ranges.push(recurrence2.range);const colon2=colonRange(RangeType.DateRangeColon);context.ranges.push(colon2);return new DateRangePart({from:DateTime$1.fromISO(cached.fromDateTimeIso,{setZone:!0}),to:DateTime$1.fromISO(cached.toDateTimeIso,{setZone:!0}),originalString:datePart,dateRangeInText:dateRangeInText,eventText:eventStartLineRegexMatch[eventTextMatchIndex],recurrence:recurrence2,definition:__spreadProps(__spreadValues({},dateRangeInText),{type:RangeType.EventDefinition,to:colon2.to}),isRelative:!1})}const eventStartDate=eventStartLineRegexMatch[from_matchIndex],eventEndDate=eventStartLineRegexMatch[to_matchIndex],relativeFromDate=eventStartLineRegexMatch[from_relativeMatchIndex],relativeFromBeforeOrAfter=eventStartLineRegexMatch[from_beforeOrAfterMatchIndex],fromBeforeOrAfter=["before","by"].includes(relativeFromBeforeOrAfter||"")?"before":"after",relativeToDate=eventStartLineRegexMatch[to_relativeMatchIndex],fromCasual=fromCasualDate(eventStartLineRegexMatch,context,from_monthFirstCasualMonthMonthFullMatchIndex,from_monthFirstCasualMonthDayMatchIndex,from_casualMonthAndDayYearMatchIndex,from_monthFirstCasualMonthMonthAbbrMatchIndex,from_dayFirstCasualMonthDayMatchIndex,from_dayFirstCasualMonthMonthFullMatchIndex,from_dayFirstCasualMonthMonthAbbrMatchIndex,from_casualMonthYearMatchIndex,from_casualMonthMonthFullMatchIndex,from_casualMonthMonthAbbrMatchIndex,eventStartLineRegexMatch[from_casualMonthTimeMatchIndex]?getTimeFromRegExpMatch(eventStartLineRegexMatch,from_casualMonthTimeMeridiemHourMatchIndex,from_casualMonthTimeMeridiemMinuteMatchIndex,from_casualMonthTimeMeridiemMeridiemMatchIndex,from_casualMonthTime24HourHourMatchIndex,from_casualMonthTime24HourMinuteMatchIndex):void 0);const toCasual=fromCasualDate(eventStartLineRegexMatch,context,to_monthFirstCasualMonthMonthFullMatchIndex,to_monthFirstCasualMonthDayMatchIndex,to_casualMonthAndDayYearMatchIndex,to_monthFirstCasualMonthMonthAbbrMatchIndex,to_dayFirstCasualMonthDayMatchIndex,to_dayFirstCasualMonthMonthFullMatchIndex,to_dayFirstCasualMonthMonthAbbrMatchIndex,to_casualMonthYearMatchIndex,to_casualMonthMonthFullMatchIndex,to_casualMonthMonthAbbrMatchIndex,eventStartLineRegexMatch[to_casualMonthTimeMatchIndex]?function(eventStartMatches){return getTimeFromRegExpMatch(eventStartMatches,to_casualMonthTimeMeridiemHourMatchIndex,to_casualMonthTimeMeridiemMinuteMatchIndex,to_casualMonthTimeMeridiemMeridiemMatchIndex,to_casualMonthTime24HourHourMatchIndex,to_casualMonthTime24HourMinuteMatchIndex)}(eventStartLineRegexMatch):void 0),slashDateFrom=eventStartLineRegexMatch[from_slashDateFullMatchIndex],slashDateTo=eventStartLineRegexMatch[to_slashDateFullMatchIndex],timeOnlyFrom=eventStartLineRegexMatch[from_timeOnlyMatchIndex],timeOnlyTo=eventStartLineRegexMatch[to_timeOnlyMatchIndex],nowFrom=eventStartLineRegexMatch[from_nowMatchIndex],nowTo=eventStartLineRegexMatch[to_nowMatchIndex];let fromDateTime,endDateTime,granularity="instant",canCacheRange=!0,isRelative=!1;if(relativeFromDate){canCacheRange=!1,isRelative=!0;const relativeToEventId=null==(_b2=eventStartLineRegexMatch[from_relativeEventIdMatchIndex])?void 0:_b2.substring(1);let relativeTo;if(relativeToEventId){const event=context.getById(relativeToEventId);if(event&&isEvent(event)){const range2=toDateRange(event.dateRangeIso);relativeTo="after"===fromBeforeOrAfter?range2.toDateTime:range2.fromDateTime}else context.parseMessages.push({type:"error",message:`Event ${relativeToEventId} not found`,pos:[lengthAtIndex[i]+line.indexOf(relativeToEventId),lengthAtIndex[i]+line.indexOf(relativeToEventId)+relativeToEventId.length]})}if(!relativeTo){const priorEvent=context.priorEvent();relativeTo=priorEvent?"after"===fromBeforeOrAfter?toDateRange(priorEvent.dateRangeIso).toDateTime:toDateRange(priorEvent.dateRangeIso).fromDateTime:context.zonedNow}relativeToDate||eventEndDate?"before"===fromBeforeOrAfter?relativeToDate&&(endDateTime=RelativeDate.from(relativeFromDate,relativeTo,!0),fromDateTime=RelativeDate.from(relativeToDate,endDateTime,!0)):fromDateTime=RelativeDate.from(relativeFromDate,relativeTo):"before"===fromBeforeOrAfter?(endDateTime=relativeTo,fromDateTime=RelativeDate.from(relativeFromDate,relativeTo,!0)):(fromDateTime=relativeTo,endDateTime=RelativeDate.from(relativeFromDate,relativeTo)),granularity="instant"}else if(fromCasual)fromDateTime=DateTime$1.fromISO(fromCasual.dateTimeIso,{setZone:!0,zone:context.timezone}),granularity=fromCasual.granularity;else if(slashDateFrom){const timeComponent=eventStartLineRegexMatch[from_slashDateTimeMatchIndex];let slashPart=slashDateFrom;timeComponent&&(slashPart=slashPart.substring(0,slashPart.indexOf(timeComponent)).trim().replace(/,/g,""));const parsed=parseSlashDate(slashPart,context.header.dateFormat,context);if(parsed)if(timeComponent){const timePart=function(eventStartMatches){return getTimeFromRegExpMatch(eventStartMatches,from_slashDateTimeMeridiemHourMatchIndex,from_slashDateTimeMeridiemMinuteMatchIndex,from_slashDateTimeMeridiemMeridiemMatchIndex,from_slashDateTime24HourHourMatchIndex,from_slashDateTime24HourMinuteMatchIndex)}(eventStartLineRegexMatch),timePartDateTime=DateTime$1.fromISO(timePart.dateTimeIso);fromDateTime=DateTime$1.fromISO(parsed.dateTimeIso,{setZone:!0,zone:context.timezone}).set({hour:timePartDateTime.hour,minute:timePartDateTime.minute}),granularity=timePart.granularity}else fromDateTime=DateTime$1.fromISO(parsed.dateTimeIso,{setZone:!0,zone:context.timezone}),granularity=parsed.granularity;else context.parseMessages.push({type:"error",message:"Was supposed to have a slash date but couldn't parse it",pos:[dateRangeInText.from,dateRangeInText.to]})}else if(timeOnlyFrom){canCacheRange=!1,isRelative=!0;const timeFrom=getTimeFromRegExpMatch(eventStartLineRegexMatch,from_timeOnlyMeridiemHourMatchIndex,from_timeOnlyMeridiemMinuteMatchIndex,from_timeOnlyMeridiemMeridiemMatchIndex,from_timeOnly24HourHourMatchIndex,from_timeOnly24HourMinuteMatchIndex),priorEventDate=context.priorEventToDateTime()||context.zonedNow,timeFromIso=DateTime$1.fromISO(timeFrom.dateTimeIso,{setZone:!0,zone:context.timezone});let priorEventWithParsedTime=priorEventDate.set({hour:timeFromIso.hour,minute:timeFromIso.minute});priorEventWithParsedTime<priorEventDate?(priorEventWithParsedTime=priorEventWithParsedTime.plus({days:1}),fromDateTime=priorEventWithParsedTime,granularity=timeFrom.granularity):(fromDateTime=priorEventWithParsedTime,granularity=timeFrom.granularity)}else nowFrom?(fromDateTime=context.zonedNow,granularity="instant"):(fromDateTime=DateTime$1.fromISO(eventStartDate,{zone:context.timezone,setZone:!0}),granularity="instant");if(fromDateTime&&fromDateTime.isValid||(fromDateTime=context.zonedNow,granularity="instant"),!endDateTime)if(relativeToDate){canCacheRange=!1,isRelative=!0;const relativeToEventId=eventStartLineRegexMatch[to_relativeEventIdMatchIndex];let relativeTo;if(relativeToEventId){const event=context.getById(relativeToEventId);event&&isEvent(event)&&(relativeTo=toDateRange(event.dateRangeIso).toDateTime)}relativeTo||(relativeTo=fromDateTime),endDateTime=RelativeDate.from(eventEndDate,relativeTo)}else if(toCasual)endDateTime=DateTime$1.fromISO(roundDateUp(toCasual,context),{setZone:!0,zone:context.timezone});else if(slashDateTo){const timeComponent=eventStartLineRegexMatch[to_slashDateTimeMatchIndex];let slashPart=slashDateTo;timeComponent&&(slashPart=slashPart.substring(0,slashPart.indexOf(timeComponent)).trim().replace(/,/g,""));const parsed=parseSlashDate(slashPart,context.header.dateFormat,context);if(parsed)if(timeComponent){const parsedFromIso=DateTime$1.fromISO(parsed.dateTimeIso,{setZone:!0,zone:context.timezone}),timePart=function(eventStartMatches){return getTimeFromRegExpMatch(eventStartMatches,to_slashDateTimeMeridiemHourMatchIndex,to_slashDateTimeMeridiemMinuteMatchIndex,to_slashDateTimeMeridiemMeridiemMatchIndex,to_slashDateTime24HourHourMatchIndex,to_slashDateTime24HourMinuteMatchIndex)}(eventStartLineRegexMatch),timePartFromIso=DateTime$1.fromISO(timePart.dateTimeIso,{setZone:!0,zone:context.timezone});endDateTime=parsedFromIso.set({hour:timePartFromIso.hour,minute:timePartFromIso.minute}),endDateTime=DateTime$1.fromISO(roundDateUp({dateTimeIso:endDateTime.toISO(),granularity:timePart.granularity},context),{setZone:!0,zone:context.timezone})}else endDateTime=DateTime$1.fromISO(roundDateUp(parsed,context),{setZone:!0,zone:context.timezone});else context.parseMessages.push({type:"error",message:"Was supposed to have a slash date but couldn't parse it",pos:[dateRangeInText.from,dateRangeInText.to]})}else if(timeOnlyTo){const timeTo=getTimeFromRegExpMatch(eventStartLineRegexMatch,to_timeOnlyMeridiemHourMatchIndex,to_timeOnlyMeridiemMinuteMatchIndex,to_timeOnlyMeridiemMeridiemMatchIndex,to_timeOnly24HourHourMatchIndex,to_timeOnly24HourMinuteMatchIndex),timeToIso=DateTime$1.fromISO(timeTo.dateTimeIso,{setZone:!0,zone:context.timezone});let eventStartWithTimeTo=fromDateTime.set({hour:timeToIso.hour,minute:timeToIso.minute});eventStartWithTimeTo<fromDateTime&&(eventStartWithTimeTo=eventStartWithTimeTo.plus({days:1})),endDateTime=eventStartWithTimeTo,granularity=timeTo.granularity}else nowTo?(endDateTime=context.zonedNow,granularity="instant"):endDateTime=DateTime$1.fromISO(roundDateUp({dateTimeIso:eventEndDate,granularity:"instant"},context),{setZone:!0,zone:context.timezone});endDateTime&&endDateTime.isValid||(endDateTime=DateTime$1.fromISO(roundDateUp({dateTimeIso:fromDateTime.toISO(),granularity:granularity},context),{setZone:!0,zone:context.timezone}));const recurrence=checkRecurrence(0,i,lengthAtIndex,eventStartLineRegexMatch,context);recurrence&&context.ranges.push(recurrence.range);const colon=colonRange(RangeType.DateRangeColon);context.ranges.push(colon);const dateRange=new DateRangePart({from:fromDateTime,to:endDateTime,originalString:datePart,dateRangeInText:dateRangeInText,eventText:eventStartLineRegexMatch[eventTextMatchIndex],recurrence:recurrence,isRelative:isRelative,definition:__spreadProps(__spreadValues({},dateRangeInText),{type:RangeType.EventDefinition,to:colon.to})});return canCacheRange&&(null==(_c2=context.cache)||_c2.zone(context.timezone).ranges.set(datePart,{fromDateTimeIso:fromDateTime.toISO(),toDateTimeIso:endDateTime.toISO()})),dateRange}var define_process_default={};const perf="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,warned=new Set,PROCESS=define_process_default||{},emitWarning=(msg,type,code,fn)=>{"function"==typeof PROCESS.emitWarning?PROCESS.emitWarning(msg,type,code,fn):console.error(`[${code}] ${type}: ${msg}`)};let AC=globalThis.AbortController,AS=globalThis.AbortSignal;if(void 0===AC){AS=class{constructor(){__publicField(this,"onabort"),__publicField(this,"_onabort",[]),__publicField(this,"reason"),__publicField(this,"aborted",!1)}addEventListener(_,fn){this._onabort.push(fn)}},AC=class{constructor(){__publicField(this,"signal",new AS),warnACPolyfill()}abort(reason){var _a2,_b2;if(!this.signal.aborted){this.signal.reason=reason,this.signal.aborted=!0;for(const fn of this.signal._onabort)fn(reason);null==(_b2=(_a2=this.signal).onabort)||_b2.call(_a2,reason)}}};let printACPolyfillWarning="1"!==(null==(_a=PROCESS.env)?void 0:_a.LRU_CACHE_IGNORE_AC_WARNING);const warnACPolyfill=()=>{printACPolyfillWarning&&(printACPolyfillWarning=!1,emitWarning("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",warnACPolyfill))}}const isPosInt=n2=>n2&&n2===Math.floor(n2)&&n2>0&&isFinite(n2),getUintArray=max=>isPosInt(max)?max<=Math.pow(2,8)?Uint8Array:max<=Math.pow(2,16)?Uint16Array:max<=Math.pow(2,32)?Uint32Array:max<=Number.MAX_SAFE_INTEGER?ZeroArray:null:null;class ZeroArray extends Array{constructor(size2){super(size2),this.fill(0)}}const _Stack=class _Stack{constructor(max,HeapCls){if(__publicField(this,"heap"),__publicField(this,"length"),!__privateGet(_Stack,_constructing))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new HeapCls(max),this.length=0}static create(max){const HeapCls=getUintArray(max);if(!HeapCls)return[];__privateSet(_Stack,_constructing,!0);const s2=new _Stack(max,HeapCls);return __privateSet(_Stack,_constructing,!1),s2}push(n2){this.heap[this.length++]=n2}pop(){return this.heap[--this.length]}};_constructing=new WeakMap,__privateAdd(_Stack,_constructing,!1);let Stack=_Stack;const _LRUCache=class _LRUCache{constructor(options){__privateAdd(this,_LRUCache_instances),__privateAdd(this,_max),__privateAdd(this,_maxSize),__privateAdd(this,_dispose),__privateAdd(this,_onInsert),__privateAdd(this,_disposeAfter),__privateAdd(this,_fetchMethod),__privateAdd(this,_memoMethod),__publicField(this,"ttl"),__publicField(this,"ttlResolution"),__publicField(this,"ttlAutopurge"),__publicField(this,"updateAgeOnGet"),__publicField(this,"updateAgeOnHas"),__publicField(this,"allowStale"),__publicField(this,"noDisposeOnSet"),__publicField(this,"noUpdateTTL"),__publicField(this,"maxEntrySize"),__publicField(this,"sizeCalculation"),__publicField(this,"noDeleteOnFetchRejection"),__publicField(this,"noDeleteOnStaleGet"),__publicField(this,"allowStaleOnFetchAbort"),__publicField(this,"allowStaleOnFetchRejection"),__publicField(this,"ignoreFetchAbort"),__privateAdd(this,_size),__privateAdd(this,_calculatedSize),__privateAdd(this,_keyMap),__privateAdd(this,_keyList),__privateAdd(this,_valList),__privateAdd(this,_next),__privateAdd(this,_prev),__privateAdd(this,_head),__privateAdd(this,_tail),__privateAdd(this,_free),__privateAdd(this,_disposed),__privateAdd(this,_sizes),__privateAdd(this,_starts),__privateAdd(this,_ttls),__privateAdd(this,_hasDispose),__privateAdd(this,_hasFetchMethod),__privateAdd(this,_hasDisposeAfter),__privateAdd(this,_hasOnInsert),__privateAdd(this,_updateItemAge,()=>{}),__privateAdd(this,_statusTTL,()=>{}),__privateAdd(this,_setItemTTL,()=>{}),__privateAdd(this,_isStale,()=>!1),__privateAdd(this,_removeItemSize,_i=>{}),__privateAdd(this,_addItemSize,(_i,_s,_st)=>{}),__privateAdd(this,_requireSize,(_k,_v,size2,sizeCalculation)=>{if(size2||sizeCalculation)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0}),__publicField(this,_b,"LRUCache");const{max:max=0,ttl:ttl,ttlResolution:ttlResolution=1,ttlAutopurge:ttlAutopurge,updateAgeOnGet:updateAgeOnGet,updateAgeOnHas:updateAgeOnHas,allowStale:allowStale,dispose:dispose,onInsert:onInsert,disposeAfter:disposeAfter,noDisposeOnSet:noDisposeOnSet,noUpdateTTL:noUpdateTTL,maxSize:maxSize=0,maxEntrySize:maxEntrySize=0,sizeCalculation:sizeCalculation,fetchMethod:fetchMethod,memoMethod:memoMethod,noDeleteOnFetchRejection:noDeleteOnFetchRejection,noDeleteOnStaleGet:noDeleteOnStaleGet,allowStaleOnFetchRejection:allowStaleOnFetchRejection,allowStaleOnFetchAbort:allowStaleOnFetchAbort,ignoreFetchAbort:ignoreFetchAbort}=options;if(0!==max&&!isPosInt(max))throw new TypeError("max option must be a nonnegative integer");const UintArray=max?getUintArray(max):Array;if(!UintArray)throw new Error("invalid max value: "+max);if(__privateSet(this,_max,max),__privateSet(this,_maxSize,maxSize),this.maxEntrySize=maxEntrySize||__privateGet(this,_maxSize),this.sizeCalculation=sizeCalculation,this.sizeCalculation){if(!__privateGet(this,_maxSize)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==memoMethod&&"function"!=typeof memoMethod)throw new TypeError("memoMethod must be a function if defined");if(__privateSet(this,_memoMethod,memoMethod),void 0!==fetchMethod&&"function"!=typeof fetchMethod)throw new TypeError("fetchMethod must be a function if specified");if(__privateSet(this,_fetchMethod,fetchMethod),__privateSet(this,_hasFetchMethod,!!fetchMethod),__privateSet(this,_keyMap,new Map),__privateSet(this,_keyList,new Array(max).fill(void 0)),__privateSet(this,_valList,new Array(max).fill(void 0)),__privateSet(this,_next,new UintArray(max)),__privateSet(this,_prev,new UintArray(max)),__privateSet(this,_head,0),__privateSet(this,_tail,0),__privateSet(this,_free,Stack.create(max)),__privateSet(this,_size,0),__privateSet(this,_calculatedSize,0),"function"==typeof dispose&&__privateSet(this,_dispose,dispose),"function"==typeof onInsert&&__privateSet(this,_onInsert,onInsert),"function"==typeof disposeAfter?(__privateSet(this,_disposeAfter,disposeAfter),__privateSet(this,_disposed,[])):(__privateSet(this,_disposeAfter,void 0),__privateSet(this,_disposed,void 0)),__privateSet(this,_hasDispose,!!__privateGet(this,_dispose)),__privateSet(this,_hasOnInsert,!!__privateGet(this,_onInsert)),__privateSet(this,_hasDisposeAfter,!!__privateGet(this,_disposeAfter)),this.noDisposeOnSet=!!noDisposeOnSet,this.noUpdateTTL=!!noUpdateTTL,this.noDeleteOnFetchRejection=!!noDeleteOnFetchRejection,this.allowStaleOnFetchRejection=!!allowStaleOnFetchRejection,this.allowStaleOnFetchAbort=!!allowStaleOnFetchAbort,this.ignoreFetchAbort=!!ignoreFetchAbort,0!==this.maxEntrySize){if(0!==__privateGet(this,_maxSize)&&!isPosInt(__privateGet(this,_maxSize)))throw new TypeError("maxSize must be a positive integer if specified");if(!isPosInt(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");__privateMethod(this,_LRUCache_instances,initializeSizeTracking_fn).call(this)}if(this.allowStale=!!allowStale,this.noDeleteOnStaleGet=!!noDeleteOnStaleGet,this.updateAgeOnGet=!!updateAgeOnGet,this.updateAgeOnHas=!!updateAgeOnHas,this.ttlResolution=isPosInt(ttlResolution)||0===ttlResolution?ttlResolution:1,this.ttlAutopurge=!!ttlAutopurge,this.ttl=ttl||0,this.ttl){if(!isPosInt(this.ttl))throw new TypeError("ttl must be a positive integer if specified");__privateMethod(this,_LRUCache_instances,initializeTTLTracking_fn).call(this)}if(0===__privateGet(this,_max)&&0===this.ttl&&0===__privateGet(this,_maxSize))throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!__privateGet(this,_max)&&!__privateGet(this,_maxSize)){const code="LRU_CACHE_UNBOUNDED";if((code=>!warned.has(code))(code)){warned.add(code);emitWarning("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",code,_LRUCache)}}}static unsafeExposeInternals(c){return{starts:__privateGet(c,_starts),ttls:__privateGet(c,_ttls),sizes:__privateGet(c,_sizes),keyMap:__privateGet(c,_keyMap),keyList:__privateGet(c,_keyList),valList:__privateGet(c,_valList),next:__privateGet(c,_next),prev:__privateGet(c,_prev),get head(){return __privateGet(c,_head)},get tail(){return __privateGet(c,_tail)},free:__privateGet(c,_free),isBackgroundFetch:p2=>{var _a2;return __privateMethod(_a2=c,_LRUCache_instances,isBackgroundFetch_fn).call(_a2,p2)},backgroundFetch:(k,index2,options,context)=>{var _a2;return __privateMethod(_a2=c,_LRUCache_instances,backgroundFetch_fn).call(_a2,k,index2,options,context)},moveToTail:index2=>{var _a2;return __privateMethod(_a2=c,_LRUCache_instances,moveToTail_fn).call(_a2,index2)},indexes:options=>{var _a2;return __privateMethod(_a2=c,_LRUCache_instances,indexes_fn).call(_a2,options)},rindexes:options=>{var _a2;return __privateMethod(_a2=c,_LRUCache_instances,rindexes_fn).call(_a2,options)},isStale:index2=>{var _a2;return __privateGet(_a2=c,_isStale).call(_a2,index2)}}}get max(){return __privateGet(this,_max)}get maxSize(){return __privateGet(this,_maxSize)}get calculatedSize(){return __privateGet(this,_calculatedSize)}get size(){return __privateGet(this,_size)}get fetchMethod(){return __privateGet(this,_fetchMethod)}get memoMethod(){return __privateGet(this,_memoMethod)}get dispose(){return __privateGet(this,_dispose)}get onInsert(){return __privateGet(this,_onInsert)}get disposeAfter(){return __privateGet(this,_disposeAfter)}getRemainingTTL(key){return __privateGet(this,_keyMap).has(key)?1/0:0}*entries(){for(const i of __privateMethod(this,_LRUCache_instances,indexes_fn).call(this))void 0===__privateGet(this,_valList)[i]||void 0===__privateGet(this,_keyList)[i]||__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,__privateGet(this,_valList)[i])||(yield[__privateGet(this,_keyList)[i],__privateGet(this,_valList)[i]])}*rentries(){for(const i of __privateMethod(this,_LRUCache_instances,rindexes_fn).call(this))void 0===__privateGet(this,_valList)[i]||void 0===__privateGet(this,_keyList)[i]||__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,__privateGet(this,_valList)[i])||(yield[__privateGet(this,_keyList)[i],__privateGet(this,_valList)[i]])}*keys(){for(const i of __privateMethod(this,_LRUCache_instances,indexes_fn).call(this)){const k=__privateGet(this,_keyList)[i];void 0===k||__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,__privateGet(this,_valList)[i])||(yield k)}}*rkeys(){for(const i of __privateMethod(this,_LRUCache_instances,rindexes_fn).call(this)){const k=__privateGet(this,_keyList)[i];void 0===k||__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,__privateGet(this,_valList)[i])||(yield k)}}*values(){for(const i of __privateMethod(this,_LRUCache_instances,indexes_fn).call(this)){void 0===__privateGet(this,_valList)[i]||__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,__privateGet(this,_valList)[i])||(yield __privateGet(this,_valList)[i])}}*rvalues(){for(const i of __privateMethod(this,_LRUCache_instances,rindexes_fn).call(this)){void 0===__privateGet(this,_valList)[i]||__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,__privateGet(this,_valList)[i])||(yield __privateGet(this,_valList)[i])}}[(_c=Symbol.iterator,_b=Symbol.toStringTag,_c)](){return this.entries()}find(fn,getOptions={}){for(const i of __privateMethod(this,_LRUCache_instances,indexes_fn).call(this)){const v=__privateGet(this,_valList)[i],value=__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)?v.__staleWhileFetching:v;if(void 0!==value&&fn(value,__privateGet(this,_keyList)[i],this))return this.get(__privateGet(this,_keyList)[i],getOptions)}}forEach(fn,thisp=this){for(const i of __privateMethod(this,_LRUCache_instances,indexes_fn).call(this)){const v=__privateGet(this,_valList)[i],value=__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)?v.__staleWhileFetching:v;void 0!==value&&fn.call(thisp,value,__privateGet(this,_keyList)[i],this)}}rforEach(fn,thisp=this){for(const i of __privateMethod(this,_LRUCache_instances,rindexes_fn).call(this)){const v=__privateGet(this,_valList)[i],value=__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)?v.__staleWhileFetching:v;void 0!==value&&fn.call(thisp,value,__privateGet(this,_keyList)[i],this)}}purgeStale(){let deleted=!1;for(const i of __privateMethod(this,_LRUCache_instances,rindexes_fn).call(this,{allowStale:!0}))__privateGet(this,_isStale).call(this,i)&&(__privateMethod(this,_LRUCache_instances,delete_fn).call(this,__privateGet(this,_keyList)[i],"expire"),deleted=!0);return deleted}info(key){const i=__privateGet(this,_keyMap).get(key);if(void 0===i)return;const v=__privateGet(this,_valList)[i],value=__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)?v.__staleWhileFetching:v;if(void 0===value)return;const entry={value:value};if(__privateGet(this,_ttls)&&__privateGet(this,_starts)){const ttl=__privateGet(this,_ttls)[i],start=__privateGet(this,_starts)[i];if(ttl&&start){const remain=ttl-(perf.now()-start);entry.ttl=remain,entry.start=Date.now()}}return __privateGet(this,_sizes)&&(entry.size=__privateGet(this,_sizes)[i]),entry}dump(){const arr=[];for(const i of __privateMethod(this,_LRUCache_instances,indexes_fn).call(this,{allowStale:!0})){const key=__privateGet(this,_keyList)[i],v=__privateGet(this,_valList)[i],value=__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)?v.__staleWhileFetching:v;if(void 0===value||void 0===key)continue;const entry={value:value};if(__privateGet(this,_ttls)&&__privateGet(this,_starts)){entry.ttl=__privateGet(this,_ttls)[i];const age=perf.now()-__privateGet(this,_starts)[i];entry.start=Math.floor(Date.now()-age)}__privateGet(this,_sizes)&&(entry.size=__privateGet(this,_sizes)[i]),arr.unshift([key,entry])}return arr}load(arr){this.clear();for(const[key,entry]of arr){if(entry.start){const age=Date.now()-entry.start;entry.start=perf.now()-age}this.set(key,entry.value,entry)}}set(k,v,setOptions={}){var _a2,_b2,_c2,_d,_e,_f,_g;if(void 0===v)return this.delete(k),this;const{ttl:ttl=this.ttl,start:start,noDisposeOnSet:noDisposeOnSet=this.noDisposeOnSet,sizeCalculation:sizeCalculation=this.sizeCalculation,status:status}=setOptions;let{noUpdateTTL:noUpdateTTL=this.noUpdateTTL}=setOptions;const size2=__privateGet(this,_requireSize).call(this,k,v,setOptions.size||0,sizeCalculation);if(this.maxEntrySize&&size2>this.maxEntrySize)return status&&(status.set="miss",status.maxEntrySizeExceeded=!0),__privateMethod(this,_LRUCache_instances,delete_fn).call(this,k,"set"),this;let index2=0===__privateGet(this,_size)?void 0:__privateGet(this,_keyMap).get(k);if(void 0===index2)index2=0===__privateGet(this,_size)?__privateGet(this,_tail):0!==__privateGet(this,_free).length?__privateGet(this,_free).pop():__privateGet(this,_size)===__privateGet(this,_max)?__privateMethod(this,_LRUCache_instances,evict_fn).call(this,!1):__privateGet(this,_size),__privateGet(this,_keyList)[index2]=k,__privateGet(this,_valList)[index2]=v,__privateGet(this,_keyMap).set(k,index2),__privateGet(this,_next)[__privateGet(this,_tail)]=index2,__privateGet(this,_prev)[index2]=__privateGet(this,_tail),__privateSet(this,_tail,index2),__privateWrapper(this,_size)._++,__privateGet(this,_addItemSize).call(this,index2,size2,status),status&&(status.set="add"),noUpdateTTL=!1,__privateGet(this,_hasOnInsert)&&(null==(_a2=__privateGet(this,_onInsert))||_a2.call(this,v,k,"add"));else{__privateMethod(this,_LRUCache_instances,moveToTail_fn).call(this,index2);const oldVal=__privateGet(this,_valList)[index2];if(v!==oldVal){if(__privateGet(this,_hasFetchMethod)&&__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,oldVal)){oldVal.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:s2}=oldVal;void 0===s2||noDisposeOnSet||(__privateGet(this,_hasDispose)&&(null==(_b2=__privateGet(this,_dispose))||_b2.call(this,s2,k,"set")),__privateGet(this,_hasDisposeAfter)&&(null==(_c2=__privateGet(this,_disposed))||_c2.push([s2,k,"set"])))}else noDisposeOnSet||(__privateGet(this,_hasDispose)&&(null==(_d=__privateGet(this,_dispose))||_d.call(this,oldVal,k,"set")),__privateGet(this,_hasDisposeAfter)&&(null==(_e=__privateGet(this,_disposed))||_e.push([oldVal,k,"set"])));if(__privateGet(this,_removeItemSize).call(this,index2),__privateGet(this,_addItemSize).call(this,index2,size2,status),__privateGet(this,_valList)[index2]=v,status){status.set="replace";const oldValue=oldVal&&__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,oldVal)?oldVal.__staleWhileFetching:oldVal;void 0!==oldValue&&(status.oldValue=oldValue)}}else status&&(status.set="update");__privateGet(this,_hasOnInsert)&&(null==(_f=this.onInsert)||_f.call(this,v,k,v===oldVal?"update":"replace"))}if(0===ttl||__privateGet(this,_ttls)||__privateMethod(this,_LRUCache_instances,initializeTTLTracking_fn).call(this),__privateGet(this,_ttls)&&(noUpdateTTL||__privateGet(this,_setItemTTL).call(this,index2,ttl,start),status&&__privateGet(this,_statusTTL).call(this,status,index2)),!noDisposeOnSet&&__privateGet(this,_hasDisposeAfter)&&__privateGet(this,_disposed)){const dt=__privateGet(this,_disposed);let task;for(;task=null==dt?void 0:dt.shift();)null==(_g=__privateGet(this,_disposeAfter))||_g.call(this,...task)}return this}pop(){var _a2;try{for(;__privateGet(this,_size);){const val=__privateGet(this,_valList)[__privateGet(this,_head)];if(__privateMethod(this,_LRUCache_instances,evict_fn).call(this,!0),__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,val)){if(val.__staleWhileFetching)return val.__staleWhileFetching}else if(void 0!==val)return val}}finally{if(__privateGet(this,_hasDisposeAfter)&&__privateGet(this,_disposed)){const dt=__privateGet(this,_disposed);let task;for(;task=null==dt?void 0:dt.shift();)null==(_a2=__privateGet(this,_disposeAfter))||_a2.call(this,...task)}}}has(k,hasOptions={}){const{updateAgeOnHas:updateAgeOnHas=this.updateAgeOnHas,status:status}=hasOptions,index2=__privateGet(this,_keyMap).get(k);if(void 0!==index2){const v=__privateGet(this,_valList)[index2];if(__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)&&void 0===v.__staleWhileFetching)return!1;if(!__privateGet(this,_isStale).call(this,index2))return updateAgeOnHas&&__privateGet(this,_updateItemAge).call(this,index2),status&&(status.has="hit",__privateGet(this,_statusTTL).call(this,status,index2)),!0;status&&(status.has="stale",__privateGet(this,_statusTTL).call(this,status,index2))}else status&&(status.has="miss");return!1}peek(k,peekOptions={}){const{allowStale:allowStale=this.allowStale}=peekOptions,index2=__privateGet(this,_keyMap).get(k);if(void 0===index2||!allowStale&&__privateGet(this,_isStale).call(this,index2))return;const v=__privateGet(this,_valList)[index2];return __privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)?v.__staleWhileFetching:v}async fetch(k,fetchOptions={}){const{allowStale:allowStale=this.allowStale,updateAgeOnGet:updateAgeOnGet=this.updateAgeOnGet,noDeleteOnStaleGet:noDeleteOnStaleGet=this.noDeleteOnStaleGet,ttl:ttl=this.ttl,noDisposeOnSet:noDisposeOnSet=this.noDisposeOnSet,size:size2=0,sizeCalculation:sizeCalculation=this.sizeCalculation,noUpdateTTL:noUpdateTTL=this.noUpdateTTL,noDeleteOnFetchRejection:noDeleteOnFetchRejection=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:allowStaleOnFetchRejection=this.allowStaleOnFetchRejection,ignoreFetchAbort:ignoreFetchAbort=this.ignoreFetchAbort,allowStaleOnFetchAbort:allowStaleOnFetchAbort=this.allowStaleOnFetchAbort,context:context,forceRefresh:forceRefresh=!1,status:status,signal:signal}=fetchOptions;if(!__privateGet(this,_hasFetchMethod))return status&&(status.fetch="get"),this.get(k,{allowStale:allowStale,updateAgeOnGet:updateAgeOnGet,noDeleteOnStaleGet:noDeleteOnStaleGet,status:status});const options={allowStale:allowStale,updateAgeOnGet:updateAgeOnGet,noDeleteOnStaleGet:noDeleteOnStaleGet,ttl:ttl,noDisposeOnSet:noDisposeOnSet,size:size2,sizeCalculation:sizeCalculation,noUpdateTTL:noUpdateTTL,noDeleteOnFetchRejection:noDeleteOnFetchRejection,allowStaleOnFetchRejection:allowStaleOnFetchRejection,allowStaleOnFetchAbort:allowStaleOnFetchAbort,ignoreFetchAbort:ignoreFetchAbort,status:status,signal:signal};let index2=__privateGet(this,_keyMap).get(k);if(void 0===index2){status&&(status.fetch="miss");const p2=__privateMethod(this,_LRUCache_instances,backgroundFetch_fn).call(this,k,index2,options,context);return p2.__returned=p2}{const v=__privateGet(this,_valList)[index2];if(__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)){const stale=allowStale&&void 0!==v.__staleWhileFetching;return status&&(status.fetch="inflight",stale&&(status.returnedStale=!0)),stale?v.__staleWhileFetching:v.__returned=v}const isStale=__privateGet(this,_isStale).call(this,index2);if(!forceRefresh&&!isStale)return status&&(status.fetch="hit"),__privateMethod(this,_LRUCache_instances,moveToTail_fn).call(this,index2),updateAgeOnGet&&__privateGet(this,_updateItemAge).call(this,index2),status&&__privateGet(this,_statusTTL).call(this,status,index2),v;const p2=__privateMethod(this,_LRUCache_instances,backgroundFetch_fn).call(this,k,index2,options,context),staleVal=void 0!==p2.__staleWhileFetching&&allowStale;return status&&(status.fetch=isStale?"stale":"refresh",staleVal&&isStale&&(status.returnedStale=!0)),staleVal?p2.__staleWhileFetching:p2.__returned=p2}}async forceFetch(k,fetchOptions={}){const v=await this.fetch(k,fetchOptions);if(void 0===v)throw new Error("fetch() returned undefined");return v}memo(k,memoOptions={}){const memoMethod=__privateGet(this,_memoMethod);if(!memoMethod)throw new Error("no memoMethod provided to constructor");const _a2=memoOptions,{context:context,forceRefresh:forceRefresh}=_a2,options=__objRest(_a2,["context","forceRefresh"]),v=this.get(k,options);if(!forceRefresh&&void 0!==v)return v;const vv=memoMethod(k,v,{options:options,context:context});return this.set(k,vv,options),vv}get(k,getOptions={}){const{allowStale:allowStale=this.allowStale,updateAgeOnGet:updateAgeOnGet=this.updateAgeOnGet,noDeleteOnStaleGet:noDeleteOnStaleGet=this.noDeleteOnStaleGet,status:status}=getOptions,index2=__privateGet(this,_keyMap).get(k);if(void 0!==index2){const value=__privateGet(this,_valList)[index2],fetching=__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,value);return status&&__privateGet(this,_statusTTL).call(this,status,index2),__privateGet(this,_isStale).call(this,index2)?(status&&(status.get="stale"),fetching?(status&&allowStale&&void 0!==value.__staleWhileFetching&&(status.returnedStale=!0),allowStale?value.__staleWhileFetching:void 0):(noDeleteOnStaleGet||__privateMethod(this,_LRUCache_instances,delete_fn).call(this,k,"expire"),status&&allowStale&&(status.returnedStale=!0),allowStale?value:void 0)):(status&&(status.get="hit"),fetching?value.__staleWhileFetching:(__privateMethod(this,_LRUCache_instances,moveToTail_fn).call(this,index2),updateAgeOnGet&&__privateGet(this,_updateItemAge).call(this,index2),value))}status&&(status.get="miss")}delete(k){return __privateMethod(this,_LRUCache_instances,delete_fn).call(this,k,"delete")}clear(){return __privateMethod(this,_LRUCache_instances,clear_fn).call(this,"delete")}};_max=new WeakMap,_maxSize=new WeakMap,_dispose=new WeakMap,_onInsert=new WeakMap,_disposeAfter=new WeakMap,_fetchMethod=new WeakMap,_memoMethod=new WeakMap,_size=new WeakMap,_calculatedSize=new WeakMap,_keyMap=new WeakMap,_keyList=new WeakMap,_valList=new WeakMap,_next=new WeakMap,_prev=new WeakMap,_head=new WeakMap,_tail=new WeakMap,_free=new WeakMap,_disposed=new WeakMap,_sizes=new WeakMap,_starts=new WeakMap,_ttls=new WeakMap,_hasDispose=new WeakMap,_hasFetchMethod=new WeakMap,_hasDisposeAfter=new WeakMap,_hasOnInsert=new WeakMap,_LRUCache_instances=new WeakSet,initializeTTLTracking_fn=function(){const ttls=new ZeroArray(__privateGet(this,_max)),starts=new ZeroArray(__privateGet(this,_max));__privateSet(this,_ttls,ttls),__privateSet(this,_starts,starts),__privateSet(this,_setItemTTL,(index2,ttl,start=perf.now())=>{if(starts[index2]=0!==ttl?start:0,ttls[index2]=ttl,0!==ttl&&this.ttlAutopurge){const t=setTimeout(()=>{__privateGet(this,_isStale).call(this,index2)&&__privateMethod(this,_LRUCache_instances,delete_fn).call(this,__privateGet(this,_keyList)[index2],"expire")},ttl+1);t.unref&&t.unref()}}),__privateSet(this,_updateItemAge,index2=>{starts[index2]=0!==ttls[index2]?perf.now():0}),__privateSet(this,_statusTTL,(status,index2)=>{if(ttls[index2]){const ttl=ttls[index2],start=starts[index2];if(!ttl||!start)return;status.ttl=ttl,status.start=start,status.now=cachedNow2||getNow2();const age=status.now-start;status.remainingTTL=ttl-age}});let cachedNow2=0;const getNow2=()=>{const n2=perf.now();if(this.ttlResolution>0){cachedNow2=n2;const t=setTimeout(()=>cachedNow2=0,this.ttlResolution);t.unref&&t.unref()}return n2};this.getRemainingTTL=key=>{const index2=__privateGet(this,_keyMap).get(key);if(void 0===index2)return 0;const ttl=ttls[index2],start=starts[index2];if(!ttl||!start)return 1/0;return ttl-((cachedNow2||getNow2())-start)},__privateSet(this,_isStale,index2=>{const s2=starts[index2],t=ttls[index2];return!!t&&!!s2&&(cachedNow2||getNow2())-s2>t})},_updateItemAge=new WeakMap,_statusTTL=new WeakMap,_setItemTTL=new WeakMap,_isStale=new WeakMap,initializeSizeTracking_fn=function(){const sizes=new ZeroArray(__privateGet(this,_max));__privateSet(this,_calculatedSize,0),__privateSet(this,_sizes,sizes),__privateSet(this,_removeItemSize,index2=>{__privateSet(this,_calculatedSize,__privateGet(this,_calculatedSize)-sizes[index2]),sizes[index2]=0}),__privateSet(this,_requireSize,(k,v,size2,sizeCalculation)=>{if(__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v))return 0;if(!isPosInt(size2)){if(!sizeCalculation)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof sizeCalculation)throw new TypeError("sizeCalculation must be a function");if(size2=sizeCalculation(v,k),!isPosInt(size2))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return size2}),__privateSet(this,_addItemSize,(index2,size2,status)=>{if(sizes[index2]=size2,__privateGet(this,_maxSize)){const maxSize=__privateGet(this,_maxSize)-sizes[index2];for(;__privateGet(this,_calculatedSize)>maxSize;)__privateMethod(this,_LRUCache_instances,evict_fn).call(this,!0)}__privateSet(this,_calculatedSize,__privateGet(this,_calculatedSize)+sizes[index2]),status&&(status.entrySize=size2,status.totalCalculatedSize=__privateGet(this,_calculatedSize))})},_removeItemSize=new WeakMap,_addItemSize=new WeakMap,_requireSize=new WeakMap,indexes_fn=function*({allowStale:allowStale=this.allowStale}={}){if(__privateGet(this,_size))for(let i=__privateGet(this,_tail);__privateMethod(this,_LRUCache_instances,isValidIndex_fn).call(this,i)&&(!allowStale&&__privateGet(this,_isStale).call(this,i)||(yield i),i!==__privateGet(this,_head));)i=__privateGet(this,_prev)[i]},rindexes_fn=function*({allowStale:allowStale=this.allowStale}={}){if(__privateGet(this,_size))for(let i=__privateGet(this,_head);__privateMethod(this,_LRUCache_instances,isValidIndex_fn).call(this,i)&&(!allowStale&&__privateGet(this,_isStale).call(this,i)||(yield i),i!==__privateGet(this,_tail));)i=__privateGet(this,_next)[i]},isValidIndex_fn=function(index2){return void 0!==index2&&__privateGet(this,_keyMap).get(__privateGet(this,_keyList)[index2])===index2},evict_fn=function(free){var _a2,_b2;const head=__privateGet(this,_head),k=__privateGet(this,_keyList)[head],v=__privateGet(this,_valList)[head];return __privateGet(this,_hasFetchMethod)&&__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)?v.__abortController.abort(new Error("evicted")):(__privateGet(this,_hasDispose)||__privateGet(this,_hasDisposeAfter))&&(__privateGet(this,_hasDispose)&&(null==(_a2=__privateGet(this,_dispose))||_a2.call(this,v,k,"evict")),__privateGet(this,_hasDisposeAfter)&&(null==(_b2=__privateGet(this,_disposed))||_b2.push([v,k,"evict"]))),__privateGet(this,_removeItemSize).call(this,head),free&&(__privateGet(this,_keyList)[head]=void 0,__privateGet(this,_valList)[head]=void 0,__privateGet(this,_free).push(head)),1===__privateGet(this,_size)?(__privateSet(this,_head,__privateSet(this,_tail,0)),__privateGet(this,_free).length=0):__privateSet(this,_head,__privateGet(this,_next)[head]),__privateGet(this,_keyMap).delete(k),__privateWrapper(this,_size)._--,head},backgroundFetch_fn=function(k,index2,options,context){const v=void 0===index2?void 0:__privateGet(this,_valList)[index2];if(__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v))return v;const ac=new AC,{signal:signal}=options;null==signal||signal.addEventListener("abort",()=>ac.abort(signal.reason),{signal:ac.signal});const fetchOpts={signal:ac.signal,options:options,context:context},cb=(v2,updateCache=!1)=>{const{aborted:aborted}=ac.signal,ignoreAbort=options.ignoreFetchAbort&&void 0!==v2;if(options.status&&(aborted&&!updateCache?(options.status.fetchAborted=!0,options.status.fetchError=ac.signal.reason,ignoreAbort&&(options.status.fetchAbortIgnored=!0)):options.status.fetchResolved=!0),aborted&&!ignoreAbort&&!updateCache)return fetchFail(ac.signal.reason);const bf2=p2;return __privateGet(this,_valList)[index2]===p2&&(void 0===v2?bf2.__staleWhileFetching?__privateGet(this,_valList)[index2]=bf2.__staleWhileFetching:__privateMethod(this,_LRUCache_instances,delete_fn).call(this,k,"fetch"):(options.status&&(options.status.fetchUpdated=!0),this.set(k,v2,fetchOpts.options))),v2},fetchFail=er=>{const{aborted:aborted}=ac.signal,allowStaleAborted=aborted&&options.allowStaleOnFetchAbort,allowStale=allowStaleAborted||options.allowStaleOnFetchRejection,noDelete=allowStale||options.noDeleteOnFetchRejection,bf2=p2;if(__privateGet(this,_valList)[index2]===p2){!noDelete||void 0===bf2.__staleWhileFetching?__privateMethod(this,_LRUCache_instances,delete_fn).call(this,k,"fetch"):allowStaleAborted||(__privateGet(this,_valList)[index2]=bf2.__staleWhileFetching)}if(allowStale)return options.status&&void 0!==bf2.__staleWhileFetching&&(options.status.returnedStale=!0),bf2.__staleWhileFetching;if(bf2.__returned===bf2)throw er};options.status&&(options.status.fetchDispatched=!0);const p2=new Promise((res,rej)=>{var _a2;const fmp=null==(_a2=__privateGet(this,_fetchMethod))?void 0:_a2.call(this,k,v,fetchOpts);fmp&&fmp instanceof Promise&&fmp.then(v2=>res(void 0===v2?void 0:v2),rej),ac.signal.addEventListener("abort",()=>{options.ignoreFetchAbort&&!options.allowStaleOnFetchAbort||(res(void 0),options.allowStaleOnFetchAbort&&(res=v2=>cb(v2,!0)))})}).then(cb,er=>(options.status&&(options.status.fetchRejected=!0,options.status.fetchError=er),fetchFail(er))),bf=Object.assign(p2,{__abortController:ac,__staleWhileFetching:v,__returned:void 0});return void 0===index2?(this.set(k,bf,__spreadProps(__spreadValues({},fetchOpts.options),{status:void 0})),index2=__privateGet(this,_keyMap).get(k)):__privateGet(this,_valList)[index2]=bf,bf},isBackgroundFetch_fn=function(p2){if(!__privateGet(this,_hasFetchMethod))return!1;const b=p2;return!!b&&b instanceof Promise&&b.hasOwnProperty("__staleWhileFetching")&&b.__abortController instanceof AC},connect_fn=function(p2,n2){__privateGet(this,_prev)[n2]=p2,__privateGet(this,_next)[p2]=n2},moveToTail_fn=function(index2){index2!==__privateGet(this,_tail)&&(index2===__privateGet(this,_head)?__privateSet(this,_head,__privateGet(this,_next)[index2]):__privateMethod(this,_LRUCache_instances,connect_fn).call(this,__privateGet(this,_prev)[index2],__privateGet(this,_next)[index2]),__privateMethod(this,_LRUCache_instances,connect_fn).call(this,__privateGet(this,_tail),index2),__privateSet(this,_tail,index2))},delete_fn=function(k,reason){var _a2,_b2,_c2,_d;let deleted=!1;if(0!==__privateGet(this,_size)){const index2=__privateGet(this,_keyMap).get(k);if(void 0!==index2)if(deleted=!0,1===__privateGet(this,_size))__privateMethod(this,_LRUCache_instances,clear_fn).call(this,reason);else{__privateGet(this,_removeItemSize).call(this,index2);const v=__privateGet(this,_valList)[index2];if(__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v)?v.__abortController.abort(new Error("deleted")):(__privateGet(this,_hasDispose)||__privateGet(this,_hasDisposeAfter))&&(__privateGet(this,_hasDispose)&&(null==(_a2=__privateGet(this,_dispose))||_a2.call(this,v,k,reason)),__privateGet(this,_hasDisposeAfter)&&(null==(_b2=__privateGet(this,_disposed))||_b2.push([v,k,reason]))),__privateGet(this,_keyMap).delete(k),__privateGet(this,_keyList)[index2]=void 0,__privateGet(this,_valList)[index2]=void 0,index2===__privateGet(this,_tail))__privateSet(this,_tail,__privateGet(this,_prev)[index2]);else if(index2===__privateGet(this,_head))__privateSet(this,_head,__privateGet(this,_next)[index2]);else{const pi=__privateGet(this,_prev)[index2];__privateGet(this,_next)[pi]=__privateGet(this,_next)[index2];const ni=__privateGet(this,_next)[index2];__privateGet(this,_prev)[ni]=__privateGet(this,_prev)[index2]}__privateWrapper(this,_size)._--,__privateGet(this,_free).push(index2)}}if(__privateGet(this,_hasDisposeAfter)&&(null==(_c2=__privateGet(this,_disposed))?void 0:_c2.length)){const dt=__privateGet(this,_disposed);let task;for(;task=null==dt?void 0:dt.shift();)null==(_d=__privateGet(this,_disposeAfter))||_d.call(this,...task)}return deleted},clear_fn=function(reason){var _a2,_b2,_c2;for(const index2 of __privateMethod(this,_LRUCache_instances,rindexes_fn).call(this,{allowStale:!0})){const v=__privateGet(this,_valList)[index2];if(__privateMethod(this,_LRUCache_instances,isBackgroundFetch_fn).call(this,v))v.__abortController.abort(new Error("deleted"));else{const k=__privateGet(this,_keyList)[index2];__privateGet(this,_hasDispose)&&(null==(_a2=__privateGet(this,_dispose))||_a2.call(this,v,k,reason)),__privateGet(this,_hasDisposeAfter)&&(null==(_b2=__privateGet(this,_disposed))||_b2.push([v,k,reason]))}}if(__privateGet(this,_keyMap).clear(),__privateGet(this,_valList).fill(void 0),__privateGet(this,_keyList).fill(void 0),__privateGet(this,_ttls)&&__privateGet(this,_starts)&&(__privateGet(this,_ttls).fill(0),__privateGet(this,_starts).fill(0)),__privateGet(this,_sizes)&&__privateGet(this,_sizes).fill(0),__privateSet(this,_head,0),__privateSet(this,_tail,0),__privateGet(this,_free).length=0,__privateSet(this,_calculatedSize,0),__privateSet(this,_size,0),__privateGet(this,_hasDisposeAfter)&&__privateGet(this,_disposed)){const dt=__privateGet(this,_disposed);let task;for(;task=null==dt?void 0:dt.shift();)null==(_c2=__privateGet(this,_disposeAfter))||_c2.call(this,...task)}};let LRUCache=_LRUCache;function checkComments(line,i,lengthAtIndex,context){if(line.match(COMMENT_REGEX)){const from=lengthAtIndex[i],to=from+line.length;context.ranges.push({type:RangeType.Comment,from:from,to:to});const currentFoldableComment=context.currentFoldableComment();if(currentFoldableComment)currentFoldableComment.endIndex=to;else{const indexOfSlashes=line.indexOf("//");context.startFoldable({startIndex:from,startLine:i,endIndex:to,type:"comment",foldStartIndex:from+(indexOfSlashes>-1?indexOfSlashes+2:0)})}return!0}return context.finishFoldableComment(i),!1}function checkListItems(line,i,lengthAtIndex,context){const checklistItemMatch=line.match(CHECKLIST_ITEM_REGEX);if(checklistItemMatch){const dashIndex=line.indexOf("-"),dashPosition=lengthAtIndex[i]+dashIndex,checkboxStart=lengthAtIndex[i]+line.indexOf(checklistItemMatch[1]),checkboxEnd=checkboxStart+checklistItemMatch[1].length,dashIndicator={type:RangeType.listItemIndicator,from:dashPosition,to:dashPosition+1},checkboxIndicator={type:RangeType.CheckboxItemIndicator,from:checkboxStart,to:checkboxEnd,content:"x"===checklistItemMatch[2]||"X"===checklistItemMatch[2]},contents={type:RangeType.ListItemContents,from:checkboxEnd,to:lengthAtIndex[i]+line.length};return context.ranges.push(dashIndicator,checkboxIndicator,contents),[dashIndicator,checkboxIndicator,contents]}if(line.match(LIST_ITEM_REGEX)){const dashIndex=line.indexOf("-"),dashPosition=lengthAtIndex[i]+dashIndex,indicator={type:RangeType.listItemIndicator,from:dashPosition,to:dashPosition+1},contents={type:RangeType.ListItemContents,from:dashPosition+2,to:lengthAtIndex[i]+line.length};return context.ranges.push(indicator,contents),[indicator,contents]}return!1}function propertyHexReplacer(line){return line.replace(/(^|\W+)#(\w+)/g,(match2,preHashWhitespace,tagName,offset2,str)=>`${preHashWhitespace})${tagName}`)}function checkHeaderTags(line,i,lengthAtIndex,context){return line.replace(/(^|\W+)#(\w+)/g,(match2,preHashWhitespace,tagName,offset2,str)=>{if(0===offset2){const from=lengthAtIndex[i]+offset2+preHashWhitespace.length;context.ranges.push({type:RangeType.Tag,from:from,to:from+tagName.length+1,content:{tag:tagName}})}return`${preHashWhitespace})${tagName}`})}function checkTags(line,i,lengthAtIndex,context){const matches=line.matchAll(TAG_REGEX);if(matches)for(let m of matches){const indexOfTag=line.indexOf("#"+m[1]),from=lengthAtIndex[i]+indexOfTag;context.ranges.push({type:RangeType.Tag,from:from,to:from+m[1].length+1,content:{tag:m[1]}})}return!1}function parseZone(zoneString,cache2){const tz=`${zoneString}`,cached=null==cache2?void 0:cache2.zones.get(tz);if(cached)return cached;{const formats=["z","ZZZ","ZZ","Z"];let zoneDateTime;for(const format of formats){if(zoneDateTime=DateTime$1.fromFormat(tz,format,{setZone:!0}),zoneDateTime.isValid&&zoneDateTime.zone.isValid)return null==cache2||cache2.zones.set(tz,zoneDateTime.zone),zoneDateTime.zone;if("z"!==format&&(zoneDateTime=DateTime$1.fromFormat(`+${tz}`,format,{setZone:!0}),zoneDateTime.isValid&&zoneDateTime.zone.isValid))return null==cache2||cache2.zones.set(tz,zoneDateTime.zone),zoneDateTime.zone}}}const ALIAS=Symbol.for("yaml.alias"),DOC=Symbol.for("yaml.document"),MAP=Symbol.for("yaml.map"),PAIR=Symbol.for("yaml.pair"),SCALAR$1=Symbol.for("yaml.scalar"),SEQ=Symbol.for("yaml.seq"),NODE_TYPE=Symbol.for("yaml.node.type"),isAlias=node=>!!node&&"object"==typeof node&&node[NODE_TYPE]===ALIAS,isDocument=node=>!!node&&"object"==typeof node&&node[NODE_TYPE]===DOC,isMap=node=>!!node&&"object"==typeof node&&node[NODE_TYPE]===MAP,isPair=node=>!!node&&"object"==typeof node&&node[NODE_TYPE]===PAIR,isScalar=node=>!!node&&"object"==typeof node&&node[NODE_TYPE]===SCALAR$1,isSeq=node=>!!node&&"object"==typeof node&&node[NODE_TYPE]===SEQ;function isCollection(node){if(node&&"object"==typeof node)switch(node[NODE_TYPE]){case MAP:case SEQ:return!0}return!1}function isNode(node){if(node&&"object"==typeof node)switch(node[NODE_TYPE]){case ALIAS:case MAP:case SCALAR$1:case SEQ:return!0}return!1}const hasAnchor=node=>(isScalar(node)||isCollection(node))&&!!node.anchor,BREAK=Symbol("break visit"),SKIP=Symbol("skip children"),REMOVE=Symbol("remove node");function visit(node,visitor){const visitor_=function(visitor){if("object"==typeof visitor&&(visitor.Collection||visitor.Node||visitor.Value))return Object.assign({Alias:visitor.Node,Map:visitor.Node,Scalar:visitor.Node,Seq:visitor.Node},visitor.Value&&{Map:visitor.Value,Scalar:visitor.Value,Seq:visitor.Value},visitor.Collection&&{Map:visitor.Collection,Seq:visitor.Collection},visitor);return visitor}(visitor);if(isDocument(node)){visit_(null,node.contents,visitor_,Object.freeze([node]))===REMOVE&&(node.contents=null)}else visit_(null,node,visitor_,Object.freeze([]))}function visit_(key,node,visitor,path){const ctrl=function(key,node,visitor,path){var _a2,_b2,_c2,_d,_e;return"function"==typeof visitor?visitor(key,node,path):isMap(node)?null==(_a2=visitor.Map)?void 0:_a2.call(visitor,key,node,path):isSeq(node)?null==(_b2=visitor.Seq)?void 0:_b2.call(visitor,key,node,path):isPair(node)?null==(_c2=visitor.Pair)?void 0:_c2.call(visitor,key,node,path):isScalar(node)?null==(_d=visitor.Scalar)?void 0:_d.call(visitor,key,node,path):isAlias(node)?null==(_e=visitor.Alias)?void 0:_e.call(visitor,key,node,path):void 0}(key,node,visitor,path);if(isNode(ctrl)||isPair(ctrl))return function(key,path,node){const parent=path[path.length-1];if(isCollection(parent))parent.items[key]=node;else if(isPair(parent))"key"===key?parent.key=node:parent.value=node;else{if(!isDocument(parent)){const pt=isAlias(parent)?"alias":"scalar";throw new Error(`Cannot replace node with ${pt} parent`)}parent.contents=node}}(key,path,ctrl),visit_(key,ctrl,visitor,path);if("symbol"!=typeof ctrl)if(isCollection(node)){path=Object.freeze(path.concat(node));for(let i=0;i<node.items.length;++i){const ci=visit_(i,node.items[i],visitor,path);if("number"==typeof ci)i=ci-1;else{if(ci===BREAK)return BREAK;ci===REMOVE&&(node.items.splice(i,1),i-=1)}}}else if(isPair(node)){path=Object.freeze(path.concat(node));const ck=visit_("key",node.key,visitor,path);if(ck===BREAK)return BREAK;ck===REMOVE&&(node.key=null);const cv=visit_("value",node.value,visitor,path);if(cv===BREAK)return BREAK;cv===REMOVE&&(node.value=null)}return ctrl}visit.BREAK=BREAK,visit.SKIP=SKIP,visit.REMOVE=REMOVE;const escapeChars={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},escapeTagName=tn=>tn.replace(/[!,[\]{}]/g,ch=>escapeChars[ch]);class Directives{constructor(yaml,tags){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Directives.defaultYaml,yaml),this.tags=Object.assign({},Directives.defaultTags,tags)}clone(){const copy=new Directives(this.yaml,this.tags);return copy.docStart=this.docStart,copy}atDocument(){const res=new Directives(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Directives.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Directives.defaultTags)}return res}add(line,onError){this.atNextDocument&&(this.yaml={explicit:Directives.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Directives.defaultTags),this.atNextDocument=!1);const parts=line.trim().split(/[ \t]+/),name=parts.shift();switch(name){case"%TAG":{if(2!==parts.length&&(onError(0,"%TAG directive should contain exactly two parts"),parts.length<2))return!1;const[handle,prefix]=parts;return this.tags[handle]=prefix,!0}case"%YAML":{if(this.yaml.explicit=!0,1!==parts.length)return onError(0,"%YAML directive should contain exactly one part"),!1;const[version2]=parts;if("1.1"===version2||"1.2"===version2)return this.yaml.version=version2,!0;return onError(6,`Unsupported YAML version ${version2}`,/^\d+\.\d+$/.test(version2)),!1}default:return onError(0,`Unknown directive ${name}`,!0),!1}}tagName(source,onError){if("!"===source)return"!";if("!"!==source[0])return onError(`Not a valid tag: ${source}`),null;if("<"===source[1]){const verbatim=source.slice(2,-1);return"!"===verbatim||"!!"===verbatim?(onError(`Verbatim tags aren't resolved, so ${source} is invalid.`),null):(">"!==source[source.length-1]&&onError("Verbatim tags must end with a >"),verbatim)}const[,handle,suffix]=source.match(new RegExp("^(.*!)([^!]*)$","s"));suffix||onError(`The ${source} tag has no suffix`);const prefix=this.tags[handle];if(prefix)try{return prefix+decodeURIComponent(suffix)}catch(error){return onError(String(error)),null}return"!"===handle?source:(onError(`Could not resolve tag: ${source}`),null)}tagString(tag){for(const[handle,prefix]of Object.entries(this.tags))if(tag.startsWith(prefix))return handle+escapeTagName(tag.substring(prefix.length));return"!"===tag[0]?tag:`!<${tag}>`}toString(doc2){const lines=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],tagEntries=Object.entries(this.tags);let tagNames;if(doc2&&tagEntries.length>0&&isNode(doc2.contents)){const tags={};visit(doc2.contents,(_key,node)=>{isNode(node)&&node.tag&&(tags[node.tag]=!0)}),tagNames=Object.keys(tags)}else tagNames=[];for(const[handle,prefix]of tagEntries)"!!"===handle&&"tag:yaml.org,2002:"===prefix||doc2&&!tagNames.some(tn=>tn.startsWith(prefix))||lines.push(`%TAG ${handle} ${prefix}`);return lines.join("\n")}}function anchorIsValid(anchor){if(/[\x00-\x19\s,[\]{}]/.test(anchor)){const sa=JSON.stringify(anchor);throw new Error(`Anchor must not contain whitespace or control characters: ${sa}`)}return!0}function anchorNames(root){const anchors=new Set;return visit(root,{Value(_key,node){node.anchor&&anchors.add(node.anchor)}}),anchors}function findNewAnchor(prefix,exclude){for(let i=1;;++i){const name=`${prefix}${i}`;if(!exclude.has(name))return name}}function applyReviver(reviver,obj,key,val){if(val&&"object"==typeof val)if(Array.isArray(val))for(let i=0,len=val.length;i<len;++i){const v0=val[i],v1=applyReviver(reviver,val,String(i),v0);void 0===v1?delete val[i]:v1!==v0&&(val[i]=v1)}else if(val instanceof Map)for(const k of Array.from(val.keys())){const v0=val.get(k),v1=applyReviver(reviver,val,k,v0);void 0===v1?val.delete(k):v1!==v0&&val.set(k,v1)}else if(val instanceof Set)for(const v0 of Array.from(val)){const v1=applyReviver(reviver,val,v0,v0);void 0===v1?val.delete(v0):v1!==v0&&(val.delete(v0),val.add(v1))}else for(const[k,v0]of Object.entries(val)){const v1=applyReviver(reviver,val,k,v0);void 0===v1?delete val[k]:v1!==v0&&(val[k]=v1)}return reviver.call(obj,key,val)}function toJS(value,arg,ctx){if(Array.isArray(value))return value.map((v,i)=>toJS(v,String(i),ctx));if(value&&"function"==typeof value.toJSON){if(!ctx||!hasAnchor(value))return value.toJSON(arg,ctx);const data={aliasCount:0,count:1,res:void 0};ctx.anchors.set(value,data),ctx.onCreate=res2=>{data.res=res2,delete ctx.onCreate};const res=value.toJSON(arg,ctx);return ctx.onCreate&&ctx.onCreate(res),res}return"bigint"!=typeof value||(null==ctx?void 0:ctx.keep)?value:Number(value)}Directives.defaultYaml={explicit:!1,version:"1.2"},Directives.defaultTags={"!!":"tag:yaml.org,2002:"};class NodeBase{constructor(type){Object.defineProperty(this,NODE_TYPE,{value:type})}clone(){const copy=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(copy.range=this.range.slice()),copy}toJS(doc2,{mapAsMap:mapAsMap,maxAliasCount:maxAliasCount,onAnchor:onAnchor,reviver:reviver}={}){if(!isDocument(doc2))throw new TypeError("A document argument is required");const ctx={anchors:new Map,doc:doc2,keep:!0,mapAsMap:!0===mapAsMap,mapKeyWarned:!1,maxAliasCount:"number"==typeof maxAliasCount?maxAliasCount:100},res=toJS(this,"",ctx);if("function"==typeof onAnchor)for(const{count:count,res:res2}of ctx.anchors.values())onAnchor(res2,count);return"function"==typeof reviver?applyReviver(reviver,{"":res},"",res):res}}class Alias extends NodeBase{constructor(source){super(ALIAS),this.source=source,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(doc2,ctx){let nodes,found;(null==ctx?void 0:ctx.aliasResolveCache)?nodes=ctx.aliasResolveCache:(nodes=[],visit(doc2,{Node:(_key,node)=>{(isAlias(node)||hasAnchor(node))&&nodes.push(node)}}),ctx&&(ctx.aliasResolveCache=nodes));for(const node of nodes){if(node===this)break;node.anchor===this.source&&(found=node)}return found}toJSON(_arg,ctx){if(!ctx)return{source:this.source};const{anchors:anchors,doc:doc2,maxAliasCount:maxAliasCount}=ctx,source=this.resolve(doc2,ctx);if(!source){const msg=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(msg)}let data=anchors.get(source);if(data||(toJS(source,null,ctx),data=anchors.get(source)),!data||void 0===data.res){throw new ReferenceError("This should not happen: Alias anchor was not resolved?")}if(maxAliasCount>=0&&(data.count+=1,0===data.aliasCount&&(data.aliasCount=getAliasCount(doc2,source,anchors)),data.count*data.aliasCount>maxAliasCount)){throw new ReferenceError("Excessive alias count indicates a resource exhaustion attack")}return data.res}toString(ctx,_onComment,_onChompKeep){const src=`*${this.source}`;if(ctx){if(anchorIsValid(this.source),ctx.options.verifyAliasOrder&&!ctx.anchors.has(this.source)){const msg=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(msg)}if(ctx.implicitKey)return`${src} `}return src}}function getAliasCount(doc2,node,anchors){if(isAlias(node)){const source=node.resolve(doc2),anchor=anchors&&source&&anchors.get(source);return anchor?anchor.count*anchor.aliasCount:0}if(isCollection(node)){let count=0;for(const item of node.items){const c=getAliasCount(doc2,item,anchors);c>count&&(count=c)}return count}if(isPair(node)){const kc=getAliasCount(doc2,node.key,anchors),vc=getAliasCount(doc2,node.value,anchors);return Math.max(kc,vc)}return 1}const isScalarValue=value=>!value||"function"!=typeof value&&"object"!=typeof value;class Scalar extends NodeBase{constructor(value){super(SCALAR$1),this.value=value}toJSON(arg,ctx){return(null==ctx?void 0:ctx.keep)?this.value:toJS(this.value,arg,ctx)}toString(){return String(this.value)}}Scalar.BLOCK_FOLDED="BLOCK_FOLDED",Scalar.BLOCK_LITERAL="BLOCK_LITERAL",Scalar.PLAIN="PLAIN",Scalar.QUOTE_DOUBLE="QUOTE_DOUBLE",Scalar.QUOTE_SINGLE="QUOTE_SINGLE";function createNode(value,tagName,ctx){var _a2,_b2,_d;if(isDocument(value)&&(value=value.contents),isNode(value))return value;if(isPair(value)){const map2=null==(_b2=(_a2=ctx.schema[MAP]).createNode)?void 0:_b2.call(_a2,ctx.schema,null,ctx);return map2.items.push(value),map2}(value instanceof String||value instanceof Number||value instanceof Boolean||"undefined"!=typeof BigInt&&value instanceof BigInt)&&(value=value.valueOf());const{aliasDuplicateObjects:aliasDuplicateObjects,onAnchor:onAnchor,onTagObj:onTagObj,schema:schema2,sourceObjects:sourceObjects}=ctx;let ref2;if(aliasDuplicateObjects&&value&&"object"==typeof value){if(ref2=sourceObjects.get(value),ref2)return null!=ref2.anchor||(ref2.anchor=onAnchor(value)),new Alias(ref2.anchor);ref2={anchor:null,node:null},sourceObjects.set(value,ref2)}(null==tagName?void 0:tagName.startsWith("!!"))&&(tagName="tag:yaml.org,2002:"+tagName.slice(2));let tagObj=function(value,tagName,tags){var _a2;if(tagName){const match2=tags.filter(t=>t.tag===tagName),tagObj=null!=(_a2=match2.find(t=>!t.format))?_a2:match2[0];if(!tagObj)throw new Error(`Tag ${tagName} not found`);return tagObj}return tags.find(t=>{var _a3;return(null==(_a3=t.identify)?void 0:_a3.call(t,value))&&!t.format})}(value,tagName,schema2.tags);if(!tagObj){if(value&&"function"==typeof value.toJSON&&(value=value.toJSON()),!value||"object"!=typeof value){const node2=new Scalar(value);return ref2&&(ref2.node=node2),node2}tagObj=value instanceof Map?schema2[MAP]:Symbol.iterator in Object(value)?schema2[SEQ]:schema2[MAP]}onTagObj&&(onTagObj(tagObj),delete ctx.onTagObj);const node=(null==tagObj?void 0:tagObj.createNode)?tagObj.createNode(ctx.schema,value,ctx):"function"==typeof(null==(_d=null==tagObj?void 0:tagObj.nodeClass)?void 0:_d.from)?tagObj.nodeClass.from(ctx.schema,value,ctx):new Scalar(value);return tagName?node.tag=tagName:tagObj.default||(node.tag=tagObj.tag),ref2&&(ref2.node=node),node}function collectionFromPath(schema2,path,value){let v=value;for(let i=path.length-1;i>=0;--i){const k=path[i];if("number"==typeof k&&Number.isInteger(k)&&k>=0){const a=[];a[k]=v,v=a}else v=new Map([[k,v]])}return createNode(v,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:schema2,sourceObjects:new Map})}const isEmptyPath=path=>null==path||"object"==typeof path&&!!path[Symbol.iterator]().next().done;class Collection extends NodeBase{constructor(type,schema2){super(type),Object.defineProperty(this,"schema",{value:schema2,configurable:!0,enumerable:!1,writable:!0})}clone(schema2){const copy=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return schema2&&(copy.schema=schema2),copy.items=copy.items.map(it=>isNode(it)||isPair(it)?it.clone(schema2):it),this.range&&(copy.range=this.range.slice()),copy}addIn(path,value){if(isEmptyPath(path))this.add(value);else{const[key,...rest]=path,node=this.get(key,!0);if(isCollection(node))node.addIn(rest,value);else{if(void 0!==node||!this.schema)throw new Error(`Expected YAML collection at ${key}. Remaining path: ${rest}`);this.set(key,collectionFromPath(this.schema,rest,value))}}}deleteIn(path){const[key,...rest]=path;if(0===rest.length)return this.delete(key);const node=this.get(key,!0);if(isCollection(node))return node.deleteIn(rest);throw new Error(`Expected YAML collection at ${key}. Remaining path: ${rest}`)}getIn(path,keepScalar){const[key,...rest]=path,node=this.get(key,!0);return 0===rest.length?!keepScalar&&isScalar(node)?node.value:node:isCollection(node)?node.getIn(rest,keepScalar):void 0}hasAllNullValues(allowScalar){return this.items.every(node=>{if(!isPair(node))return!1;const n2=node.value;return null==n2||allowScalar&&isScalar(n2)&&null==n2.value&&!n2.commentBefore&&!n2.comment&&!n2.tag})}hasIn(path){const[key,...rest]=path;if(0===rest.length)return this.has(key);const node=this.get(key,!0);return!!isCollection(node)&&node.hasIn(rest)}setIn(path,value){const[key,...rest]=path;if(0===rest.length)this.set(key,value);else{const node=this.get(key,!0);if(isCollection(node))node.setIn(rest,value);else{if(void 0!==node||!this.schema)throw new Error(`Expected YAML collection at ${key}. Remaining path: ${rest}`);this.set(key,collectionFromPath(this.schema,rest,value))}}}}const stringifyComment=str=>str.replace(/^(?!$)(?: $)?/gm,"#");function indentComment(comment,indent){return/^\n+$/.test(comment)?comment.substring(1):indent?comment.replace(/^(?! *$)/gm,indent):comment}const lineComment=(str,indent,comment)=>str.endsWith("\n")?indentComment(comment,indent):comment.includes("\n")?"\n"+indentComment(comment,indent):(str.endsWith(" ")?"":" ")+comment;function foldFlowLines(text,indent,mode="flow",{indentAtStart:indentAtStart,lineWidth:lineWidth=80,minContentWidth:minContentWidth=20,onFold:onFold,onOverflow:onOverflow}={}){if(!lineWidth||lineWidth<0)return text;lineWidth<minContentWidth&&(minContentWidth=0);const endStep=Math.max(1+minContentWidth,1+lineWidth-indent.length);if(text.length<=endStep)return text;const folds=[],escapedFolds={};let split2,prev,end=lineWidth-indent.length;"number"==typeof indentAtStart&&(indentAtStart>lineWidth-Math.max(2,minContentWidth)?folds.push(0):end=lineWidth-indentAtStart);let overflow=!1,i=-1,escStart=-1,escEnd=-1;"block"===mode&&(i=consumeMoreIndentedLines(text,i,indent.length),-1!==i&&(end=i+endStep));for(let ch;ch=text[i+=1];){if("quoted"===mode&&"\\"===ch){switch(escStart=i,text[i+1]){case"x":i+=3;break;case"u":i+=5;break;case"U":i+=9;break;default:i+=1}escEnd=i}if("\n"===ch)"block"===mode&&(i=consumeMoreIndentedLines(text,i,indent.length)),end=i+indent.length+endStep,split2=void 0;else{if(" "===ch&&prev&&" "!==prev&&"\n"!==prev&&"\t"!==prev){const next=text[i+1];next&&" "!==next&&"\n"!==next&&"\t"!==next&&(split2=i)}if(i>=end)if(split2)folds.push(split2),end=split2+endStep,split2=void 0;else if("quoted"===mode){for(;" "===prev||"\t"===prev;)prev=ch,ch=text[i+=1],overflow=!0;const j=i>escEnd+1?i-2:escStart-1;if(escapedFolds[j])return text;folds.push(j),escapedFolds[j]=!0,end=j+endStep,split2=void 0}else overflow=!0}prev=ch}if(overflow&&onOverflow&&onOverflow(),0===folds.length)return text;onFold&&onFold();let res=text.slice(0,folds[0]);for(let i2=0;i2<folds.length;++i2){const fold=folds[i2],end2=folds[i2+1]||text.length;0===fold?res=`\n${indent}${text.slice(0,end2)}`:("quoted"===mode&&escapedFolds[fold]&&(res+=`${text[fold]}\\`),res+=`\n${indent}${text.slice(fold+1,end2)}`)}return res}function consumeMoreIndentedLines(text,i,indent){let end=i,start=i+1,ch=text[start];for(;" "===ch||"\t"===ch;)if(i<start+indent)ch=text[++i];else{do{ch=text[++i]}while(ch&&"\n"!==ch);end=i,start=i+1,ch=text[start]}return end}const getFoldOptions=(ctx,isBlock2)=>({indentAtStart:isBlock2?ctx.indent.length:ctx.indentAtStart,lineWidth:ctx.options.lineWidth,minContentWidth:ctx.options.minContentWidth}),containsDocumentMarker=str=>/^(%|---|\.\.\.)/m.test(str);function doubleQuotedString(value,ctx){const json=JSON.stringify(value);if(ctx.options.doubleQuotedAsJSON)return json;const{implicitKey:implicitKey}=ctx,minMultiLineLength=ctx.options.doubleQuotedMinMultiLineLength,indent=ctx.indent||(containsDocumentMarker(value)?"  ":"");let str="",start=0;for(let i=0,ch=json[i];ch;ch=json[++i])if(" "===ch&&"\\"===json[i+1]&&"n"===json[i+2]&&(str+=json.slice(start,i)+"\\ ",i+=1,start=i,ch="\\"),"\\"===ch)switch(json[i+1]){case"u":{str+=json.slice(start,i);const code=json.substr(i+2,4);switch(code){case"0000":str+="\\0";break;case"0007":str+="\\a";break;case"000b":str+="\\v";break;case"001b":str+="\\e";break;case"0085":str+="\\N";break;case"00a0":str+="\\_";break;case"2028":str+="\\L";break;case"2029":str+="\\P";break;default:"00"===code.substr(0,2)?str+="\\x"+code.substr(2):str+=json.substr(i,6)}i+=5,start=i+1}break;case"n":if(implicitKey||'"'===json[i+2]||json.length<minMultiLineLength)i+=1;else{for(str+=json.slice(start,i)+"\n\n";"\\"===json[i+2]&&"n"===json[i+3]&&'"'!==json[i+4];)str+="\n",i+=2;str+=indent," "===json[i+2]&&(str+="\\"),i+=1,start=i+1}break;default:i+=1}return str=start?str+json.slice(start):json,implicitKey?str:foldFlowLines(str,indent,"quoted",getFoldOptions(ctx,!1))}function singleQuotedString(value,ctx){if(!1===ctx.options.singleQuote||ctx.implicitKey&&value.includes("\n")||/[ \t]\n|\n[ \t]/.test(value))return doubleQuotedString(value,ctx);const indent=ctx.indent||(containsDocumentMarker(value)?"  ":""),res="'"+value.replace(/'/g,"''").replace(/\n+/g,`$&\n${indent}`)+"'";return ctx.implicitKey?res:foldFlowLines(res,indent,"flow",getFoldOptions(ctx,!1))}function quotedString(value,ctx){const{singleQuote:singleQuote}=ctx.options;let qs;if(!1===singleQuote)qs=doubleQuotedString;else{const hasDouble=value.includes('"'),hasSingle=value.includes("'");qs=hasDouble&&!hasSingle?singleQuotedString:hasSingle&&!hasDouble?doubleQuotedString:singleQuote?singleQuotedString:doubleQuotedString}return qs(value,ctx)}let blockEndNewlines;try{blockEndNewlines=new RegExp("(^|(?<!\n))\n+(?!\n|$)","g")}catch(e){blockEndNewlines=/\n+(?!\n|$)/g}function blockString({comment:comment,type:type,value:value},ctx,onComment,onChompKeep){const{blockQuote:blockQuote,commentString:commentString,lineWidth:lineWidth}=ctx.options;if(!blockQuote||/\n[\t ]+$/.test(value)||/^\s*$/.test(value))return quotedString(value,ctx);const indent=ctx.indent||(ctx.forceBlockIndent||containsDocumentMarker(value)?"  ":""),literal="literal"===blockQuote||"folded"!==blockQuote&&type!==Scalar.BLOCK_FOLDED&&(type===Scalar.BLOCK_LITERAL||!function(str,lineWidth,indentLength){if(!lineWidth||lineWidth<0)return!1;const limit2=lineWidth-indentLength,strLen=str.length;if(strLen<=limit2)return!1;for(let i=0,start=0;i<strLen;++i)if("\n"===str[i]){if(i-start>limit2)return!0;if(start=i+1,strLen-start<=limit2)return!1}return!0}(value,lineWidth,indent.length));if(!value)return literal?"|\n":">\n";let chomp,endStart;for(endStart=value.length;endStart>0;--endStart){const ch=value[endStart-1];if("\n"!==ch&&"\t"!==ch&&" "!==ch)break}let end=value.substring(endStart);const endNlPos=end.indexOf("\n");-1===endNlPos?chomp="-":value===end||endNlPos!==end.length-1?(chomp="+",onChompKeep&&onChompKeep()):chomp="",end&&(value=value.slice(0,-end.length),"\n"===end[end.length-1]&&(end=end.slice(0,-1)),end=end.replace(blockEndNewlines,`$&${indent}`));let startEnd,startWithSpace=!1,startNlPos=-1;for(startEnd=0;startEnd<value.length;++startEnd){const ch=value[startEnd];if(" "===ch)startWithSpace=!0;else{if("\n"!==ch)break;startNlPos=startEnd}}let start=value.substring(0,startNlPos<startEnd?startNlPos+1:startEnd);start&&(value=value.substring(start.length),start=start.replace(/\n+/g,`$&${indent}`));let header=(startWithSpace?indent?"2":"1":"")+chomp;if(comment&&(header+=" "+commentString(comment.replace(/ ?[\r\n]+/g," ")),onComment&&onComment()),!literal){const foldedValue=value.replace(/\n+/g,"\n$&").replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${indent}`);let literalFallback=!1;const foldOptions=getFoldOptions(ctx,!0);"folded"!==blockQuote&&type!==Scalar.BLOCK_FOLDED&&(foldOptions.onOverflow=()=>{literalFallback=!0});const body=foldFlowLines(`${start}${foldedValue}${end}`,indent,"block",foldOptions);if(!literalFallback)return`>${header}\n${indent}${body}`}return`|${header}\n${indent}${start}${value=value.replace(/\n+/g,`$&${indent}`)}${end}`}function stringifyString(item,ctx,onComment,onChompKeep){const{implicitKey:implicitKey,inFlow:inFlow}=ctx,ss="string"==typeof item.value?item:Object.assign({},item,{value:String(item.value)});let{type:type}=item;type!==Scalar.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(ss.value)&&(type=Scalar.QUOTE_DOUBLE);const _stringify=_type=>{switch(_type){case Scalar.BLOCK_FOLDED:case Scalar.BLOCK_LITERAL:return implicitKey||inFlow?quotedString(ss.value,ctx):blockString(ss,ctx,onComment,onChompKeep);case Scalar.QUOTE_DOUBLE:return doubleQuotedString(ss.value,ctx);case Scalar.QUOTE_SINGLE:return singleQuotedString(ss.value,ctx);case Scalar.PLAIN:return function(item,ctx,onComment,onChompKeep){const{type:type,value:value}=item,{actualString:actualString,implicitKey:implicitKey,indent:indent,indentStep:indentStep,inFlow:inFlow}=ctx;if(implicitKey&&value.includes("\n")||inFlow&&/[[\]{},]/.test(value))return quotedString(value,ctx);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(value))return implicitKey||inFlow||!value.includes("\n")?quotedString(value,ctx):blockString(item,ctx,onComment,onChompKeep);if(!implicitKey&&!inFlow&&type!==Scalar.PLAIN&&value.includes("\n"))return blockString(item,ctx,onComment,onChompKeep);if(containsDocumentMarker(value)){if(""===indent)return ctx.forceBlockIndent=!0,blockString(item,ctx,onComment,onChompKeep);if(implicitKey&&indent===indentStep)return quotedString(value,ctx)}const str=value.replace(/\n+/g,`$&\n${indent}`);if(actualString){const test=tag=>{var _a2;return tag.default&&"tag:yaml.org,2002:str"!==tag.tag&&(null==(_a2=tag.test)?void 0:_a2.test(str))},{compat:compat,tags:tags}=ctx.doc.schema;if(tags.some(test)||(null==compat?void 0:compat.some(test)))return quotedString(value,ctx)}return implicitKey?str:foldFlowLines(str,indent,"flow",getFoldOptions(ctx,!1))}(ss,ctx,onComment,onChompKeep);default:return null}};let res=_stringify(type);if(null===res){const{defaultKeyType:defaultKeyType,defaultStringType:defaultStringType}=ctx.options,t=implicitKey&&defaultKeyType||defaultStringType;if(res=_stringify(t),null===res)throw new Error(`Unsupported default string type ${t}`)}return res}function createStringifyContext(doc2,options){const opt=Object.assign({blockQuote:!0,commentString:stringifyComment,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},doc2.schema.toStringOptions,options);let inFlow;switch(opt.collectionStyle){case"block":inFlow=!1;break;case"flow":inFlow=!0;break;default:inFlow=null}return{anchors:new Set,doc:doc2,flowCollectionPadding:opt.flowCollectionPadding?" ":"",indent:"",indentStep:"number"==typeof opt.indent?" ".repeat(opt.indent):"  ",inFlow:inFlow,options:opt}}function stringify$1(item,ctx,onComment,onChompKeep){var _a2,_b2;if(isPair(item))return item.toString(ctx,onComment,onChompKeep);if(isAlias(item)){if(ctx.doc.directives)return item.toString(ctx);if(null==(_a2=ctx.resolvedAliases)?void 0:_a2.has(item))throw new TypeError("Cannot stringify circular structure without alias nodes");ctx.resolvedAliases?ctx.resolvedAliases.add(item):ctx.resolvedAliases=new Set([item]),item=item.resolve(ctx.doc)}let tagObj;const node=isNode(item)?item:ctx.doc.createNode(item,{onTagObj:o=>tagObj=o});null!=tagObj||(tagObj=function(tags,item){var _a2,_b2,_c2,_d;if(item.tag){const match2=tags.filter(t=>t.tag===item.tag);if(match2.length>0)return null!=(_a2=match2.find(t=>t.format===item.format))?_a2:match2[0]}let tagObj,obj;if(isScalar(item)){obj=item.value;let match2=tags.filter(t=>{var _a3;return null==(_a3=t.identify)?void 0:_a3.call(t,obj)});if(match2.length>1){const testMatch=match2.filter(t=>t.test);testMatch.length>0&&(match2=testMatch)}tagObj=null!=(_b2=match2.find(t=>t.format===item.format))?_b2:match2.find(t=>!t.format)}else obj=item,tagObj=tags.find(t=>t.nodeClass&&obj instanceof t.nodeClass);if(!tagObj){const name=null!=(_d=null==(_c2=null==obj?void 0:obj.constructor)?void 0:_c2.name)?_d:null===obj?"null":typeof obj;throw new Error(`Tag not resolved for ${name} value`)}return tagObj}(ctx.doc.schema.tags,node));const props=function(node,tagObj,{anchors:anchors,doc:doc2}){var _a2;if(!doc2.directives)return"";const props=[],anchor=(isScalar(node)||isCollection(node))&&node.anchor;anchor&&anchorIsValid(anchor)&&(anchors.add(anchor),props.push(`&${anchor}`));const tag=null!=(_a2=node.tag)?_a2:tagObj.default?null:tagObj.tag;return tag&&props.push(doc2.directives.tagString(tag)),props.join(" ")}(node,tagObj,ctx);props.length>0&&(ctx.indentAtStart=(null!=(_b2=ctx.indentAtStart)?_b2:0)+props.length+1);const str="function"==typeof tagObj.stringify?tagObj.stringify(node,ctx,onComment,onChompKeep):isScalar(node)?stringifyString(node,ctx,onComment,onChompKeep):node.toString(ctx,onComment,onChompKeep);return props?isScalar(node)||"{"===str[0]||"["===str[0]?`${props} ${str}`:`${props}\n${ctx.indent}${str}`:str}function warn(logLevel,warning){"debug"!==logLevel&&"warn"!==logLevel||console.warn(warning)}const merge={identify:value=>"<<"===value||"symbol"==typeof value&&"<<"===value.description,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new Scalar(Symbol("<<")),{addToJSMap:addMergeToJSMap}),stringify:()=>"<<"};function addMergeToJSMap(ctx,map2,value){if(value=ctx&&isAlias(value)?value.resolve(ctx.doc):value,isSeq(value))for(const it of value.items)mergeValue(ctx,map2,it);else if(Array.isArray(value))for(const it of value)mergeValue(ctx,map2,it);else mergeValue(ctx,map2,value)}function mergeValue(ctx,map2,value){const source=ctx&&isAlias(value)?value.resolve(ctx.doc):value;if(!isMap(source))throw new Error("Merge sources must be maps or map aliases");const srcMap=source.toJSON(null,ctx,Map);for(const[key,value2]of srcMap)map2 instanceof Map?map2.has(key)||map2.set(key,value2):map2 instanceof Set?map2.add(key):Object.prototype.hasOwnProperty.call(map2,key)||Object.defineProperty(map2,key,{value:value2,writable:!0,enumerable:!0,configurable:!0});return map2}function addPairToJSMap(ctx,map2,{key:key,value:value}){if(isNode(key)&&key.addToJSMap)key.addToJSMap(ctx,map2,value);else if(((ctx,key)=>(merge.identify(key)||isScalar(key)&&(!key.type||key.type===Scalar.PLAIN)&&merge.identify(key.value))&&(null==ctx?void 0:ctx.doc.schema.tags.some(tag=>tag.tag===merge.tag&&tag.default)))(ctx,key))addMergeToJSMap(ctx,map2,value);else{const jsKey=toJS(key,"",ctx);if(map2 instanceof Map)map2.set(jsKey,toJS(value,jsKey,ctx));else if(map2 instanceof Set)map2.add(jsKey);else{const stringKey=function(key,jsKey,ctx){if(null===jsKey)return"";if("object"!=typeof jsKey)return String(jsKey);if(isNode(key)&&(null==ctx?void 0:ctx.doc)){const strCtx=createStringifyContext(ctx.doc,{});strCtx.anchors=new Set;for(const node of ctx.anchors.keys())strCtx.anchors.add(node.anchor);strCtx.inFlow=!0,strCtx.inStringifyKey=!0;const strKey=key.toString(strCtx);if(!ctx.mapKeyWarned){let jsonStr=JSON.stringify(strKey);jsonStr.length>40&&(jsonStr=jsonStr.substring(0,36)+'..."'),warn(ctx.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${jsonStr}. Set mapAsMap: true to use object keys.`),ctx.mapKeyWarned=!0}return strKey}return JSON.stringify(jsKey)}(key,jsKey,ctx),jsValue=toJS(value,stringKey,ctx);stringKey in map2?Object.defineProperty(map2,stringKey,{value:jsValue,writable:!0,enumerable:!0,configurable:!0}):map2[stringKey]=jsValue}}return map2}function createPair(key,value,ctx){const k=createNode(key,void 0,ctx),v=createNode(value,void 0,ctx);return new Pair(k,v)}class Pair{constructor(key,value=null){Object.defineProperty(this,NODE_TYPE,{value:PAIR}),this.key=key,this.value=value}clone(schema2){let{key:key,value:value}=this;return isNode(key)&&(key=key.clone(schema2)),isNode(value)&&(value=value.clone(schema2)),new Pair(key,value)}toJSON(_,ctx){return addPairToJSMap(ctx,(null==ctx?void 0:ctx.mapAsMap)?new Map:{},this)}toString(ctx,onComment,onChompKeep){return(null==ctx?void 0:ctx.doc)?function({key:key,value:value},ctx,onComment,onChompKeep){var _a2,_b2;const{allNullValues:allNullValues,doc:doc2,indent:indent,indentStep:indentStep,options:{commentString:commentString,indentSeq:indentSeq,simpleKeys:simpleKeys}}=ctx;let keyComment=isNode(key)&&key.comment||null;if(simpleKeys){if(keyComment)throw new Error("With simple keys, key nodes cannot have comments");if(isCollection(key)||!isNode(key)&&"object"==typeof key)throw new Error("With simple keys, collection cannot be used as a key value")}let explicitKey=!simpleKeys&&(!key||keyComment&&null==value&&!ctx.inFlow||isCollection(key)||(isScalar(key)?key.type===Scalar.BLOCK_FOLDED||key.type===Scalar.BLOCK_LITERAL:"object"==typeof key));ctx=Object.assign({},ctx,{allNullValues:!1,implicitKey:!explicitKey&&(simpleKeys||!allNullValues),indent:indent+indentStep});let vsb,vcb,valueComment,keyCommentDone=!1,chompKeep=!1,str=stringify$1(key,ctx,()=>keyCommentDone=!0,()=>chompKeep=!0);if(!explicitKey&&!ctx.inFlow&&str.length>1024){if(simpleKeys)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");explicitKey=!0}if(ctx.inFlow){if(allNullValues||null==value)return keyCommentDone&&onComment&&onComment(),""===str?"?":explicitKey?`? ${str}`:str}else if(allNullValues&&!simpleKeys||null==value&&explicitKey)return str=`? ${str}`,keyComment&&!keyCommentDone?str+=lineComment(str,ctx.indent,commentString(keyComment)):chompKeep&&onChompKeep&&onChompKeep(),str;keyCommentDone&&(keyComment=null),explicitKey?(keyComment&&(str+=lineComment(str,ctx.indent,commentString(keyComment))),str=`? ${str}\n${indent}:`):(str=`${str}:`,keyComment&&(str+=lineComment(str,ctx.indent,commentString(keyComment)))),isNode(value)?(vsb=!!value.spaceBefore,vcb=value.commentBefore,valueComment=value.comment):(vsb=!1,vcb=null,valueComment=null,value&&"object"==typeof value&&(value=doc2.createNode(value))),ctx.implicitKey=!1,explicitKey||keyComment||!isScalar(value)||(ctx.indentAtStart=str.length+1),chompKeep=!1,indentSeq||!(indentStep.length>=2)||ctx.inFlow||explicitKey||!isSeq(value)||value.flow||value.tag||value.anchor||(ctx.indent=ctx.indent.substring(2));let valueCommentDone=!1;const valueStr=stringify$1(value,ctx,()=>valueCommentDone=!0,()=>chompKeep=!0);let ws=" ";if(keyComment||vsb||vcb)ws=vsb?"\n":"",vcb&&(ws+=`\n${indentComment(commentString(vcb),ctx.indent)}`),""!==valueStr||ctx.inFlow?ws+=`\n${ctx.indent}`:"\n"===ws&&(ws="\n\n");else if(!explicitKey&&isCollection(value)){const vs0=valueStr[0],nl0=valueStr.indexOf("\n"),hasNewline=-1!==nl0,flow=null!=(_b2=null!=(_a2=ctx.inFlow)?_a2:value.flow)?_b2:0===value.items.length;if(hasNewline||!flow){let hasPropsLine=!1;if(hasNewline&&("&"===vs0||"!"===vs0)){let sp0=valueStr.indexOf(" ");"&"===vs0&&-1!==sp0&&sp0<nl0&&"!"===valueStr[sp0+1]&&(sp0=valueStr.indexOf(" ",sp0+1)),(-1===sp0||nl0<sp0)&&(hasPropsLine=!0)}hasPropsLine||(ws=`\n${ctx.indent}`)}}else""!==valueStr&&"\n"!==valueStr[0]||(ws="");return str+=ws+valueStr,ctx.inFlow?valueCommentDone&&onComment&&onComment():valueComment&&!valueCommentDone?str+=lineComment(str,ctx.indent,commentString(valueComment)):chompKeep&&onChompKeep&&onChompKeep(),str}(this,ctx,onComment,onChompKeep):JSON.stringify(this)}}function stringifyCollection(collection,ctx,options){var _a2;return((null!=(_a2=ctx.inFlow)?_a2:collection.flow)?stringifyFlowCollection:stringifyBlockCollection)(collection,ctx,options)}function stringifyBlockCollection({comment:comment,items:items},ctx,{blockItemPrefix:blockItemPrefix,flowChars:flowChars,itemIndent:itemIndent,onChompKeep:onChompKeep,onComment:onComment}){const{indent:indent,options:{commentString:commentString}}=ctx,itemCtx=Object.assign({},ctx,{indent:itemIndent,type:null});let chompKeep=!1;const lines=[];for(let i=0;i<items.length;++i){const item=items[i];let comment2=null;if(isNode(item))!chompKeep&&item.spaceBefore&&lines.push(""),addCommentBefore(ctx,lines,item.commentBefore,chompKeep),item.comment&&(comment2=item.comment);else if(isPair(item)){const ik=isNode(item.key)?item.key:null;ik&&(!chompKeep&&ik.spaceBefore&&lines.push(""),addCommentBefore(ctx,lines,ik.commentBefore,chompKeep))}chompKeep=!1;let str2=stringify$1(item,itemCtx,()=>comment2=null,()=>chompKeep=!0);comment2&&(str2+=lineComment(str2,itemIndent,commentString(comment2))),chompKeep&&comment2&&(chompKeep=!1),lines.push(blockItemPrefix+str2)}let str;if(0===lines.length)str=flowChars.start+flowChars.end;else{str=lines[0];for(let i=1;i<lines.length;++i){const line=lines[i];str+=line?`\n${indent}${line}`:"\n"}}return comment?(str+="\n"+indentComment(commentString(comment),indent),onComment&&onComment()):chompKeep&&onChompKeep&&onChompKeep(),str}function stringifyFlowCollection({items:items},ctx,{flowChars:flowChars,itemIndent:itemIndent}){const{indent:indent,indentStep:indentStep,flowCollectionPadding:fcPadding,options:{commentString:commentString}}=ctx;itemIndent+=indentStep;const itemCtx=Object.assign({},ctx,{indent:itemIndent,inFlow:!0,type:null});let reqNewline=!1,linesAtValue=0;const lines=[];for(let i=0;i<items.length;++i){const item=items[i];let comment=null;if(isNode(item))item.spaceBefore&&lines.push(""),addCommentBefore(ctx,lines,item.commentBefore,!1),item.comment&&(comment=item.comment);else if(isPair(item)){const ik=isNode(item.key)?item.key:null;ik&&(ik.spaceBefore&&lines.push(""),addCommentBefore(ctx,lines,ik.commentBefore,!1),ik.comment&&(reqNewline=!0));const iv=isNode(item.value)?item.value:null;iv?(iv.comment&&(comment=iv.comment),iv.commentBefore&&(reqNewline=!0)):null==item.value&&(null==ik?void 0:ik.comment)&&(comment=ik.comment)}comment&&(reqNewline=!0);let str=stringify$1(item,itemCtx,()=>comment=null);i<items.length-1&&(str+=","),comment&&(str+=lineComment(str,itemIndent,commentString(comment))),!reqNewline&&(lines.length>linesAtValue||str.includes("\n"))&&(reqNewline=!0),lines.push(str),linesAtValue=lines.length}const{start:start,end:end}=flowChars;if(0===lines.length)return start+end;if(!reqNewline){const len=lines.reduce((sum,line)=>sum+line.length+2,2);reqNewline=ctx.options.lineWidth>0&&len>ctx.options.lineWidth}if(reqNewline){let str=start;for(const line of lines)str+=line?`\n${indentStep}${indent}${line}`:"\n";return`${str}\n${indent}${end}`}return`${start}${fcPadding}${lines.join(" ")}${fcPadding}${end}`}function addCommentBefore({indent:indent,options:{commentString:commentString}},lines,comment,chompKeep){if(comment&&chompKeep&&(comment=comment.replace(/^\n+/,"")),comment){const ic=indentComment(commentString(comment),indent);lines.push(ic.trimStart())}}function findPair(items,key){const k=isScalar(key)?key.value:key;for(const it of items)if(isPair(it)){if(it.key===key||it.key===k)return it;if(isScalar(it.key)&&it.key.value===k)return it}}class YAMLMap extends Collection{static get tagName(){return"tag:yaml.org,2002:map"}constructor(schema2){super(MAP,schema2),this.items=[]}static from(schema2,obj,ctx){const{keepUndefined:keepUndefined,replacer:replacer2}=ctx,map2=new this(schema2),add2=(key,value)=>{if("function"==typeof replacer2)value=replacer2.call(obj,key,value);else if(Array.isArray(replacer2)&&!replacer2.includes(key))return;(void 0!==value||keepUndefined)&&map2.items.push(createPair(key,value,ctx))};if(obj instanceof Map)for(const[key,value]of obj)add2(key,value);else if(obj&&"object"==typeof obj)for(const key of Object.keys(obj))add2(key,obj[key]);return"function"==typeof schema2.sortMapEntries&&map2.items.sort(schema2.sortMapEntries),map2}add(pair,overwrite){var _a2;let _pair;_pair=isPair(pair)?pair:pair&&"object"==typeof pair&&"key"in pair?new Pair(pair.key,pair.value):new Pair(pair,null==pair?void 0:pair.value);const prev=findPair(this.items,_pair.key),sortEntries=null==(_a2=this.schema)?void 0:_a2.sortMapEntries;if(prev){if(!overwrite)throw new Error(`Key ${_pair.key} already set`);isScalar(prev.value)&&isScalarValue(_pair.value)?prev.value.value=_pair.value:prev.value=_pair.value}else if(sortEntries){const i=this.items.findIndex(item=>sortEntries(_pair,item)<0);-1===i?this.items.push(_pair):this.items.splice(i,0,_pair)}else this.items.push(_pair)}delete(key){const it=findPair(this.items,key);if(!it)return!1;return this.items.splice(this.items.indexOf(it),1).length>0}get(key,keepScalar){var _a2;const it=findPair(this.items,key),node=null==it?void 0:it.value;return null!=(_a2=!keepScalar&&isScalar(node)?node.value:node)?_a2:void 0}has(key){return!!findPair(this.items,key)}set(key,value){this.add(new Pair(key,value),!0)}toJSON(_,ctx,Type){const map2=Type?new Type:(null==ctx?void 0:ctx.mapAsMap)?new Map:{};(null==ctx?void 0:ctx.onCreate)&&ctx.onCreate(map2);for(const item of this.items)addPairToJSMap(ctx,map2,item);return map2}toString(ctx,onComment,onChompKeep){if(!ctx)return JSON.stringify(this);for(const item of this.items)if(!isPair(item))throw new Error(`Map items must all be pairs; found ${JSON.stringify(item)} instead`);return!ctx.allNullValues&&this.hasAllNullValues(!1)&&(ctx=Object.assign({},ctx,{allNullValues:!0})),stringifyCollection(this,ctx,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:ctx.indent||"",onChompKeep:onChompKeep,onComment:onComment})}}const map={collection:"map",default:!0,nodeClass:YAMLMap,tag:"tag:yaml.org,2002:map",resolve:(map2,onError)=>(isMap(map2)||onError("Expected a mapping for this tag"),map2),createNode:(schema2,obj,ctx)=>YAMLMap.from(schema2,obj,ctx)};class YAMLSeq extends Collection{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(schema2){super(SEQ,schema2),this.items=[]}add(value){this.items.push(value)}delete(key){const idx=asItemIndex(key);if("number"!=typeof idx)return!1;return this.items.splice(idx,1).length>0}get(key,keepScalar){const idx=asItemIndex(key);if("number"!=typeof idx)return;const it=this.items[idx];return!keepScalar&&isScalar(it)?it.value:it}has(key){const idx=asItemIndex(key);return"number"==typeof idx&&idx<this.items.length}set(key,value){const idx=asItemIndex(key);if("number"!=typeof idx)throw new Error(`Expected a valid index, not ${key}.`);const prev=this.items[idx];isScalar(prev)&&isScalarValue(value)?prev.value=value:this.items[idx]=value}toJSON(_,ctx){const seq2=[];(null==ctx?void 0:ctx.onCreate)&&ctx.onCreate(seq2);let i=0;for(const item of this.items)seq2.push(toJS(item,String(i++),ctx));return seq2}toString(ctx,onComment,onChompKeep){return ctx?stringifyCollection(this,ctx,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(ctx.indent||"")+"  ",onChompKeep:onChompKeep,onComment:onComment}):JSON.stringify(this)}static from(schema2,obj,ctx){const{replacer:replacer2}=ctx,seq2=new this(schema2);if(obj&&Symbol.iterator in Object(obj)){let i=0;for(let it of obj){if("function"==typeof replacer2){const key=obj instanceof Set?it:String(i++);it=replacer2.call(obj,key,it)}seq2.items.push(createNode(it,void 0,ctx))}}return seq2}}function asItemIndex(key){let idx=isScalar(key)?key.value:key;return idx&&"string"==typeof idx&&(idx=Number(idx)),"number"==typeof idx&&Number.isInteger(idx)&&idx>=0?idx:null}const seq={collection:"seq",default:!0,nodeClass:YAMLSeq,tag:"tag:yaml.org,2002:seq",resolve:(seq2,onError)=>(isSeq(seq2)||onError("Expected a sequence for this tag"),seq2),createNode:(schema2,obj,ctx)=>YAMLSeq.from(schema2,obj,ctx)},string={identify:value=>"string"==typeof value,default:!0,tag:"tag:yaml.org,2002:str",resolve:str=>str,stringify:(item,ctx,onComment,onChompKeep)=>stringifyString(item,ctx=Object.assign({actualString:!0},ctx),onComment,onChompKeep)},nullTag={identify:value=>null==value,createNode:()=>new Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new Scalar(null),stringify:({source:source},ctx)=>"string"==typeof source&&nullTag.test.test(source)?source:ctx.options.nullStr},boolTag={identify:value=>"boolean"==typeof value,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:str=>new Scalar("t"===str[0]||"T"===str[0]),stringify({source:source,value:value},ctx){if(source&&boolTag.test.test(source)){if(value===("t"===source[0]||"T"===source[0]))return source}return value?ctx.options.trueStr:ctx.options.falseStr}};function stringifyNumber({format:format,minFractionDigits:minFractionDigits,tag:tag,value:value}){if("bigint"==typeof value)return String(value);const num="number"==typeof value?value:Number(value);if(!isFinite(num))return isNaN(num)?".nan":num<0?"-.inf":".inf";let n2=JSON.stringify(value);if(!format&&minFractionDigits&&(!tag||"tag:yaml.org,2002:float"===tag)&&/^\d/.test(n2)){let i=n2.indexOf(".");i<0&&(i=n2.length,n2+=".");let d=minFractionDigits-(n2.length-i-1);for(;d-- >0;)n2+="0"}return n2}const floatNaN$1={identify:value=>"number"==typeof value,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:str=>"nan"===str.slice(-3).toLowerCase()?NaN:"-"===str[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:stringifyNumber},floatExp$1={identify:value=>"number"==typeof value,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:str=>parseFloat(str),stringify(node){const num=Number(node.value);return isFinite(num)?num.toExponential():stringifyNumber(node)}},float$1={identify:value=>"number"==typeof value,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(str){const node=new Scalar(parseFloat(str)),dot=str.indexOf(".");return-1!==dot&&"0"===str[str.length-1]&&(node.minFractionDigits=str.length-dot-1),node},stringify:stringifyNumber},intIdentify$2=value=>"bigint"==typeof value||Number.isInteger(value),intResolve$1=(str,offset2,radix,{intAsBigInt:intAsBigInt})=>intAsBigInt?BigInt(str):parseInt(str.substring(offset2),radix);function intStringify$1(node,radix,prefix){const{value:value}=node;return intIdentify$2(value)&&value>=0?prefix+value.toString(radix):stringifyNumber(node)}const intOct$1={identify:value=>intIdentify$2(value)&&value>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(str,_onError,opt)=>intResolve$1(str,2,8,opt),stringify:node=>intStringify$1(node,8,"0o")},int$1={identify:intIdentify$2,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(str,_onError,opt)=>intResolve$1(str,0,10,opt),stringify:stringifyNumber},intHex$1={identify:value=>intIdentify$2(value)&&value>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(str,_onError,opt)=>intResolve$1(str,2,16,opt),stringify:node=>intStringify$1(node,16,"0x")},schema$2=[map,seq,string,nullTag,boolTag,intOct$1,int$1,intHex$1,floatNaN$1,floatExp$1,float$1];function intIdentify$1(value){return"bigint"==typeof value||Number.isInteger(value)}const stringifyJSON=({value:value})=>JSON.stringify(value),schema$1=[map,seq].concat([{identify:value=>"string"==typeof value,default:!0,tag:"tag:yaml.org,2002:str",resolve:str=>str,stringify:stringifyJSON},{identify:value=>null==value,createNode:()=>new Scalar(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:stringifyJSON},{identify:value=>"boolean"==typeof value,default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:str=>"true"===str,stringify:stringifyJSON},{identify:intIdentify$1,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(str,_onError,{intAsBigInt:intAsBigInt})=>intAsBigInt?BigInt(str):parseInt(str,10),stringify:({value:value})=>intIdentify$1(value)?value.toString():JSON.stringify(value)},{identify:value=>"number"==typeof value,default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:str=>parseFloat(str),stringify:stringifyJSON}],{default:!0,tag:"",test:/^/,resolve:(str,onError)=>(onError(`Unresolved plain scalar ${JSON.stringify(str)}`),str)}),binary={identify:value=>value instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(src,onError){if("function"==typeof atob){const str=atob(src.replace(/[\n\r]/g,"")),buffer=new Uint8Array(str.length);for(let i=0;i<str.length;++i)buffer[i]=str.charCodeAt(i);return buffer}return onError("This environment does not support reading binary tags; either Buffer or atob is required"),src},stringify({comment:comment,type:type,value:value},ctx,onComment,onChompKeep){if(!value)return"";const buf=value;let str;if("function"!=typeof btoa)throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");{let s2="";for(let i=0;i<buf.length;++i)s2+=String.fromCharCode(buf[i]);str=btoa(s2)}if(null!=type||(type=Scalar.BLOCK_LITERAL),type!==Scalar.QUOTE_DOUBLE){const lineWidth=Math.max(ctx.options.lineWidth-ctx.indent.length,ctx.options.minContentWidth),n2=Math.ceil(str.length/lineWidth),lines=new Array(n2);for(let i=0,o=0;i<n2;++i,o+=lineWidth)lines[i]=str.substr(o,lineWidth);str=lines.join(type===Scalar.BLOCK_LITERAL?"\n":" ")}return stringifyString({comment:comment,type:type,value:str},ctx,onComment,onChompKeep)}};function resolvePairs(seq2,onError){var _a2;if(isSeq(seq2))for(let i=0;i<seq2.items.length;++i){let item=seq2.items[i];if(!isPair(item)){if(isMap(item)){item.items.length>1&&onError("Each pair must have its own sequence indicator");const pair=item.items[0]||new Pair(new Scalar(null));if(item.commentBefore&&(pair.key.commentBefore=pair.key.commentBefore?`${item.commentBefore}\n${pair.key.commentBefore}`:item.commentBefore),item.comment){const cn=null!=(_a2=pair.value)?_a2:pair.key;cn.comment=cn.comment?`${item.comment}\n${cn.comment}`:item.comment}item=pair}seq2.items[i]=isPair(item)?item:new Pair(item)}}else onError("Expected a sequence for this tag");return seq2}function createPairs(schema2,iterable,ctx){const{replacer:replacer2}=ctx,pairs2=new YAMLSeq(schema2);pairs2.tag="tag:yaml.org,2002:pairs";let i=0;if(iterable&&Symbol.iterator in Object(iterable))for(let it of iterable){let key,value;if("function"==typeof replacer2&&(it=replacer2.call(iterable,String(i++),it)),Array.isArray(it)){if(2!==it.length)throw new TypeError(`Expected [key, value] tuple: ${it}`);key=it[0],value=it[1]}else if(it&&it instanceof Object){const keys=Object.keys(it);if(1!==keys.length)throw new TypeError(`Expected tuple with one key, not ${keys.length} keys`);key=keys[0],value=it[key]}else key=it;pairs2.items.push(createPair(key,value,ctx))}return pairs2}const pairs={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:resolvePairs,createNode:createPairs};class YAMLOMap extends YAMLSeq{constructor(){super(),this.add=YAMLMap.prototype.add.bind(this),this.delete=YAMLMap.prototype.delete.bind(this),this.get=YAMLMap.prototype.get.bind(this),this.has=YAMLMap.prototype.has.bind(this),this.set=YAMLMap.prototype.set.bind(this),this.tag=YAMLOMap.tag}toJSON(_,ctx){if(!ctx)return super.toJSON(_);const map2=new Map;(null==ctx?void 0:ctx.onCreate)&&ctx.onCreate(map2);for(const pair of this.items){let key,value;if(isPair(pair)?(key=toJS(pair.key,"",ctx),value=toJS(pair.value,key,ctx)):key=toJS(pair,"",ctx),map2.has(key))throw new Error("Ordered maps must not include duplicate keys");map2.set(key,value)}return map2}static from(schema2,iterable,ctx){const pairs2=createPairs(schema2,iterable,ctx),omap2=new this;return omap2.items=pairs2.items,omap2}}YAMLOMap.tag="tag:yaml.org,2002:omap";const omap={collection:"seq",identify:value=>value instanceof Map,nodeClass:YAMLOMap,default:!1,tag:"tag:yaml.org,2002:omap",resolve(seq2,onError){const pairs2=resolvePairs(seq2,onError),seenKeys=[];for(const{key:key}of pairs2.items)isScalar(key)&&(seenKeys.includes(key.value)?onError(`Ordered maps must not include duplicate keys: ${key.value}`):seenKeys.push(key.value));return Object.assign(new YAMLOMap,pairs2)},createNode:(schema2,iterable,ctx)=>YAMLOMap.from(schema2,iterable,ctx)};function boolStringify({value:value,source:source},ctx){return source&&(value?trueTag:falseTag).test.test(source)?source:value?ctx.options.trueStr:ctx.options.falseStr}const trueTag={identify:value=>!0===value,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new Scalar(!0),stringify:boolStringify},falseTag={identify:value=>!1===value,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new Scalar(!1),stringify:boolStringify},floatNaN={identify:value=>"number"==typeof value,default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:str=>"nan"===str.slice(-3).toLowerCase()?NaN:"-"===str[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:stringifyNumber},floatExp={identify:value=>"number"==typeof value,default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:str=>parseFloat(str.replace(/_/g,"")),stringify(node){const num=Number(node.value);return isFinite(num)?num.toExponential():stringifyNumber(node)}},float={identify:value=>"number"==typeof value,default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(str){const node=new Scalar(parseFloat(str.replace(/_/g,""))),dot=str.indexOf(".");if(-1!==dot){const f=str.substring(dot+1).replace(/_/g,"");"0"===f[f.length-1]&&(node.minFractionDigits=f.length)}return node},stringify:stringifyNumber},intIdentify=value=>"bigint"==typeof value||Number.isInteger(value);function intResolve(str,offset2,radix,{intAsBigInt:intAsBigInt}){const sign=str[0];if("-"!==sign&&"+"!==sign||(offset2+=1),str=str.substring(offset2).replace(/_/g,""),intAsBigInt){switch(radix){case 2:str=`0b${str}`;break;case 8:str=`0o${str}`;break;case 16:str=`0x${str}`}const n3=BigInt(str);return"-"===sign?BigInt(-1)*n3:n3}const n2=parseInt(str,radix);return"-"===sign?-1*n2:n2}function intStringify(node,radix,prefix){const{value:value}=node;if(intIdentify(value)){const str=value.toString(radix);return value<0?"-"+prefix+str.substr(1):prefix+str}return stringifyNumber(node)}const intBin={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(str,_onError,opt)=>intResolve(str,2,2,opt),stringify:node=>intStringify(node,2,"0b")},intOct={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(str,_onError,opt)=>intResolve(str,1,8,opt),stringify:node=>intStringify(node,8,"0")},int={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(str,_onError,opt)=>intResolve(str,0,10,opt),stringify:stringifyNumber},intHex={identify:intIdentify,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(str,_onError,opt)=>intResolve(str,2,16,opt),stringify:node=>intStringify(node,16,"0x")};class YAMLSet extends YAMLMap{constructor(schema2){super(schema2),this.tag=YAMLSet.tag}add(key){let pair;pair=isPair(key)?key:key&&"object"==typeof key&&"key"in key&&"value"in key&&null===key.value?new Pair(key.key,null):new Pair(key,null);findPair(this.items,pair.key)||this.items.push(pair)}get(key,keepPair){const pair=findPair(this.items,key);return!keepPair&&isPair(pair)?isScalar(pair.key)?pair.key.value:pair.key:pair}set(key,value){if("boolean"!=typeof value)throw new Error("Expected boolean value for set(key, value) in a YAML set, not "+typeof value);const prev=findPair(this.items,key);prev&&!value?this.items.splice(this.items.indexOf(prev),1):!prev&&value&&this.items.push(new Pair(key))}toJSON(_,ctx){return super.toJSON(_,ctx,Set)}toString(ctx,onComment,onChompKeep){if(!ctx)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},ctx,{allNullValues:!0}),onComment,onChompKeep);throw new Error("Set items must all have null values")}static from(schema2,iterable,ctx){const{replacer:replacer2}=ctx,set2=new this(schema2);if(iterable&&Symbol.iterator in Object(iterable))for(let value of iterable)"function"==typeof replacer2&&(value=replacer2.call(iterable,value,value)),set2.items.push(createPair(value,null,ctx));return set2}}YAMLSet.tag="tag:yaml.org,2002:set";const set={collection:"map",identify:value=>value instanceof Set,nodeClass:YAMLSet,default:!1,tag:"tag:yaml.org,2002:set",createNode:(schema2,iterable,ctx)=>YAMLSet.from(schema2,iterable,ctx),resolve(map2,onError){if(isMap(map2)){if(map2.hasAllNullValues(!0))return Object.assign(new YAMLSet,map2);onError("Set items must all have null values")}else onError("Expected a mapping for this tag");return map2}};function parseSexagesimal(str,asBigInt){const sign=str[0],parts="-"===sign||"+"===sign?str.substring(1):str,num=n2=>asBigInt?BigInt(n2):Number(n2),res=parts.replace(/_/g,"").split(":").reduce((res2,p2)=>res2*num(60)+num(p2),num(0));return"-"===sign?num(-1)*res:res}function stringifySexagesimal(node){let{value:value}=node,num=n2=>n2;if("bigint"==typeof value)num=n2=>BigInt(n2);else if(isNaN(value)||!isFinite(value))return stringifyNumber(node);let sign="";value<0&&(sign="-",value*=num(-1));const _60=num(60),parts=[value%_60];return value<60?parts.unshift(0):(value=(value-parts[0])/_60,parts.unshift(value%_60),value>=60&&(value=(value-parts[0])/_60,parts.unshift(value))),sign+parts.map(n2=>String(n2).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const intTime={identify:value=>"bigint"==typeof value||Number.isInteger(value),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(str,_onError,{intAsBigInt:intAsBigInt})=>parseSexagesimal(str,intAsBigInt),stringify:stringifySexagesimal},floatTime={identify:value=>"number"==typeof value,default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:str=>parseSexagesimal(str,!1),stringify:stringifySexagesimal},timestamp={identify:value=>value instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(str){const match2=str.match(timestamp.test);if(!match2)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,year2,month,day,hour,minute,second]=match2.map(Number),millisec=match2[7]?Number((match2[7]+"00").substr(1,3)):0;let date=Date.UTC(year2,month-1,day,hour||0,minute||0,second||0,millisec);const tz=match2[8];if(tz&&"Z"!==tz){let d=parseSexagesimal(tz,!1);Math.abs(d)<30&&(d*=60),date-=6e4*d}return new Date(date)},stringify:({value:value})=>{var _a2;return null!=(_a2=null==value?void 0:value.toISOString().replace(/(T00:00:00)?\.000Z$/,""))?_a2:""}},schema=[map,seq,string,nullTag,trueTag,falseTag,intBin,intOct,int,intHex,floatNaN,floatExp,float,binary,merge,omap,pairs,set,intTime,floatTime,timestamp],schemas=new Map([["core",schema$2],["failsafe",[map,seq,string]],["json",schema$1],["yaml11",schema],["yaml-1.1",schema]]),tagsByName={binary:binary,bool:boolTag,float:float$1,floatExp:floatExp$1,floatNaN:floatNaN$1,floatTime:floatTime,int:int$1,intHex:intHex$1,intOct:intOct$1,intTime:intTime,map:map,merge:merge,null:nullTag,omap:omap,pairs:pairs,seq:seq,set:set,timestamp:timestamp},coreKnownTags={"tag:yaml.org,2002:binary":binary,"tag:yaml.org,2002:merge":merge,"tag:yaml.org,2002:omap":omap,"tag:yaml.org,2002:pairs":pairs,"tag:yaml.org,2002:set":set,"tag:yaml.org,2002:timestamp":timestamp};function getTags(customTags,schemaName,addMergeTag){const schemaTags=schemas.get(schemaName);if(schemaTags&&!customTags)return addMergeTag&&!schemaTags.includes(merge)?schemaTags.concat(merge):schemaTags.slice();let tags=schemaTags;if(!tags){if(!Array.isArray(customTags)){const keys=Array.from(schemas.keys()).filter(key=>"yaml11"!==key).map(key=>JSON.stringify(key)).join(", ");throw new Error(`Unknown schema "${schemaName}"; use one of ${keys} or define customTags array`)}tags=[]}if(Array.isArray(customTags))for(const tag of customTags)tags=tags.concat(tag);else"function"==typeof customTags&&(tags=customTags(tags.slice()));return addMergeTag&&(tags=tags.concat(merge)),tags.reduce((tags2,tag)=>{const tagObj="string"==typeof tag?tagsByName[tag]:tag;if(!tagObj){const tagName=JSON.stringify(tag),keys=Object.keys(tagsByName).map(key=>JSON.stringify(key)).join(", ");throw new Error(`Unknown custom tag ${tagName}; use one of ${keys}`)}return tags2.includes(tagObj)||tags2.push(tagObj),tags2},[])}const sortMapEntriesByKey=(a,b)=>a.key<b.key?-1:a.key>b.key?1:0;class Schema{constructor({compat:compat,customTags:customTags,merge:merge2,resolveKnownTags:resolveKnownTags,schema:schema2,sortMapEntries:sortMapEntries,toStringDefaults:toStringDefaults}){this.compat=Array.isArray(compat)?getTags(compat,"compat"):compat?getTags(null,compat):null,this.name="string"==typeof schema2&&schema2||"core",this.knownTags=resolveKnownTags?coreKnownTags:{},this.tags=getTags(customTags,this.name,merge2),this.toStringOptions=null!=toStringDefaults?toStringDefaults:null,Object.defineProperty(this,MAP,{value:map}),Object.defineProperty(this,SCALAR$1,{value:string}),Object.defineProperty(this,SEQ,{value:seq}),this.sortMapEntries="function"==typeof sortMapEntries?sortMapEntries:!0===sortMapEntries?sortMapEntriesByKey:null}clone(){const copy=Object.create(Schema.prototype,Object.getOwnPropertyDescriptors(this));return copy.tags=this.tags.slice(),copy}}class Document{constructor(value,replacer2,options){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,NODE_TYPE,{value:DOC});let _replacer=null;"function"==typeof replacer2||Array.isArray(replacer2)?_replacer=replacer2:void 0===options&&replacer2&&(options=replacer2,replacer2=void 0);const opt=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},options);this.options=opt;let{version:version2}=opt;(null==options?void 0:options._directives)?(this.directives=options._directives.atDocument(),this.directives.yaml.explicit&&(version2=this.directives.yaml.version)):this.directives=new Directives({version:version2}),this.setSchema(version2,options),this.contents=void 0===value?null:this.createNode(value,_replacer,options)}clone(){const copy=Object.create(Document.prototype,{[NODE_TYPE]:{value:DOC}});return copy.commentBefore=this.commentBefore,copy.comment=this.comment,copy.errors=this.errors.slice(),copy.warnings=this.warnings.slice(),copy.options=Object.assign({},this.options),this.directives&&(copy.directives=this.directives.clone()),copy.schema=this.schema.clone(),copy.contents=isNode(this.contents)?this.contents.clone(copy.schema):this.contents,this.range&&(copy.range=this.range.slice()),copy}add(value){assertCollection(this.contents)&&this.contents.add(value)}addIn(path,value){assertCollection(this.contents)&&this.contents.addIn(path,value)}createAlias(node,name){if(!node.anchor){const prev=anchorNames(this);node.anchor=!name||prev.has(name)?findNewAnchor(name||"a",prev):name}return new Alias(node.anchor)}createNode(value,replacer2,options){let _replacer;if("function"==typeof replacer2)value=replacer2.call({"":value},"",value),_replacer=replacer2;else if(Array.isArray(replacer2)){const keyToStr=v=>"number"==typeof v||v instanceof String||v instanceof Number,asStr=replacer2.filter(keyToStr).map(String);asStr.length>0&&(replacer2=replacer2.concat(asStr)),_replacer=replacer2}else void 0===options&&replacer2&&(options=replacer2,replacer2=void 0);const{aliasDuplicateObjects:aliasDuplicateObjects,anchorPrefix:anchorPrefix,flow:flow,keepUndefined:keepUndefined,onTagObj:onTagObj,tag:tag}=null!=options?options:{},{onAnchor:onAnchor,setAnchors:setAnchors,sourceObjects:sourceObjects}=function(doc2,prefix){const aliasObjects=[],sourceObjects=new Map;let prevAnchors=null;return{onAnchor:source=>{aliasObjects.push(source),null!=prevAnchors||(prevAnchors=anchorNames(doc2));const anchor=findNewAnchor(prefix,prevAnchors);return prevAnchors.add(anchor),anchor},setAnchors:()=>{for(const source of aliasObjects){const ref2=sourceObjects.get(source);if("object"!=typeof ref2||!ref2.anchor||!isScalar(ref2.node)&&!isCollection(ref2.node)){const error=new Error("Failed to resolve repeated object (this should not happen)");throw error.source=source,error}ref2.node.anchor=ref2.anchor}},sourceObjects:sourceObjects}}(this,anchorPrefix||"a"),node=createNode(value,tag,{aliasDuplicateObjects:null==aliasDuplicateObjects||aliasDuplicateObjects,keepUndefined:null!=keepUndefined&&keepUndefined,onAnchor:onAnchor,onTagObj:onTagObj,replacer:_replacer,schema:this.schema,sourceObjects:sourceObjects});return flow&&isCollection(node)&&(node.flow=!0),setAnchors(),node}createPair(key,value,options={}){const k=this.createNode(key,null,options),v=this.createNode(value,null,options);return new Pair(k,v)}delete(key){return!!assertCollection(this.contents)&&this.contents.delete(key)}deleteIn(path){return isEmptyPath(path)?null!=this.contents&&(this.contents=null,!0):!!assertCollection(this.contents)&&this.contents.deleteIn(path)}get(key,keepScalar){return isCollection(this.contents)?this.contents.get(key,keepScalar):void 0}getIn(path,keepScalar){return isEmptyPath(path)?!keepScalar&&isScalar(this.contents)?this.contents.value:this.contents:isCollection(this.contents)?this.contents.getIn(path,keepScalar):void 0}has(key){return!!isCollection(this.contents)&&this.contents.has(key)}hasIn(path){return isEmptyPath(path)?void 0!==this.contents:!!isCollection(this.contents)&&this.contents.hasIn(path)}set(key,value){null==this.contents?this.contents=collectionFromPath(this.schema,[key],value):assertCollection(this.contents)&&this.contents.set(key,value)}setIn(path,value){isEmptyPath(path)?this.contents=value:null==this.contents?this.contents=collectionFromPath(this.schema,Array.from(path),value):assertCollection(this.contents)&&this.contents.setIn(path,value)}setSchema(version2,options={}){let opt;switch("number"==typeof version2&&(version2=String(version2)),version2){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Directives({version:"1.1"}),opt={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=version2:this.directives=new Directives({version:version2}),opt={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,opt=null;break;default:{const sv=JSON.stringify(version2);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${sv}`)}}if(options.schema instanceof Object)this.schema=options.schema;else{if(!opt)throw new Error("With a null YAML version, the { schema: Schema } option is required");this.schema=new Schema(Object.assign(opt,options))}}toJS({json:json,jsonArg:jsonArg,mapAsMap:mapAsMap,maxAliasCount:maxAliasCount,onAnchor:onAnchor,reviver:reviver}={}){const ctx={anchors:new Map,doc:this,keep:!json,mapAsMap:!0===mapAsMap,mapKeyWarned:!1,maxAliasCount:"number"==typeof maxAliasCount?maxAliasCount:100},res=toJS(this.contents,null!=jsonArg?jsonArg:"",ctx);if("function"==typeof onAnchor)for(const{count:count,res:res2}of ctx.anchors.values())onAnchor(res2,count);return"function"==typeof reviver?applyReviver(reviver,{"":res},"",res):res}toJSON(jsonArg,onAnchor){return this.toJS({json:!0,jsonArg:jsonArg,mapAsMap:!1,onAnchor:onAnchor})}toString(options={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in options&&(!Number.isInteger(options.indent)||Number(options.indent)<=0)){const s2=JSON.stringify(options.indent);throw new Error(`"indent" option must be a positive integer, not ${s2}`)}return function(doc2,options){var _a2;const lines=[];let hasDirectives=!0===options.directives;if(!1!==options.directives&&doc2.directives){const dir=doc2.directives.toString(doc2);dir?(lines.push(dir),hasDirectives=!0):doc2.directives.docStart&&(hasDirectives=!0)}hasDirectives&&lines.push("---");const ctx=createStringifyContext(doc2,options),{commentString:commentString}=ctx.options;if(doc2.commentBefore){1!==lines.length&&lines.unshift("");const cs=commentString(doc2.commentBefore);lines.unshift(indentComment(cs,""))}let chompKeep=!1,contentComment=null;if(doc2.contents){if(isNode(doc2.contents)){if(doc2.contents.spaceBefore&&hasDirectives&&lines.push(""),doc2.contents.commentBefore){const cs=commentString(doc2.contents.commentBefore);lines.push(indentComment(cs,""))}ctx.forceBlockIndent=!!doc2.comment,contentComment=doc2.contents.comment}const onChompKeep=contentComment?void 0:()=>chompKeep=!0;let body=stringify$1(doc2.contents,ctx,()=>contentComment=null,onChompKeep);contentComment&&(body+=lineComment(body,"",commentString(contentComment))),"|"!==body[0]&&">"!==body[0]||"---"!==lines[lines.length-1]?lines.push(body):lines[lines.length-1]=`--- ${body}`}else lines.push(stringify$1(doc2.contents,ctx));if(null==(_a2=doc2.directives)?void 0:_a2.docEnd)if(doc2.comment){const cs=commentString(doc2.comment);cs.includes("\n")?(lines.push("..."),lines.push(indentComment(cs,""))):lines.push(`... ${cs}`)}else lines.push("...");else{let dc=doc2.comment;dc&&chompKeep&&(dc=dc.replace(/^\n+/,"")),dc&&(chompKeep&&!contentComment||""===lines[lines.length-1]||lines.push(""),lines.push(indentComment(commentString(dc),"")))}return lines.join("\n")+"\n"}(this,options)}}function assertCollection(contents){if(isCollection(contents))return!0;throw new Error("Expected a YAML collection as document contents")}class YAMLError extends Error{constructor(name,pos,code,message){super(),this.name=name,this.code=code,this.message=message,this.pos=pos}}class YAMLParseError extends YAMLError{constructor(pos,code,message){super("YAMLParseError",pos,code,message)}}class YAMLWarning extends YAMLError{constructor(pos,code,message){super("YAMLWarning",pos,code,message)}}const prettifyError=(src,lc)=>error=>{if(-1===error.pos[0])return;error.linePos=error.pos.map(pos=>lc.linePos(pos));const{line:line,col:col}=error.linePos[0];error.message+=` at line ${line}, column ${col}`;let ci=col-1,lineStr=src.substring(lc.lineStarts[line-1],lc.lineStarts[line]).replace(/[\n\r]+$/,"");if(ci>=60&&lineStr.length>80){const trimStart=Math.min(ci-39,lineStr.length-79);lineStr="…"+lineStr.substring(trimStart),ci-=trimStart-1}if(lineStr.length>80&&(lineStr=lineStr.substring(0,79)+"…"),line>1&&/^ *$/.test(lineStr.substring(0,ci))){let prev=src.substring(lc.lineStarts[line-2],lc.lineStarts[line-1]);prev.length>80&&(prev=prev.substring(0,79)+"…\n"),lineStr=prev+lineStr}if(/[^ ]/.test(lineStr)){let count=1;const end=error.linePos[1];end&&end.line===line&&end.col>col&&(count=Math.max(1,Math.min(end.col-col,80-ci)));const pointer=" ".repeat(ci)+"^".repeat(count);error.message+=`:\n\n${lineStr}\n${pointer}\n`}};function resolveProps(tokens,{flow:flow,indicator:indicator,next:next,offset:offset2,onError:onError,parentIndent:parentIndent,startOnNewline:startOnNewline}){let spaceBefore=!1,atNewline=startOnNewline,hasSpace=startOnNewline,comment="",commentSep="",hasNewline=!1,reqSpace=!1,tab=null,anchor=null,tag=null,newlineAfterProp=null,comma=null,found=null,start=null;for(const token of tokens)switch(reqSpace&&("space"!==token.type&&"newline"!==token.type&&"comma"!==token.type&&onError(token.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),reqSpace=!1),tab&&(atNewline&&"comment"!==token.type&&"newline"!==token.type&&onError(tab,"TAB_AS_INDENT","Tabs are not allowed as indentation"),tab=null),token.type){case"space":flow||"doc-start"===indicator&&"flow-collection"===(null==next?void 0:next.type)||!token.source.includes("\t")||(tab=token),hasSpace=!0;break;case"comment":{hasSpace||onError(token,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const cb=token.source.substring(1)||" ";comment?comment+=commentSep+cb:comment=cb,commentSep="",atNewline=!1;break}case"newline":atNewline?comment?comment+=token.source:found&&"seq-item-ind"===indicator||(spaceBefore=!0):commentSep+=token.source,atNewline=!0,hasNewline=!0,(anchor||tag)&&(newlineAfterProp=token),hasSpace=!0;break;case"anchor":anchor&&onError(token,"MULTIPLE_ANCHORS","A node can have at most one anchor"),token.source.endsWith(":")&&onError(token.offset+token.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),anchor=token,null!=start||(start=token.offset),atNewline=!1,hasSpace=!1,reqSpace=!0;break;case"tag":tag&&onError(token,"MULTIPLE_TAGS","A node can have at most one tag"),tag=token,null!=start||(start=token.offset),atNewline=!1,hasSpace=!1,reqSpace=!0;break;case indicator:(anchor||tag)&&onError(token,"BAD_PROP_ORDER",`Anchors and tags must be after the ${token.source} indicator`),found&&onError(token,"UNEXPECTED_TOKEN",`Unexpected ${token.source} in ${null!=flow?flow:"collection"}`),found=token,atNewline="seq-item-ind"===indicator||"explicit-key-ind"===indicator,hasSpace=!1;break;case"comma":if(flow){comma&&onError(token,"UNEXPECTED_TOKEN",`Unexpected , in ${flow}`),comma=token,atNewline=!1,hasSpace=!1;break}default:onError(token,"UNEXPECTED_TOKEN",`Unexpected ${token.type} token`),atNewline=!1,hasSpace=!1}const last=tokens[tokens.length-1],end=last?last.offset+last.source.length:offset2;return reqSpace&&next&&"space"!==next.type&&"newline"!==next.type&&"comma"!==next.type&&("scalar"!==next.type||""!==next.source)&&onError(next.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),tab&&(atNewline&&tab.indent<=parentIndent||"block-map"===(null==next?void 0:next.type)||"block-seq"===(null==next?void 0:next.type))&&onError(tab,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:comma,found:found,spaceBefore:spaceBefore,comment:comment,hasNewline:hasNewline,anchor:anchor,tag:tag,newlineAfterProp:newlineAfterProp,end:end,start:null!=start?start:end}}function containsNewline(key){if(!key)return null;switch(key.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(key.source.includes("\n"))return!0;if(key.end)for(const st of key.end)if("newline"===st.type)return!0;return!1;case"flow-collection":for(const it of key.items){for(const st of it.start)if("newline"===st.type)return!0;if(it.sep)for(const st of it.sep)if("newline"===st.type)return!0;if(containsNewline(it.key)||containsNewline(it.value))return!0}return!1;default:return!0}}function flowIndentCheck(indent,fc,onError){if("flow-collection"===(null==fc?void 0:fc.type)){const end=fc.end[0];if(end.indent===indent&&("]"===end.source||"}"===end.source)&&containsNewline(fc)){onError(end,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}}function mapIncludes(ctx,items,search){const{uniqueKeys:uniqueKeys}=ctx.options;if(!1===uniqueKeys)return!1;const isEqual="function"==typeof uniqueKeys?uniqueKeys:(a,b)=>a===b||isScalar(a)&&isScalar(b)&&a.value===b.value;return items.some(pair=>isEqual(pair.key,search))}const startColMsg="All mapping items must start at the same column";function resolveEnd(end,offset2,reqSpace,onError){let comment="";if(end){let hasSpace=!1,sep="";for(const token of end){const{source:source,type:type}=token;switch(type){case"space":hasSpace=!0;break;case"comment":{reqSpace&&!hasSpace&&onError(token,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const cb=source.substring(1)||" ";comment?comment+=sep+cb:comment=cb,sep="";break}case"newline":comment&&(sep+=source),hasSpace=!0;break;default:onError(token,"UNEXPECTED_TOKEN",`Unexpected ${type} at node end`)}offset2+=source.length}}return{comment:comment,offset:offset2}}const blockMsg="Block collections are not allowed within flow collections",isBlock=token=>token&&("block-map"===token.type||"block-seq"===token.type);function resolveCollection(CN2,ctx,token,onError,tagName,tag){const coll="block-map"===token.type?function({composeNode:composeNode2,composeEmptyNode:composeEmptyNode2},ctx,bm,onError,tag){var _a2,_b2;const map2=new(null!=(_a2=null==tag?void 0:tag.nodeClass)?_a2:YAMLMap)(ctx.schema);ctx.atRoot&&(ctx.atRoot=!1);let offset2=bm.offset,commentEnd=null;for(const collItem of bm.items){const{start:start,key:key,sep:sep,value:value}=collItem,keyProps=resolveProps(start,{indicator:"explicit-key-ind",next:null!=key?key:null==sep?void 0:sep[0],offset:offset2,onError:onError,parentIndent:bm.indent,startOnNewline:!0}),implicitKey=!keyProps.found;if(implicitKey){if(key&&("block-seq"===key.type?onError(offset2,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in key&&key.indent!==bm.indent&&onError(offset2,"BAD_INDENT",startColMsg)),!keyProps.anchor&&!keyProps.tag&&!sep){commentEnd=keyProps.end,keyProps.comment&&(map2.comment?map2.comment+="\n"+keyProps.comment:map2.comment=keyProps.comment);continue}(keyProps.newlineAfterProp||containsNewline(key))&&onError(null!=key?key:start[start.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else(null==(_b2=keyProps.found)?void 0:_b2.indent)!==bm.indent&&onError(offset2,"BAD_INDENT",startColMsg);ctx.atKey=!0;const keyStart=keyProps.end,keyNode=key?composeNode2(ctx,key,keyProps,onError):composeEmptyNode2(ctx,keyStart,start,null,keyProps,onError);ctx.schema.compat&&flowIndentCheck(bm.indent,key,onError),ctx.atKey=!1,mapIncludes(ctx,map2.items,keyNode)&&onError(keyStart,"DUPLICATE_KEY","Map keys must be unique");const valueProps=resolveProps(null!=sep?sep:[],{indicator:"map-value-ind",next:value,offset:keyNode.range[2],onError:onError,parentIndent:bm.indent,startOnNewline:!key||"block-scalar"===key.type});if(offset2=valueProps.end,valueProps.found){implicitKey&&("block-map"!==(null==value?void 0:value.type)||valueProps.hasNewline||onError(offset2,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),ctx.options.strict&&keyProps.start<valueProps.found.offset-1024&&onError(keyNode.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const valueNode=value?composeNode2(ctx,value,valueProps,onError):composeEmptyNode2(ctx,offset2,sep,null,valueProps,onError);ctx.schema.compat&&flowIndentCheck(bm.indent,value,onError),offset2=valueNode.range[2];const pair=new Pair(keyNode,valueNode);ctx.options.keepSourceTokens&&(pair.srcToken=collItem),map2.items.push(pair)}else{implicitKey&&onError(keyNode.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),valueProps.comment&&(keyNode.comment?keyNode.comment+="\n"+valueProps.comment:keyNode.comment=valueProps.comment);const pair=new Pair(keyNode);ctx.options.keepSourceTokens&&(pair.srcToken=collItem),map2.items.push(pair)}}return commentEnd&&commentEnd<offset2&&onError(commentEnd,"IMPOSSIBLE","Map comment with trailing content"),map2.range=[bm.offset,offset2,null!=commentEnd?commentEnd:offset2],map2}(CN2,ctx,token,onError,tag):"block-seq"===token.type?function({composeNode:composeNode2,composeEmptyNode:composeEmptyNode2},ctx,bs,onError,tag){var _a2;const seq2=new(null!=(_a2=null==tag?void 0:tag.nodeClass)?_a2:YAMLSeq)(ctx.schema);ctx.atRoot&&(ctx.atRoot=!1),ctx.atKey&&(ctx.atKey=!1);let offset2=bs.offset,commentEnd=null;for(const{start:start,value:value}of bs.items){const props=resolveProps(start,{indicator:"seq-item-ind",next:value,offset:offset2,onError:onError,parentIndent:bs.indent,startOnNewline:!0});if(!props.found){if(!(props.anchor||props.tag||value)){commentEnd=props.end,props.comment&&(seq2.comment=props.comment);continue}value&&"block-seq"===value.type?onError(props.end,"BAD_INDENT","All sequence items must start at the same column"):onError(offset2,"MISSING_CHAR","Sequence item without - indicator")}const node=value?composeNode2(ctx,value,props,onError):composeEmptyNode2(ctx,props.end,start,null,props,onError);ctx.schema.compat&&flowIndentCheck(bs.indent,value,onError),offset2=node.range[2],seq2.items.push(node)}return seq2.range=[bs.offset,offset2,null!=commentEnd?commentEnd:offset2],seq2}(CN2,ctx,token,onError,tag):function({composeNode:composeNode2,composeEmptyNode:composeEmptyNode2},ctx,fc,onError,tag){var _a2,_b2;const isMap2="{"===fc.start.source,fcName=isMap2?"flow map":"flow sequence",coll=new(null!=(_a2=null==tag?void 0:tag.nodeClass)?_a2:isMap2?YAMLMap:YAMLSeq)(ctx.schema);coll.flow=!0;const atRoot=ctx.atRoot;atRoot&&(ctx.atRoot=!1),ctx.atKey&&(ctx.atKey=!1);let offset2=fc.offset+fc.start.source.length;for(let i=0;i<fc.items.length;++i){const collItem=fc.items[i],{start:start,key:key,sep:sep,value:value}=collItem,props=resolveProps(start,{flow:fcName,indicator:"explicit-key-ind",next:null!=key?key:null==sep?void 0:sep[0],offset:offset2,onError:onError,parentIndent:fc.indent,startOnNewline:!1});if(!props.found){if(!(props.anchor||props.tag||sep||value)){0===i&&props.comma?onError(props.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${fcName}`):i<fc.items.length-1&&onError(props.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${fcName}`),props.comment&&(coll.comment?coll.comment+="\n"+props.comment:coll.comment=props.comment),offset2=props.end;continue}!isMap2&&ctx.options.strict&&containsNewline(key)&&onError(key,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(0===i)props.comma&&onError(props.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${fcName}`);else if(props.comma||onError(props.start,"MISSING_CHAR",`Missing , between ${fcName} items`),props.comment){let prevItemComment="";loop:for(const st of start)switch(st.type){case"comma":case"space":break;case"comment":prevItemComment=st.source.substring(1);break loop;default:break loop}if(prevItemComment){let prev=coll.items[coll.items.length-1];isPair(prev)&&(prev=null!=(_b2=prev.value)?_b2:prev.key),prev.comment?prev.comment+="\n"+prevItemComment:prev.comment=prevItemComment,props.comment=props.comment.substring(prevItemComment.length+1)}}if(isMap2||sep||props.found){ctx.atKey=!0;const keyStart=props.end,keyNode=key?composeNode2(ctx,key,props,onError):composeEmptyNode2(ctx,keyStart,start,null,props,onError);isBlock(key)&&onError(keyNode.range,"BLOCK_IN_FLOW",blockMsg),ctx.atKey=!1;const valueProps=resolveProps(null!=sep?sep:[],{flow:fcName,indicator:"map-value-ind",next:value,offset:keyNode.range[2],onError:onError,parentIndent:fc.indent,startOnNewline:!1});if(valueProps.found){if(!isMap2&&!props.found&&ctx.options.strict){if(sep)for(const st of sep){if(st===valueProps.found)break;if("newline"===st.type){onError(st,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}props.start<valueProps.found.offset-1024&&onError(valueProps.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else value&&("source"in value&&value.source&&":"===value.source[0]?onError(value,"MISSING_CHAR",`Missing space after : in ${fcName}`):onError(valueProps.start,"MISSING_CHAR",`Missing , or : between ${fcName} items`));const valueNode=value?composeNode2(ctx,value,valueProps,onError):valueProps.found?composeEmptyNode2(ctx,valueProps.end,sep,null,valueProps,onError):null;valueNode?isBlock(value)&&onError(valueNode.range,"BLOCK_IN_FLOW",blockMsg):valueProps.comment&&(keyNode.comment?keyNode.comment+="\n"+valueProps.comment:keyNode.comment=valueProps.comment);const pair=new Pair(keyNode,valueNode);if(ctx.options.keepSourceTokens&&(pair.srcToken=collItem),isMap2){const map2=coll;mapIncludes(ctx,map2.items,keyNode)&&onError(keyStart,"DUPLICATE_KEY","Map keys must be unique"),map2.items.push(pair)}else{const map2=new YAMLMap(ctx.schema);map2.flow=!0,map2.items.push(pair);const endRange=(null!=valueNode?valueNode:keyNode).range;map2.range=[keyNode.range[0],endRange[1],endRange[2]],coll.items.push(map2)}offset2=valueNode?valueNode.range[2]:valueProps.end}else{const valueNode=value?composeNode2(ctx,value,props,onError):composeEmptyNode2(ctx,props.end,sep,null,props,onError);coll.items.push(valueNode),offset2=valueNode.range[2],isBlock(value)&&onError(valueNode.range,"BLOCK_IN_FLOW",blockMsg)}}const expectedEnd=isMap2?"}":"]",[ce,...ee]=fc.end;let cePos=offset2;if(ce&&ce.source===expectedEnd)cePos=ce.offset+ce.source.length;else{const name=fcName[0].toUpperCase()+fcName.substring(1);onError(offset2,atRoot?"MISSING_CHAR":"BAD_INDENT",atRoot?`${name} must end with a ${expectedEnd}`:`${name} in block collection must be sufficiently indented and end with a ${expectedEnd}`),ce&&1!==ce.source.length&&ee.unshift(ce)}if(ee.length>0){const end=resolveEnd(ee,cePos,ctx.options.strict,onError);end.comment&&(coll.comment?coll.comment+="\n"+end.comment:coll.comment=end.comment),coll.range=[fc.offset,cePos,end.offset]}else coll.range=[fc.offset,cePos,cePos];return coll}(CN2,ctx,token,onError,tag),Coll=coll.constructor;return"!"===tagName||tagName===Coll.tagName?(coll.tag=Coll.tagName,coll):(tagName&&(coll.tag=tagName),coll)}function resolveBlockScalar(ctx,scalar,onError){const start=scalar.offset,header=function({offset:offset2,props:props},strict,onError){if("block-scalar-header"!==props[0].type)return onError(props[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:source}=props[0],mode=source[0];let indent=0,chomp="",error=-1;for(let i=1;i<source.length;++i){const ch=source[i];if(chomp||"-"!==ch&&"+"!==ch){const n2=Number(ch);!indent&&n2?indent=n2:-1===error&&(error=offset2+i)}else chomp=ch}-1!==error&&onError(error,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${source}`);let hasSpace=!1,comment="",length=source.length;for(let i=1;i<props.length;++i){const token=props[i];switch(token.type){case"space":hasSpace=!0;case"newline":length+=token.source.length;break;case"comment":if(strict&&!hasSpace){onError(token,"MISSING_CHAR","Comments must be separated from other tokens by white space characters")}length+=token.source.length,comment=token.source.substring(1);break;case"error":onError(token,"UNEXPECTED_TOKEN",token.message),length+=token.source.length;break;default:{onError(token,"UNEXPECTED_TOKEN",`Unexpected token in block scalar header: ${token.type}`);const ts=token.source;ts&&"string"==typeof ts&&(length+=ts.length)}}}return{mode:mode,indent:indent,chomp:chomp,comment:comment,length:length}}(scalar,ctx.options.strict,onError);if(!header)return{value:"",type:null,comment:"",range:[start,start,start]};const type=">"===header.mode?Scalar.BLOCK_FOLDED:Scalar.BLOCK_LITERAL,lines=scalar.source?function(source){const split2=source.split(/\n( *)/),first=split2[0],m=first.match(/^( *)/),lines=[(null==m?void 0:m[1])?[m[1],first.slice(m[1].length)]:["",first]];for(let i=1;i<split2.length;i+=2)lines.push([split2[i],split2[i+1]]);return lines}(scalar.source):[];let chompStart=lines.length;for(let i=lines.length-1;i>=0;--i){const content=lines[i][1];if(""!==content&&"\r"!==content)break;chompStart=i}if(0===chompStart){const value2="+"===header.chomp&&lines.length>0?"\n".repeat(Math.max(1,lines.length-1)):"";let end2=start+header.length;return scalar.source&&(end2+=scalar.source.length),{value:value2,type:type,comment:header.comment,range:[start,end2,end2]}}let trimIndent=scalar.indent+header.indent,offset2=scalar.offset+header.length,contentStart=0;for(let i=0;i<chompStart;++i){const[indent,content]=lines[i];if(""!==content&&"\r"!==content){if(indent.length<trimIndent){const message="Block scalars with more-indented leading empty lines must use an explicit indentation indicator";onError(offset2+indent.length,"MISSING_CHAR",message)}if(0===header.indent&&(trimIndent=indent.length),contentStart=i,0===trimIndent&&!ctx.atRoot){onError(offset2,"BAD_INDENT","Block scalar values in collections must be indented")}break}0===header.indent&&indent.length>trimIndent&&(trimIndent=indent.length),offset2+=indent.length+content.length+1}for(let i=lines.length-1;i>=chompStart;--i)lines[i][0].length>trimIndent&&(chompStart=i+1);let value="",sep="",prevMoreIndented=!1;for(let i=0;i<contentStart;++i)value+=lines[i][0].slice(trimIndent)+"\n";for(let i=contentStart;i<chompStart;++i){let[indent,content]=lines[i];offset2+=indent.length+content.length+1;const crlf="\r"===content[content.length-1];if(crlf&&(content=content.slice(0,-1)),content&&indent.length<trimIndent){const message=`Block scalar lines must not be less indented than their ${header.indent?"explicit indentation indicator":"first line"}`;onError(offset2-content.length-(crlf?2:1),"BAD_INDENT",message),indent=""}type===Scalar.BLOCK_LITERAL?(value+=sep+indent.slice(trimIndent)+content,sep="\n"):indent.length>trimIndent||"\t"===content[0]?(" "===sep?sep="\n":prevMoreIndented||"\n"!==sep||(sep="\n\n"),value+=sep+indent.slice(trimIndent)+content,sep="\n",prevMoreIndented=!0):""===content?"\n"===sep?value+="\n":sep="\n":(value+=sep+content,sep=" ",prevMoreIndented=!1)}switch(header.chomp){case"-":break;case"+":for(let i=chompStart;i<lines.length;++i)value+="\n"+lines[i][0].slice(trimIndent);"\n"!==value[value.length-1]&&(value+="\n");break;default:value+="\n"}const end=start+header.length+scalar.source.length;return{value:value,type:type,comment:header.comment,range:[start,end,end]}}function resolveFlowScalar(scalar,strict,onError){const{offset:offset2,type:type,source:source,end:end}=scalar;let _type,value;const _onError=(rel,code,msg)=>onError(offset2+rel,code,msg);switch(type){case"scalar":_type=Scalar.PLAIN,value=function(source,onError){let badChar="";switch(source[0]){case"\t":badChar="a tab character";break;case",":badChar="flow indicator character ,";break;case"%":badChar="directive indicator character %";break;case"|":case">":badChar=`block scalar indicator ${source[0]}`;break;case"@":case"`":badChar=`reserved character ${source[0]}`}badChar&&onError(0,"BAD_SCALAR_START",`Plain value cannot start with ${badChar}`);return foldLines(source)}(source,_onError);break;case"single-quoted-scalar":_type=Scalar.QUOTE_SINGLE,value=function(source,onError){"'"===source[source.length-1]&&1!==source.length||onError(source.length,"MISSING_CHAR","Missing closing 'quote");return foldLines(source.slice(1,-1)).replace(/''/g,"'")}(source,_onError);break;case"double-quoted-scalar":_type=Scalar.QUOTE_DOUBLE,value=function(source,onError){let res="";for(let i=1;i<source.length-1;++i){const ch=source[i];if("\r"!==ch||"\n"!==source[i+1])if("\n"===ch){const{fold:fold,offset:offset2}=foldNewline(source,i);res+=fold,i=offset2}else if("\\"===ch){let next=source[++i];const cc=escapeCodes[next];if(cc)res+=cc;else if("\n"===next)for(next=source[i+1];" "===next||"\t"===next;)next=source[1+ ++i];else if("\r"===next&&"\n"===source[i+1])for(next=source[1+ ++i];" "===next||"\t"===next;)next=source[1+ ++i];else if("x"===next||"u"===next||"U"===next){const length={x:2,u:4,U:8}[next];res+=parseCharCode(source,i+1,length,onError),i+=length}else{const raw=source.substr(i-1,2);onError(i-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${raw}`),res+=raw}}else if(" "===ch||"\t"===ch){const wsStart=i;let next=source[i+1];for(;" "===next||"\t"===next;)next=source[1+ ++i];"\n"===next||"\r"===next&&"\n"===source[i+2]||(res+=i>wsStart?source.slice(wsStart,i+1):ch)}else res+=ch}'"'===source[source.length-1]&&1!==source.length||onError(source.length,"MISSING_CHAR",'Missing closing "quote');return res}(source,_onError);break;default:return onError(scalar,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${type}`),{value:"",type:null,comment:"",range:[offset2,offset2+source.length,offset2+source.length]}}const valueEnd=offset2+source.length,re=resolveEnd(end,valueEnd,strict,onError);return{value:value,type:_type,comment:re.comment,range:[offset2,valueEnd,re.offset]}}function foldLines(source){var _a2;let first,line;try{first=new RegExp("(.*?)(?<![ \t])[ \t]*\r?\n","sy"),line=new RegExp("[ \t]*(.*?)(?:(?<![ \t])[ \t]*)?\r?\n","sy")}catch(e){first=new RegExp("(.*?)[ \\t]*\\r?\\n","sy"),line=new RegExp("[ \\t]*(.*?)[ \\t]*\\r?\\n","sy")}let match2=first.exec(source);if(!match2)return source;let res=match2[1],sep=" ",pos=first.lastIndex;for(line.lastIndex=pos;match2=line.exec(source);)""===match2[1]?"\n"===sep?res+=sep:sep="\n":(res+=sep+match2[1],sep=" "),pos=line.lastIndex;const last=new RegExp("[ \\t]*(.*)","sy");return last.lastIndex=pos,match2=last.exec(source),res+sep+(null!=(_a2=null==match2?void 0:match2[1])?_a2:"")}function foldNewline(source,offset2){let fold="",ch=source[offset2+1];for(;!(" "!==ch&&"\t"!==ch&&"\n"!==ch&&"\r"!==ch||"\r"===ch&&"\n"!==source[offset2+2]);)"\n"===ch&&(fold+="\n"),ch=source[(offset2+=1)+1];return fold||(fold=" "),{fold:fold,offset:offset2}}const escapeCodes={0:"\0",a:"",b:"\b",e:"",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","\t":"\t"};function parseCharCode(source,offset2,length,onError){const cc=source.substr(offset2,length),code=cc.length===length&&/^[0-9a-fA-F]+$/.test(cc)?parseInt(cc,16):NaN;if(isNaN(code)){const raw=source.substr(offset2-2,length+2);return onError(offset2-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${raw}`),raw}return String.fromCodePoint(code)}function composeScalar(ctx,token,tagToken,onError){const{value:value,type:type,comment:comment,range:range2}="block-scalar"===token.type?resolveBlockScalar(ctx,token,onError):resolveFlowScalar(token,ctx.options.strict,onError),tagName=tagToken?ctx.directives.tagName(tagToken.source,msg=>onError(tagToken,"TAG_RESOLVE_FAILED",msg)):null;let tag,scalar;tag=ctx.options.stringKeys&&ctx.atKey?ctx.schema[SCALAR$1]:tagName?function(schema2,value,tagName,tagToken,onError){var _a2;if("!"===tagName)return schema2[SCALAR$1];const matchWithTest=[];for(const tag of schema2.tags)if(!tag.collection&&tag.tag===tagName){if(!tag.default||!tag.test)return tag;matchWithTest.push(tag)}for(const tag of matchWithTest)if(null==(_a2=tag.test)?void 0:_a2.test(value))return tag;const kt=schema2.knownTags[tagName];if(kt&&!kt.collection)return schema2.tags.push(Object.assign({},kt,{default:!1,test:void 0})),kt;return onError(tagToken,"TAG_RESOLVE_FAILED",`Unresolved tag: ${tagName}`,"tag:yaml.org,2002:str"!==tagName),schema2[SCALAR$1]}(ctx.schema,value,tagName,tagToken,onError):"scalar"===token.type?function({atKey:atKey,directives:directives,schema:schema2},value,token,onError){var _a2;const tag=schema2.tags.find(tag2=>{var _a3;return(!0===tag2.default||atKey&&"key"===tag2.default)&&(null==(_a3=tag2.test)?void 0:_a3.test(value))})||schema2[SCALAR$1];if(schema2.compat){const compat=null!=(_a2=schema2.compat.find(tag2=>{var _a3;return tag2.default&&(null==(_a3=tag2.test)?void 0:_a3.test(value))}))?_a2:schema2[SCALAR$1];if(tag.tag!==compat.tag){onError(token,"TAG_RESOLVE_FAILED",`Value may be parsed as either ${directives.tagString(tag.tag)} or ${directives.tagString(compat.tag)}`,!0)}}return tag}(ctx,value,token,onError):ctx.schema[SCALAR$1];try{const res=tag.resolve(value,msg=>onError(null!=tagToken?tagToken:token,"TAG_RESOLVE_FAILED",msg),ctx.options);scalar=isScalar(res)?res:new Scalar(res)}catch(error){const msg=error instanceof Error?error.message:String(error);onError(null!=tagToken?tagToken:token,"TAG_RESOLVE_FAILED",msg),scalar=new Scalar(value)}return scalar.range=range2,scalar.source=value,type&&(scalar.type=type),tagName&&(scalar.tag=tagName),tag.format&&(scalar.format=tag.format),comment&&(scalar.comment=comment),scalar}function emptyScalarPosition(offset2,before,pos){if(before){null!=pos||(pos=before.length);for(let i=pos-1;i>=0;--i){let st=before[i];switch(st.type){case"space":case"comment":case"newline":offset2-=st.source.length;continue}for(st=before[++i];"space"===(null==st?void 0:st.type);)offset2+=st.source.length,st=before[++i];break}}return offset2}const CN={composeNode:composeNode,composeEmptyNode:composeEmptyNode};function composeNode(ctx,token,props,onError){const atKey=ctx.atKey,{spaceBefore:spaceBefore,comment:comment,anchor:anchor,tag:tag}=props;let node,isSrcToken=!0;switch(token.type){case"alias":node=function({options:options},{offset:offset2,source:source,end:end},onError){const alias=new Alias(source.substring(1));""===alias.source&&onError(offset2,"BAD_ALIAS","Alias cannot be an empty string");alias.source.endsWith(":")&&onError(offset2+source.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const valueEnd=offset2+source.length,re=resolveEnd(end,valueEnd,options.strict,onError);alias.range=[offset2,valueEnd,re.offset],re.comment&&(alias.comment=re.comment);return alias}(ctx,token,onError),(anchor||tag)&&onError(token,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":node=composeScalar(ctx,token,tag,onError),anchor&&(node.anchor=anchor.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":node=function(CN2,ctx,token,props,onError){var _a2,_b2,_c2;const tagToken=props.tag,tagName=tagToken?ctx.directives.tagName(tagToken.source,msg=>onError(tagToken,"TAG_RESOLVE_FAILED",msg)):null;if("block-seq"===token.type){const{anchor:anchor,newlineAfterProp:nl}=props,lastProp=anchor&&tagToken?anchor.offset>tagToken.offset?anchor:tagToken:null!=anchor?anchor:tagToken;lastProp&&(!nl||nl.offset<lastProp.offset)&&onError(lastProp,"MISSING_CHAR","Missing newline after block sequence props")}const expType="block-map"===token.type?"map":"block-seq"===token.type?"seq":"{"===token.start.source?"map":"seq";if(!tagToken||!tagName||"!"===tagName||tagName===YAMLMap.tagName&&"map"===expType||tagName===YAMLSeq.tagName&&"seq"===expType)return resolveCollection(CN2,ctx,token,onError,tagName);let tag=ctx.schema.tags.find(t=>t.tag===tagName&&t.collection===expType);if(!tag){const kt=ctx.schema.knownTags[tagName];if(!kt||kt.collection!==expType)return kt?onError(tagToken,"BAD_COLLECTION_TYPE",`${kt.tag} used for ${expType} collection, but expects ${null!=(_a2=kt.collection)?_a2:"scalar"}`,!0):onError(tagToken,"TAG_RESOLVE_FAILED",`Unresolved tag: ${tagName}`,!0),resolveCollection(CN2,ctx,token,onError,tagName);ctx.schema.tags.push(Object.assign({},kt,{default:!1})),tag=kt}const coll=resolveCollection(CN2,ctx,token,onError,tagName,tag),res=null!=(_c2=null==(_b2=tag.resolve)?void 0:_b2.call(tag,coll,msg=>onError(tagToken,"TAG_RESOLVE_FAILED",msg),ctx.options))?_c2:coll,node=isNode(res)?res:new Scalar(res);return node.range=coll.range,node.tag=tagName,(null==tag?void 0:tag.format)&&(node.format=tag.format),node}(CN,ctx,token,props,onError),anchor&&(node.anchor=anchor.source.substring(1));break;default:onError(token,"UNEXPECTED_TOKEN","error"===token.type?token.message:`Unsupported token (type: ${token.type})`),node=composeEmptyNode(ctx,token.offset,void 0,null,props,onError),isSrcToken=!1}if(anchor&&""===node.anchor&&onError(anchor,"BAD_ALIAS","Anchor cannot be an empty string"),atKey&&ctx.options.stringKeys&&(!isScalar(node)||"string"!=typeof node.value||node.tag&&"tag:yaml.org,2002:str"!==node.tag)){onError(null!=tag?tag:token,"NON_STRING_KEY","With stringKeys, all keys must be strings")}return spaceBefore&&(node.spaceBefore=!0),comment&&("scalar"===token.type&&""===token.source?node.comment=comment:node.commentBefore=comment),ctx.options.keepSourceTokens&&isSrcToken&&(node.srcToken=token),node}function composeEmptyNode(ctx,offset2,before,pos,{spaceBefore:spaceBefore,comment:comment,anchor:anchor,tag:tag,end:end},onError){const node=composeScalar(ctx,{type:"scalar",offset:emptyScalarPosition(offset2,before,pos),indent:-1,source:""},tag,onError);return anchor&&(node.anchor=anchor.source.substring(1),""===node.anchor&&onError(anchor,"BAD_ALIAS","Anchor cannot be an empty string")),spaceBefore&&(node.spaceBefore=!0),comment&&(node.comment=comment,node.range[2]=end),node}function getErrorPos(src){if("number"==typeof src)return[src,src+1];if(Array.isArray(src))return 2===src.length?src:[src[0],src[1]];const{offset:offset2,source:source}=src;return[offset2,offset2+("string"==typeof source?source.length:1)]}function parsePrelude(prelude){var _a2;let comment="",atComment=!1,afterEmptyLine=!1;for(let i=0;i<prelude.length;++i){const source=prelude[i];switch(source[0]){case"#":comment+=(""===comment?"":afterEmptyLine?"\n\n":"\n")+(source.substring(1)||" "),atComment=!0,afterEmptyLine=!1;break;case"%":"#"!==(null==(_a2=prelude[i+1])?void 0:_a2[0])&&(i+=1),atComment=!1;break;default:atComment||(afterEmptyLine=!0),atComment=!1}}return{comment:comment,afterEmptyLine:afterEmptyLine}}class Composer{constructor(options={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(source,code,message,warning)=>{const pos=getErrorPos(source);warning?this.warnings.push(new YAMLWarning(pos,code,message)):this.errors.push(new YAMLParseError(pos,code,message))},this.directives=new Directives({version:options.version||"1.2"}),this.options=options}decorate(doc2,afterDoc){const{comment:comment,afterEmptyLine:afterEmptyLine}=parsePrelude(this.prelude);if(comment){const dc=doc2.contents;if(afterDoc)doc2.comment=doc2.comment?`${doc2.comment}\n${comment}`:comment;else if(afterEmptyLine||doc2.directives.docStart||!dc)doc2.commentBefore=comment;else if(isCollection(dc)&&!dc.flow&&dc.items.length>0){let it=dc.items[0];isPair(it)&&(it=it.key);const cb=it.commentBefore;it.commentBefore=cb?`${comment}\n${cb}`:comment}else{const cb=dc.commentBefore;dc.commentBefore=cb?`${comment}\n${cb}`:comment}}afterDoc?(Array.prototype.push.apply(doc2.errors,this.errors),Array.prototype.push.apply(doc2.warnings,this.warnings)):(doc2.errors=this.errors,doc2.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:parsePrelude(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(tokens,forceDoc=!1,endOffset=-1){for(const token of tokens)yield*__yieldStar(this.next(token));yield*__yieldStar(this.end(forceDoc,endOffset))}*next(token){switch(token.type){case"directive":this.directives.add(token.source,(offset2,message,warning)=>{const pos=getErrorPos(token);pos[0]+=offset2,this.onError(pos,"BAD_DIRECTIVE",message,warning)}),this.prelude.push(token.source),this.atDirectives=!0;break;case"document":{const doc2=function(options,directives,{offset:offset2,start:start,value:value,end:end},onError){const opts=Object.assign({_directives:directives},options),doc2=new Document(void 0,opts),ctx={atKey:!1,atRoot:!0,directives:doc2.directives,options:doc2.options,schema:doc2.schema},props=resolveProps(start,{indicator:"doc-start",next:null!=value?value:null==end?void 0:end[0],offset:offset2,onError:onError,parentIndent:0,startOnNewline:!0});props.found&&(doc2.directives.docStart=!0,!value||"block-map"!==value.type&&"block-seq"!==value.type||props.hasNewline||onError(props.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),doc2.contents=value?composeNode(ctx,value,props,onError):composeEmptyNode(ctx,props.end,start,null,props,onError);const contentEnd=doc2.contents.range[2],re=resolveEnd(end,contentEnd,!1,onError);return re.comment&&(doc2.comment=re.comment),doc2.range=[offset2,contentEnd,re.offset],doc2}(this.options,this.directives,token,this.onError);this.atDirectives&&!doc2.directives.docStart&&this.onError(token,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(doc2,!1),this.doc&&(yield this.doc),this.doc=doc2,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(token.source);break;case"error":{const msg=token.source?`${token.message}: ${JSON.stringify(token.source)}`:token.message,error=new YAMLParseError(getErrorPos(token),"UNEXPECTED_TOKEN",msg);this.atDirectives||!this.doc?this.errors.push(error):this.doc.errors.push(error);break}case"doc-end":{if(!this.doc){const msg="Unexpected doc-end without preceding document";this.errors.push(new YAMLParseError(getErrorPos(token),"UNEXPECTED_TOKEN",msg));break}this.doc.directives.docEnd=!0;const end=resolveEnd(token.end,token.offset+token.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),end.comment){const dc=this.doc.comment;this.doc.comment=dc?`${dc}\n${end.comment}`:end.comment}this.doc.range[2]=end.offset;break}default:this.errors.push(new YAMLParseError(getErrorPos(token),"UNEXPECTED_TOKEN",`Unsupported token ${token.type}`))}}*end(forceDoc=!1,endOffset=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(forceDoc){const opts=Object.assign({_directives:this.directives},this.options),doc2=new Document(void 0,opts);this.atDirectives&&this.onError(endOffset,"MISSING_CHAR","Missing directives-end indicator line"),doc2.range=[0,endOffset,endOffset],this.decorate(doc2,!1),yield doc2}}}function isEmpty(ch){switch(ch){case void 0:case" ":case"\n":case"\r":case"\t":return!0;default:return!1}}const hexDigits=new Set("0123456789ABCDEFabcdef"),tagChars=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),flowIndicatorChars=new Set(",[]{}"),invalidAnchorChars=new Set(" ,[]{}\n\r\t"),isNotAnchorChar=ch=>!ch||invalidAnchorChars.has(ch);class Lexer{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(source,incomplete=!1){var _a2;if(source){if("string"!=typeof source)throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+source:source,this.lineEndPos=null}this.atEnd=!incomplete;let next=null!=(_a2=this.next)?_a2:"stream";for(;next&&(incomplete||this.hasChars(1));)next=yield*__yieldStar(this.parseNext(next))}atLineEnd(){let i=this.pos,ch=this.buffer[i];for(;" "===ch||"\t"===ch;)ch=this.buffer[++i];return!ch||"#"===ch||"\n"===ch||"\r"===ch&&"\n"===this.buffer[i+1]}charAt(n2){return this.buffer[this.pos+n2]}continueScalar(offset2){let ch=this.buffer[offset2];if(this.indentNext>0){let indent=0;for(;" "===ch;)ch=this.buffer[++indent+offset2];if("\r"===ch){const next=this.buffer[indent+offset2+1];if("\n"===next||!next&&!this.atEnd)return offset2+indent+1}return"\n"===ch||indent>=this.indentNext||!ch&&!this.atEnd?offset2+indent:-1}if("-"===ch||"."===ch){const dt=this.buffer.substr(offset2,3);if(("---"===dt||"..."===dt)&&isEmpty(this.buffer[offset2+3]))return-1}return offset2}getLine(){let end=this.lineEndPos;return("number"!=typeof end||-1!==end&&end<this.pos)&&(end=this.buffer.indexOf("\n",this.pos),this.lineEndPos=end),-1===end?this.atEnd?this.buffer.substring(this.pos):null:("\r"===this.buffer[end-1]&&(end-=1),this.buffer.substring(this.pos,end))}hasChars(n2){return this.pos+n2<=this.buffer.length}setNext(state){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=state,null}peek(n2){return this.buffer.substr(this.pos,n2)}*parseNext(next){switch(next){case"stream":return yield*__yieldStar(this.parseStream());case"line-start":return yield*__yieldStar(this.parseLineStart());case"block-start":return yield*__yieldStar(this.parseBlockStart());case"doc":return yield*__yieldStar(this.parseDocument());case"flow":return yield*__yieldStar(this.parseFlowCollection());case"quoted-scalar":return yield*__yieldStar(this.parseQuotedScalar());case"block-scalar":return yield*__yieldStar(this.parseBlockScalar());case"plain-scalar":return yield*__yieldStar(this.parsePlainScalar())}}*parseStream(){let line=this.getLine();if(null===line)return this.setNext("stream");if("\ufeff"===line[0]&&(yield*__yieldStar(this.pushCount(1)),line=line.substring(1)),"%"===line[0]){let dirEnd=line.length,cs=line.indexOf("#");for(;-1!==cs;){const ch=line[cs-1];if(" "===ch||"\t"===ch){dirEnd=cs-1;break}cs=line.indexOf("#",cs+1)}for(;;){const ch=line[dirEnd-1];if(" "!==ch&&"\t"!==ch)break;dirEnd-=1}const n2=(yield*__yieldStar(this.pushCount(dirEnd)))+(yield*__yieldStar(this.pushSpaces(!0)));return yield*__yieldStar(this.pushCount(line.length-n2)),this.pushNewline(),"stream"}if(this.atLineEnd()){const sp=yield*__yieldStar(this.pushSpaces(!0));return yield*__yieldStar(this.pushCount(line.length-sp)),yield*__yieldStar(this.pushNewline()),"stream"}return yield"",yield*__yieldStar(this.parseLineStart())}*parseLineStart(){const ch=this.charAt(0);if(!ch&&!this.atEnd)return this.setNext("line-start");if("-"===ch||"."===ch){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const s2=this.peek(3);if(("---"===s2||"..."===s2)&&isEmpty(this.charAt(3)))return yield*__yieldStar(this.pushCount(3)),this.indentValue=0,this.indentNext=0,"---"===s2?"doc":"stream"}return this.indentValue=yield*__yieldStar(this.pushSpaces(!1)),this.indentNext>this.indentValue&&!isEmpty(this.charAt(1))&&(this.indentNext=this.indentValue),yield*__yieldStar(this.parseBlockStart())}*parseBlockStart(){const[ch0,ch1]=this.peek(2);if(!ch1&&!this.atEnd)return this.setNext("block-start");if(("-"===ch0||"?"===ch0||":"===ch0)&&isEmpty(ch1)){const n2=(yield*__yieldStar(this.pushCount(1)))+(yield*__yieldStar(this.pushSpaces(!0)));return this.indentNext=this.indentValue+1,this.indentValue+=n2,yield*__yieldStar(this.parseBlockStart())}return"doc"}*parseDocument(){yield*__yieldStar(this.pushSpaces(!0));const line=this.getLine();if(null===line)return this.setNext("doc");let n2=yield*__yieldStar(this.pushIndicators());switch(line[n2]){case"#":yield*__yieldStar(this.pushCount(line.length-n2));case void 0:return yield*__yieldStar(this.pushNewline()),yield*__yieldStar(this.parseLineStart());case"{":case"[":return yield*__yieldStar(this.pushCount(1)),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*__yieldStar(this.pushCount(1)),"doc";case"*":return yield*__yieldStar(this.pushUntil(isNotAnchorChar)),"doc";case'"':case"'":return yield*__yieldStar(this.parseQuotedScalar());case"|":case">":return n2+=(yield*__yieldStar(this.parseBlockScalarHeader())),n2+=(yield*__yieldStar(this.pushSpaces(!0))),yield*__yieldStar(this.pushCount(line.length-n2)),yield*__yieldStar(this.pushNewline()),yield*__yieldStar(this.parseBlockScalar());default:return yield*__yieldStar(this.parsePlainScalar())}}*parseFlowCollection(){let nl,sp,indent=-1;do{nl=yield*__yieldStar(this.pushNewline()),nl>0?(sp=yield*__yieldStar(this.pushSpaces(!1)),this.indentValue=indent=sp):sp=0,sp+=(yield*__yieldStar(this.pushSpaces(!0)))}while(nl+sp>0);const line=this.getLine();if(null===line)return this.setNext("flow");if(-1!==indent&&indent<this.indentNext&&"#"!==line[0]||0===indent&&(line.startsWith("---")||line.startsWith("..."))&&isEmpty(line[3])){if(!(indent===this.indentNext-1&&1===this.flowLevel&&("]"===line[0]||"}"===line[0])))return this.flowLevel=0,yield"",yield*__yieldStar(this.parseLineStart())}let n2=0;for(;","===line[n2];)n2+=(yield*__yieldStar(this.pushCount(1))),n2+=(yield*__yieldStar(this.pushSpaces(!0))),this.flowKey=!1;switch(n2+=(yield*__yieldStar(this.pushIndicators())),line[n2]){case void 0:return"flow";case"#":return yield*__yieldStar(this.pushCount(line.length-n2)),"flow";case"{":case"[":return yield*__yieldStar(this.pushCount(1)),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*__yieldStar(this.pushCount(1)),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*__yieldStar(this.pushUntil(isNotAnchorChar)),"flow";case'"':case"'":return this.flowKey=!0,yield*__yieldStar(this.parseQuotedScalar());case":":{const next=this.charAt(1);if(this.flowKey||isEmpty(next)||","===next)return this.flowKey=!1,yield*__yieldStar(this.pushCount(1)),yield*__yieldStar(this.pushSpaces(!0)),"flow"}default:return this.flowKey=!1,yield*__yieldStar(this.parsePlainScalar())}}*parseQuotedScalar(){const quote=this.charAt(0);let end=this.buffer.indexOf(quote,this.pos+1);if("'"===quote)for(;-1!==end&&"'"===this.buffer[end+1];)end=this.buffer.indexOf("'",end+2);else for(;-1!==end;){let n2=0;for(;"\\"===this.buffer[end-1-n2];)n2+=1;if(n2%2==0)break;end=this.buffer.indexOf('"',end+1)}const qb=this.buffer.substring(0,end);let nl=qb.indexOf("\n",this.pos);if(-1!==nl){for(;-1!==nl;){const cs=this.continueScalar(nl+1);if(-1===cs)break;nl=qb.indexOf("\n",cs)}-1!==nl&&(end=nl-("\r"===qb[nl-1]?2:1))}if(-1===end){if(!this.atEnd)return this.setNext("quoted-scalar");end=this.buffer.length}return yield*__yieldStar(this.pushToIndex(end+1,!1)),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let i=this.pos;for(;;){const ch=this.buffer[++i];if("+"===ch)this.blockScalarKeep=!0;else if(ch>"0"&&ch<="9")this.blockScalarIndent=Number(ch)-1;else if("-"!==ch)break}return yield*__yieldStar(this.pushUntil(ch=>isEmpty(ch)||"#"===ch))}*parseBlockScalar(){let ch,nl=this.pos-1,indent=0;loop:for(let i2=this.pos;ch=this.buffer[i2];++i2)switch(ch){case" ":indent+=1;break;case"\n":nl=i2,indent=0;break;case"\r":{const next=this.buffer[i2+1];if(!next&&!this.atEnd)return this.setNext("block-scalar");if("\n"===next)break}default:break loop}if(!ch&&!this.atEnd)return this.setNext("block-scalar");if(indent>=this.indentNext){-1===this.blockScalarIndent?this.indentNext=indent:this.indentNext=this.blockScalarIndent+(0===this.indentNext?1:this.indentNext);do{const cs=this.continueScalar(nl+1);if(-1===cs)break;nl=this.buffer.indexOf("\n",cs)}while(-1!==nl);if(-1===nl){if(!this.atEnd)return this.setNext("block-scalar");nl=this.buffer.length}}let i=nl+1;for(ch=this.buffer[i];" "===ch;)ch=this.buffer[++i];if("\t"===ch){for(;"\t"===ch||" "===ch||"\r"===ch||"\n"===ch;)ch=this.buffer[++i];nl=i-1}else if(!this.blockScalarKeep)for(;;){let i2=nl-1,ch2=this.buffer[i2];"\r"===ch2&&(ch2=this.buffer[--i2]);const lastChar=i2;for(;" "===ch2;)ch2=this.buffer[--i2];if(!("\n"===ch2&&i2>=this.pos&&i2+1+indent>lastChar))break;nl=i2}return yield"",yield*__yieldStar(this.pushToIndex(nl+1,!0)),yield*__yieldStar(this.parseLineStart())}*parsePlainScalar(){const inFlow=this.flowLevel>0;let ch,end=this.pos-1,i=this.pos-1;for(;ch=this.buffer[++i];)if(":"===ch){const next=this.buffer[i+1];if(isEmpty(next)||inFlow&&flowIndicatorChars.has(next))break;end=i}else if(isEmpty(ch)){let next=this.buffer[i+1];if("\r"===ch&&("\n"===next?(i+=1,ch="\n",next=this.buffer[i+1]):end=i),"#"===next||inFlow&&flowIndicatorChars.has(next))break;if("\n"===ch){const cs=this.continueScalar(i+1);if(-1===cs)break;i=Math.max(i,cs-2)}}else{if(inFlow&&flowIndicatorChars.has(ch))break;end=i}return ch||this.atEnd?(yield"",yield*__yieldStar(this.pushToIndex(end+1,!0)),inFlow?"flow":"doc"):this.setNext("plain-scalar")}*pushCount(n2){return n2>0?(yield this.buffer.substr(this.pos,n2),this.pos+=n2,n2):0}*pushToIndex(i,allowEmpty){const s2=this.buffer.slice(this.pos,i);return s2?(yield s2,this.pos+=s2.length,s2.length):(allowEmpty&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*__yieldStar(this.pushTag()))+(yield*__yieldStar(this.pushSpaces(!0)))+(yield*__yieldStar(this.pushIndicators()));case"&":return(yield*__yieldStar(this.pushUntil(isNotAnchorChar)))+(yield*__yieldStar(this.pushSpaces(!0)))+(yield*__yieldStar(this.pushIndicators()));case"-":case"?":case":":{const inFlow=this.flowLevel>0,ch1=this.charAt(1);if(isEmpty(ch1)||inFlow&&flowIndicatorChars.has(ch1))return inFlow?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*__yieldStar(this.pushCount(1)))+(yield*__yieldStar(this.pushSpaces(!0)))+(yield*__yieldStar(this.pushIndicators()))}}return 0}*pushTag(){if("<"===this.charAt(1)){let i=this.pos+2,ch=this.buffer[i];for(;!isEmpty(ch)&&">"!==ch;)ch=this.buffer[++i];return yield*__yieldStar(this.pushToIndex(">"===ch?i+1:i,!1))}{let i=this.pos+1,ch=this.buffer[i];for(;ch;)if(tagChars.has(ch))ch=this.buffer[++i];else{if("%"!==ch||!hexDigits.has(this.buffer[i+1])||!hexDigits.has(this.buffer[i+2]))break;ch=this.buffer[i+=3]}return yield*__yieldStar(this.pushToIndex(i,!1))}}*pushNewline(){const ch=this.buffer[this.pos];return"\n"===ch?yield*__yieldStar(this.pushCount(1)):"\r"===ch&&"\n"===this.charAt(1)?yield*__yieldStar(this.pushCount(2)):0}*pushSpaces(allowTabs){let ch,i=this.pos-1;do{ch=this.buffer[++i]}while(" "===ch||allowTabs&&"\t"===ch);const n2=i-this.pos;return n2>0&&(yield this.buffer.substr(this.pos,n2),this.pos=i),n2}*pushUntil(test){let i=this.pos,ch=this.buffer[i];for(;!test(ch);)ch=this.buffer[++i];return yield*__yieldStar(this.pushToIndex(i,!1))}}class LineCounter{constructor(){this.lineStarts=[],this.addNewLine=offset2=>this.lineStarts.push(offset2),this.linePos=offset2=>{let low=0,high=this.lineStarts.length;for(;low<high;){const mid=low+high>>1;this.lineStarts[mid]<offset2?low=mid+1:high=mid}if(this.lineStarts[low]===offset2)return{line:low+1,col:1};if(0===low)return{line:0,col:offset2};return{line:low,col:offset2-this.lineStarts[low-1]+1}}}}function includesToken(list,type){for(let i=0;i<list.length;++i)if(list[i].type===type)return!0;return!1}function findNonEmptyIndex(list){for(let i=0;i<list.length;++i)switch(list[i].type){case"space":case"comment":case"newline":break;default:return i}return-1}function isFlowToken(token){switch(null==token?void 0:token.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function getPrevProps(parent){var _a2;switch(parent.type){case"document":return parent.start;case"block-map":{const it=parent.items[parent.items.length-1];return null!=(_a2=it.sep)?_a2:it.start}case"block-seq":return parent.items[parent.items.length-1].start;default:return[]}}function getFirstKeyStartProps(prev){var _a2;if(0===prev.length)return[];let i=prev.length;loop:for(;--i>=0;)switch(prev[i].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break loop}for(;"space"===(null==(_a2=prev[++i])?void 0:_a2.type););return prev.splice(i,prev.length)}function fixFlowSeqItems(fc){if("flow-seq-start"===fc.start.type)for(const it of fc.items)!it.sep||it.value||includesToken(it.start,"explicit-key-ind")||includesToken(it.sep,"map-value-ind")||(it.key&&(it.value=it.key),delete it.key,isFlowToken(it.value)?it.value.end?Array.prototype.push.apply(it.value.end,it.sep):it.value.end=it.sep:Array.prototype.push.apply(it.start,it.sep),delete it.sep)}class Parser{constructor(onNewLine){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Lexer,this.onNewLine=onNewLine}*parse(source,incomplete=!1){this.onNewLine&&0===this.offset&&this.onNewLine(0);for(const lexeme of this.lexer.lex(source,incomplete))yield*__yieldStar(this.next(lexeme));incomplete||(yield*__yieldStar(this.end()))}*next(source){if(this.source=source,this.atScalar)return this.atScalar=!1,yield*__yieldStar(this.step()),void(this.offset+=source.length);const type=function(source){switch(source){case"\ufeff":return"byte-order-mark";case"":return"doc-mode";case"":return"flow-error-end";case"":return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case"\n":case"\r\n":return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(source[0]){case" ":case"\t":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}(source);if(type)if("scalar"===type)this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=type,yield*__yieldStar(this.step()),type){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+source.length);break;case"space":this.atNewLine&&" "===source[0]&&(this.indent+=source.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=source.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=source.length}else{const message=`Not a YAML token: ${source}`;yield*__yieldStar(this.pop({type:"error",offset:this.offset,message:message,source:source})),this.offset+=source.length}}*end(){for(;this.stack.length>0;)yield*__yieldStar(this.pop())}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const top=this.peek(1);if("doc-end"!==this.type||top&&"doc-end"===top.type){if(!top)return yield*__yieldStar(this.stream());switch(top.type){case"document":return yield*__yieldStar(this.document(top));case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*__yieldStar(this.scalar(top));case"block-scalar":return yield*__yieldStar(this.blockScalar(top));case"block-map":return yield*__yieldStar(this.blockMap(top));case"block-seq":return yield*__yieldStar(this.blockSequence(top));case"flow-collection":return yield*__yieldStar(this.flowCollection(top));case"doc-end":return yield*__yieldStar(this.documentEnd(top))}yield*__yieldStar(this.pop())}else{for(;this.stack.length>0;)yield*__yieldStar(this.pop());this.stack.push({type:"doc-end",offset:this.offset,source:this.source})}}peek(n2){return this.stack[this.stack.length-n2]}*pop(error){const token=null!=error?error:this.stack.pop();if(token)if(0===this.stack.length)yield token;else{const top=this.peek(1);switch("block-scalar"===token.type?token.indent="indent"in top?top.indent:0:"flow-collection"===token.type&&"document"===top.type&&(token.indent=0),"flow-collection"===token.type&&fixFlowSeqItems(token),top.type){case"document":top.value=token;break;case"block-scalar":top.props.push(token);break;case"block-map":{const it=top.items[top.items.length-1];if(it.value)return top.items.push({start:[],key:token,sep:[]}),void(this.onKeyLine=!0);if(!it.sep)return Object.assign(it,{key:token,sep:[]}),void(this.onKeyLine=!it.explicitKey);it.value=token;break}case"block-seq":{const it=top.items[top.items.length-1];it.value?top.items.push({start:[],value:token}):it.value=token;break}case"flow-collection":{const it=top.items[top.items.length-1];return void(!it||it.value?top.items.push({start:[],key:token,sep:[]}):it.sep?it.value=token:Object.assign(it,{key:token,sep:[]}))}default:yield*__yieldStar(this.pop()),yield*__yieldStar(this.pop(token))}if(!("document"!==top.type&&"block-map"!==top.type&&"block-seq"!==top.type||"block-map"!==token.type&&"block-seq"!==token.type)){const last=token.items[token.items.length-1];last&&!last.sep&&!last.value&&last.start.length>0&&-1===findNonEmptyIndex(last.start)&&(0===token.indent||last.start.every(st=>"comment"!==st.type||st.indent<token.indent))&&("document"===top.type?top.end=last.start:top.items.push({start:last.start}),token.items.splice(-1,1))}}else{const message="Tried to pop an empty stack";yield{type:"error",offset:this.offset,source:"",message:message}}}*stream(){switch(this.type){case"directive-line":return void(yield{type:"directive",offset:this.offset,source:this.source});case"byte-order-mark":case"space":case"comment":case"newline":return void(yield this.sourceToken);case"doc-mode":case"doc-start":{const doc2={type:"document",offset:this.offset,start:[]};return"doc-start"===this.type&&doc2.start.push(this.sourceToken),void this.stack.push(doc2)}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(doc2){if(doc2.value)return yield*__yieldStar(this.lineEnd(doc2));switch(this.type){case"doc-start":return void(-1!==findNonEmptyIndex(doc2.start)?(yield*__yieldStar(this.pop()),yield*__yieldStar(this.step())):doc2.start.push(this.sourceToken));case"anchor":case"tag":case"space":case"comment":case"newline":return void doc2.start.push(this.sourceToken)}const bv=this.startBlockValue(doc2);bv?this.stack.push(bv):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(scalar){if("map-value-ind"===this.type){const start=getFirstKeyStartProps(getPrevProps(this.peek(2)));let sep;scalar.end?(sep=scalar.end,sep.push(this.sourceToken),delete scalar.end):sep=[this.sourceToken];const map2={type:"block-map",offset:scalar.offset,indent:scalar.indent,items:[{start:start,key:scalar,sep:sep}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=map2}else yield*__yieldStar(this.lineEnd(scalar))}*blockScalar(scalar){switch(this.type){case"space":case"comment":case"newline":return void scalar.props.push(this.sourceToken);case"scalar":if(scalar.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let nl=this.source.indexOf("\n")+1;for(;0!==nl;)this.onNewLine(this.offset+nl),nl=this.source.indexOf("\n",nl)+1}yield*__yieldStar(this.pop());break;default:yield*__yieldStar(this.pop()),yield*__yieldStar(this.step())}}*blockMap(map2){var _a2;const it=map2.items[map2.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,it.value){const end="end"in it.value?it.value.end:void 0,last=Array.isArray(end)?end[end.length-1]:void 0;"comment"===(null==last?void 0:last.type)?null==end||end.push(this.sourceToken):map2.items.push({start:[this.sourceToken]})}else it.sep?it.sep.push(this.sourceToken):it.start.push(this.sourceToken);return;case"space":case"comment":if(it.value)map2.items.push({start:[this.sourceToken]});else if(it.sep)it.sep.push(this.sourceToken);else{if(this.atIndentedComment(it.start,map2.indent)){const prev=map2.items[map2.items.length-2],end=null==(_a2=null==prev?void 0:prev.value)?void 0:_a2.end;if(Array.isArray(end))return Array.prototype.push.apply(end,it.start),end.push(this.sourceToken),void map2.items.pop()}it.start.push(this.sourceToken)}return}if(this.indent>=map2.indent){const atMapIndent=!this.onKeyLine&&this.indent===map2.indent,atNextItem=atMapIndent&&(it.sep||it.explicitKey)&&"seq-item-ind"!==this.type;let start=[];if(atNextItem&&it.sep&&!it.value){const nl=[];for(let i=0;i<it.sep.length;++i){const st=it.sep[i];switch(st.type){case"newline":nl.push(i);break;case"space":break;case"comment":st.indent>map2.indent&&(nl.length=0);break;default:nl.length=0}}nl.length>=2&&(start=it.sep.splice(nl[1]))}switch(this.type){case"anchor":case"tag":return void(atNextItem||it.value?(start.push(this.sourceToken),map2.items.push({start:start}),this.onKeyLine=!0):it.sep?it.sep.push(this.sourceToken):it.start.push(this.sourceToken));case"explicit-key-ind":return it.sep||it.explicitKey?atNextItem||it.value?(start.push(this.sourceToken),map2.items.push({start:start,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}):(it.start.push(this.sourceToken),it.explicitKey=!0),void(this.onKeyLine=!0);case"map-value-ind":if(it.explicitKey)if(it.sep)if(it.value)map2.items.push({start:[],key:null,sep:[this.sourceToken]});else if(includesToken(it.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:start,key:null,sep:[this.sourceToken]}]});else if(isFlowToken(it.key)&&!includesToken(it.sep,"newline")){const start2=getFirstKeyStartProps(it.start),key=it.key,sep=it.sep;sep.push(this.sourceToken),delete it.key,delete it.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:start2,key:key,sep:sep}]})}else start.length>0?it.sep=it.sep.concat(start,this.sourceToken):it.sep.push(this.sourceToken);else if(includesToken(it.start,"newline"))Object.assign(it,{key:null,sep:[this.sourceToken]});else{const start2=getFirstKeyStartProps(it.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:start2,key:null,sep:[this.sourceToken]}]})}else it.sep?it.value||atNextItem?map2.items.push({start:start,key:null,sep:[this.sourceToken]}):includesToken(it.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):it.sep.push(this.sourceToken):Object.assign(it,{key:null,sep:[this.sourceToken]});return void(this.onKeyLine=!0);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const fs=this.flowScalar(this.type);return void(atNextItem||it.value?(map2.items.push({start:start,key:fs,sep:[]}),this.onKeyLine=!0):it.sep?this.stack.push(fs):(Object.assign(it,{key:fs,sep:[]}),this.onKeyLine=!0))}default:{const bv=this.startBlockValue(map2);if(bv){if("block-seq"===bv.type){if(!it.explicitKey&&it.sep&&!includesToken(it.sep,"newline"))return void(yield*__yieldStar(this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source})))}else atMapIndent&&map2.items.push({start:start});return void this.stack.push(bv)}}}}yield*__yieldStar(this.pop()),yield*__yieldStar(this.step())}*blockSequence(seq2){var _a2;const it=seq2.items[seq2.items.length-1];switch(this.type){case"newline":if(it.value){const end="end"in it.value?it.value.end:void 0,last=Array.isArray(end)?end[end.length-1]:void 0;"comment"===(null==last?void 0:last.type)?null==end||end.push(this.sourceToken):seq2.items.push({start:[this.sourceToken]})}else it.start.push(this.sourceToken);return;case"space":case"comment":if(it.value)seq2.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(it.start,seq2.indent)){const prev=seq2.items[seq2.items.length-2],end=null==(_a2=null==prev?void 0:prev.value)?void 0:_a2.end;if(Array.isArray(end))return Array.prototype.push.apply(end,it.start),end.push(this.sourceToken),void seq2.items.pop()}it.start.push(this.sourceToken)}return;case"anchor":case"tag":if(it.value||this.indent<=seq2.indent)break;return void it.start.push(this.sourceToken);case"seq-item-ind":if(this.indent!==seq2.indent)break;return void(it.value||includesToken(it.start,"seq-item-ind")?seq2.items.push({start:[this.sourceToken]}):it.start.push(this.sourceToken))}if(this.indent>seq2.indent){const bv=this.startBlockValue(seq2);if(bv)return void this.stack.push(bv)}yield*__yieldStar(this.pop()),yield*__yieldStar(this.step())}*flowCollection(fc){const it=fc.items[fc.items.length-1];if("flow-error-end"===this.type){let top;do{yield*__yieldStar(this.pop()),top=this.peek(1)}while(top&&"flow-collection"===top.type)}else if(0===fc.end.length){switch(this.type){case"comma":case"explicit-key-ind":return void(!it||it.sep?fc.items.push({start:[this.sourceToken]}):it.start.push(this.sourceToken));case"map-value-ind":return void(!it||it.value?fc.items.push({start:[],key:null,sep:[this.sourceToken]}):it.sep?it.sep.push(this.sourceToken):Object.assign(it,{key:null,sep:[this.sourceToken]}));case"space":case"comment":case"newline":case"anchor":case"tag":return void(!it||it.value?fc.items.push({start:[this.sourceToken]}):it.sep?it.sep.push(this.sourceToken):it.start.push(this.sourceToken));case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const fs=this.flowScalar(this.type);return void(!it||it.value?fc.items.push({start:[],key:fs,sep:[]}):it.sep?this.stack.push(fs):Object.assign(it,{key:fs,sep:[]}))}case"flow-map-end":case"flow-seq-end":return void fc.end.push(this.sourceToken)}const bv=this.startBlockValue(fc);bv?this.stack.push(bv):(yield*__yieldStar(this.pop()),yield*__yieldStar(this.step()))}else{const parent=this.peek(2);if("block-map"===parent.type&&("map-value-ind"===this.type&&parent.indent===fc.indent||"newline"===this.type&&!parent.items[parent.items.length-1].sep))yield*__yieldStar(this.pop()),yield*__yieldStar(this.step());else if("map-value-ind"===this.type&&"flow-collection"!==parent.type){const start=getFirstKeyStartProps(getPrevProps(parent));fixFlowSeqItems(fc);const sep=fc.end.splice(1,fc.end.length);sep.push(this.sourceToken);const map2={type:"block-map",offset:fc.offset,indent:fc.indent,items:[{start:start,key:fc,sep:sep}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=map2}else yield*__yieldStar(this.lineEnd(fc))}}flowScalar(type){if(this.onNewLine){let nl=this.source.indexOf("\n")+1;for(;0!==nl;)this.onNewLine(this.offset+nl),nl=this.source.indexOf("\n",nl)+1}return{type:type,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(parent){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const start=getFirstKeyStartProps(getPrevProps(parent));return start.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:start,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const start=getFirstKeyStartProps(getPrevProps(parent));return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:start,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(start,indent){return"comment"===this.type&&(!(this.indent<=indent)&&start.every(st=>"newline"===st.type||"space"===st.type))}*documentEnd(docEnd){"doc-mode"!==this.type&&(docEnd.end?docEnd.end.push(this.sourceToken):docEnd.end=[this.sourceToken],"newline"===this.type&&(yield*__yieldStar(this.pop())))}*lineEnd(token){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*__yieldStar(this.pop()),yield*__yieldStar(this.step());break;case"newline":this.onKeyLine=!1;default:token.end?token.end.push(this.sourceToken):token.end=[this.sourceToken],"newline"===this.type&&(yield*__yieldStar(this.pop()))}}}function parseDocument(source,options={}){const{lineCounter:lineCounter,prettyErrors:prettyErrors}=function(options){const prettyErrors=!1!==options.prettyErrors;return{lineCounter:options.lineCounter||prettyErrors&&new LineCounter||null,prettyErrors:prettyErrors}}(options),parser=new Parser(null==lineCounter?void 0:lineCounter.addNewLine),composer=new Composer(options);let doc2=null;for(const _doc of composer.compose(parser.parse(source),!0,source.length))if(doc2){if("silent"!==doc2.options.logLevel){doc2.errors.push(new YAMLParseError(_doc.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}}else doc2=_doc;return prettyErrors&&lineCounter&&(doc2.errors.forEach(prettifyError(source,lineCounter)),doc2.warnings.forEach(prettifyError(source,lineCounter))),doc2}function parse$2(src,reviver,options){let _reviver;"function"==typeof reviver?_reviver=reviver:void 0===options&&reviver&&"object"==typeof reviver&&(options=reviver);const doc2=parseDocument(src,options);if(!doc2)return null;if(doc2.warnings.forEach(warning=>warn(doc2.options.logLevel,warning)),doc2.errors.length>0){if("silent"!==doc2.options.logLevel)throw doc2.errors[0];doc2.errors=[]}return doc2.toJS(Object.assign({reviver:_reviver},options))}const stringEmailListToArray=s2=>s2.trim().split(/ |,/).filter(email=>!!email&&email.includes("@")||"*"===email||"\\*"===email),headerKeyRegex=/^([^:]+)(:)(?:\s|$)/,propertyKeyRegex=/^(?!-)\s*([\w\-\.]+)(:)(?:\s|$)/,headerValueRegex=/(:)\s+(.+)$/,eventsStarted=line=>!!(line.match(EDTF_START_REGEX)||line.match(EVENT_START_REGEX)||line.match(BCE_START_REGEX)||line.match(GROUP_START_REGEX)),threeDashRegex=/^---/;function parseProperties(lines,lengthAtIndex,i,context){let propertiesStartLineIndex=i,propertiesEndLineIndex=propertiesStartLineIndex,firstPropertiesLineIndexWithText=-1,lastPropertiesLineIndexWithText=-1;const propertyRanges=[],propertyLines=[];let hasThreeDashStart=!1;const threeDashRanges=[];let line=lines[propertiesStartLineIndex];for(;void 0!==line&&(hasThreeDashStart||!eventsStarted(line));){const isThreeDash=line.match(threeDashRegex);if(isThreeDash){const range2={type:RangeType.FrontmatterDelimiter,from:lengthAtIndex[propertiesEndLineIndex],to:lengthAtIndex[propertiesEndLineIndex]+4};if(threeDashRanges.push(range2),hasThreeDashStart){2===threeDashRanges.length&&(context.ranges.push(threeDashRanges[0]),context.ranges.push(threeDashRanges[1]));break}propertiesStartLineIndex=propertiesEndLineIndex,hasThreeDashStart=!0}const isComment=checkComments(line,propertiesEndLineIndex,lengthAtIndex,context);if(isComment||(line=propertyHexReplacer(line)),isComment||isThreeDash){if(!hasThreeDashStart)break}else{const keyMatch=line.match(propertyKeyRegex);if(keyMatch){const from=lengthAtIndex[propertiesEndLineIndex],leadingWhitespaceLength=keyMatch.index+keyMatch[0].indexOf(keyMatch[1]);propertyRanges.push({type:RangeType.PropertyKey,from:from+leadingWhitespaceLength,to:from+leadingWhitespaceLength+keyMatch[1].length}),propertyRanges.push({type:RangeType.PropertyKeyColon,from:from+leadingWhitespaceLength+keyMatch[1].length,to:from+leadingWhitespaceLength+keyMatch[1].length+1}),propertyRanges.push({type:RangeType.PropertyValue,from:from+leadingWhitespaceLength+keyMatch[1].length+1,to:from+line.length}),propertyLines.push(line),-1===firstPropertiesLineIndexWithText&&(firstPropertiesLineIndexWithText=propertiesEndLineIndex),lastPropertiesLineIndexWithText=propertiesEndLineIndex}else if(!hasThreeDashStart)break}line=lines[++propertiesEndLineIndex]}let properties={},propOrder=[];if(propertyLines.length)try{const map2=parse$2(propertyLines.join("\n"),{mapAsMap:!0});propOrder=(()=>{const o=[];for(const k of map2.keys())o.push(k);return o})(),properties=deepMapToObject(map2),context.ranges.push(...propertyRanges)}catch(e){e instanceof YAMLParseError&&context.parseMessages.push({type:"error",pos:e.pos.map(index2=>lengthAtIndex[i]+index2),message:e.message}),console.error(e)}if(2===threeDashRanges.length){const index2=lengthAtIndex[propertiesStartLineIndex];context.foldables[index2]={startLine:propertiesStartLineIndex,startIndex:index2,endIndex:lengthAtIndex[propertiesEndLineIndex]-1,type:"header",foldStartIndex:2===threeDashRanges.length?index2+3:index2}}else if(firstPropertiesLineIndexWithText>=0&&lastPropertiesLineIndexWithText>=0&&lastPropertiesLineIndexWithText!==firstPropertiesLineIndexWithText){const index2=lengthAtIndex[firstPropertiesLineIndexWithText],foldable={startLine:firstPropertiesLineIndexWithText,startIndex:index2,endIndex:lengthAtIndex[lastPropertiesLineIndexWithText+1]-1,type:"header",foldStartIndex:index2};context.foldables[index2]=foldable}return{properties:properties,propOrder:propOrder,i:propertiesEndLineIndex}}function deepMapToObject(map2){const obj={};for(const[key,value]of map2.entries())value instanceof Map?obj[key]=deepMapToObject(value):"object"!=typeof value||null===value||Array.isArray(value)?obj[key]=value:obj[key]=deepMapToObject(new Map(Object.entries(value)));return obj}function checkEvent(line,lines,i,lengthAtIndex,context){let dateRange=function(line,i,lengthAtIndex,context){var _a2,_b2,_c2;const eventStartLineRegexMatch=line.match(EDTF_START_REGEX);if(!eventStartLineRegexMatch)return;const datePart=eventStartLineRegexMatch[edtfDatePartMatchIndex],edtfFrom=eventStartLineRegexMatch[from_edtfDateIndex],edtfFromHasMonth=!!eventStartLineRegexMatch[from_edtfDateMonthPart],edtfFromHasDay=!!eventStartLineRegexMatch[from_edtfDateDayPart],edtfFromHasTime=!!eventStartLineRegexMatch[from_edtfDateTimePartMatchIndex],eventEndDate=eventStartLineRegexMatch[to_edtfIndex],edtfTo=eventStartLineRegexMatch[to_edtfDateIndex],edtfToHasMonth=!!eventStartLineRegexMatch[to_edtfDateMonthPart],edtfToHasDay=!!eventStartLineRegexMatch[to_edtfDateDayPart],edtfToHasTime=!!eventStartLineRegexMatch[to_edtfDateTimePartMatchIndex],relativeFromBeforeOrAfter=eventStartLineRegexMatch[from_edtfBeforeOrAfterMatchIndex];eventStartLineRegexMatch[to_edtfBeforeOrAfterMatchIndex];const relativeFromDate=eventStartLineRegexMatch[from_edtfRelativeMatchIndex],fromBeforeOrAfter=["before","by"].includes(relativeFromBeforeOrAfter||"")?"before":"after",relativeToDate=eventStartLineRegexMatch[to_edtfRelativeMatchIndex],nowFrom=eventStartLineRegexMatch[from_edtfNowMatchIndex],nowTo=eventStartLineRegexMatch[to_edtfNowMatchIndex],indexOfDateRange=line.indexOf(datePart),dateRangeInText={type:RangeType.DateRange,from:lengthAtIndex[i]+indexOfDateRange,to:lengthAtIndex[i]+indexOfDateRange+datePart.length};context.ranges.push(dateRangeInText);const colonIndex=line.indexOf(":",indexOfDateRange+datePart.length),colonRange=rangeType=>({type:rangeType,from:lengthAtIndex[i]+colonIndex,to:lengthAtIndex[i]+colonIndex+1}),cached=null==(_a2=context.cache)?void 0:_a2.zone(context.timezone).ranges.get(datePart);if(cached){const recurrence2=checkEdtfRecurrence(0,i,lengthAtIndex,eventStartLineRegexMatch,context);return recurrence2&&context.ranges.push(recurrence2.range),context.ranges.push(colonRange(RangeType.DateRangeColon)),new DateRangePart({from:DateTime$1.fromISO(cached.fromDateTimeIso,{setZone:!0}),to:DateTime$1.fromISO(cached.toDateTimeIso,{setZone:!0}),originalString:datePart,dateRangeInText:dateRangeInText,eventText:eventStartLineRegexMatch[edtfEventTextMatchIndex],recurrence:recurrence2,isRelative:!1,definition:__spreadProps(__spreadValues({},dateRangeInText),{type:RangeType.EventDefinition,to:lengthAtIndex[i]+colonIndex+1})})}let fromDateTime,endDateTime,granularity="instant",canCacheRange=!0,isRelative=!1;if(edtfFrom)if(edtfFromHasTime){const time=getTimeFromRegExpMatch(eventStartLineRegexMatch,from_edtfDateTimeMeridiemHourMatchIndex,from_edtfDateTimeMeridiemMinuteMatchIndex,from_edtfDateTimeMeridiemMeridiemMatchIndex,from_edtfDateTime24HourHourMatchIndex,from_edtfDateTime24HourMinuteMatchIndex),timeDateTime=DateTime$1.fromISO(time.dateTimeIso);fromDateTime=DateTime$1.fromISO(edtfFrom.substring(0,10),{zone:context.timezone}).set({hour:timeDateTime.hour,minute:timeDateTime.minute}),granularity=time.granularity}else fromDateTime=DateTime$1.fromISO(edtfFrom,{zone:context.timezone}),granularity=edtfFromHasDay?"day":edtfFromHasMonth?"month":"year";else if(relativeFromDate){canCacheRange=!1,isRelative=!0;const relativeToEventId=null==(_b2=eventStartLineRegexMatch[from_edtfRelativeEventIdMatchIndex])?void 0:_b2.substring(1);let relativeTo;if(relativeToEventId){const event=context.getById(relativeToEventId);if(event&&isEvent(event)){const range2=toDateRange(event.dateRangeIso);relativeTo="after"===fromBeforeOrAfter?range2.toDateTime:range2.fromDateTime}else context.parseMessages.push({type:"error",message:`Event ${relativeToEventId} not found`,pos:[lengthAtIndex[i]+line.indexOf(relativeToEventId),lengthAtIndex[i]+line.indexOf(relativeToEventId)+relativeToEventId.length]})}if(!relativeTo){const priorEvent=context.priorEvent();relativeTo=priorEvent?"after"===fromBeforeOrAfter?toDateRange(priorEvent.dateRangeIso).toDateTime:toDateRange(priorEvent.dateRangeIso).fromDateTime:context.zonedNow}relativeToDate||eventEndDate?"before"===fromBeforeOrAfter?relativeToDate&&(endDateTime=RelativeDate.from(relativeFromDate,relativeTo,!0),fromDateTime=RelativeDate.from(relativeToDate,endDateTime,!0)):fromDateTime=RelativeDate.from(relativeFromDate,relativeTo):"before"===fromBeforeOrAfter?(endDateTime=relativeTo,fromDateTime=RelativeDate.from(relativeFromDate,relativeTo,!0)):(fromDateTime=relativeTo,endDateTime=RelativeDate.from(relativeFromDate,relativeTo)),granularity="instant"}else nowFrom?(fromDateTime=context.zonedNow,granularity="instant"):(fromDateTime=DateTime$1.fromISO(edtfFrom,{zone:context.timezone}),granularity="instant");if(fromDateTime&&(null==fromDateTime?void 0:fromDateTime.isValid)||(fromDateTime=context.zonedNow,granularity="instant"),!endDateTime)if(relativeToDate){const relativeToEventId=eventStartLineRegexMatch[to_edtfRelativeEventIdMatchIndex];let relativeTo;if(relativeToEventId){const event=context.getById(relativeToEventId);if(event&&isEvent(event))relativeTo=toDateRange(event.dateRangeIso).toDateTime,canCacheRange=!1,isRelative=!0;else{const index2=line.indexOf(relativeToEventId);context.parseMessages.push({type:"error",message:`Event ${relativeToEventId} not found`,pos:[lengthAtIndex[i]+index2,lengthAtIndex[i]+index2+relativeToEventId.length]})}}relativeTo||(relativeTo=fromDateTime),endDateTime=RelativeDate.from(relativeToDate,relativeTo)}else if(nowTo)endDateTime=context.zonedNow,granularity="instant";else if(edtfTo)if(edtfToHasTime){const time=getTimeFromRegExpMatch(eventStartLineRegexMatch,to_edtfDateTimeMeridiemHourMatchIndex,to_edtfDateTimeMeridiemMinuteMatchIndex,to_edtfDateTimeMeridiemMeridiemMatchIndex,to_edtfDateTime24HourHourMatchIndex,to_edtfDateTime24HourMinuteMatchIndex),timeDateTime=DateTime$1.fromISO(time.dateTimeIso);endDateTime=DateTime$1.fromISO(edtfFrom.substring(0,10),{zone:context.timezone}).set({hour:timeDateTime.hour,minute:timeDateTime.minute})}else endDateTime=DateTime$1.fromISO(roundDateUp({dateTimeIso:edtfTo,granularity:edtfToHasDay?"day":edtfToHasMonth?"month":"year"},context),{setZone:!0,zone:context.timezone});endDateTime&&endDateTime.isValid||(endDateTime=DateTime$1.fromISO(roundDateUp({dateTimeIso:fromDateTime.toISO(),granularity:granularity},context),{setZone:!0,zone:context.timezone}));const recurrence=checkEdtfRecurrence(0,i,lengthAtIndex,eventStartLineRegexMatch,context),colon=colonRange(RangeType.DateRangeColon);recurrence&&context.ranges.push(recurrence.range),context.ranges.push(colon);const dateRange=new DateRangePart({from:fromDateTime,to:endDateTime,originalString:datePart,dateRangeInText:dateRangeInText,eventText:eventStartLineRegexMatch[edtfEventTextMatchIndex],recurrence:recurrence,isRelative:isRelative,definition:__spreadProps(__spreadValues({},dateRangeInText),{type:RangeType.EventDefinition,to:colon.to})});return canCacheRange&&(null==(_c2=context.cache)||_c2.zone(context.timezone).ranges.set(datePart,{fromDateTimeIso:fromDateTime.toISO(),toDateTimeIso:endDateTime.toISO()})),dateRange}(line,i,lengthAtIndex,context);if(dateRange||(dateRange=getDateRangeFromCasualRegexMatch(line,i,lengthAtIndex,context)),dateRange||(dateRange=function(line,i,lengthAtIndex,context){var _a2,_b2;const eventStartLineRegexMatch=line.match(BCE_START_REGEX);if(!eventStartLineRegexMatch)return;const datePart=eventStartLineRegexMatch[BCEDatePartMatchIndex],BCEFromYear=eventStartLineRegexMatch[fromYear_BCEDateIndex],BCEFromYearNotation=eventStartLineRegexMatch[fromYearNotation_BCEDateIndex]||eventStartLineRegexMatch[toYearNotation_BCEDateIndex],BCEToYear=eventStartLineRegexMatch[toYear_BCEDateIndex],BCEToYearNotation=eventStartLineRegexMatch[toYearNotation_BCEDateIndex],indexOfDateRange=line.indexOf(datePart),dateRangeInText={type:RangeType.DateRange,from:lengthAtIndex[i]+indexOfDateRange,to:lengthAtIndex[i]+indexOfDateRange+datePart.length};context.ranges.push(dateRangeInText);const colonIndex=line.indexOf(":",indexOfDateRange+datePart.length),colonRange=rangeType=>({type:rangeType,from:lengthAtIndex[i]+colonIndex,to:lengthAtIndex[i]+colonIndex+1}),cached=null==(_a2=context.cache)?void 0:_a2.zone(context.timezone).ranges.get(datePart);if(cached){const colon2=colonRange(RangeType.DateRangeColon);return context.ranges.push(colon2),new DateRangePart({from:DateTime$1.fromISO(cached.fromDateTimeIso,{setZone:!0}),to:DateTime$1.fromISO(cached.toDateTimeIso,{setZone:!0}),originalString:datePart,dateRangeInText:dateRangeInText,eventText:eventStartLineRegexMatch[BCEEventTextMatchIndex],definition:__spreadProps(__spreadValues({},dateRangeInText),{type:RangeType.EventDefinition,to:colon2.to}),isRelative:!1})}let fromDateTime,endDateTime,granularity="year";if(!BCEFromYear)return;fromDateTime=getYearNotationToDatetime(BCEFromYear,BCEFromYearNotation,context),fromDateTime&&(null==fromDateTime?void 0:fromDateTime.isValid)||(fromDateTime=context.zonedNow,granularity="instant"),endDateTime||BCEToYear&&(endDateTime=getYearNotationToDatetime(BCEToYear,BCEToYearNotation,context)),endDateTime&&endDateTime.isValid||(endDateTime=DateTime$1.fromISO(roundDateUp({dateTimeIso:fromDateTime.toISO(),granularity:granularity},context),{setZone:!0,zone:context.timezone}));const colon=colonRange(RangeType.DateRangeColon);context.ranges.push(colon);const dateRange=new DateRangePart({from:fromDateTime,to:endDateTime,originalString:datePart,dateRangeInText:dateRangeInText,eventText:eventStartLineRegexMatch[BCEEventTextMatchIndex],definition:__spreadProps(__spreadValues({},dateRangeInText),{type:RangeType.EventDefinition,to:colon.to}),isRelative:!1});return null==(_b2=context.cache)||_b2.zone(context.timezone).ranges.set(datePart,{fromDateTimeIso:fromDateTime.toISO(),toDateTimeIso:endDateTime.toISO()}),dateRange}(line,i,lengthAtIndex,context)),!dateRange)return i;const{properties:properties,i:from,propOrder:propOrder}=parseProperties(lines,lengthAtIndex,i+1,context),matchedListItems=[];let nextLine,end=from-1;for(;nextLine=lines[++end],!("string"!=typeof nextLine||nextLine.match(EDTF_START_REGEX)||nextLine.match(EVENT_START_REGEX)||nextLine.match(BCE_START_REGEX)||nextLine.match(GROUP_START_REGEX)||context.currentPath.length>1&&nextLine.match(GROUP_END_REGEX));){checkComments(nextLine,end,lengthAtIndex,context),checkTags(nextLine,end,lengthAtIndex,context);const listItems=checkListItems(nextLine,end,lengthAtIndex,context);listItems&&matchedListItems.push(...listItems)}const eventGroup=lines.slice(from-1,end),completed=function(dateRange,line,context){const completionMatch=dateRange.eventText.match(COMPLETION_REGEX),indexOfEventText=line.indexOf(dateRange.eventText);let completed;if(completionMatch){const from=indexOfEventText+dateRange.eventText.indexOf(completionMatch[0]),to=from+dateRange.eventText.indexOf(completionMatch[1])+completionMatch[1].length;completed=["X","x"].some(x=>completionMatch.includes(x));const indicator={type:RangeType.CheckboxItemIndicator,from:dateRange.dateRangeInText.from+from,to:dateRange.dateRangeInText.from+to,content:completed};context.ranges.push(indicator)}return completed}(dateRange,line,context);eventGroup[0]=dateRange.eventText.trim();const eventDescription=new EventDescription(eventGroup,matchedListItems,completed),tz=properties.timezone||properties.tz;if(tz)if("string"==typeof tz||"number"==typeof tz){const zone=parseZone(tz,context.cache);zone?(dateRange.fromDateTime=dateRange.fromDateTime.setZone(zone,{keepLocalTime:!0}),dateRange.toDateTime=dateRange.toDateTime.setZone(zone,{keepLocalTime:!0})):context.parseMessages.push({type:"error",message:`Unable to parse timezone "${tz}"`,pos:[dateRange.dateRangeInText.from,dateRange.dateRangeInText.to]})}else if("object"==typeof tz){const from2=tz.from,to=tz.to;if(from2||to||context.parseMessages.push({type:"error",message:"Unable to parse distinct from and to timezones. Specify 'timezone.from' and/or 'timezone.to' to set zones for the start or end of ranges, respectively.",pos:[dateRange.dateRangeInText.from,dateRange.dateRangeInText.to]}),from2){const zone=parseZone(from2,context.cache);zone?dateRange.fromDateTime=dateRange.fromDateTime.setZone(zone,{keepLocalTime:!0}):context.parseMessages.push({type:"error",message:`Unable to parse 'from' timezone "${from2}"`,pos:[dateRange.dateRangeInText.from,dateRange.dateRangeInText.to]})}if(to){const zone=parseZone(to,context.cache);zone?dateRange.toDateTime=dateRange.toDateTime.setZone(zone,{keepLocalTime:!0}):context.parseMessages.push({type:"error",message:`Unable to parse 'to' timezone "${to}"`,pos:[dateRange.dateRangeInText.from,dateRange.dateRangeInText.to]})}}else context.parseMessages.push({type:"error",message:`Unable to parse timezone "${tz[1]}"`,pos:[dateRange.dateRangeInText.from,dateRange.dateRangeInText.to]});const eventRange2={from:lengthAtIndex[i],to:lengthAtIndex[end],type:RangeType.Event},event=new Event$1(line,properties,propOrder,dateRange,eventRange2,dateRange.dateRangeInText,eventDescription,dateRange.originalString);if(event){!function(event,path,dateRange,context){event.id&&!context.ids[event.id]&&(context.ids[event.id]=[...path]),(!context.earliest||dateRange.fromDateTime<context.earliest)&&(context.earliest=dateRange.fromDateTime),(!context.latest||dateRange.toDateTime>context.latest)&&(context.latest=dateRange.toDateTime);const eventDuration=+dateRange.toDateTime-+dateRange.fromDateTime;(void 0===context.maxDuration||eventDuration>context.maxDuration)&&(context.maxDuration=eventDuration)}(event,context.push(event),dateRange,context),end-i>1&&eventRange2.to-lengthAtIndex[i+1]>0&&(context.foldables[lengthAtIndex[i]]={startIndex:lengthAtIndex[i+1]-1,endIndex:eventRange2.to-1,type:"event",foldStartIndex:lengthAtIndex[i+1]-1,startLine:i})}return end-1}class ParsingContext{constructor(now2,cache2,getPriorEvent){if(this.parseMessages=[],this.documentMessages=[],this.events=new EventGroup,this.ids={},this.paletteIndex=0,this.earliest=void 0,this.latest=void 0,this.maxDuration=void 0,this.currentPath=[],this.foldables={},this.foldableSections=[],this.ranges=[],this.header={dateFormat:"M/d/y"},this.cache=cache2,"string"==typeof now2){const parsed=DateTime$1.fromISO(now2);parsed.isValid?this.now=parsed:this.now=DateTime$1.now()}else this.now=now2||DateTime$1.now();getPriorEvent&&(this.priorEvent=()=>getPriorEvent(this))}get zonedNow(){return this.now.setZone(this.timezone)}get timezone(){return this.parentZone()}currentFoldableSection(){return this.foldableSections[this.foldableSections.length-1]}currentFoldableComment(){return this.foldables.comment}startFoldableSection(f){this.foldableSections.push(f)}startFoldable(f){this.foldables[f.type]=f}finishFoldableSection(line,endIndex){const currentFoldableSection=this.foldableSections.pop();currentFoldableSection&&currentFoldableSection.startLine<line-1&&(this.foldables[currentFoldableSection.startIndex]=__spreadProps(__spreadValues({},currentFoldableSection),{endIndex:endIndex}))}finishFoldableComment(lineNumber){const commentFoldable=this.currentFoldableComment();commentFoldable&&(commentFoldable.startLine<lineNumber-1&&(this.foldables[commentFoldable.startIndex]=__spreadValues({},commentFoldable)),delete this.foldables.comment)}push(node){const{path:path,tail:newTail}=push(node,this.events,this.currentPath.slice(0,-1),this.tail);return newTail&&(this.head||(this.head=newTail),this.tail=newTail),this.currentPath=path,path}endCurrentGroup(to,lineTo){this.currentPath.pop();const group=get(this.events,this.currentPath);group.textRanges.whole=__spreadProps(__spreadValues({},group.textRanges.whole),{to:to}),this.finishFoldableSection(lineTo.line,to)}toTimeline(){return this.maxDuration&&this.maxDuration,{events:this.events,ids:this.ids,ranges:this.ranges.sort(({from:fromA},{from:fromB})=>fromA-fromB),foldables:this.foldables,header:this.header,parseMessages:this.parseMessages.sort(({pos:posA,message:messageA},{pos:posB,message:messageB})=>posA[0]-posB[0]),documentMessages:this.documentMessages}}priorEvent(){return this.tail}parentZone(){var _a2,_b2,_c2;const p2=[...this.currentPath];for(p2.pop();p2.length;){const parent=get(this.events,p2),zone=timezoneFromProperties(null!=(_a2=null==parent?void 0:parent.properties)?_a2:[],this.cache);if(zone)return zone;p2.pop()}return null!=(_c2=parseZone(null!=(_b2=this.header.timezone)?_b2:this.header.tz,this.cache))?_c2:SystemZone.instance}priorEventToDateTime(){const prior=this.priorEvent();if(prior)return toDateRange(prior.dateRangeIso).toDateTime}priorEventFromDateTime(){const prior=this.priorEvent();if(prior)return toDateRange(prior.dateRangeIso).fromDateTime}getById(id){const path=this.ids[id];if(path)return get(this.events,path)}}function timezoneFromProperties(properties,cache2){var _a2;if(Array.isArray(properties)){const timezoneProperty=properties.find(([k,v])=>!("tz"!==k&&"timezone"!==k||"string"!=typeof v&&"number"!=typeof v));if(timezoneProperty)return parseZone(timezoneProperty[1],cache2)}else{const tz=null!=(_a2=null==properties?void 0:properties.timezone)?_a2:null==properties?void 0:properties.tz;if(tz)return parseZone(tz,cache2)}}function checkGroupEnd(line,i,lengthAtIndex,context){return!!(context.currentPath.length>1&&line.match(GROUP_END_REGEX))&&(context.ranges.push({from:lengthAtIndex[i],to:lengthAtIndex[i]+line.length,type:RangeType.Section}),context.endCurrentGroup(lengthAtIndex[i]+line.length,{line:i,index:line.length}),!0)}function checkNonEvents(line,i,lengthAtIndex,context){return[checkComments,checkTags,checkGroupEnd].some(f=>f(line,i,lengthAtIndex,context))}class Binary{constructor(aValue){__publicField(this,"icaltype","binary"),this.value=aValue}static fromString(aString){return new Binary(aString)}decodeValue(){return this._b64_decode(this.value)}setEncodedValue(aValue){this.value=this._b64_encode(aValue)}_b64_encode(data){let o1,o2,o3,h1,h2,h3,h4,bits,b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,ac=0,enc="",tmp_arr=[];if(!data)return data;do{o1=data.charCodeAt(i++),o2=data.charCodeAt(i++),o3=data.charCodeAt(i++),bits=o1<<16|o2<<8|o3,h1=bits>>18&63,h2=bits>>12&63,h3=bits>>6&63,h4=63&bits,tmp_arr[ac++]=b64.charAt(h1)+b64.charAt(h2)+b64.charAt(h3)+b64.charAt(h4)}while(i<data.length);enc=tmp_arr.join("");let r=data.length%3;return(r?enc.slice(0,r-3):enc)+"===".slice(r||3)}_b64_decode(data){let o1,o2,o3,h1,h2,h3,h4,bits,b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=0,ac=0,dec="",tmp_arr=[];if(!data)return data;data+="";do{h1=b64.indexOf(data.charAt(i++)),h2=b64.indexOf(data.charAt(i++)),h3=b64.indexOf(data.charAt(i++)),h4=b64.indexOf(data.charAt(i++)),bits=h1<<18|h2<<12|h3<<6|h4,o1=bits>>16&255,o2=bits>>8&255,o3=255&bits,tmp_arr[ac++]=64==h3?String.fromCharCode(o1):64==h4?String.fromCharCode(o1,o2):String.fromCharCode(o1,o2,o3)}while(i<data.length);return dec=tmp_arr.join(""),dec}toString(){return this.value}}const DURATION_LETTERS=/([PDWHMTS]{1,1})/,DATA_PROPS_TO_COPY=["weeks","days","hours","minutes","seconds","isNegative"];class Duration{constructor(data){__publicField(this,"weeks",0),__publicField(this,"days",0),__publicField(this,"hours",0),__publicField(this,"minutes",0),__publicField(this,"seconds",0),__publicField(this,"isNegative",!1),__publicField(this,"icalclass","icalduration"),__publicField(this,"icaltype","duration"),this.wrappedJSObject=this,this.fromData(data)}static fromSeconds(aSeconds){return(new Duration).fromSeconds(aSeconds)}static isValueString(string2){return"P"===string2[0]||"P"===string2[1]}static fromString(aStr){let pos=0,dict=Object.create(null),chunks=0;for(;-1!==(pos=aStr.search(DURATION_LETTERS));){let type=aStr[pos],numeric=aStr.slice(0,Math.max(0,pos));aStr=aStr.slice(pos+1),chunks+=parseDurationChunk(type,numeric,dict)}if(chunks<2)throw new Error('invalid duration value: Not enough duration components in "'+aStr+'"');return new Duration(dict)}static fromData(aData){return new Duration(aData)}clone(){return Duration.fromData(this)}toSeconds(){let seconds=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+604800*this.weeks;return this.isNegative?-seconds:seconds}fromSeconds(aSeconds){let secs=Math.abs(aSeconds);return this.isNegative=aSeconds<0,this.days=trunc(secs/86400),this.days%7==0?(this.weeks=this.days/7,this.days=0):this.weeks=0,secs-=86400*(this.days+7*this.weeks),this.hours=trunc(secs/3600),secs-=3600*this.hours,this.minutes=trunc(secs/60),secs-=60*this.minutes,this.seconds=secs,this}fromData(aData){for(let prop of DATA_PROPS_TO_COPY)this[prop]=aData&&prop in aData?aData[prop]:0}reset(){this.isNegative=!1,this.weeks=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0}compare(aOther){let thisSeconds=this.toSeconds(),otherSeconds=aOther.toSeconds();return(thisSeconds>otherSeconds)-(thisSeconds<otherSeconds)}normalize(){this.fromSeconds(this.toSeconds())}toString(){if(0==this.toSeconds())return"PT0S";{let str="";return this.isNegative&&(str+="-"),str+="P",this.weeks&&(str+=this.weeks+"W"),this.days&&(str+=this.days+"D"),(this.hours||this.minutes||this.seconds)&&(str+="T",this.hours&&(str+=this.hours+"H"),this.minutes&&(str+=this.minutes+"M"),this.seconds&&(str+=this.seconds+"S")),str}}toICALString(){return this.toString()}}function parseDurationChunk(letter,number,object){let type;switch(letter){case"P":object.isNegative=!(!number||"-"!==number);break;case"D":type="days";break;case"W":type="weeks";break;case"H":type="hours";break;case"M":type="minutes";break;case"S":type="seconds";break;default:return 0}if(type){if(!number&&0!==number)throw new Error('invalid duration value: Missing number before "'+letter+'"');let num=parseInt(number,10);if(isStrictlyNaN(num))throw new Error('invalid duration value: Invalid number "'+number+'" before "'+letter+'"');object[type]=num}return 1}const _Time=class _Time{constructor(data,zone){__publicField(this,"icalclass","icaltime"),__publicField(this,"_cachedUnixTime",null),__publicField(this,"zone",null),__publicField(this,"_pendingNormalization",!1),this.wrappedJSObject=this;let time=this._time=Object.create(null);time.year=0,time.month=1,time.day=1,time.hour=0,time.minute=0,time.second=0,time.isDate=!1,this.fromData(data,zone)}static daysInMonth(month,year2){let days=30;return month<1||month>12||(days=[0,31,28,31,30,31,30,31,31,30,31,30,31][month],2==month&&(days+=_Time.isLeapYear(year2))),days}static isLeapYear(year2){return year2<=1752?year2%4==0:year2%4==0&&year2%100!=0||year2%400==0}static fromDayOfYear(aDayOfYear,aYear){let year2=aYear,doy=aDayOfYear,tt2=new _Time;tt2.auto_normalize=!1;let is_leap=_Time.isLeapYear(year2)?1:0;if(doy<1)return year2--,is_leap=_Time.isLeapYear(year2)?1:0,doy+=_Time.daysInYearPassedMonth[is_leap][12],_Time.fromDayOfYear(doy,year2);if(doy>_Time.daysInYearPassedMonth[is_leap][12])return is_leap=_Time.isLeapYear(year2)?1:0,doy-=_Time.daysInYearPassedMonth[is_leap][12],year2++,_Time.fromDayOfYear(doy,year2);tt2.year=year2,tt2.isDate=!0;for(let month=11;month>=0;month--)if(doy>_Time.daysInYearPassedMonth[is_leap][month]){tt2.month=month+1,tt2.day=doy-_Time.daysInYearPassedMonth[is_leap][month];break}return tt2.auto_normalize=!0,tt2}static fromStringv2(str){return new _Time({year:parseInt(str.slice(0,4),10),month:parseInt(str.slice(5,7),10),day:parseInt(str.slice(8,10),10),isDate:!0})}static fromDateString(aValue){return new _Time({year:strictParseInt(aValue.slice(0,4)),month:strictParseInt(aValue.slice(5,7)),day:strictParseInt(aValue.slice(8,10)),isDate:!0})}static fromDateTimeString(aValue,prop){if(aValue.length<19)throw new Error('invalid date-time value: "'+aValue+'"');let zone,zoneId;aValue[19]&&"Z"===aValue[19]?zone=Timezone.utcTimezone:prop&&(zoneId=prop.getParameter("tzid"),prop.parent&&("standard"===prop.parent.name||"daylight"===prop.parent.name?zone=Timezone.localTimezone:zoneId&&(zone=prop.parent.getTimeZoneByID(zoneId))));const timeData={year:strictParseInt(aValue.slice(0,4)),month:strictParseInt(aValue.slice(5,7)),day:strictParseInt(aValue.slice(8,10)),hour:strictParseInt(aValue.slice(11,13)),minute:strictParseInt(aValue.slice(14,16)),second:strictParseInt(aValue.slice(17,19))};return zoneId&&!zone&&(timeData.timezone=zoneId),new _Time(timeData,zone)}static fromString(aValue,aProperty){return aValue.length>10?_Time.fromDateTimeString(aValue,aProperty):_Time.fromDateString(aValue)}static fromJSDate(aDate,useUTC){return(new _Time).fromJSDate(aDate,useUTC)}static now(){return _Time.fromJSDate(new Date,!1)}static weekOneStarts(aYear,aWeekStart){let t=_Time.fromData({year:aYear,month:1,day:1,isDate:!0}),dow=t.dayOfWeek(),wkst=aWeekStart||_Time.DEFAULT_WEEK_START;return dow>_Time.THURSDAY&&(t.day+=7),wkst>_Time.THURSDAY&&(t.day-=7),t.day-=dow-wkst,t}static getDominicalLetter(yr){let dom=(yr+(yr/4|0)+(yr/400|0)-(yr/100|0)-1)%7;return _Time.isLeapYear(yr)?"GFEDCBA"[(dom+6)%7]+"GFEDCBA"[dom]:"GFEDCBA"[dom]}static get epochTime(){return __privateGet(this,_epochTime)||__privateSet(this,_epochTime,_Time.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:!1,timezone:"Z"})),__privateGet(this,_epochTime)}static _cmp_attr(a,b,attr){return a[attr]>b[attr]?1:a[attr]<b[attr]?-1:0}get icaltype(){return this.isDate?"date":"date-time"}clone(){return new _Time(this._time,this.zone)}reset(){this.fromData(_Time.epochTime),this.zone=Timezone.utcTimezone}resetTo(year2,month,day,hour,minute,second,timezone){this.fromData({year:year2,month:month,day:day,hour:hour,minute:minute,second:second,zone:timezone})}fromJSDate(aDate,useUTC){return aDate?useUTC?(this.zone=Timezone.utcTimezone,this.year=aDate.getUTCFullYear(),this.month=aDate.getUTCMonth()+1,this.day=aDate.getUTCDate(),this.hour=aDate.getUTCHours(),this.minute=aDate.getUTCMinutes(),this.second=aDate.getUTCSeconds()):(this.zone=Timezone.localTimezone,this.year=aDate.getFullYear(),this.month=aDate.getMonth()+1,this.day=aDate.getDate(),this.hour=aDate.getHours(),this.minute=aDate.getMinutes(),this.second=aDate.getSeconds()):this.reset(),this._cachedUnixTime=null,this}fromData(aData,aZone){if(aData)for(let[key,value]of Object.entries(aData))"icaltype"!==key&&(this[key]=value);if(aZone&&(this.zone=aZone),aData&&!("isDate"in aData)?this.isDate=!("hour"in aData):aData&&"isDate"in aData&&(this.isDate=aData.isDate),aData&&"timezone"in aData){let zone=TimezoneService.get(aData.timezone);this.zone=zone||Timezone.localTimezone}return aData&&"zone"in aData&&(this.zone=aData.zone),this.zone||(this.zone=Timezone.localTimezone),this._cachedUnixTime=null,this}dayOfWeek(aWeekStart){let firstDow=aWeekStart||_Time.SUNDAY,dowCacheKey=(this.year<<12)+(this.month<<8)+(this.day<<3)+firstDow;if(dowCacheKey in _Time._dowCache)return _Time._dowCache[dowCacheKey];let q=this.day,m=this.month+(this.month<3?12:0),Y=this.year-(this.month<3?1:0),h2=q+Y+trunc(26*(m+1)/10)+trunc(Y/4);return h2+=6*trunc(Y/100)+trunc(Y/400),h2=(h2+7-firstDow)%7+1,_Time._dowCache[dowCacheKey]=h2,h2}dayOfYear(){let is_leap=_Time.isLeapYear(this.year)?1:0;return _Time.daysInYearPassedMonth[is_leap][this.month-1]+this.day}startOfWeek(aWeekStart){let firstDow=aWeekStart||_Time.SUNDAY,result=this.clone();return result.day-=(this.dayOfWeek()+7-firstDow)%7,result.isDate=!0,result.hour=0,result.minute=0,result.second=0,result}endOfWeek(aWeekStart){let firstDow=aWeekStart||_Time.SUNDAY,result=this.clone();return result.day+=(7-this.dayOfWeek()+firstDow-_Time.SUNDAY)%7,result.isDate=!0,result.hour=0,result.minute=0,result.second=0,result}startOfMonth(){let result=this.clone();return result.day=1,result.isDate=!0,result.hour=0,result.minute=0,result.second=0,result}endOfMonth(){let result=this.clone();return result.day=_Time.daysInMonth(result.month,result.year),result.isDate=!0,result.hour=0,result.minute=0,result.second=0,result}startOfYear(){let result=this.clone();return result.day=1,result.month=1,result.isDate=!0,result.hour=0,result.minute=0,result.second=0,result}endOfYear(){let result=this.clone();return result.day=31,result.month=12,result.isDate=!0,result.hour=0,result.minute=0,result.second=0,result}startDoyWeek(aFirstDayOfWeek){let firstDow=aFirstDayOfWeek||_Time.SUNDAY,delta=this.dayOfWeek()-firstDow;return delta<0&&(delta+=7),this.dayOfYear()-delta}getDominicalLetter(){return _Time.getDominicalLetter(this.year)}nthWeekDay(aDayOfWeek,aPos){let weekday,daysInMonth2=_Time.daysInMonth(this.month,this.year),pos=aPos,start=0,otherDay=this.clone();if(pos>=0){otherDay.day=1,0!=pos&&pos--,start=otherDay.day;let offset2=aDayOfWeek-otherDay.dayOfWeek();offset2<0&&(offset2+=7),start+=offset2,start-=aDayOfWeek,weekday=aDayOfWeek}else{otherDay.day=daysInMonth2,pos++,weekday=otherDay.dayOfWeek()-aDayOfWeek,weekday<0&&(weekday+=7),weekday=daysInMonth2-weekday}return weekday+=7*pos,start+weekday}isNthWeekDay(aDayOfWeek,aPos){let dow=this.dayOfWeek();return 0===aPos&&dow===aDayOfWeek||this.nthWeekDay(aDayOfWeek,aPos)===this.day}weekNumber(aWeekStart){let week1,wnCacheKey=(this.year<<12)+(this.month<<8)+(this.day<<3)+aWeekStart;if(wnCacheKey in _Time._wnCache)return _Time._wnCache[wnCacheKey];let dt=this.clone();dt.isDate=!0;let isoyear=this.year;12==dt.month&&dt.day>25?(week1=_Time.weekOneStarts(isoyear+1,aWeekStart),dt.compare(week1)<0?week1=_Time.weekOneStarts(isoyear,aWeekStart):isoyear++):(week1=_Time.weekOneStarts(isoyear,aWeekStart),dt.compare(week1)<0&&(week1=_Time.weekOneStarts(--isoyear,aWeekStart)));let answer=trunc(dt.subtractDate(week1).toSeconds()/86400/7)+1;return _Time._wnCache[wnCacheKey]=answer,answer}addDuration(aDuration){let mult=aDuration.isNegative?-1:1,second=this.second,minute=this.minute,hour=this.hour,day=this.day;second+=mult*aDuration.seconds,minute+=mult*aDuration.minutes,hour+=mult*aDuration.hours,day+=mult*aDuration.days,day+=7*mult*aDuration.weeks,this.second=second,this.minute=minute,this.hour=hour,this.day=day,this._cachedUnixTime=null}subtractDate(aDate){let unixTime=this.toUnixTime()+this.utcOffset(),other=aDate.toUnixTime()+aDate.utcOffset();return Duration.fromSeconds(unixTime-other)}subtractDateTz(aDate){let unixTime=this.toUnixTime(),other=aDate.toUnixTime();return Duration.fromSeconds(unixTime-other)}compare(other){let a=this.toUnixTime(),b=other.toUnixTime();return a>b?1:b>a?-1:0}compareDateOnlyTz(other,tz){let a=this.convertToZone(tz),b=other.convertToZone(tz),rc=0;return 0!=(rc=_Time._cmp_attr(a,b,"year"))||0!=(rc=_Time._cmp_attr(a,b,"month"))||(rc=_Time._cmp_attr(a,b,"day")),rc}convertToZone(zone){let copy=this.clone(),zone_equals=this.zone.tzid==zone.tzid;return this.isDate||zone_equals||Timezone.convert_time(copy,this.zone,zone),copy.zone=zone,copy}utcOffset(){return this.zone==Timezone.localTimezone||this.zone==Timezone.utcTimezone?0:this.zone.utcOffset(this)}toICALString(){let string2=this.toString();return string2.length>10?design$1.icalendar.value["date-time"].toICAL(string2):design$1.icalendar.value.date.toICAL(string2)}toString(){let result=this.year+"-"+pad2(this.month)+"-"+pad2(this.day);return this.isDate||(result+="T"+pad2(this.hour)+":"+pad2(this.minute)+":"+pad2(this.second),this.zone===Timezone.utcTimezone&&(result+="Z")),result}toJSDate(){return this.zone==Timezone.localTimezone?this.isDate?new Date(this.year,this.month-1,this.day):new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0):new Date(1e3*this.toUnixTime())}_normalize(){return this._time.isDate&&(this._time.hour=0,this._time.minute=0,this._time.second=0),this.adjust(0,0,0,0),this}adjust(aExtraDays,aExtraHours,aExtraMinutes,aExtraSeconds,aTime){let minutesOverflow,hoursOverflow,second,minute,hour,day,daysInMonth2,daysOverflow=0,yearsOverflow=0,time=aTime||this._time;if(time.isDate||(second=time.second+aExtraSeconds,time.second=second%60,minutesOverflow=trunc(second/60),time.second<0&&(time.second+=60,minutesOverflow--),minute=time.minute+aExtraMinutes+minutesOverflow,time.minute=minute%60,hoursOverflow=trunc(minute/60),time.minute<0&&(time.minute+=60,hoursOverflow--),hour=time.hour+aExtraHours+hoursOverflow,time.hour=hour%24,daysOverflow=trunc(hour/24),time.hour<0&&(time.hour+=24,daysOverflow--)),time.month>12?yearsOverflow=trunc((time.month-1)/12):time.month<1&&(yearsOverflow=trunc(time.month/12)-1),time.year+=yearsOverflow,time.month-=12*yearsOverflow,day=time.day+aExtraDays+daysOverflow,day>0)for(;daysInMonth2=_Time.daysInMonth(time.month,time.year),!(day<=daysInMonth2);)time.month++,time.month>12&&(time.year++,time.month=1),day-=daysInMonth2;else for(;day<=0;)1==time.month?(time.year--,time.month=12):time.month--,day+=_Time.daysInMonth(time.month,time.year);return time.day=day,this._cachedUnixTime=null,this}fromUnixTime(seconds){this.zone=Timezone.utcTimezone;let date=new Date(1e3*seconds);this.year=date.getUTCFullYear(),this.month=date.getUTCMonth()+1,this.day=date.getUTCDate(),this._time.isDate?(this.hour=0,this.minute=0,this.second=0):(this.hour=date.getUTCHours(),this.minute=date.getUTCMinutes(),this.second=date.getUTCSeconds()),this._cachedUnixTime=null}toUnixTime(){if(null!==this._cachedUnixTime)return this._cachedUnixTime;let offset2=this.utcOffset(),ms=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-offset2);return this._cachedUnixTime=ms/1e3,this._cachedUnixTime}toJSON(){let prop,copy=["year","month","day","hour","minute","second","isDate"],result=Object.create(null),i=0,len=copy.length;for(;i<len;i++)prop=copy[i],result[prop]=this[prop];return this.zone&&(result.timezone=this.zone.tzid),result}};_epochTime=new WeakMap,__publicField(_Time,"_dowCache",{}),__publicField(_Time,"_wnCache",{}),__publicField(_Time,"fromData",function(aData,aZone){return(new _Time).fromData(aData,aZone)}),__privateAdd(_Time,_epochTime,null),__publicField(_Time,"daysInYearPassedMonth",[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]]),__publicField(_Time,"SUNDAY",1),__publicField(_Time,"MONDAY",2),__publicField(_Time,"TUESDAY",3),__publicField(_Time,"WEDNESDAY",4),__publicField(_Time,"THURSDAY",5),__publicField(_Time,"FRIDAY",6),__publicField(_Time,"SATURDAY",7),__publicField(_Time,"DEFAULT_WEEK_START",2);let Time=_Time;!function(){function defineAttr(attr){Object.defineProperty(Time.prototype,attr,{get:function(){return this._pendingNormalization&&(this._normalize(),this._pendingNormalization=!1),this._time[attr]},set:function(val){"isDate"===attr&&val&&!this._time.isDate&&this.adjust(0,0,0,0),this._cachedUnixTime=null,this._pendingNormalization=!0,this._time[attr]=val}})}defineAttr("year"),defineAttr("month"),defineAttr("day"),defineAttr("hour"),defineAttr("minute"),defineAttr("second"),defineAttr("isDate")}();const CHAR=/[^ \t]/,RFC6868_REPLACE_MAP$1={"^'":'"',"^n":"\n","^^":"^"};function parse$1(input){let state={},root=state.component=[];if(state.stack=[root],parse$1._eachLine(input,function(err,line){parse$1._handleContentLine(line,state)}),state.stack.length>1)throw new ParserError("invalid ical body. component began but did not end");return state=null,1==root.length?root[0]:root}parse$1.property=function(str,designSet){let state={component:[[],[]],designSet:designSet||design$1.defaultSet};return parse$1._handleContentLine(str,state),state.component[1][0]},parse$1.component=function(str){return parse$1(str)};class ParserError extends Error{constructor(){super(...arguments),__publicField(this,"name",this.constructor.name)}}parse$1.ParserError=ParserError,parse$1._handleContentLine=function(line,state){let lastParamIndex,lastValuePos,name,value,parsedParams,valueType,valuePos=line.indexOf(":"),paramPos=line.indexOf(";"),params={};if(-1!==paramPos&&-1!==valuePos&&paramPos>valuePos&&(paramPos=-1),-1!==paramPos){if(name=line.slice(0,Math.max(0,paramPos)).toLowerCase(),parsedParams=parse$1._parseParameters(line.slice(Math.max(0,paramPos)),0,state.designSet),-1==parsedParams[2])throw new ParserError("Invalid parameters in '"+line+"'");if(params=parsedParams[0],lastParamIndex=parsedParams[1].length+parsedParams[2]+paramPos,-1===(lastValuePos=line.slice(Math.max(0,lastParamIndex)).indexOf(":")))throw new ParserError("Missing parameter value in '"+line+"'");value=line.slice(Math.max(0,lastParamIndex+lastValuePos+1))}else{if(-1===valuePos)throw new ParserError('invalid line (no token ";" or ":") "'+line+'"');if(name=line.slice(0,Math.max(0,valuePos)).toLowerCase(),value=line.slice(Math.max(0,valuePos+1)),"begin"===name){let newComponent=[value.toLowerCase(),[],[]];return 1===state.stack.length?state.component.push(newComponent):state.component[2].push(newComponent),state.stack.push(state.component),state.component=newComponent,void(state.designSet||(state.designSet=design$1.getDesignSet(state.component[0])))}if("end"===name)return void(state.component=state.stack.pop())}let propertyDetails,splitName,ungroupedName,result,multiValue=!1,structuredValue=!1;state.designSet.propertyGroups&&-1!==name.indexOf(".")?(splitName=name.split("."),params.group=splitName[0],ungroupedName=splitName[1]):ungroupedName=name,ungroupedName in state.designSet.property&&(propertyDetails=state.designSet.property[ungroupedName],"multiValue"in propertyDetails&&(multiValue=propertyDetails.multiValue),"structuredValue"in propertyDetails&&(structuredValue=propertyDetails.structuredValue),value&&"detectType"in propertyDetails&&(valueType=propertyDetails.detectType(value))),valueType||(valueType="value"in params?params.value.toLowerCase():propertyDetails?propertyDetails.defaultType:"unknown"),delete params.value,multiValue&&structuredValue?(value=parse$1._parseMultiValue(value,structuredValue,valueType,[],multiValue,state.designSet,structuredValue),result=[ungroupedName,params,valueType,value]):multiValue?(result=[ungroupedName,params,valueType],parse$1._parseMultiValue(value,multiValue,valueType,result,null,state.designSet,!1)):structuredValue?(value=parse$1._parseMultiValue(value,structuredValue,valueType,[],null,state.designSet,structuredValue),result=[ungroupedName,params,valueType,value]):(value=parse$1._parseValue(value,valueType,state.designSet,!1),result=[ungroupedName,params,valueType,value]),"vcard"!==state.component[0]||0!==state.component[1].length||"version"===name&&"4.0"===value||(state.designSet=design$1.getDesignSet("vcard3")),state.component[1].push(result)},parse$1._parseValue=function(value,type,designSet,structuredValue){return type in designSet.value&&"fromICAL"in designSet.value[type]?designSet.value[type].fromICAL(value,structuredValue):value},parse$1._parseParameters=function(line,start,designSet){let name,lcname,value,type,multiValue,mvdelim,lastParam=start,pos=0,result={},valuePos=-1;for(;!1!==pos&&-1!==(pos=line.indexOf("=",pos+1));){if(name=line.slice(lastParam+1,pos),0==name.length)throw new ParserError("Empty parameter name in '"+line+"'");if(lcname=name.toLowerCase(),mvdelim=!1,multiValue=!1,type=lcname in designSet.param&&designSet.param[lcname].valueType?designSet.param[lcname].valueType:"text",lcname in designSet.param&&(multiValue=designSet.param[lcname].multiValue,designSet.param[lcname].multiValueSeparateDQuote&&(mvdelim=parse$1._rfc6868Escape('"'+multiValue+'"'))),'"'===line[pos+1]){if(valuePos=pos+2,pos=line.indexOf('"',valuePos),multiValue&&-1!=pos){let extendedValue=!0;for(;extendedValue;)line[pos+1]==multiValue&&'"'==line[pos+2]?pos=line.indexOf('"',pos+3):extendedValue=!1}if(-1===pos)throw new ParserError('invalid line (no matching double quote) "'+line+'"');value=line.slice(valuePos,pos),lastParam=line.indexOf(";",pos);let propValuePos=line.indexOf(":",pos);(-1===lastParam||-1!==propValuePos&&lastParam>propValuePos)&&(pos=!1)}else{valuePos=pos+1;let nextPos=line.indexOf(";",valuePos),propValuePos=line.indexOf(":",valuePos);-1!==propValuePos&&nextPos>propValuePos?(nextPos=propValuePos,pos=!1):-1===nextPos?(nextPos=-1===propValuePos?line.length:propValuePos,pos=!1):(lastParam=nextPos,pos=nextPos),value=line.slice(valuePos,nextPos)}const length_before=value.length;if(value=parse$1._rfc6868Escape(value),valuePos+=length_before-value.length,multiValue){let delimiter=mvdelim||multiValue;value=parse$1._parseMultiValue(value,delimiter,type,[],null,designSet)}else value=parse$1._parseValue(value,type,designSet);multiValue&&lcname in result?Array.isArray(result[lcname])?result[lcname].push(value):result[lcname]=[result[lcname],value]:result[lcname]=value}return[result,value,valuePos]},parse$1._rfc6868Escape=function(val){return val.replace(/\^['n^]/g,function(x){return RFC6868_REPLACE_MAP$1[x]})},parse$1._parseMultiValue=function(buffer,delim,type,result,innerMulti,designSet,structuredValue){let value,pos=0,lastPos=0;if(0===delim.length)return buffer;for(;-1!==(pos=unescapedIndexOf(buffer,delim,lastPos));)value=buffer.slice(lastPos,pos),value=innerMulti?parse$1._parseMultiValue(value,innerMulti,type,[],null,designSet,structuredValue):parse$1._parseValue(value,type,designSet,structuredValue),result.push(value),lastPos=pos+delim.length;return value=buffer.slice(lastPos),value=innerMulti?parse$1._parseMultiValue(value,innerMulti,type,[],null,designSet,structuredValue):parse$1._parseValue(value,type,designSet,structuredValue),result.push(value),1==result.length?result[0]:result},parse$1._eachLine=function(buffer,callback){let line,firstChar,newlineOffset,len=buffer.length,lastPos=buffer.search(CHAR),pos=lastPos;do{pos=buffer.indexOf("\n",lastPos)+1,newlineOffset=pos>1&&"\r"===buffer[pos-2]?2:1,0===pos&&(pos=len,newlineOffset=0),firstChar=buffer[lastPos]," "===firstChar||"\t"===firstChar?line+=buffer.slice(lastPos+1,pos-newlineOffset):(line&&callback(null,line),line=buffer.slice(lastPos,pos-newlineOffset)),lastPos=pos}while(pos!==len);line=line.trim(),line.length&&callback(null,line)};const OPTIONS=["tzid","location","tznames","latitude","longitude"],_Timezone=class _Timezone{constructor(data){__publicField(this,"tzid",""),__publicField(this,"location",""),__publicField(this,"tznames",""),__publicField(this,"latitude",0),__publicField(this,"longitude",0),__publicField(this,"component",null),__publicField(this,"expandedUntilYear",0),__publicField(this,"icalclass","icaltimezone"),this.wrappedJSObject=this,this.fromData(data)}static _compare_change_fn(a,b){return a.year<b.year?-1:a.year>b.year?1:a.month<b.month?-1:a.month>b.month?1:a.day<b.day?-1:a.day>b.day?1:a.hour<b.hour?-1:a.hour>b.hour?1:a.minute<b.minute?-1:a.minute>b.minute?1:a.second<b.second?-1:a.second>b.second?1:0}static convert_time(tt2,from_zone,to_zone){if(tt2.isDate||from_zone.tzid==to_zone.tzid||from_zone==_Timezone.localTimezone||to_zone==_Timezone.localTimezone)return tt2.zone=to_zone,tt2;let utcOffset=from_zone.utcOffset(tt2);return tt2.adjust(0,0,0,-utcOffset),utcOffset=to_zone.utcOffset(tt2),tt2.adjust(0,0,0,utcOffset),null}static fromData(aData){return(new _Timezone).fromData(aData)}static get utcTimezone(){return __privateGet(this,_utcTimezone)||__privateSet(this,_utcTimezone,_Timezone.fromData({tzid:"UTC"})),__privateGet(this,_utcTimezone)}static get localTimezone(){return __privateGet(this,_localTimezone)||__privateSet(this,_localTimezone,_Timezone.fromData({tzid:"floating"})),__privateGet(this,_localTimezone)}static adjust_change(change,days,hours,minutes,seconds){return Time.prototype.adjust.call(change,days,hours,minutes,seconds,change)}fromData(aData){if(this.expandedUntilYear=0,this.changes=[],aData instanceof Component)this.component=aData;else{if(aData&&"component"in aData)if("string"==typeof aData.component){let jCal=parse$1(aData.component);this.component=new Component(jCal)}else aData.component instanceof Component?this.component=aData.component:this.component=null;for(let prop of OPTIONS)aData&&prop in aData&&(this[prop]=aData[prop])}return this.component instanceof Component&&!this.tzid&&(this.tzid=this.component.getFirstPropertyValue("tzid")),this}utcOffset(tt2){if(this==_Timezone.utcTimezone||this==_Timezone.localTimezone)return 0;if(this._ensureCoverage(tt2.year),!this.changes.length)return 0;let tt_change={year:tt2.year,month:tt2.month,day:tt2.day,hour:tt2.hour,minute:tt2.minute,second:tt2.second},change_num=this._findNearbyChange(tt_change),change_num_to_use=-1,step=1;for(;;){let change=clone(this.changes[change_num],!0);if(change.utcOffset<change.prevUtcOffset?_Timezone.adjust_change(change,0,0,0,change.utcOffset):_Timezone.adjust_change(change,0,0,0,change.prevUtcOffset),_Timezone._compare_change_fn(tt_change,change)>=0?change_num_to_use=change_num:step=-1,-1==step&&-1!=change_num_to_use)break;if(change_num+=step,change_num<0)return 0;if(change_num>=this.changes.length)break}let zone_change=this.changes[change_num_to_use];if(zone_change.utcOffset-zone_change.prevUtcOffset<0&&change_num_to_use>0){let tmp_change=clone(zone_change,!0);if(_Timezone.adjust_change(tmp_change,0,0,0,tmp_change.prevUtcOffset),_Timezone._compare_change_fn(tt_change,tmp_change)<0){let prev_zone_change=this.changes[change_num_to_use-1],want_daylight=!1;zone_change.is_daylight!=want_daylight&&prev_zone_change.is_daylight==want_daylight&&(zone_change=prev_zone_change)}}return zone_change.utcOffset}_findNearbyChange(change){let idx=binsearchInsert(this.changes,change,_Timezone._compare_change_fn);return idx>=this.changes.length?this.changes.length-1:idx}_ensureCoverage(aYear){if(-1==_Timezone._minimumExpansionYear){let today=Time.now();_Timezone._minimumExpansionYear=today.year}let changesEndYear=aYear;if(changesEndYear<_Timezone._minimumExpansionYear&&(changesEndYear=_Timezone._minimumExpansionYear),changesEndYear+=_Timezone.EXTRA_COVERAGE,!this.changes.length||this.expandedUntilYear<aYear){let subcomps=this.component.getAllSubcomponents(),compLen=subcomps.length,compIdx=0;for(;compIdx<compLen;compIdx++)this._expandComponent(subcomps[compIdx],changesEndYear,this.changes);this.changes.sort(_Timezone._compare_change_fn),this.expandedUntilYear=changesEndYear}}_expandComponent(aComponent,aYear,changes){if(!aComponent.hasProperty("dtstart")||!aComponent.hasProperty("tzoffsetto")||!aComponent.hasProperty("tzoffsetfrom"))return null;let change,dtstart=aComponent.getFirstProperty("dtstart").getFirstValue();function convert_tzoffset(offset2){return offset2.factor*(3600*offset2.hours+60*offset2.minutes)}function init_changes(){let changebase={};return changebase.is_daylight="daylight"==aComponent.name,changebase.utcOffset=convert_tzoffset(aComponent.getFirstProperty("tzoffsetto").getFirstValue()),changebase.prevUtcOffset=convert_tzoffset(aComponent.getFirstProperty("tzoffsetfrom").getFirstValue()),changebase}if(aComponent.hasProperty("rrule")||aComponent.hasProperty("rdate")){let props=aComponent.getAllProperties("rdate");for(let rdate of props){let time=rdate.getFirstValue();change=init_changes(),change.year=time.year,change.month=time.month,change.day=time.day,time.isDate?(change.hour=dtstart.hour,change.minute=dtstart.minute,change.second=dtstart.second,dtstart.zone!=_Timezone.utcTimezone&&_Timezone.adjust_change(change,0,0,0,-change.prevUtcOffset)):(change.hour=time.hour,change.minute=time.minute,change.second=time.second,time.zone!=_Timezone.utcTimezone&&_Timezone.adjust_change(change,0,0,0,-change.prevUtcOffset)),changes.push(change)}let rrule2=aComponent.getFirstProperty("rrule");if(rrule2){rrule2=rrule2.getFirstValue(),change=init_changes(),rrule2.until&&rrule2.until.zone==_Timezone.utcTimezone&&(rrule2.until.adjust(0,0,0,change.prevUtcOffset),rrule2.until.zone=_Timezone.localTimezone);let occ,iterator2=rrule2.iterator(dtstart);for(;(occ=iterator2.next())&&(change=init_changes(),!(occ.year>aYear)&&occ);)change.year=occ.year,change.month=occ.month,change.day=occ.day,change.hour=occ.hour,change.minute=occ.minute,change.second=occ.second,change.isDate=occ.isDate,_Timezone.adjust_change(change,0,0,0,-change.prevUtcOffset),changes.push(change)}}else change=init_changes(),change.year=dtstart.year,change.month=dtstart.month,change.day=dtstart.day,change.hour=dtstart.hour,change.minute=dtstart.minute,change.second=dtstart.second,_Timezone.adjust_change(change,0,0,0,-change.prevUtcOffset),changes.push(change);return changes}toString(){return this.tznames?this.tznames:this.tzid}};_utcTimezone=new WeakMap,_localTimezone=new WeakMap,__privateAdd(_Timezone,_utcTimezone,null),__privateAdd(_Timezone,_localTimezone,null),__publicField(_Timezone,"_minimumExpansionYear",-1),__publicField(_Timezone,"EXTRA_COVERAGE",5);let Timezone=_Timezone,zones=null;const TimezoneService={get count(){return null===zones?0:Object.keys(zones).length},reset:function(){zones=Object.create(null);let utc=Timezone.utcTimezone;zones.Z=utc,zones.UTC=utc,zones.GMT=utc},_hard_reset:function(){zones=null},has:function(tzid){return null!==zones&&!!zones[tzid]},get:function(tzid){return null===zones&&this.reset(),zones[tzid]},register:function(timezone,name){if(null===zones&&this.reset(),"string"==typeof timezone&&name instanceof Timezone&&([timezone,name]=[name,timezone]),name||(timezone instanceof Timezone?name=timezone.tzid:"vtimezone"===timezone.name&&(name=(timezone=new Timezone(timezone)).tzid)),!name)throw new TypeError("Neither a timezone nor a name was passed");if(!(timezone instanceof Timezone))throw new TypeError("timezone must be ICAL.Timezone or ICAL.Component");zones[name]=timezone},remove:function(tzid){return null===zones?null:delete zones[tzid]}};function isStrictlyNaN(number){return"number"==typeof number&&isNaN(number)}function strictParseInt(string2){let result=parseInt(string2,10);if(isStrictlyNaN(result))throw new Error('Could not extract integer from "'+string2+'"');return result}function formatClassType(data,type){if(void 0!==data)return data instanceof type?data:new type(data)}function unescapedIndexOf(buffer,search,pos){for(;-1!==(pos=buffer.indexOf(search,pos));){if(!(pos>0&&"\\"===buffer[pos-1]))return pos;pos+=1}return-1}function binsearchInsert(list,seekVal,cmpfunc){if(!list.length)return 0;let mid,cmpval,low=0,high=list.length-1;for(;low<=high;)if(mid=low+Math.floor((high-low)/2),cmpval=cmpfunc(seekVal,list[mid]),cmpval<0)high=mid-1;else{if(!(cmpval>0))break;low=mid+1}return cmpval<0?mid:cmpval>0?mid+1:mid}function clone(aSrc,aDeep){if(aSrc&&"object"==typeof aSrc){if(aSrc instanceof Date)return new Date(aSrc.getTime());if("clone"in aSrc)return aSrc.clone();if(Array.isArray(aSrc)){let arr=[];for(let i=0;i<aSrc.length;i++)arr.push(aDeep?clone(aSrc[i],!0):aSrc[i]);return arr}{let obj={};for(let[name,value]of Object.entries(aSrc))obj[name]=aDeep?clone(value,!0):value;return obj}}return aSrc}function foldline(aLine){let result="",line=aLine||"",pos=0,line_length=0;for(;line.length;){let cp=line.codePointAt(pos);cp<128?++line_length:line_length+=cp<2048?2:cp<65536?3:4,line_length<ICALmodule.foldLength+1?pos+=cp>65535?2:1:(result+=ICALmodule.newLineChar+" "+line.slice(0,Math.max(0,pos)),line=line.slice(Math.max(0,pos)),pos=line_length=0)}return result.slice(ICALmodule.newLineChar.length+1)}function pad2(data){switch("string"!=typeof data&&("number"==typeof data&&(data=parseInt(data)),data=String(data)),data.length){case 0:return"00";case 1:return"0"+data;default:return data}}function trunc(number){return number<0?Math.ceil(number):Math.floor(number)}function extend(source,target){for(let key in source){let descr=Object.getOwnPropertyDescriptor(source,key);descr&&!Object.getOwnPropertyDescriptor(target,key)&&Object.defineProperty(target,key,descr)}return target}var helpers=Object.freeze({__proto__:null,updateTimezones:function(vcal){let allsubs,properties,vtimezones,reqTzid,i;if(!vcal||"vcalendar"!==vcal.name)return vcal;for(allsubs=vcal.getAllSubcomponents(),properties=[],vtimezones={},i=0;i<allsubs.length;i++)if("vtimezone"===allsubs[i].name){vtimezones[allsubs[i].getFirstProperty("tzid").getFirstValue()]=allsubs[i]}else properties=properties.concat(allsubs[i].getAllProperties());for(reqTzid={},i=0;i<properties.length;i++){let tzid=properties[i].getParameter("tzid");tzid&&(reqTzid[tzid]=!0)}for(let[tzid,comp]of Object.entries(vtimezones))reqTzid[tzid]||vcal.removeSubcomponent(comp);for(let tzid of Object.keys(reqTzid))!vtimezones[tzid]&&TimezoneService.has(tzid)&&vcal.addSubcomponent(TimezoneService.get(tzid).component);return vcal},isStrictlyNaN:isStrictlyNaN,strictParseInt:strictParseInt,formatClassType:formatClassType,unescapedIndexOf:unescapedIndexOf,binsearchInsert:binsearchInsert,clone:clone,foldline:foldline,pad2:pad2,trunc:trunc,extend:extend});class UtcOffset{constructor(aData){__publicField(this,"hours",0),__publicField(this,"minutes",0),__publicField(this,"factor",1),__publicField(this,"icaltype","utc-offset"),this.fromData(aData)}static fromString(aString){let options={};return options.factor="+"===aString[0]?1:-1,options.hours=strictParseInt(aString.slice(1,3)),options.minutes=strictParseInt(aString.slice(4,6)),new UtcOffset(options)}static fromSeconds(aSeconds){let instance=new UtcOffset;return instance.fromSeconds(aSeconds),instance}clone(){return UtcOffset.fromSeconds(this.toSeconds())}fromData(aData){if(aData)for(let[key,value]of Object.entries(aData))this[key]=value;this._normalize()}fromSeconds(aSeconds){let secs=Math.abs(aSeconds);return this.factor=aSeconds<0?-1:1,this.hours=trunc(secs/3600),secs-=3600*this.hours,this.minutes=trunc(secs/60),this}toSeconds(){return this.factor*(60*this.minutes+3600*this.hours)}compare(other){let a=this.toSeconds(),b=other.toSeconds();return(a>b)-(b>a)}_normalize(){let secs=this.toSeconds(),factor=this.factor;for(;secs<-43200;)secs+=97200;for(;secs>50400;)secs-=97200;this.fromSeconds(secs),0==secs&&(this.factor=factor)}toICALString(){return design$1.icalendar.value["utc-offset"].toICAL(this.toString())}toString(){return(1==this.factor?"+":"-")+pad2(this.hours)+":"+pad2(this.minutes)}}class VCardTime extends Time{constructor(data,zone,icaltype){super(data,zone),__publicField(this,"icalclass","vcardtime"),__publicField(this,"icaltype","date-and-or-time"),this.icaltype=icaltype||"date-and-or-time"}static fromDateAndOrTimeString(aValue,aIcalType){function part(v,s2,e){return v?strictParseInt(v.slice(s2,s2+e)):null}let parts=aValue.split("T"),dt=parts[0],tmz=parts[1],splitzone=tmz?design$1.vcard.value.time._splitZone(tmz):[],zone=splitzone[0],tm=splitzone[1],dtlen=dt?dt.length:0,tmlen=tm?tm.length:0,hasDashDate=dt&&"-"==dt[0]&&"-"==dt[1],hasDashTime=tm&&"-"==tm[0],o={year:hasDashDate?null:part(dt,0,4),month:!hasDashDate||4!=dtlen&&7!=dtlen?7==dtlen||10==dtlen?part(dt,5,2):null:part(dt,2,2),day:5==dtlen?part(dt,3,2):7==dtlen&&hasDashDate?part(dt,5,2):10==dtlen?part(dt,8,2):null,hour:hasDashTime?null:part(tm,0,2),minute:hasDashTime&&3==tmlen?part(tm,1,2):tmlen>4?part(tm,hasDashTime?1:3,2):null,second:4==tmlen?part(tm,2,2):6==tmlen?part(tm,4,2):8==tmlen?part(tm,6,2):null};return zone="Z"==zone?Timezone.utcTimezone:zone&&":"==zone[3]?UtcOffset.fromString(zone):null,new VCardTime(o,zone,aIcalType)}clone(){return new VCardTime(this._time,this.zone,this.icaltype)}_normalize(){return this}utcOffset(){return this.zone instanceof UtcOffset?this.zone.toSeconds():Time.prototype.utcOffset.apply(this,arguments)}toICALString(){return design$1.vcard.value[this.icaltype].toICAL(this.toString())}toString(){let zone,y=this.year,m=this.month,d=this.day,h2=this.hour,mm=this.minute,s2=this.second,hasMonth=null!==m,hasDay=null!==d,hasHour=null!==h2,hasMinute=null!==mm,hasSecond=null!==s2,datepart=(null!==y?pad2(y)+(hasMonth||hasDay?"-":""):hasMonth||hasDay?"--":"")+(hasMonth?pad2(m):"")+(hasDay?"-"+pad2(d):""),timepart=(hasHour?pad2(h2):"-")+(hasHour&&hasMinute?":":"")+(hasMinute?pad2(mm):"")+(hasHour||hasMinute?"":"-")+(hasMinute&&hasSecond?":":"")+(hasSecond?pad2(s2):"");if(this.zone===Timezone.utcTimezone)zone="Z";else if(this.zone instanceof UtcOffset)zone=this.zone.toString();else if(this.zone===Timezone.localTimezone)zone="";else if(this.zone instanceof Timezone){zone=UtcOffset.fromSeconds(this.zone.utcOffset(this)).toString()}else zone="";switch(this.icaltype){case"time":return timepart+zone;case"date-and-or-time":case"date-time":return datepart+("--"==timepart?"":"T"+timepart+zone);case"date":return datepart}return null}}const _RecurIterator=class _RecurIterator{constructor(options){__publicField(this,"completed",!1),__publicField(this,"rule",null),__publicField(this,"dtstart",null),__publicField(this,"last",null),__publicField(this,"occurrence_number",0),__publicField(this,"by_indices",null),__publicField(this,"initialized",!1),__publicField(this,"by_data",null),__publicField(this,"days",null),__publicField(this,"days_index",0),this.fromData(options)}fromData(options){if(this.rule=formatClassType(options.rule,Recur),!this.rule)throw new Error("iterator requires a (ICAL.Recur) rule");if(this.dtstart=formatClassType(options.dtstart,Time),!this.dtstart)throw new Error("iterator requires a (ICAL.Time) dtstart");if(options.by_data?this.by_data=options.by_data:this.by_data=clone(this.rule.parts,!0),options.occurrence_number&&(this.occurrence_number=options.occurrence_number),this.days=options.days||[],options.last&&(this.last=formatClassType(options.last,Time)),this.by_indices=options.by_indices,this.by_indices||(this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}),this.initialized=options.initialized||!1,!this.initialized)try{this.init()}catch(e){if(!(e instanceof InvalidRecurrenceRuleError))throw e;this.completed=!0}}init(){this.initialized=!0,this.last=this.dtstart.clone();let parts=this.by_data;if("BYDAY"in parts&&this.sort_byday_rules(parts.BYDAY),"BYYEARDAY"in parts&&("BYMONTH"in parts||"BYWEEKNO"in parts||"BYMONTHDAY"in parts||"BYDAY"in parts))throw new Error("Invalid BYYEARDAY rule");if("BYWEEKNO"in parts&&"BYMONTHDAY"in parts)throw new Error("BYWEEKNO does not fit to BYMONTHDAY");if("MONTHLY"==this.rule.freq&&("BYYEARDAY"in parts||"BYWEEKNO"in parts))throw new Error("For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear");if("WEEKLY"==this.rule.freq&&("BYYEARDAY"in parts||"BYMONTHDAY"in parts))throw new Error("For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear");if("YEARLY"!=this.rule.freq&&"BYYEARDAY"in parts)throw new Error("BYYEARDAY may only appear in YEARLY rules");if(this.last.second=this.setup_defaults("BYSECOND","SECONDLY",this.dtstart.second),this.last.minute=this.setup_defaults("BYMINUTE","MINUTELY",this.dtstart.minute),this.last.hour=this.setup_defaults("BYHOUR","HOURLY",this.dtstart.hour),this.last.day=this.setup_defaults("BYMONTHDAY","DAILY",this.dtstart.day),this.last.month=this.setup_defaults("BYMONTH","MONTHLY",this.dtstart.month),"WEEKLY"==this.rule.freq)if("BYDAY"in parts){let[,dow]=this.ruleDayOfWeek(parts.BYDAY[0],this.rule.wkst),wkdy=dow-this.last.dayOfWeek(this.rule.wkst);(this.last.dayOfWeek(this.rule.wkst)<dow&&wkdy>=0||wkdy<0)&&(this.last.day+=wkdy)}else{let dayName=Recur.numericDayToIcalDay(this.dtstart.dayOfWeek());parts.BYDAY=[dayName]}if("YEARLY"==this.rule.freq){const untilYear=this.rule.until?this.rule.until.year:2e4;for(;this.last.year<=untilYear&&(this.expand_year_days(this.last.year),!(this.days.length>0));)this.increment_year(this.rule.interval);if(0==this.days.length)throw new InvalidRecurrenceRuleError;this._nextByYearDay()}if("MONTHLY"==this.rule.freq)if(this.has_by_data("BYDAY")){let tempLast=null,initLast=this.last.clone(),daysInMonth2=Time.daysInMonth(this.last.month,this.last.year);for(let bydow of this.by_data.BYDAY){this.last=initLast.clone();let[pos,dow]=this.ruleDayOfWeek(bydow),dayOfMonth=this.last.nthWeekDay(dow,pos);if(pos>=6||pos<=-6)throw new Error("Malformed values in BYDAY part");if(dayOfMonth>daysInMonth2||dayOfMonth<=0){if(tempLast&&tempLast.month==initLast.month)continue;for(;dayOfMonth>daysInMonth2||dayOfMonth<=0;)this.increment_month(),daysInMonth2=Time.daysInMonth(this.last.month,this.last.year),dayOfMonth=this.last.nthWeekDay(dow,pos)}this.last.day=dayOfMonth,(!tempLast||this.last.compare(tempLast)<0)&&(tempLast=this.last.clone())}if(this.last=tempLast.clone(),this.has_by_data("BYMONTHDAY")&&this._byDayAndMonthDay(!0),this.last.day>daysInMonth2||0==this.last.day)throw new Error("Malformed values in BYDAY part")}else if(this.has_by_data("BYMONTHDAY")){this.last.day=1;let normalized=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY).filter(d=>d>=this.last.day);if(normalized.length)this.last.day=normalized[0],this.by_data.BYMONTHDAY=normalized;else if(!this.next_month()&&!this.next_month()&&!this.next_month())throw new Error("No possible occurrences")}}next(again=!1){let valid,before=this.last?this.last.clone():null;if((this.rule.count&&this.occurrence_number>=this.rule.count||this.rule.until&&this.last.compare(this.rule.until)>0)&&(this.completed=!0),this.completed)return null;if(0==this.occurrence_number&&this.last.compare(this.dtstart)>=0)return this.occurrence_number++,this.last;do{switch(valid=1,this.rule.freq){case"SECONDLY":this.next_second();break;case"MINUTELY":this.next_minute();break;case"HOURLY":this.next_hour();break;case"DAILY":this.next_day();break;case"WEEKLY":this.next_week();break;case"MONTHLY":valid=this.next_month();break;case"YEARLY":this.next_year();break;default:return null}}while(!this.check_contracting_rules()||this.last.compare(this.dtstart)<0||!valid);if(0==this.last.compare(before)){if(again)throw new Error("Same occurrence found twice, protecting you from death by recursion");this.next(!0)}return this.rule.until&&this.last.compare(this.rule.until)>0?(this.completed=!0,null):(this.occurrence_number++,this.last)}next_second(){return this.next_generic("BYSECOND","SECONDLY","second","minute")}increment_second(inc){return this.increment_generic(inc,"second",60,"minute")}next_minute(){return this.next_generic("BYMINUTE","MINUTELY","minute","hour","next_second")}increment_minute(inc){return this.increment_generic(inc,"minute",60,"hour")}next_hour(){return this.next_generic("BYHOUR","HOURLY","hour","monthday","next_minute")}increment_hour(inc){this.increment_generic(inc,"hour",24,"monthday")}next_day(){let this_freq="DAILY"==this.rule.freq;return 0==this.next_hour()||(this_freq?this.increment_monthday(this.rule.interval):this.increment_monthday(1)),0}next_week(){let end_of_data=0;if(0==this.next_weekday_by_week())return end_of_data;if(this.has_by_data("BYWEEKNO")){this.by_indices.BYWEEKNO++,this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length&&(this.by_indices.BYWEEKNO=0,end_of_data=1),this.last.month=1,this.last.day=1;let week_no=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*week_no,end_of_data&&this.increment_year(1)}else this.increment_monthday(7*this.rule.interval);return end_of_data}normalizeByMonthDayRules(year2,month,rules){let rule,daysInMonth2=Time.daysInMonth(month,year2),newRules=[],ruleIdx=0,len=rules.length;for(;ruleIdx<len;ruleIdx++){if(rule=parseInt(rules[ruleIdx],10),isNaN(rule))throw new Error("Invalid BYMONTHDAY value");if(!(Math.abs(rule)>daysInMonth2)){if(rule<0)rule=daysInMonth2+(rule+1);else if(0===rule)continue;-1===newRules.indexOf(rule)&&newRules.push(rule)}}return newRules.sort(function(a,b){return a-b})}_byDayAndMonthDay(isInit){let byMonthDay,date,dateLen,daysInMonth2,byDay=this.by_data.BYDAY,dateIdx=0,dayLen=byDay.length,dataIsValid=0,self2=this,lastDay=this.last.day;function initMonth(){for(daysInMonth2=Time.daysInMonth(self2.last.month,self2.last.year),byMonthDay=self2.normalizeByMonthDayRules(self2.last.year,self2.last.month,self2.by_data.BYMONTHDAY),dateLen=byMonthDay.length;byMonthDay[dateIdx]<=lastDay&&(!isInit||byMonthDay[dateIdx]!=lastDay)&&dateIdx<dateLen-1;)dateIdx++}function nextMonth(){lastDay=0,self2.increment_month(),dateIdx=0,initMonth()}initMonth(),isInit&&(lastDay-=1);let monthsCounter=48;for(;!dataIsValid&&monthsCounter;){if(monthsCounter--,date=lastDay+1,date>daysInMonth2){nextMonth();continue}let next=byMonthDay[dateIdx++];if(next>=date){lastDay=next;for(let dayIdx=0;dayIdx<dayLen;dayIdx++){let parts=this.ruleDayOfWeek(byDay[dayIdx]),pos=parts[0],dow=parts[1];if(this.last.day=lastDay,this.last.isNthWeekDay(dow,pos)){dataIsValid=1;break}}dataIsValid||dateIdx!==dateLen||nextMonth()}else nextMonth()}if(monthsCounter<=0)throw new Error("Malformed values in BYDAY combined with BYMONTHDAY parts");return dataIsValid}next_month(){let data_valid=1;if(0==this.next_hour())return data_valid;if(this.has_by_data("BYDAY")&&this.has_by_data("BYMONTHDAY"))data_valid=this._byDayAndMonthDay();else if(this.has_by_data("BYDAY")){let day,daysInMonth2=Time.daysInMonth(this.last.month,this.last.year),setpos=0,setpos_total=0;if(this.has_by_data("BYSETPOS")){let last_day=this.last.day;for(let day2=1;day2<=daysInMonth2;day2++)this.last.day=day2,this.is_day_in_byday(this.last)&&(setpos_total++,day2<=last_day&&setpos++);this.last.day=last_day}for(data_valid=0,day=this.last.day+1;day<=daysInMonth2;day++)if(this.last.day=day,this.is_day_in_byday(this.last)&&(!this.has_by_data("BYSETPOS")||this.check_set_position(++setpos)||this.check_set_position(setpos-setpos_total-1))){data_valid=1;break}day>daysInMonth2&&(this.last.day=1,this.increment_month(),this.is_day_in_byday(this.last)?this.has_by_data("BYSETPOS")&&!this.check_set_position(1)||(data_valid=1):data_valid=0)}else if(this.has_by_data("BYMONTHDAY")){if(this.by_indices.BYMONTHDAY++,this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length&&(this.by_indices.BYMONTHDAY=0,this.increment_month(),this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length))return 0;let daysInMonth2=Time.daysInMonth(this.last.month,this.last.year),day=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];day<0&&(day=daysInMonth2+day+1),day>daysInMonth2?(this.last.day=1,data_valid=this.is_day_in_byday(this.last)):this.last.day=day}else{this.increment_month();let daysInMonth2=Time.daysInMonth(this.last.month,this.last.year);this.by_data.BYMONTHDAY[0]>daysInMonth2?data_valid=0:this.last.day=this.by_data.BYMONTHDAY[0]}return data_valid}next_weekday_by_week(){let end_of_data=0;if(0==this.next_hour())return end_of_data;if(!this.has_by_data("BYDAY"))return 1;for(;;){let tt2=new Time;this.by_indices.BYDAY++,this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length&&(this.by_indices.BYDAY=0,end_of_data=1);let coded_day=this.by_data.BYDAY[this.by_indices.BYDAY],dow=this.ruleDayOfWeek(coded_day)[1];dow-=this.rule.wkst,dow<0&&(dow+=7),tt2.year=this.last.year,tt2.month=this.last.month,tt2.day=this.last.day;let startOfWeek=tt2.startDoyWeek(this.rule.wkst);if(dow+startOfWeek<1&&!end_of_data)continue;let next=Time.fromDayOfYear(startOfWeek+dow,this.last.year);return this.last.year=next.year,this.last.month=next.month,this.last.day=next.day,end_of_data}}next_year(){if(0==this.next_hour())return 0;if(++this.days_index==this.days.length){this.days_index=0;do{this.increment_year(this.rule.interval),this.has_by_data("BYMONTHDAY")&&(this.by_data.BYMONTHDAY=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY)),this.expand_year_days(this.last.year)}while(0==this.days.length)}return this._nextByYearDay(),1}_nextByYearDay(){let doy=this.days[this.days_index],year2=this.last.year;doy<1&&(doy+=1,year2+=1);let next=Time.fromDayOfYear(doy,year2);this.last.day=next.day,this.last.month=next.month}ruleDayOfWeek(dow,aWeekStart){let matches=dow.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);if(matches){return[parseInt(matches[1]||0,10),dow=Recur.icalDayToNumericDay(matches[2],aWeekStart)]}return[0,0]}next_generic(aRuleType,aInterval,aDateAttr,aFollowingAttr,aPreviousIncr){let has_by_rule=aRuleType in this.by_data,this_freq=this.rule.freq==aInterval,end_of_data=0;if(aPreviousIncr&&0==this[aPreviousIncr]())return end_of_data;if(has_by_rule){this.by_indices[aRuleType]++;let dta=this.by_data[aRuleType];this.by_indices[aRuleType]==dta.length&&(this.by_indices[aRuleType]=0,end_of_data=1),this.last[aDateAttr]=dta[this.by_indices[aRuleType]]}else this_freq&&this["increment_"+aDateAttr](this.rule.interval);return has_by_rule&&end_of_data&&this_freq&&this["increment_"+aFollowingAttr](1),end_of_data}increment_monthday(inc){for(let i=0;i<inc;i++){let daysInMonth2=Time.daysInMonth(this.last.month,this.last.year);this.last.day++,this.last.day>daysInMonth2&&(this.last.day-=daysInMonth2,this.increment_month())}}increment_month(){if(this.last.day=1,this.has_by_data("BYMONTH"))this.by_indices.BYMONTH++,this.by_indices.BYMONTH==this.by_data.BYMONTH.length&&(this.by_indices.BYMONTH=0,this.increment_year(1)),this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH];else{"MONTHLY"==this.rule.freq?this.last.month+=this.rule.interval:this.last.month++,this.last.month--;let years=trunc(this.last.month/12);this.last.month%=12,this.last.month++,0!=years&&this.increment_year(years)}this.has_by_data("BYMONTHDAY")&&(this.by_data.BYMONTHDAY=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY))}increment_year(inc){this.last.day=1,this.last.year+=inc}increment_generic(inc,aDateAttr,aFactor,aNextIncrement){this.last[aDateAttr]+=inc;let nextunit=trunc(this.last[aDateAttr]/aFactor);this.last[aDateAttr]%=aFactor,0!=nextunit&&this["increment_"+aNextIncrement](nextunit)}has_by_data(aRuleType){return aRuleType in this.rule.parts}expand_year_days(aYear){let t=new Time;this.days=[];let parts={},rules=["BYDAY","BYWEEKNO","BYMONTHDAY","BYMONTH","BYYEARDAY"];for(let part of rules)part in this.rule.parts&&(parts[part]=this.rule.parts[part]);if("BYMONTH"in parts&&"BYWEEKNO"in parts){let valid=1,validWeeks={};t.year=aYear,t.isDate=!0;for(let monthIdx=0;monthIdx<this.by_data.BYMONTH.length;monthIdx++){let month=this.by_data.BYMONTH[monthIdx];t.month=month,t.day=1;let first_week=t.weekNumber(this.rule.wkst);t.day=Time.daysInMonth(month,aYear);let last_week=t.weekNumber(this.rule.wkst);for(monthIdx=first_week;monthIdx<last_week;monthIdx++)validWeeks[monthIdx]=1}for(let weekIdx=0;weekIdx<this.by_data.BYWEEKNO.length&&valid;weekIdx++){this.by_data.BYWEEKNO[weekIdx]<52?valid&=validWeeks[weekIdx]:valid=0}valid?delete parts.BYMONTH:delete parts.BYWEEKNO}let partCount=Object.keys(parts).length;if(0==partCount){let t1=this.dtstart.clone();t1.year=this.last.year,this.days.push(t1.dayOfYear())}else if(1==partCount&&"BYMONTH"in parts)for(let month of this.by_data.BYMONTH){let t2=this.dtstart.clone();t2.year=aYear,t2.month=month,t2.isDate=!0,this.days.push(t2.dayOfYear())}else if(1==partCount&&"BYMONTHDAY"in parts)for(let monthday of this.by_data.BYMONTHDAY){let t3=this.dtstart.clone();if(monthday<0){monthday=monthday+Time.daysInMonth(t3.month,aYear)+1}t3.day=monthday,t3.year=aYear,t3.isDate=!0,this.days.push(t3.dayOfYear())}else if(2==partCount&&"BYMONTHDAY"in parts&&"BYMONTH"in parts)for(let month of this.by_data.BYMONTH){let daysInMonth2=Time.daysInMonth(month,aYear);for(let monthday of this.by_data.BYMONTHDAY)monthday<0&&(monthday=monthday+daysInMonth2+1),t.day=monthday,t.month=month,t.year=aYear,t.isDate=!0,this.days.push(t.dayOfYear())}else if(1==partCount&&"BYWEEKNO"in parts);else if(2==partCount&&"BYWEEKNO"in parts&&"BYMONTHDAY"in parts);else if(1==partCount&&"BYDAY"in parts)this.days=this.days.concat(this.expand_by_day(aYear));else if(2==partCount&&"BYDAY"in parts&&"BYMONTH"in parts){for(let month of this.by_data.BYMONTH){let daysInMonth2=Time.daysInMonth(month,aYear);t.year=aYear,t.month=month,t.day=1,t.isDate=!0;let first_dow=t.dayOfWeek(),doy_offset=t.dayOfYear()-1;t.day=daysInMonth2;let last_dow=t.dayOfWeek();if(this.has_by_data("BYSETPOS")){let by_month_day=[];for(let day=1;day<=daysInMonth2;day++)t.day=day,this.is_day_in_byday(t)&&by_month_day.push(day);for(let spIndex=0;spIndex<by_month_day.length;spIndex++)(this.check_set_position(spIndex+1)||this.check_set_position(spIndex-by_month_day.length))&&this.days.push(doy_offset+by_month_day[spIndex])}else for(let coded_day of this.by_data.BYDAY){let month_day,bydayParts=this.ruleDayOfWeek(coded_day),pos=bydayParts[0],dow=bydayParts[1],first_matching_day=(dow+7-first_dow)%7+1,last_matching_day=daysInMonth2-(last_dow+7-dow)%7;if(0==pos)for(let day=first_matching_day;day<=daysInMonth2;day+=7)this.days.push(doy_offset+day);else pos>0?(month_day=first_matching_day+7*(pos-1),month_day<=daysInMonth2&&this.days.push(doy_offset+month_day)):(month_day=last_matching_day+7*(pos+1),month_day>0&&this.days.push(doy_offset+month_day))}}this.days.sort(function(a,b){return a-b})}else if(2==partCount&&"BYDAY"in parts&&"BYMONTHDAY"in parts){let expandedDays=this.expand_by_day(aYear);for(let day of expandedDays){let tt2=Time.fromDayOfYear(day,aYear);this.by_data.BYMONTHDAY.indexOf(tt2.day)>=0&&this.days.push(day)}}else if(3==partCount&&"BYDAY"in parts&&"BYMONTHDAY"in parts&&"BYMONTH"in parts){let expandedDays=this.expand_by_day(aYear);for(let day of expandedDays){let tt2=Time.fromDayOfYear(day,aYear);this.by_data.BYMONTH.indexOf(tt2.month)>=0&&this.by_data.BYMONTHDAY.indexOf(tt2.day)>=0&&this.days.push(day)}}else if(2==partCount&&"BYDAY"in parts&&"BYWEEKNO"in parts){let expandedDays=this.expand_by_day(aYear);for(let day of expandedDays){let weekno=Time.fromDayOfYear(day,aYear).weekNumber(this.rule.wkst);this.by_data.BYWEEKNO.indexOf(weekno)&&this.days.push(day)}}else 3==partCount&&"BYDAY"in parts&&"BYWEEKNO"in parts&&"BYMONTHDAY"in parts||(this.days=1==partCount&&"BYYEARDAY"in parts?this.days.concat(this.by_data.BYYEARDAY):[]);let daysInYear2=Time.isLeapYear(aYear)?366:365;return this.days.sort((a,b)=>(a<0&&(a+=daysInYear2+1),b<0&&(b+=daysInYear2+1),a-b)),0}expand_by_day(aYear){let days_list=[],tmp=this.last.clone();tmp.year=aYear,tmp.month=1,tmp.day=1,tmp.isDate=!0;let start_dow=tmp.dayOfWeek();tmp.month=12,tmp.day=31,tmp.isDate=!0;let end_dow=tmp.dayOfWeek(),end_year_day=tmp.dayOfYear();for(let day of this.by_data.BYDAY){let parts=this.ruleDayOfWeek(day),pos=parts[0],dow=parts[1];if(0==pos){for(let doy=(dow+7-start_dow)%7+1;doy<=end_year_day;doy+=7)days_list.push(doy)}else if(pos>0){let first;first=dow>=start_dow?dow-start_dow+1:dow-start_dow+8,days_list.push(first+7*(pos-1))}else{let last;pos=-pos,last=dow<=end_dow?end_year_day-end_dow+dow:end_year_day-end_dow+dow-7,days_list.push(last-7*(pos-1))}}return days_list}is_day_in_byday(tt2){if(this.by_data.BYDAY)for(let day of this.by_data.BYDAY){let parts=this.ruleDayOfWeek(day),pos=parts[0],dow=parts[1],this_dow=tt2.dayOfWeek();if(0==pos&&dow==this_dow||tt2.nthWeekDay(dow,pos)==tt2.day)return 1}return 0}check_set_position(aPos){if(this.has_by_data("BYSETPOS")){return-1!==this.by_data.BYSETPOS.indexOf(aPos)}return!1}sort_byday_rules(aRules){for(let i=0;i<aRules.length;i++)for(let j=0;j<i;j++){if(this.ruleDayOfWeek(aRules[j],this.rule.wkst)[1]>this.ruleDayOfWeek(aRules[i],this.rule.wkst)[1]){let tmp=aRules[i];aRules[i]=aRules[j],aRules[j]=tmp}}}check_contract_restriction(aRuleType,v){let indexMapValue=_RecurIterator._indexMap[aRuleType],ruleMapValue=_RecurIterator._expandMap[this.rule.freq][indexMapValue],pass=!1;if(aRuleType in this.by_data&&ruleMapValue==_RecurIterator.CONTRACT){let ruleType=this.by_data[aRuleType];for(let bydata of ruleType)if(bydata==v){pass=!0;break}}else pass=!0;return pass}check_contracting_rules(){let dow=this.last.dayOfWeek(),weekNo=this.last.weekNumber(this.rule.wkst),doy=this.last.dayOfYear();return this.check_contract_restriction("BYSECOND",this.last.second)&&this.check_contract_restriction("BYMINUTE",this.last.minute)&&this.check_contract_restriction("BYHOUR",this.last.hour)&&this.check_contract_restriction("BYDAY",Recur.numericDayToIcalDay(dow))&&this.check_contract_restriction("BYWEEKNO",weekNo)&&this.check_contract_restriction("BYMONTHDAY",this.last.day)&&this.check_contract_restriction("BYMONTH",this.last.month)&&this.check_contract_restriction("BYYEARDAY",doy)}setup_defaults(aRuleType,req,deftime){let indexMapValue=_RecurIterator._indexMap[aRuleType];return _RecurIterator._expandMap[this.rule.freq][indexMapValue]!=_RecurIterator.CONTRACT&&(aRuleType in this.by_data||(this.by_data[aRuleType]=[deftime]),this.rule.freq!=req)?this.by_data[aRuleType][0]:deftime}toJSON(){let result=Object.create(null);return result.initialized=this.initialized,result.rule=this.rule.toJSON(),result.dtstart=this.dtstart.toJSON(),result.by_data=this.by_data,result.days=this.days,result.last=this.last.toJSON(),result.by_indices=this.by_indices,result.occurrence_number=this.occurrence_number,result}};__publicField(_RecurIterator,"_indexMap",{BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8}),__publicField(_RecurIterator,"_expandMap",{SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]}),__publicField(_RecurIterator,"UNKNOWN",0),__publicField(_RecurIterator,"CONTRACT",1),__publicField(_RecurIterator,"EXPAND",2),__publicField(_RecurIterator,"ILLEGAL",3);let RecurIterator=_RecurIterator;class InvalidRecurrenceRuleError extends Error{constructor(){super("Recurrence rule has no valid occurrences")}}const VALID_DAY_NAMES=/^(SU|MO|TU|WE|TH|FR|SA)$/,VALID_BYDAY_PART=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/,DOW_MAP={SU:Time.SUNDAY,MO:Time.MONDAY,TU:Time.TUESDAY,WE:Time.WEDNESDAY,TH:Time.THURSDAY,FR:Time.FRIDAY,SA:Time.SATURDAY},REVERSE_DOW_MAP=Object.fromEntries(Object.entries(DOW_MAP).map(entry=>entry.reverse())),ALLOWED_FREQ=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"];class Recur{constructor(data){__publicField(this,"parts",null),__publicField(this,"interval",1),__publicField(this,"wkst",Time.MONDAY),__publicField(this,"until",null),__publicField(this,"count",null),__publicField(this,"freq",null),__publicField(this,"icalclass","icalrecur"),__publicField(this,"icaltype","recur"),this.wrappedJSObject=this,this.parts={},data&&"object"==typeof data&&this.fromData(data)}static fromString(string2){let data=this._stringToData(string2,!1);return new Recur(data)}static fromData(aData){return new Recur(aData)}static _stringToData(string2,fmtIcal){let dict=Object.create(null),values=string2.split(";"),len=values.length;for(let i=0;i<len;i++){let parts=values[i].split("="),ucname=parts[0].toUpperCase(),lcname=parts[0].toLowerCase(),name=fmtIcal?lcname:ucname,value=parts[1];if(ucname in partDesign){let partArr=value.split(","),partSet=new Set;for(let part of partArr)partSet.add(partDesign[ucname](part));partArr=[...partSet],dict[name]=1==partArr.length?partArr[0]:partArr}else ucname in optionDesign?optionDesign[ucname](value,dict,fmtIcal):dict[lcname]=value}return dict}static icalDayToNumericDay(string2,aWeekStart){let firstDow=aWeekStart||Time.SUNDAY;return(DOW_MAP[string2]-firstDow+7)%7+1}static numericDayToIcalDay(num,aWeekStart){let dow=num+(aWeekStart||Time.SUNDAY)-Time.SUNDAY;return dow>7&&(dow-=7),REVERSE_DOW_MAP[dow]}iterator(aStart){return new RecurIterator({rule:this,dtstart:aStart})}clone(){return new Recur(this.toJSON())}isFinite(){return!(!this.count&&!this.until)}isByCount(){return!(!this.count||this.until)}addComponent(aType,aValue){let ucname=aType.toUpperCase();ucname in this.parts?this.parts[ucname].push(aValue):this.parts[ucname]=[aValue]}setComponent(aType,aValues){this.parts[aType.toUpperCase()]=aValues.slice()}getComponent(aType){let ucname=aType.toUpperCase();return ucname in this.parts?this.parts[ucname].slice():[]}getNextOccurrence(aStartTime,aRecurrenceId){let next,iter2=this.iterator(aStartTime);do{next=iter2.next()}while(next&&next.compare(aRecurrenceId)<=0);return next&&aRecurrenceId.zone&&(next.zone=aRecurrenceId.zone),next}fromData(data){for(let key in data){let uckey=key.toUpperCase();uckey in partDesign?Array.isArray(data[key])?this.parts[uckey]=data[key]:this.parts[uckey]=[data[key]]:this[key]=data[key]}this.interval&&"number"!=typeof this.interval&&optionDesign.INTERVAL(this.interval,this),this.wkst&&"number"!=typeof this.wkst&&(this.wkst=Recur.icalDayToNumericDay(this.wkst)),!this.until||this.until instanceof Time||(this.until=Time.fromString(this.until))}toJSON(){let res=Object.create(null);res.freq=this.freq,this.count&&(res.count=this.count),this.interval>1&&(res.interval=this.interval);for(let[k,kparts]of Object.entries(this.parts))Array.isArray(kparts)&&1==kparts.length?res[k.toLowerCase()]=kparts[0]:res[k.toLowerCase()]=clone(kparts);return this.until&&(res.until=this.until.toString()),"wkst"in this&&this.wkst!==Time.DEFAULT_WEEK_START&&(res.wkst=Recur.numericDayToIcalDay(this.wkst)),res}toString(){let str="FREQ="+this.freq;this.count&&(str+=";COUNT="+this.count),this.interval>1&&(str+=";INTERVAL="+this.interval);for(let[k,v]of Object.entries(this.parts))str+=";"+k+"="+v;return this.until&&(str+=";UNTIL="+this.until.toICALString()),"wkst"in this&&this.wkst!==Time.DEFAULT_WEEK_START&&(str+=";WKST="+Recur.numericDayToIcalDay(this.wkst)),str}}function parseNumericValue(type,min,max,value){let result=value;if("+"===value[0]&&(result=value.slice(1)),result=strictParseInt(result),void 0!==min&&value<min)throw new Error(type+': invalid value "'+value+'" must be > '+min);if(void 0!==max&&value>max)throw new Error(type+': invalid value "'+value+'" must be < '+min);return result}const optionDesign={FREQ:function(value,dict,fmtIcal){if(-1===ALLOWED_FREQ.indexOf(value))throw new Error('invalid frequency "'+value+'" expected: "'+ALLOWED_FREQ.join(", ")+'"');dict.freq=value},COUNT:function(value,dict,fmtIcal){dict.count=strictParseInt(value)},INTERVAL:function(value,dict,fmtIcal){dict.interval=strictParseInt(value),dict.interval<1&&(dict.interval=1)},UNTIL:function(value,dict,fmtIcal){value.length>10?dict.until=design$1.icalendar.value["date-time"].fromICAL(value):dict.until=design$1.icalendar.value.date.fromICAL(value),fmtIcal||(dict.until=Time.fromString(dict.until))},WKST:function(value,dict,fmtIcal){if(!VALID_DAY_NAMES.test(value))throw new Error('invalid WKST value "'+value+'"');dict.wkst=Recur.icalDayToNumericDay(value)}},partDesign={BYSECOND:parseNumericValue.bind(void 0,"BYSECOND",0,60),BYMINUTE:parseNumericValue.bind(void 0,"BYMINUTE",0,59),BYHOUR:parseNumericValue.bind(void 0,"BYHOUR",0,23),BYDAY:function(value){if(VALID_BYDAY_PART.test(value))return value;throw new Error('invalid BYDAY value "'+value+'"')},BYMONTHDAY:parseNumericValue.bind(void 0,"BYMONTHDAY",-31,31),BYYEARDAY:parseNumericValue.bind(void 0,"BYYEARDAY",-366,366),BYWEEKNO:parseNumericValue.bind(void 0,"BYWEEKNO",-53,53),BYMONTH:parseNumericValue.bind(void 0,"BYMONTH",1,12),BYSETPOS:parseNumericValue.bind(void 0,"BYSETPOS",-366,366)};class Period{constructor(aData){if(__publicField(this,"start",null),__publicField(this,"end",null),__publicField(this,"duration",null),__publicField(this,"icalclass","icalperiod"),__publicField(this,"icaltype","period"),this.wrappedJSObject=this,aData&&"start"in aData){if(aData.start&&!(aData.start instanceof Time))throw new TypeError(".start must be an instance of ICAL.Time");this.start=aData.start}if(aData&&aData.end&&aData.duration)throw new Error("cannot accept both end and duration");if(aData&&"end"in aData){if(aData.end&&!(aData.end instanceof Time))throw new TypeError(".end must be an instance of ICAL.Time");this.end=aData.end}if(aData&&"duration"in aData){if(aData.duration&&!(aData.duration instanceof Duration))throw new TypeError(".duration must be an instance of ICAL.Duration");this.duration=aData.duration}}static fromString(str,prop){let parts=str.split("/");if(2!==parts.length)throw new Error('Invalid string value: "'+str+'" must contain a "/" char.');let options={start:Time.fromDateTimeString(parts[0],prop)},end=parts[1];return Duration.isValueString(end)?options.duration=Duration.fromString(end):options.end=Time.fromDateTimeString(end,prop),new Period(options)}static fromData(aData){return new Period(aData)}static fromJSON(aData,aProp,aLenient){function fromDateOrDateTimeString(aValue,dateProp){return aLenient?Time.fromString(aValue,dateProp):Time.fromDateTimeString(aValue,dateProp)}return Duration.isValueString(aData[1])?Period.fromData({start:fromDateOrDateTimeString(aData[0],aProp),duration:Duration.fromString(aData[1])}):Period.fromData({start:fromDateOrDateTimeString(aData[0],aProp),end:fromDateOrDateTimeString(aData[1],aProp)})}clone(){return Period.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})}getDuration(){return this.duration?this.duration:this.end.subtractDate(this.start)}getEnd(){if(this.end)return this.end;{let end=this.start.clone();return end.addDuration(this.duration),end}}toString(){return this.start+"/"+(this.end||this.duration)}toJSON(){return[this.start.toString(),(this.end||this.duration).toString()]}toICALString(){return this.start.toICALString()+"/"+(this.end||this.duration).toICALString()}}const FROM_VCARD_NEWLINE=/\\\\|\\,|\\[Nn]/g,TO_VCARD_NEWLINE=/\\|,|\n/g;function createTextType(fromNewline,toNewline){return{matches:/.*/,fromICAL:function(aValue,structuredEscape){return function(value,newline,structuredEscape){if(-1===value.indexOf("\\"))return value;structuredEscape&&(newline=new RegExp(newline.source+"|\\\\"+structuredEscape,newline.flags));return value.replace(newline,replaceNewlineReplace)}(aValue,fromNewline,structuredEscape)},toICAL:function(aValue,structuredEscape){let regEx=toNewline;return structuredEscape&&(regEx=new RegExp(regEx.source+"|"+structuredEscape,regEx.flags)),aValue.replace(regEx,function(str){switch(str){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case"\n":return"\\n";default:return str}})}}}const DEFAULT_TYPE_TEXT={defaultType:"text"},DEFAULT_TYPE_TEXT_MULTI={defaultType:"text",multiValue:","},DEFAULT_TYPE_TEXT_STRUCTURED={defaultType:"text",structuredValue:";"},DEFAULT_TYPE_INTEGER={defaultType:"integer"},DEFAULT_TYPE_DATETIME_DATE={defaultType:"date-time",allowedTypes:["date-time","date"]},DEFAULT_TYPE_DATETIME={defaultType:"date-time"},DEFAULT_TYPE_URI={defaultType:"uri"},DEFAULT_TYPE_UTCOFFSET={defaultType:"utc-offset"},DEFAULT_TYPE_RECUR={defaultType:"recur"},DEFAULT_TYPE_DATE_ANDOR_TIME={defaultType:"date-and-or-time",allowedTypes:["date-time","date","text"]};function replaceNewlineReplace(string2){switch(string2){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return"\n";default:return string2}}let commonProperties={categories:DEFAULT_TYPE_TEXT_MULTI,url:DEFAULT_TYPE_URI,version:DEFAULT_TYPE_TEXT,uid:DEFAULT_TYPE_TEXT},commonValues={boolean:{values:["TRUE","FALSE"],fromICAL:function(aValue){return"TRUE"===aValue},toICAL:function(aValue){return aValue?"TRUE":"FALSE"}},float:{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(aValue){let parsed=parseFloat(aValue);return isStrictlyNaN(parsed)?0:parsed},toICAL:function(aValue){return String(aValue)}},integer:{fromICAL:function(aValue){let parsed=parseInt(aValue);return isStrictlyNaN(parsed)?0:parsed},toICAL:function(aValue){return String(aValue)}},"utc-offset":{toICAL:function(aValue){return aValue.length<7?aValue.slice(0,3)+aValue.slice(4,6):aValue.slice(0,3)+aValue.slice(4,6)+aValue.slice(7,9)},fromICAL:function(aValue){return aValue.length<6?aValue.slice(0,3)+":"+aValue.slice(3,5):aValue.slice(0,3)+":"+aValue.slice(3,5)+":"+aValue.slice(5,7)},decorate:function(aValue){return UtcOffset.fromString(aValue)},undecorate:function(aValue){return aValue.toString()}}};const icalValues=extend(commonValues,{text:createTextType(/\\\\|\\;|\\,|\\[Nn]/g,/\\|;|,|\n/g),uri:{},binary:{decorate:function(aString){return Binary.fromString(aString)},undecorate:function(aBinary){return aBinary.toString()}},"cal-address":{},date:{decorate:function(aValue,aProp){return Time.fromDateString(aValue,aProp)},undecorate:function(aValue){return aValue.toString()},fromICAL:function(aValue){return aValue.slice(0,4)+"-"+aValue.slice(4,6)+"-"+aValue.slice(6,8)},toICAL:function(aValue){let len=aValue.length;return 10==len?aValue.slice(0,4)+aValue.slice(5,7)+aValue.slice(8,10):len>=19?icalValues["date-time"].toICAL(aValue):aValue}},"date-time":{fromICAL:function(aValue){{let result=aValue.slice(0,4)+"-"+aValue.slice(4,6)+"-"+aValue.slice(6,8)+"T"+aValue.slice(9,11)+":"+aValue.slice(11,13)+":"+aValue.slice(13,15);return aValue[15]&&"Z"===aValue[15]&&(result+="Z"),result}},toICAL:function(aValue){let len=aValue.length;if(10!=len||design.strict){if(len>=19){let result=aValue.slice(0,4)+aValue.slice(5,7)+aValue.slice(8,13)+aValue.slice(14,16)+aValue.slice(17,19);return aValue[19]&&"Z"===aValue[19]&&(result+="Z"),result}return aValue}return icalValues.date.toICAL(aValue)},decorate:function(aValue,aProp){return Time.fromDateTimeString(aValue,aProp)},undecorate:function(aValue){return aValue.toString()}},duration:{decorate:function(aValue){return Duration.fromString(aValue)},undecorate:function(aValue){return aValue.toString()}},period:{fromICAL:function(string2){let parts=string2.split("/");return parts[0]=icalValues["date-time"].fromICAL(parts[0]),Duration.isValueString(parts[1])||(parts[1]=icalValues["date-time"].fromICAL(parts[1])),parts},toICAL:function(parts){return(parts=parts.slice())[0]=icalValues["date-time"].toICAL(parts[0]),Duration.isValueString(parts[1])||(parts[1]=icalValues["date-time"].toICAL(parts[1])),parts.join("/")},decorate:function(aValue,aProp){return Period.fromJSON(aValue,aProp,!design.strict)},undecorate:function(aValue){return aValue.toJSON()}},recur:{fromICAL:function(string2){return Recur._stringToData(string2,!0)},toICAL:function(data){let str="";for(let[k,val]of Object.entries(data))"until"==k?val=val.length>10?icalValues["date-time"].toICAL(val):icalValues.date.toICAL(val):"wkst"==k?"number"==typeof val&&(val=Recur.numericDayToIcalDay(val)):Array.isArray(val)&&(val=val.join(",")),str+=k.toUpperCase()+"="+val+";";return str.slice(0,Math.max(0,str.length-1))},decorate:function(aValue){return Recur.fromData(aValue)},undecorate:function(aRecur){return aRecur.toJSON()}},time:{fromICAL:function(aValue){if(aValue.length<6)return aValue;let result=aValue.slice(0,2)+":"+aValue.slice(2,4)+":"+aValue.slice(4,6);return"Z"===aValue[6]&&(result+="Z"),result},toICAL:function(aValue){if(aValue.length<8)return aValue;let result=aValue.slice(0,2)+aValue.slice(3,5)+aValue.slice(6,8);return"Z"===aValue[8]&&(result+="Z"),result}}});let icalProperties=extend(commonProperties,{action:DEFAULT_TYPE_TEXT,attach:{defaultType:"uri"},attendee:{defaultType:"cal-address"},calscale:DEFAULT_TYPE_TEXT,class:DEFAULT_TYPE_TEXT,comment:DEFAULT_TYPE_TEXT,completed:DEFAULT_TYPE_DATETIME,contact:DEFAULT_TYPE_TEXT,created:DEFAULT_TYPE_DATETIME,description:DEFAULT_TYPE_TEXT,dtend:DEFAULT_TYPE_DATETIME_DATE,dtstamp:DEFAULT_TYPE_DATETIME,dtstart:DEFAULT_TYPE_DATETIME_DATE,due:DEFAULT_TYPE_DATETIME_DATE,duration:{defaultType:"duration"},exdate:{defaultType:"date-time",allowedTypes:["date-time","date"],multiValue:","},exrule:DEFAULT_TYPE_RECUR,freebusy:{defaultType:"period",multiValue:","},geo:{defaultType:"float",structuredValue:";"},"last-modified":DEFAULT_TYPE_DATETIME,location:DEFAULT_TYPE_TEXT,method:DEFAULT_TYPE_TEXT,organizer:{defaultType:"cal-address"},"percent-complete":DEFAULT_TYPE_INTEGER,priority:DEFAULT_TYPE_INTEGER,prodid:DEFAULT_TYPE_TEXT,"related-to":DEFAULT_TYPE_TEXT,repeat:DEFAULT_TYPE_INTEGER,rdate:{defaultType:"date-time",allowedTypes:["date-time","date","period"],multiValue:",",detectType:function(string2){return-1!==string2.indexOf("/")?"period":-1===string2.indexOf("T")?"date":"date-time"}},"recurrence-id":DEFAULT_TYPE_DATETIME_DATE,resources:DEFAULT_TYPE_TEXT_MULTI,"request-status":DEFAULT_TYPE_TEXT_STRUCTURED,rrule:DEFAULT_TYPE_RECUR,sequence:DEFAULT_TYPE_INTEGER,status:DEFAULT_TYPE_TEXT,summary:DEFAULT_TYPE_TEXT,transp:DEFAULT_TYPE_TEXT,trigger:{defaultType:"duration",allowedTypes:["duration","date-time"]},tzoffsetfrom:DEFAULT_TYPE_UTCOFFSET,tzoffsetto:DEFAULT_TYPE_UTCOFFSET,tzurl:DEFAULT_TYPE_URI,tzid:DEFAULT_TYPE_TEXT,tzname:DEFAULT_TYPE_TEXT});const vcardValues=extend(commonValues,{text:createTextType(FROM_VCARD_NEWLINE,TO_VCARD_NEWLINE),uri:createTextType(FROM_VCARD_NEWLINE,TO_VCARD_NEWLINE),date:{decorate:function(aValue){return VCardTime.fromDateAndOrTimeString(aValue,"date")},undecorate:function(aValue){return aValue.toString()},fromICAL:function(aValue){return 8==aValue.length?icalValues.date.fromICAL(aValue):"-"==aValue[0]&&6==aValue.length?aValue.slice(0,4)+"-"+aValue.slice(4):aValue},toICAL:function(aValue){return 10==aValue.length?icalValues.date.toICAL(aValue):"-"==aValue[0]&&7==aValue.length?aValue.slice(0,4)+aValue.slice(5):aValue}},time:{decorate:function(aValue){return VCardTime.fromDateAndOrTimeString("T"+aValue,"time")},undecorate:function(aValue){return aValue.toString()},fromICAL:function(aValue){let splitzone=vcardValues.time._splitZone(aValue,!0),zone=splitzone[0],value=splitzone[1];return 6==value.length?value=value.slice(0,2)+":"+value.slice(2,4)+":"+value.slice(4,6):4==value.length&&"-"!=value[0]?value=value.slice(0,2)+":"+value.slice(2,4):5==value.length&&(value=value.slice(0,3)+":"+value.slice(3,5)),5!=zone.length||"-"!=zone[0]&&"+"!=zone[0]||(zone=zone.slice(0,3)+":"+zone.slice(3)),value+zone},toICAL:function(aValue){let splitzone=vcardValues.time._splitZone(aValue),zone=splitzone[0],value=splitzone[1];return 8==value.length?value=value.slice(0,2)+value.slice(3,5)+value.slice(6,8):5==value.length&&"-"!=value[0]?value=value.slice(0,2)+value.slice(3,5):6==value.length&&(value=value.slice(0,3)+value.slice(4,6)),6!=zone.length||"-"!=zone[0]&&"+"!=zone[0]||(zone=zone.slice(0,3)+zone.slice(4)),value+zone},_splitZone:function(aValue,isFromIcal){let zone,value,lastChar=aValue.length-1,signChar=aValue.length-(isFromIcal?5:6),sign=aValue[signChar];return"Z"==aValue[lastChar]?(zone=aValue[lastChar],value=aValue.slice(0,Math.max(0,lastChar))):aValue.length>6&&("-"==sign||"+"==sign)?(zone=aValue.slice(signChar),value=aValue.slice(0,Math.max(0,signChar))):(zone="",value=aValue),[zone,value]}},"date-time":{decorate:function(aValue){return VCardTime.fromDateAndOrTimeString(aValue,"date-time")},undecorate:function(aValue){return aValue.toString()},fromICAL:function(aValue){return vcardValues["date-and-or-time"].fromICAL(aValue)},toICAL:function(aValue){return vcardValues["date-and-or-time"].toICAL(aValue)}},"date-and-or-time":{decorate:function(aValue){return VCardTime.fromDateAndOrTimeString(aValue,"date-and-or-time")},undecorate:function(aValue){return aValue.toString()},fromICAL:function(aValue){let parts=aValue.split("T");return(parts[0]?vcardValues.date.fromICAL(parts[0]):"")+(parts[1]?"T"+vcardValues.time.fromICAL(parts[1]):"")},toICAL:function(aValue){let parts=aValue.split("T");return vcardValues.date.toICAL(parts[0])+(parts[1]?"T"+vcardValues.time.toICAL(parts[1]):"")}},timestamp:icalValues["date-time"],"language-tag":{matches:/^[a-zA-Z0-9-]+$/},"phone-number":{fromICAL:function(aValue){return Array.from(aValue).filter(function(c){return"\\"===c?void 0:c}).join("")},toICAL:function(aValue){return Array.from(aValue).map(function(c){return","===c||";"===c?"\\"+c:c}).join("")}}});let vcardProperties=extend(commonProperties,{adr:{defaultType:"text",structuredValue:";",multiValue:","},anniversary:DEFAULT_TYPE_DATE_ANDOR_TIME,bday:DEFAULT_TYPE_DATE_ANDOR_TIME,caladruri:DEFAULT_TYPE_URI,caluri:DEFAULT_TYPE_URI,clientpidmap:DEFAULT_TYPE_TEXT_STRUCTURED,email:DEFAULT_TYPE_TEXT,fburl:DEFAULT_TYPE_URI,fn:DEFAULT_TYPE_TEXT,gender:DEFAULT_TYPE_TEXT_STRUCTURED,geo:DEFAULT_TYPE_URI,impp:DEFAULT_TYPE_URI,key:DEFAULT_TYPE_URI,kind:DEFAULT_TYPE_TEXT,lang:{defaultType:"language-tag"},logo:DEFAULT_TYPE_URI,member:DEFAULT_TYPE_URI,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:DEFAULT_TYPE_TEXT_MULTI,note:DEFAULT_TYPE_TEXT,org:{defaultType:"text",structuredValue:";"},photo:DEFAULT_TYPE_URI,related:DEFAULT_TYPE_URI,rev:{defaultType:"timestamp"},role:DEFAULT_TYPE_TEXT,sound:DEFAULT_TYPE_URI,source:DEFAULT_TYPE_URI,tel:{defaultType:"uri",allowedTypes:["uri","text"]},title:DEFAULT_TYPE_TEXT,tz:{defaultType:"text",allowedTypes:["text","utc-offset","uri"]},xml:DEFAULT_TYPE_TEXT}),vcard3Values=extend(commonValues,{binary:icalValues.binary,date:vcardValues.date,"date-time":vcardValues["date-time"],"phone-number":vcardValues["phone-number"],uri:icalValues.uri,text:icalValues.text,time:icalValues.time,vcard:icalValues.text,"utc-offset":{toICAL:function(aValue){return aValue.slice(0,7)},fromICAL:function(aValue){return aValue.slice(0,7)},decorate:function(aValue){return UtcOffset.fromString(aValue)},undecorate:function(aValue){return aValue.toString()}}}),vcard3Properties=extend(commonProperties,{fn:DEFAULT_TYPE_TEXT,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:DEFAULT_TYPE_TEXT_MULTI,photo:{defaultType:"binary",allowedTypes:["binary","uri"]},bday:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(string2){return-1===string2.indexOf("T")?"date":"date-time"}},adr:{defaultType:"text",structuredValue:";",multiValue:","},label:DEFAULT_TYPE_TEXT,tel:{defaultType:"phone-number"},email:DEFAULT_TYPE_TEXT,mailer:DEFAULT_TYPE_TEXT,tz:{defaultType:"utc-offset",allowedTypes:["utc-offset","text"]},geo:{defaultType:"float",structuredValue:";"},title:DEFAULT_TYPE_TEXT,role:DEFAULT_TYPE_TEXT,logo:{defaultType:"binary",allowedTypes:["binary","uri"]},agent:{defaultType:"vcard",allowedTypes:["vcard","text","uri"]},org:DEFAULT_TYPE_TEXT_STRUCTURED,note:DEFAULT_TYPE_TEXT_MULTI,prodid:DEFAULT_TYPE_TEXT,rev:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(string2){return-1===string2.indexOf("T")?"date":"date-time"}},"sort-string":DEFAULT_TYPE_TEXT,sound:{defaultType:"binary",allowedTypes:["binary","uri"]},class:DEFAULT_TYPE_TEXT,key:{defaultType:"binary",allowedTypes:["binary","text"]}}),icalSet={value:icalValues,param:{cutype:{values:["INDIVIDUAL","GROUP","RESOURCE","ROOM","UNKNOWN"],allowXName:!0,allowIanaToken:!0},"delegated-from":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},"delegated-to":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},encoding:{values:["8BIT","BASE64"]},fbtype:{values:["FREE","BUSY","BUSY-UNAVAILABLE","BUSY-TENTATIVE"],allowXName:!0,allowIanaToken:!0},member:{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},partstat:{values:["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN-PROCESS"],allowXName:!0,allowIanaToken:!0},range:{values:["THISANDFUTURE"]},related:{values:["START","END"]},reltype:{values:["PARENT","CHILD","SIBLING"],allowXName:!0,allowIanaToken:!0},role:{values:["REQ-PARTICIPANT","CHAIR","OPT-PARTICIPANT","NON-PARTICIPANT"],allowXName:!0,allowIanaToken:!0},rsvp:{values:["TRUE","FALSE"]},"sent-by":{valueType:"cal-address"},tzid:{matches:/^\//},value:{values:["binary","boolean","cal-address","date","date-time","duration","float","integer","period","recur","text","time","uri","utc-offset"],allowXName:!0,allowIanaToken:!0}},property:icalProperties,propertyGroups:!1},vcardSet={value:vcardValues,param:{type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","time","date-time","date-and-or-time","timestamp","boolean","integer","float","utc-offset","language-tag"],allowXName:!0,allowIanaToken:!0}},property:vcardProperties,propertyGroups:!0},vcard3Set={value:vcard3Values,param:{type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","date-time","phone-number","time","boolean","integer","float","utc-offset","vcard","binary"],allowXName:!0,allowIanaToken:!0}},property:vcard3Properties,propertyGroups:!0};const design={strict:!0,defaultSet:icalSet,defaultType:"unknown",components:{vcard:vcardSet,vcard3:vcard3Set,vevent:icalSet,vtodo:icalSet,vjournal:icalSet,valarm:icalSet,vtimezone:icalSet,daylight:icalSet,standard:icalSet},icalendar:icalSet,vcard:vcardSet,vcard3:vcard3Set,getDesignSet:function(componentName){return componentName&&componentName in design.components?design.components[componentName]:design.defaultSet}};var design$1=design;const RFC6868_REPLACE_MAP={'"':"^'","\n":"^n","^":"^^"};function stringify(jCal){"string"==typeof jCal[0]&&(jCal=[jCal]);let i=0,len=jCal.length,result="";for(;i<len;i++)result+=stringify.component(jCal[i])+"\r\n";return result}stringify.component=function(component,designSet){let name=component[0].toUpperCase(),result="BEGIN:"+name+"\r\n",props=component[1],propIdx=0,propLen=props.length,designSetName=component[0];for("vcard"===designSetName&&component[1].length>0&&("version"!==component[1][0][0]||"4.0"!==component[1][0][3])&&(designSetName="vcard3"),designSet=designSet||design$1.getDesignSet(designSetName);propIdx<propLen;propIdx++)result+=stringify.property(props[propIdx],designSet)+"\r\n";let comps=component[2]||[],compIdx=0,compLen=comps.length;for(;compIdx<compLen;compIdx++)result+=stringify.component(comps[compIdx],designSet)+"\r\n";return result+="END:"+name,result},stringify.property=function(property,designSet,noFold){let name=property[0].toUpperCase(),jsName=property[0],params=property[1];designSet||(designSet=design$1.defaultSet);let line,groupName=params.group;line=designSet.propertyGroups&&groupName?groupName.toUpperCase()+"."+name:name;for(let[paramName,value]of Object.entries(params)){if(designSet.propertyGroups&&"group"==paramName)continue;let paramDesign=designSet.param[paramName],multiValue2=paramDesign&&paramDesign.multiValue;multiValue2&&Array.isArray(value)?(value=value.map(function(val){return val=stringify._rfc6868Unescape(val),val=stringify.paramPropertyValue(val,paramDesign.multiValueSeparateDQuote)}),value=stringify.multiValue(value,multiValue2,"unknown",null,designSet)):(value=stringify._rfc6868Unescape(value),value=stringify.paramPropertyValue(value)),line+=";"+paramName.toUpperCase()+"="+value}if(3===property.length)return line+":";let propDetails,valueType=property[2],multiValue=!1,structuredValue=!1,isDefault=!1;return jsName in designSet.property?(propDetails=designSet.property[jsName],"multiValue"in propDetails&&(multiValue=propDetails.multiValue),"structuredValue"in propDetails&&Array.isArray(property[3])&&(structuredValue=propDetails.structuredValue),"defaultType"in propDetails?valueType===propDetails.defaultType&&(isDefault=!0):"unknown"===valueType&&(isDefault=!0)):"unknown"===valueType&&(isDefault=!0),isDefault||(line+=";VALUE="+valueType.toUpperCase()),line+=":",line+=multiValue&&structuredValue?stringify.multiValue(property[3],structuredValue,valueType,multiValue,designSet,structuredValue):multiValue?stringify.multiValue(property.slice(3),multiValue,valueType,null,designSet,!1):structuredValue?stringify.multiValue(property[3],structuredValue,valueType,null,designSet,structuredValue):stringify.value(property[3],valueType,designSet,!1),noFold?line:foldline(line)},stringify.paramPropertyValue=function(value,force){return force||-1!==value.indexOf(",")||-1!==value.indexOf(":")||-1!==value.indexOf(";")?'"'+value+'"':value},stringify.multiValue=function(values,delim,type,innerMulti,designSet,structuredValue){let result="",len=values.length,i=0;for(;i<len;i++)innerMulti&&Array.isArray(values[i])?result+=stringify.multiValue(values[i],innerMulti,type,null,designSet,structuredValue):result+=stringify.value(values[i],type,designSet,structuredValue),i!==len-1&&(result+=delim);return result},stringify.value=function(value,type,designSet,structuredValue){return type in designSet.value&&"toICAL"in designSet.value[type]?designSet.value[type].toICAL(value,structuredValue):value},stringify._rfc6868Unescape=function(val){return val.replace(/[\n^"]/g,function(x){return RFC6868_REPLACE_MAP[x]})};class Property{static fromString(str,designSet){return new Property(parse$1.property(str,designSet))}constructor(jCal,parent){this._parent=parent||null,"string"==typeof jCal?(this.jCal=[jCal,{},design$1.defaultType],this.jCal[2]=this.getDefaultType()):this.jCal=jCal,this._updateType()}get type(){return this.jCal[2]}get name(){return this.jCal[0]}get parent(){return this._parent}set parent(p2){let designSetChanged=!this._parent||p2&&p2._designSet!=this._parent._designSet;this._parent=p2,this.type==design$1.defaultType&&designSetChanged&&(this.jCal[2]=this.getDefaultType(),this._updateType())}get _designSet(){return this.parent?this.parent._designSet:design$1.defaultSet}_updateType(){let designSet=this._designSet;this.type in designSet.value&&("decorate"in designSet.value[this.type]?this.isDecorated=!0:this.isDecorated=!1,this.name in designSet.property&&(this.isMultiValue="multiValue"in designSet.property[this.name],this.isStructuredValue="structuredValue"in designSet.property[this.name]))}_hydrateValue(index2){return this._values&&this._values[index2]?this._values[index2]:this.jCal.length<=3+index2?null:this.isDecorated?(this._values||(this._values=[]),this._values[index2]=this._decorate(this.jCal[3+index2])):this.jCal[3+index2]}_decorate(value){return this._designSet.value[this.type].decorate(value,this)}_undecorate(value){return this._designSet.value[this.type].undecorate(value,this)}_setDecoratedValue(value,index2){this._values||(this._values=[]),"object"==typeof value&&"icaltype"in value?(this.jCal[3+index2]=this._undecorate(value),this._values[index2]=value):(this.jCal[3+index2]=value,this._values[index2]=this._decorate(value))}getParameter(name){return name in this.jCal[1]?this.jCal[1][name]:void 0}getFirstParameter(name){let parameters=this.getParameter(name);return Array.isArray(parameters)?parameters[0]:parameters}setParameter(name,value){let lcname=name.toLowerCase();"string"==typeof value&&lcname in this._designSet.param&&"multiValue"in this._designSet.param[lcname]&&(value=[value]),this.jCal[1][name]=value}removeParameter(name){delete this.jCal[1][name]}getDefaultType(){let name=this.jCal[0],designSet=this._designSet;if(name in designSet.property){let details=designSet.property[name];if("defaultType"in details)return details.defaultType}return design$1.defaultType}resetType(type){this.removeAllValues(),this.jCal[2]=type,this._updateType()}getFirstValue(){return this._hydrateValue(0)}getValues(){let len=this.jCal.length-3;if(len<1)return[];let i=0,result=[];for(;i<len;i++)result[i]=this._hydrateValue(i);return result}removeAllValues(){this._values&&(this._values.length=0),this.jCal.length=3}setValues(values){if(!this.isMultiValue)throw new Error(this.name+": does not not support mulitValue.\noverride isMultiValue");let len=values.length,i=0;if(this.removeAllValues(),len>0&&"object"==typeof values[0]&&"icaltype"in values[0]&&this.resetType(values[0].icaltype),this.isDecorated)for(;i<len;i++)this._setDecoratedValue(values[i],i);else for(;i<len;i++)this.jCal[3+i]=values[i]}setValue(value){this.removeAllValues(),"object"==typeof value&&"icaltype"in value&&this.resetType(value.icaltype),this.isDecorated?this._setDecoratedValue(value,0):this.jCal[3]=value}toJSON(){return this.jCal}toICALString(){return stringify.property(this.jCal,this._designSet,!0)}}class Component{constructor(jCal,parent){__publicField(this,"_hydratedPropertyCount",0),__publicField(this,"_hydratedComponentCount",0),__publicField(this,"_timezoneCache",null),__publicField(this,"_components",null),__publicField(this,"_properties",null),"string"==typeof jCal&&(jCal=[jCal,[],[]]),this.jCal=jCal,this.parent=parent||null,this.parent||"vcalendar"!==this.name||(this._timezoneCache=new Map)}static fromString(str){return new Component(parse$1.component(str))}get name(){return this.jCal[0]}get _designSet(){return this.parent&&this.parent._designSet||design$1.getDesignSet(this.name)}_hydrateComponent(index2){if(this._components||(this._components=[],this._hydratedComponentCount=0),this._components[index2])return this._components[index2];let comp=new Component(this.jCal[2][index2],this);return this._hydratedComponentCount++,this._components[index2]=comp}_hydrateProperty(index2){if(this._properties||(this._properties=[],this._hydratedPropertyCount=0),this._properties[index2])return this._properties[index2];let prop=new Property(this.jCal[1][index2],this);return this._hydratedPropertyCount++,this._properties[index2]=prop}getFirstSubcomponent(name){if(name){let i=0,comps=this.jCal[2],len=comps.length;for(;i<len;i++)if(comps[i][0]===name){return this._hydrateComponent(i)}}else if(this.jCal[2].length)return this._hydrateComponent(0);return null}getAllSubcomponents(name){let jCalLen=this.jCal[2].length,i=0;if(name){let comps=this.jCal[2],result=[];for(;i<jCalLen;i++)name===comps[i][0]&&result.push(this._hydrateComponent(i));return result}if(!this._components||this._hydratedComponentCount!==jCalLen)for(;i<jCalLen;i++)this._hydrateComponent(i);return this._components||[]}hasProperty(name){let props=this.jCal[1],len=props.length,i=0;for(;i<len;i++)if(props[i][0]===name)return!0;return!1}getFirstProperty(name){if(name){let i=0,props=this.jCal[1],len=props.length;for(;i<len;i++)if(props[i][0]===name){return this._hydrateProperty(i)}}else if(this.jCal[1].length)return this._hydrateProperty(0);return null}getFirstPropertyValue(name){let prop=this.getFirstProperty(name);return prop?prop.getFirstValue():null}getAllProperties(name){let jCalLen=this.jCal[1].length,i=0;if(name){let props=this.jCal[1],result=[];for(;i<jCalLen;i++)name===props[i][0]&&result.push(this._hydrateProperty(i));return result}if(!this._properties||this._hydratedPropertyCount!==jCalLen)for(;i<jCalLen;i++)this._hydrateProperty(i);return this._properties||[]}_removeObjectByIndex(jCalIndex,cache2,index2){if((cache2=cache2||[])[index2]){let obj=cache2[index2];"parent"in obj&&(obj.parent=null)}cache2.splice(index2,1),this.jCal[jCalIndex].splice(index2,1)}_removeObject(jCalIndex,cache2,nameOrObject){let i=0,objects=this.jCal[jCalIndex],len=objects.length,cached=this[cache2];if("string"==typeof nameOrObject){for(;i<len;i++)if(objects[i][0]===nameOrObject)return this._removeObjectByIndex(jCalIndex,cached,i),!0}else if(cached)for(;i<len;i++)if(cached[i]&&cached[i]===nameOrObject)return this._removeObjectByIndex(jCalIndex,cached,i),!0;return!1}_removeAllObjects(jCalIndex,cache2,name){let cached=this[cache2],objects=this.jCal[jCalIndex],i=objects.length-1;for(;i>=0;i--)name&&objects[i][0]!==name||this._removeObjectByIndex(jCalIndex,cached,i)}addSubcomponent(component){this._components||(this._components=[],this._hydratedComponentCount=0),component.parent&&component.parent.removeSubcomponent(component);let idx=this.jCal[2].push(component.jCal);return this._components[idx-1]=component,this._hydratedComponentCount++,component.parent=this,component}removeSubcomponent(nameOrComp){let removed=this._removeObject(2,"_components",nameOrComp);return removed&&this._hydratedComponentCount--,removed}removeAllSubcomponents(name){let removed=this._removeAllObjects(2,"_components",name);return this._hydratedComponentCount=0,removed}addProperty(property){if(!(property instanceof Property))throw new TypeError("must be instance of ICAL.Property");this._properties||(this._properties=[],this._hydratedPropertyCount=0),property.parent&&property.parent.removeProperty(property);let idx=this.jCal[1].push(property.jCal);return this._properties[idx-1]=property,this._hydratedPropertyCount++,property.parent=this,property}addPropertyWithValue(name,value){let prop=new Property(name);return prop.setValue(value),this.addProperty(prop),prop}updatePropertyWithValue(name,value){let prop=this.getFirstProperty(name);return prop?prop.setValue(value):prop=this.addPropertyWithValue(name,value),prop}removeProperty(nameOrProp){let removed=this._removeObject(1,"_properties",nameOrProp);return removed&&this._hydratedPropertyCount--,removed}removeAllProperties(name){let removed=this._removeAllObjects(1,"_properties",name);return this._hydratedPropertyCount=0,removed}toJSON(){return this.jCal}toString(){return stringify.component(this.jCal,this._designSet)}getTimeZoneByID(tzid){if(this.parent)return this.parent.getTimeZoneByID(tzid);if(!this._timezoneCache)return null;if(this._timezoneCache.has(tzid))return this._timezoneCache.get(tzid);const zones2=this.getAllSubcomponents("vtimezone");for(const zone of zones2)if(zone.getFirstProperty("tzid").getFirstValue()===tzid){const hydratedZone=new Timezone({component:zone,tzid:tzid});return this._timezoneCache.set(tzid,hydratedZone),hydratedZone}return null}}class RecurExpansion{constructor(options){__publicField(this,"complete",!1),__publicField(this,"ruleIterators",null),__publicField(this,"ruleDates",null),__publicField(this,"exDates",null),__publicField(this,"ruleDateInc",0),__publicField(this,"exDateInc",0),__publicField(this,"exDate",null),__publicField(this,"ruleDate",null),__publicField(this,"dtstart",null),__publicField(this,"last",null),this.ruleDates=[],this.exDates=[],this.fromData(options)}fromData(options){let start=formatClassType(options.dtstart,Time);if(!start)throw new Error(".dtstart (ICAL.Time) must be given");if(this.dtstart=start,options.component)this._init(options.component);else{if(this.last=formatClassType(options.last,Time)||start.clone(),!options.ruleIterators)throw new Error(".ruleIterators or .component must be given");this.ruleIterators=options.ruleIterators.map(function(item){return formatClassType(item,RecurIterator)}),this.ruleDateInc=options.ruleDateInc,this.exDateInc=options.exDateInc,options.ruleDates&&(this.ruleDates=options.ruleDates.map(item=>formatClassType(item,Time)),this.ruleDate=this.ruleDates[this.ruleDateInc]),options.exDates&&(this.exDates=options.exDates.map(item=>formatClassType(item,Time)),this.exDate=this.exDates[this.exDateInc]),void 0!==options.complete&&(this.complete=options.complete)}}next(){let iter2,next,compare2,currentTry=0;for(;;){if(currentTry++>500)throw new Error("max tries have occurred, rule may be impossible to fulfill.");if(next=this.ruleDate,iter2=this._nextRecurrenceIter(this.last),!next&&!iter2){this.complete=!0;break}if((!next||iter2&&next.compare(iter2.last)>0)&&(next=iter2.last.clone(),iter2.next()),this.ruleDate===next&&this._nextRuleDay(),this.last=next,!this.exDate||(compare2=this.exDate.compare(this.last),compare2<0&&this._nextExDay(),0!==compare2))return this.last;this._nextExDay()}}toJSON(){function toJSON(item){return item.toJSON()}let result=Object.create(null);return result.ruleIterators=this.ruleIterators.map(toJSON),this.ruleDates&&(result.ruleDates=this.ruleDates.map(toJSON)),this.exDates&&(result.exDates=this.exDates.map(toJSON)),result.ruleDateInc=this.ruleDateInc,result.exDateInc=this.exDateInc,result.last=this.last.toJSON(),result.dtstart=this.dtstart.toJSON(),result.complete=this.complete,result}_extractDates(component,propertyName){let result=[],props=component.getAllProperties(propertyName);for(let i=0,len=props.length;i<len;i++)for(let prop of props[i].getValues()){let idx=binsearchInsert(result,prop,(a,b)=>a.compare(b));result.splice(idx,0,prop)}return result}_init(component){if(this.ruleIterators=[],this.last=this.dtstart.clone(),!component.hasProperty("rdate")&&!component.hasProperty("rrule")&&!component.hasProperty("recurrence-id"))return this.ruleDate=this.last.clone(),void(this.complete=!0);if(component.hasProperty("rdate")&&(this.ruleDates=this._extractDates(component,"rdate"),this.ruleDates[0]&&this.ruleDates[0].compare(this.dtstart)<0?(this.ruleDateInc=0,this.last=this.ruleDates[0].clone()):this.ruleDateInc=binsearchInsert(this.ruleDates,this.last,(a,b)=>a.compare(b)),this.ruleDate=this.ruleDates[this.ruleDateInc]),component.hasProperty("rrule")){let rule,iter2,rules=component.getAllProperties("rrule"),i=0,len=rules.length;for(;i<len;i++)rule=rules[i].getFirstValue(),iter2=rule.iterator(this.dtstart),this.ruleIterators.push(iter2),iter2.next()}component.hasProperty("exdate")&&(this.exDates=this._extractDates(component,"exdate"),this.exDateInc=binsearchInsert(this.exDates,this.last,(a,b)=>a.compare(b)),this.exDate=this.exDates[this.exDateInc])}_nextExDay(){this.exDate=this.exDates[++this.exDateInc]}_nextRuleDay(){this.ruleDate=this.ruleDates[++this.ruleDateInc]}_nextRecurrenceIter(){let iters=this.ruleIterators;if(0===iters.length)return null;let iter2,iterTime,chosenIter,len=iters.length,iterIdx=0;for(;iterIdx<len;iterIdx++)iter2=iters[iterIdx],iterTime=iter2.last,iter2.completed?(len--,0!==iterIdx&&iterIdx--,iters.splice(iterIdx,1)):(!chosenIter||chosenIter.last.compare(iterTime)>0)&&(chosenIter=iter2);return chosenIter}}const _Event=class _Event{constructor(component,options){__publicField(this,"exceptions",null),__publicField(this,"strictExceptions",!1),component instanceof Component||(options=component,component=null),this.component=component||new Component("vevent"),this._rangeExceptionCache=Object.create(null),this.exceptions=Object.create(null),this.rangeExceptions=[],options&&options.strictExceptions&&(this.strictExceptions=options.strictExceptions),options&&options.exceptions?options.exceptions.forEach(this.relateException,this):this.component.parent&&!this.isRecurrenceException()&&this.component.parent.getAllSubcomponents("vevent").forEach(function(event){event.hasProperty("recurrence-id")&&this.relateException(event)},this)}relateException(obj){if(this.isRecurrenceException())throw new Error("cannot relate exception to exceptions");if(obj instanceof Component&&(obj=new _Event(obj)),this.strictExceptions&&obj.uid!==this.uid)throw new Error("attempted to relate unrelated exception");let id=obj.recurrenceId.toString();if(this.exceptions[id]=obj,obj.modifiesFuture()){let item=[obj.recurrenceId.toUnixTime(),id],idx=binsearchInsert(this.rangeExceptions,item,compareRangeException);this.rangeExceptions.splice(idx,0,item)}}modifiesFuture(){if(!this.component.hasProperty("recurrence-id"))return!1;return this.component.getFirstProperty("recurrence-id").getParameter("range")===_Event.THISANDFUTURE}findRangeException(time){if(!this.rangeExceptions.length)return null;let utc=time.toUnixTime(),idx=binsearchInsert(this.rangeExceptions,[utc],compareRangeException);if(idx-=1,idx<0)return null;let rangeItem=this.rangeExceptions[idx];return utc<rangeItem[0]?null:rangeItem[1]}getOccurrenceDetails(occurrence){let item,id=occurrence.toString(),utcId=occurrence.convertToZone(Timezone.utcTimezone).toString(),result={recurrenceId:occurrence};if(id in this.exceptions)item=result.item=this.exceptions[id],result.startDate=item.startDate,result.endDate=item.endDate,result.item=item;else if(utcId in this.exceptions)item=this.exceptions[utcId],result.startDate=item.startDate,result.endDate=item.endDate,result.item=item;else{let end,rangeExceptionId=this.findRangeException(occurrence);if(rangeExceptionId){let exception=this.exceptions[rangeExceptionId];result.item=exception;let startDiff=this._rangeExceptionCache[rangeExceptionId];if(!startDiff){let original=exception.recurrenceId.clone(),newStart=exception.startDate.clone();original.zone=newStart.zone,startDiff=newStart.subtractDate(original),this._rangeExceptionCache[rangeExceptionId]=startDiff}let start=occurrence.clone();start.zone=exception.startDate.zone,start.addDuration(startDiff),end=start.clone(),end.addDuration(exception.duration),result.startDate=start,result.endDate=end}else end=occurrence.clone(),end.addDuration(this.duration),result.endDate=end,result.startDate=occurrence,result.item=this}return result}iterator(startTime){return new RecurExpansion({component:this.component,dtstart:startTime||this.startDate})}isRecurring(){let comp=this.component;return comp.hasProperty("rrule")||comp.hasProperty("rdate")}isRecurrenceException(){return this.component.hasProperty("recurrence-id")}getRecurrenceTypes(){let rules=this.component.getAllProperties("rrule"),i=0,len=rules.length,result=Object.create(null);for(;i<len;i++){result[rules[i].getFirstValue().freq]=!0}return result}get uid(){return this._firstProp("uid")}set uid(value){this._setProp("uid",value)}get startDate(){return this._firstProp("dtstart")}set startDate(value){this._setTime("dtstart",value)}get endDate(){let endDate=this._firstProp("dtend");if(!endDate){let duration=this._firstProp("duration");endDate=this.startDate.clone(),duration?endDate.addDuration(duration):endDate.isDate&&(endDate.day+=1)}return endDate}set endDate(value){this.component.hasProperty("duration")&&this.component.removeProperty("duration"),this._setTime("dtend",value)}get duration(){let duration=this._firstProp("duration");return duration||this.endDate.subtractDateTz(this.startDate)}set duration(value){this.component.hasProperty("dtend")&&this.component.removeProperty("dtend"),this._setProp("duration",value)}get location(){return this._firstProp("location")}set location(value){this._setProp("location",value)}get attendees(){return this.component.getAllProperties("attendee")}get summary(){return this._firstProp("summary")}set summary(value){this._setProp("summary",value)}get description(){return this._firstProp("description")}set description(value){this._setProp("description",value)}get color(){return this._firstProp("color")}set color(value){this._setProp("color",value)}get organizer(){return this._firstProp("organizer")}set organizer(value){this._setProp("organizer",value)}get sequence(){return this._firstProp("sequence")}set sequence(value){this._setProp("sequence",value)}get recurrenceId(){return this._firstProp("recurrence-id")}set recurrenceId(value){this._setTime("recurrence-id",value)}_setTime(propName,time){let prop=this.component.getFirstProperty(propName);prop||(prop=new Property(propName),this.component.addProperty(prop)),time.zone===Timezone.localTimezone||time.zone===Timezone.utcTimezone?prop.removeParameter("tzid"):prop.setParameter("tzid",time.zone.tzid),prop.setValue(time)}_setProp(name,value){this.component.updatePropertyWithValue(name,value)}_firstProp(name){return this.component.getFirstPropertyValue(name)}toString(){return this.component.toString()}};__publicField(_Event,"THISANDFUTURE","THISANDFUTURE");let Event=_Event;function compareRangeException(a,b){return a[0]>b[0]?1:b[0]>a[0]?-1:0}var Weight$1,Weight2,ICALmodule={foldLength:75,debug:!1,newLineChar:"\r\n",Binary:Binary,Component:Component,ComponentParser:class{constructor(options){__publicField(this,"parseEvent",!0),__publicField(this,"parseTimezone",!0),__publicField(this,"oncomplete",function(){}),__publicField(this,"onerror",function(err){}),__publicField(this,"ontimezone",function(component){}),__publicField(this,"onevent",function(component){}),void 0===options&&(options={});for(let[key,value]of Object.entries(options))this[key]=value}process(ical){"string"==typeof ical&&(ical=parse$1(ical)),ical instanceof Component||(ical=new Component(ical));let component,components=ical.getAllSubcomponents(),i=0,len=components.length;for(;i<len;i++)switch(component=components[i],component.name){case"vtimezone":if(this.parseTimezone){let tzid=component.getFirstPropertyValue("tzid");tzid&&this.ontimezone(new Timezone({tzid:tzid,component:component}))}break;case"vevent":this.parseEvent&&this.onevent(new Event(component));break;default:continue}this.oncomplete()}},Duration:Duration,Event:Event,Period:Period,Property:Property,Recur:Recur,RecurExpansion:RecurExpansion,RecurIterator:RecurIterator,Time:Time,Timezone:Timezone,TimezoneService:TimezoneService,UtcOffset:UtcOffset,VCardTime:VCardTime,parse:parse$1,stringify:stringify,design:design$1,helpers:helpers};function checkGroupStart(lines,i,lengthAtIndex,context){const line=lines[i],groupStart=line.match(GROUP_START_REGEX);if(groupStart){const range2={from:lengthAtIndex[i],to:lengthAtIndex[i]+groupStart[0].length,type:RangeType.Section};context.ranges.push(range2);const group=function(s2,regexMatch,range2){const group=new EventGroup;return group.tags=[],group.style="group",group.textRanges={whole:range2,definition:{from:range2.from,to:range2.from+s2.length,type:RangeType.SectionDefinition}},s2=s2.replace(GROUP_START_REGEX,(match2,startToken,groupOrSection)=>(group.startExpanded=!startToken.length,group.style=groupOrSection,group.textRanges.definition.to=group.textRanges.definition.from+startToken.length+groupOrSection.length,"")).replace(TAG_REGEX,(match2,tag)=>(group.tags.includes(tag)||group.tags.push(tag),"")),group.title=s2.trim(),group}(line,0,range2),{properties:properties,i:end,propOrder:propOrder}=parseProperties(lines,lengthAtIndex,i+1,context);group.properties=properties,group.propOrder=propOrder;let tz=properties.timezone||properties.tz;if("string"!=typeof tz&&"number"!=typeof tz&&(tz=void 0),tz){parseZone(tz,context.cache)||context.parseMessages.push({type:"error",message:`Unable to parse timezone "${tz}"`,pos:[range2.from,range2.to]})}return context.push(group),context.startFoldableSection({type:RangeType.Section,startLine:i,startIndex:lengthAtIndex[i],endIndex:lengthAtIndex[i]+line.length,foldStartIndex:lengthAtIndex[i]+line.length}),{end:end}}return!1}(Weight2=Weight$1||(Weight$1={}))[Weight2.SECOND=0]="SECOND",Weight2[Weight2.QUARTER_MINUTE=1]="QUARTER_MINUTE",Weight2[Weight2.MINUTE=2]="MINUTE",Weight2[Weight2.QUARTER_HOUR=3]="QUARTER_HOUR",Weight2[Weight2.HOUR=4]="HOUR",Weight2[Weight2.DAY=5]="DAY",Weight2[Weight2.MONTH=6]="MONTH",Weight2[Weight2.YEAR=7]="YEAR",Weight2[Weight2.DECADE=8]="DECADE",Weight2[Weight2.CENT=9]="CENT",Weight$1.CENT,Weight$1.DECADE,Weight$1.YEAR,Weight$1.MONTH,Weight$1.DAY,Weight$1.HOUR,Weight$1.MINUTE,Weight$1.QUARTER_HOUR,Weight$1.QUARTER_MINUTE,Weight$1.SECOND,Weight$1.CENT,Weight$1.DECADE,Weight$1.YEAR,Weight$1.MONTH,Weight$1.DAY,Weight$1.HOUR,Weight$1.QUARTER_HOUR,Weight$1.MINUTE,Weight$1.QUARTER_MINUTE,Weight$1.SECOND;let rangeFrom=[],rangeTo=[];(()=>{let numbers="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(s2=>s2?parseInt(s2,36):1);for(let i=0,n2=0;i<numbers.length;i++)(i%2?rangeTo:rangeFrom).push(n2+=numbers[i])})();class Text{lineAt(pos){if(pos<0||pos>this.length)throw new RangeError(`Invalid position ${pos} in document of length ${this.length}`);return this.lineInner(pos,!1,1,0)}line(n2){if(n2<1||n2>this.lines)throw new RangeError(`Invalid line number ${n2} in ${this.lines}-line document`);return this.lineInner(n2,!0,1,0)}replace(from,to,text){[from,to]=clip(this,from,to);let parts=[];return this.decompose(0,from,parts,2),text.length&&text.decompose(0,text.length,parts,3),this.decompose(to,this.length,parts,1),TextNode.from(parts,this.length-(to-from)+text.length)}append(other){return this.replace(this.length,this.length,other)}slice(from,to=this.length){[from,to]=clip(this,from,to);let parts=[];return this.decompose(from,to,parts,0),TextNode.from(parts,to-from)}eq(other){if(other==this)return!0;if(other.length!=this.length||other.lines!=this.lines)return!1;let start=this.scanIdentical(other,1),end=this.length-this.scanIdentical(other,-1),a=new RawTextCursor(this),b=new RawTextCursor(other);for(let skip=start,pos=start;;){if(a.next(skip),b.next(skip),skip=0,a.lineBreak!=b.lineBreak||a.done!=b.done||a.value!=b.value)return!1;if(pos+=a.value.length,a.done||pos>=end)return!0}}iter(dir=1){return new RawTextCursor(this,dir)}iterRange(from,to=this.length){return new PartialTextCursor(this,from,to)}iterLines(from,to){let inner;if(null==from)inner=this.iter();else{null==to&&(to=this.lines+1);let start=this.line(from).from;inner=this.iterRange(start,Math.max(start,to==this.lines+1?this.length:to<=1?0:this.line(to-1).to))}return new LineCursor(inner)}toString(){return this.sliceString(0)}toJSON(){let lines=[];return this.flatten(lines),lines}constructor(){}static of(text){if(0==text.length)throw new RangeError("A document must have at least one line");return 1!=text.length||text[0]?text.length<=32?new TextLeaf(text):TextNode.from(TextLeaf.split(text,[])):Text.empty}}class TextLeaf extends Text{constructor(text,length=function(text){let length=-1;for(let line of text)length+=line.length+1;return length}(text)){super(),this.text=text,this.length=length}get lines(){return this.text.length}get children(){return null}lineInner(target,isLine,line,offset2){for(let i=0;;i++){let string2=this.text[i],end=offset2+string2.length;if((isLine?line:end)>=target)return new Line(offset2,end,line,string2);offset2=end+1,line++}}decompose(from,to,target,open){let text=from<=0&&to>=this.length?this:new TextLeaf(sliceText(this.text,from,to),Math.min(to,this.length)-Math.max(0,from));if(1&open){let prev=target.pop(),joined=appendText(text.text,prev.text.slice(),0,text.length);if(joined.length<=32)target.push(new TextLeaf(joined,prev.length+text.length));else{let mid=joined.length>>1;target.push(new TextLeaf(joined.slice(0,mid)),new TextLeaf(joined.slice(mid)))}}else target.push(text)}replace(from,to,text){if(!(text instanceof TextLeaf))return super.replace(from,to,text);[from,to]=clip(this,from,to);let lines=appendText(this.text,appendText(text.text,sliceText(this.text,0,from)),to),newLen=this.length+text.length-(to-from);return lines.length<=32?new TextLeaf(lines,newLen):TextNode.from(TextLeaf.split(lines,[]),newLen)}sliceString(from,to=this.length,lineSep="\n"){[from,to]=clip(this,from,to);let result="";for(let pos=0,i=0;pos<=to&&i<this.text.length;i++){let line=this.text[i],end=pos+line.length;pos>from&&i&&(result+=lineSep),from<end&&to>pos&&(result+=line.slice(Math.max(0,from-pos),to-pos)),pos=end+1}return result}flatten(target){for(let line of this.text)target.push(line)}scanIdentical(){return 0}static split(text,target){let part=[],len=-1;for(let line of text)part.push(line),len+=line.length+1,32==part.length&&(target.push(new TextLeaf(part,len)),part=[],len=-1);return len>-1&&target.push(new TextLeaf(part,len)),target}}class TextNode extends Text{constructor(children,length){super(),this.children=children,this.length=length,this.lines=0;for(let child of children)this.lines+=child.lines}lineInner(target,isLine,line,offset2){for(let i=0;;i++){let child=this.children[i],end=offset2+child.length,endLine=line+child.lines-1;if((isLine?endLine:end)>=target)return child.lineInner(target,isLine,line,offset2);offset2=end+1,line=endLine+1}}decompose(from,to,target,open){for(let i=0,pos=0;pos<=to&&i<this.children.length;i++){let child=this.children[i],end=pos+child.length;if(from<=end&&to>=pos){let childOpen=open&((pos<=from?1:0)|(end>=to?2:0));pos>=from&&end<=to&&!childOpen?target.push(child):child.decompose(from-pos,to-pos,target,childOpen)}pos=end+1}}replace(from,to,text){if([from,to]=clip(this,from,to),text.lines<this.lines)for(let i=0,pos=0;i<this.children.length;i++){let child=this.children[i],end=pos+child.length;if(from>=pos&&to<=end){let updated=child.replace(from-pos,to-pos,text),totalLines=this.lines-child.lines+updated.lines;if(updated.lines<totalLines>>4&&updated.lines>totalLines>>6){let copy=this.children.slice();return copy[i]=updated,new TextNode(copy,this.length-(to-from)+text.length)}return super.replace(pos,end,updated)}pos=end+1}return super.replace(from,to,text)}sliceString(from,to=this.length,lineSep="\n"){[from,to]=clip(this,from,to);let result="";for(let i=0,pos=0;i<this.children.length&&pos<=to;i++){let child=this.children[i],end=pos+child.length;pos>from&&i&&(result+=lineSep),from<end&&to>pos&&(result+=child.sliceString(from-pos,to-pos,lineSep)),pos=end+1}return result}flatten(target){for(let child of this.children)child.flatten(target)}scanIdentical(other,dir){if(!(other instanceof TextNode))return 0;let length=0,[iA,iB,eA,eB]=dir>0?[0,0,this.children.length,other.children.length]:[this.children.length-1,other.children.length-1,-1,-1];for(;;iA+=dir,iB+=dir){if(iA==eA||iB==eB)return length;let chA=this.children[iA],chB=other.children[iB];if(chA!=chB)return length+chA.scanIdentical(chB,dir);length+=chA.length+1}}static from(children,length=children.reduce((l2,ch)=>l2+ch.length+1,-1)){let lines=0;for(let ch of children)lines+=ch.lines;if(lines<32){let flat=[];for(let ch of children)ch.flatten(flat);return new TextLeaf(flat,length)}let chunk=Math.max(32,lines>>5),maxChunk=chunk<<1,minChunk=chunk>>1,chunked=[],currentLines=0,currentLen=-1,currentChunk=[];function add2(child){let last;if(child.lines>maxChunk&&child instanceof TextNode)for(let node of child.children)add2(node);else child.lines>minChunk&&(currentLines>minChunk||!currentLines)?(flush(),chunked.push(child)):child instanceof TextLeaf&&currentLines&&(last=currentChunk[currentChunk.length-1])instanceof TextLeaf&&child.lines+last.lines<=32?(currentLines+=child.lines,currentLen+=child.length+1,currentChunk[currentChunk.length-1]=new TextLeaf(last.text.concat(child.text),last.length+1+child.length)):(currentLines+child.lines>chunk&&flush(),currentLines+=child.lines,currentLen+=child.length+1,currentChunk.push(child))}function flush(){0!=currentLines&&(chunked.push(1==currentChunk.length?currentChunk[0]:TextNode.from(currentChunk,currentLen)),currentLen=-1,currentLines=currentChunk.length=0)}for(let child of children)add2(child);return flush(),1==chunked.length?chunked[0]:new TextNode(chunked,length)}}function appendText(text,target,from=0,to=1e9){for(let pos=0,i=0,first=!0;i<text.length&&pos<=to;i++){let line=text[i],end=pos+line.length;end>=from&&(end>to&&(line=line.slice(0,to-pos)),pos<from&&(line=line.slice(from-pos)),first?(target[target.length-1]+=line,first=!1):target.push(line)),pos=end+1}return target}function sliceText(text,from,to){return appendText(text,[""],from,to)}Text.empty=new TextLeaf([""],0);class RawTextCursor{constructor(text,dir=1){this.dir=dir,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[text],this.offsets=[dir>0?1:(text instanceof TextLeaf?text.text.length:text.children.length)<<1]}nextInner(skip,dir){for(this.done=this.lineBreak=!1;;){let last=this.nodes.length-1,top=this.nodes[last],offsetValue=this.offsets[last],offset2=offsetValue>>1,size2=top instanceof TextLeaf?top.text.length:top.children.length;if(offset2==(dir>0?size2:0)){if(0==last)return this.done=!0,this.value="",this;dir>0&&this.offsets[last-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&offsetValue)==(dir>0?0:1)){if(this.offsets[last]+=dir,0==skip)return this.lineBreak=!0,this.value="\n",this;skip--}else if(top instanceof TextLeaf){let next=top.text[offset2+(dir<0?-1:0)];if(this.offsets[last]+=dir,next.length>Math.max(0,skip))return this.value=0==skip?next:dir>0?next.slice(skip):next.slice(0,next.length-skip),this;skip-=next.length}else{let next=top.children[offset2+(dir<0?-1:0)];skip>next.length?(skip-=next.length,this.offsets[last]+=dir):(dir<0&&this.offsets[last]--,this.nodes.push(next),this.offsets.push(dir>0?1:(next instanceof TextLeaf?next.text.length:next.children.length)<<1))}}}next(skip=0){return skip<0&&(this.nextInner(-skip,-this.dir),skip=this.value.length),this.nextInner(skip,this.dir)}}class PartialTextCursor{constructor(text,start,end){this.value="",this.done=!1,this.cursor=new RawTextCursor(text,start>end?-1:1),this.pos=start>end?text.length:0,this.from=Math.min(start,end),this.to=Math.max(start,end)}nextInner(skip,dir){if(dir<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;skip+=Math.max(0,dir<0?this.pos-this.to:this.from-this.pos);let limit2=dir<0?this.pos-this.from:this.to-this.pos;skip>limit2&&(skip=limit2),limit2-=skip;let{value:value}=this.cursor.next(skip);return this.pos+=(value.length+skip)*dir,this.value=value.length<=limit2?value:dir<0?value.slice(value.length-limit2):value.slice(0,limit2),this.done=!this.value,this}next(skip=0){return skip<0?skip=Math.max(skip,this.from-this.pos):skip>0&&(skip=Math.min(skip,this.to-this.pos)),this.nextInner(skip,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class LineCursor{constructor(inner){this.inner=inner,this.afterBreak=!0,this.value="",this.done=!1}next(skip=0){let{done:done,lineBreak:lineBreak,value:value}=this.inner.next(skip);return done&&this.afterBreak?(this.value="",this.afterBreak=!1):done?(this.done=!0,this.value=""):lineBreak?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=value,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(Text.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});class Line{constructor(from,to,number,text){this.from=from,this.to=to,this.number=number,this.text=text}get length(){return this.to-this.from}}function clip(text,from,to){return[from=Math.max(0,Math.min(text.length,from)),Math.max(from,Math.min(text.length,to))]}var MapMode=function(MapMode2){return MapMode2[MapMode2.Simple=0]="Simple",MapMode2[MapMode2.TrackDel=1]="TrackDel",MapMode2[MapMode2.TrackBefore=2]="TrackBefore",MapMode2[MapMode2.TrackAfter=3]="TrackAfter",MapMode2}(MapMode||(MapMode={}));let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(_){}MapMode.TrackDel;class Range{constructor(from,to,value){this.from=from,this.to=to,this.value=value}static create(from,to,value){return new Range(from,to,value)}}function cmpRange(a,b){return a.from-b.from||a.value.startSide-b.value.startSide}class Chunk{constructor(from,to,value,maxPoint){this.from=from,this.to=to,this.value=value,this.maxPoint=maxPoint}get length(){return this.to[this.to.length-1]}findIndex(pos,side,end,startAt=0){let arr=end?this.to:this.from;for(let lo=startAt,hi=arr.length;;){if(lo==hi)return lo;let mid=lo+hi>>1,diff2=arr[mid]-pos||(end?this.value[mid].endSide:this.value[mid].startSide)-side;if(mid==lo)return diff2>=0?lo:hi;diff2>=0?hi=mid:lo=mid+1}}between(offset2,from,to,f){for(let i=this.findIndex(from,-1e9,!0),e=this.findIndex(to,1e9,!1,i);i<e;i++)if(!1===f(this.from[i]+offset2,this.to[i]+offset2,this.value[i]))return!1}map(offset2,changes){let value=[],from=[],to=[],newPos=-1,maxPoint=-1;for(let i=0;i<this.value.length;i++){let newFrom,newTo,val=this.value[i],curFrom=this.from[i]+offset2,curTo=this.to[i]+offset2;if(curFrom==curTo){let mapped=changes.mapPos(curFrom,val.startSide,val.mapMode);if(null==mapped)continue;if(newFrom=newTo=mapped,val.startSide!=val.endSide&&(newTo=changes.mapPos(curFrom,val.endSide),newTo<newFrom))continue}else if(newFrom=changes.mapPos(curFrom,val.startSide),newTo=changes.mapPos(curTo,val.endSide),newFrom>newTo||newFrom==newTo&&val.startSide>0&&val.endSide<=0)continue;(newTo-newFrom||val.endSide-val.startSide)<0||(newPos<0&&(newPos=newFrom),val.point&&(maxPoint=Math.max(maxPoint,newTo-newFrom)),value.push(val),from.push(newFrom-newPos),to.push(newTo-newPos))}return{mapped:value.length?new Chunk(from,to,value,maxPoint):null,pos:newPos}}}class RangeSet{constructor(chunkPos,chunk,nextLayer,maxPoint){this.chunkPos=chunkPos,this.chunk=chunk,this.nextLayer=nextLayer,this.maxPoint=maxPoint}static create(chunkPos,chunk,nextLayer,maxPoint){return new RangeSet(chunkPos,chunk,nextLayer,maxPoint)}get length(){let last=this.chunk.length-1;return last<0?0:Math.max(this.chunkEnd(last),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let size2=this.nextLayer.size;for(let chunk of this.chunk)size2+=chunk.value.length;return size2}chunkEnd(index2){return this.chunkPos[index2]+this.chunk[index2].length}update(updateSpec){let{add:add2=[],sort:sort2=!1,filterFrom:filterFrom=0,filterTo:filterTo=this.length}=updateSpec,filter=updateSpec.filter;if(0==add2.length&&!filter)return this;if(sort2&&(add2=add2.slice().sort(cmpRange)),this.isEmpty)return add2.length?RangeSet.of(add2):this;let cur=new LayerCursor(this,null,-1).goto(0),i=0,spill=[],builder=new RangeSetBuilder;for(;cur.value||i<add2.length;)if(i<add2.length&&(cur.from-add2[i].from||cur.startSide-add2[i].value.startSide)>=0){let range2=add2[i++];builder.addInner(range2.from,range2.to,range2.value)||spill.push(range2)}else 1==cur.rangeIndex&&cur.chunkIndex<this.chunk.length&&(i==add2.length||this.chunkEnd(cur.chunkIndex)<add2[i].from)&&(!filter||filterFrom>this.chunkEnd(cur.chunkIndex)||filterTo<this.chunkPos[cur.chunkIndex])&&builder.addChunk(this.chunkPos[cur.chunkIndex],this.chunk[cur.chunkIndex])?cur.nextChunk():((!filter||filterFrom>cur.to||filterTo<cur.from||filter(cur.from,cur.to,cur.value))&&(builder.addInner(cur.from,cur.to,cur.value)||spill.push(Range.create(cur.from,cur.to,cur.value))),cur.next());return builder.finishInner(this.nextLayer.isEmpty&&!spill.length?RangeSet.empty:this.nextLayer.update({add:spill,filter:filter,filterFrom:filterFrom,filterTo:filterTo}))}map(changes){if(changes.empty||this.isEmpty)return this;let chunks=[],chunkPos=[],maxPoint=-1;for(let i=0;i<this.chunk.length;i++){let start=this.chunkPos[i],chunk=this.chunk[i],touch=changes.touchesRange(start,start+chunk.length);if(!1===touch)maxPoint=Math.max(maxPoint,chunk.maxPoint),chunks.push(chunk),chunkPos.push(changes.mapPos(start));else if(!0===touch){let{mapped:mapped,pos:pos}=chunk.map(start,changes);mapped&&(maxPoint=Math.max(maxPoint,mapped.maxPoint),chunks.push(mapped),chunkPos.push(pos))}}let next=this.nextLayer.map(changes);return 0==chunks.length?next:new RangeSet(chunkPos,chunks,next||RangeSet.empty,maxPoint)}between(from,to,f){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let start=this.chunkPos[i],chunk=this.chunk[i];if(to>=start&&from<=start+chunk.length&&!1===chunk.between(start,from-start,to-start,f))return}this.nextLayer.between(from,to,f)}}iter(from=0){return HeapCursor.from([this]).goto(from)}get isEmpty(){return this.nextLayer==this}static iter(sets,from=0){return HeapCursor.from(sets).goto(from)}static compare(oldSets,newSets,textDiff,comparator,minPointSize=-1){let a=oldSets.filter(set2=>set2.maxPoint>0||!set2.isEmpty&&set2.maxPoint>=minPointSize),b=newSets.filter(set2=>set2.maxPoint>0||!set2.isEmpty&&set2.maxPoint>=minPointSize),sharedChunks=findSharedChunks(a,b,textDiff),sideA=new SpanCursor(a,sharedChunks,minPointSize),sideB=new SpanCursor(b,sharedChunks,minPointSize);textDiff.iterGaps((fromA,fromB,length)=>compare(sideA,fromA,sideB,fromB,length,comparator)),textDiff.empty&&0==textDiff.length&&compare(sideA,0,sideB,0,0,comparator)}static eq(oldSets,newSets,from=0,to){null==to&&(to=999999999);let a=oldSets.filter(set2=>!set2.isEmpty&&newSets.indexOf(set2)<0),b=newSets.filter(set2=>!set2.isEmpty&&oldSets.indexOf(set2)<0);if(a.length!=b.length)return!1;if(!a.length)return!0;let sharedChunks=findSharedChunks(a,b),sideA=new SpanCursor(a,sharedChunks,0).goto(from),sideB=new SpanCursor(b,sharedChunks,0).goto(from);for(;;){if(sideA.to!=sideB.to||!sameValues(sideA.active,sideB.active)||sideA.point&&(!sideB.point||!sideA.point.eq(sideB.point)))return!1;if(sideA.to>to)return!0;sideA.next(),sideB.next()}}static spans(sets,from,to,iterator2,minPointSize=-1){let cursor=new SpanCursor(sets,null,minPointSize).goto(from),pos=from,openRanges=cursor.openStart;for(;;){let curTo=Math.min(cursor.to,to);if(cursor.point){let active=cursor.activeForPoint(cursor.to),openCount=cursor.pointFrom<from?active.length+1:cursor.point.startSide<0?active.length:Math.min(active.length,openRanges);iterator2.point(pos,curTo,cursor.point,active,openCount,cursor.pointRank),openRanges=Math.min(cursor.openEnd(curTo),active.length)}else curTo>pos&&(iterator2.span(pos,curTo,cursor.active,openRanges),openRanges=cursor.openEnd(curTo));if(cursor.to>to)return openRanges+(cursor.point&&cursor.to>to?1:0);pos=cursor.to,cursor.next()}}static of(ranges,sort2=!1){let build=new RangeSetBuilder;for(let range2 of ranges instanceof Range?[ranges]:sort2?function(ranges){if(ranges.length>1)for(let prev=ranges[0],i=1;i<ranges.length;i++){let cur=ranges[i];if(cmpRange(prev,cur)>0)return ranges.slice().sort(cmpRange);prev=cur}return ranges}(ranges):ranges)build.add(range2.from,range2.to,range2.value);return build.finish()}static join(sets){if(!sets.length)return RangeSet.empty;let result=sets[sets.length-1];for(let i=sets.length-2;i>=0;i--)for(let layer=sets[i];layer!=RangeSet.empty;layer=layer.nextLayer)result=new RangeSet(layer.chunkPos,layer.chunk,result,Math.max(layer.maxPoint,result.maxPoint));return result}}RangeSet.empty=new RangeSet([],[],null,-1),RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{finishChunk(newArrays){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,newArrays&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(from,to,value){this.addInner(from,to,value)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(from,to,value)}addInner(from,to,value){let diff2=from-this.lastTo||value.startSide-this.last.endSide;if(diff2<=0&&(from-this.lastFrom||value.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(diff2<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=from),this.from.push(from-this.chunkStart),this.to.push(to-this.chunkStart),this.last=value,this.lastFrom=from,this.lastTo=to,this.value.push(value),value.point&&(this.maxPoint=Math.max(this.maxPoint,to-from)),!0)}addChunk(from,chunk){if((from-this.lastTo||chunk.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,chunk.maxPoint),this.chunks.push(chunk),this.chunkPos.push(from);let last=chunk.value.length-1;return this.last=chunk.value[last],this.lastFrom=chunk.from[last]+from,this.lastTo=chunk.to[last]+from,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(next){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return next;let result=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(next):next,this.setMaxPoint);return this.from=null,result}}function findSharedChunks(a,b,textDiff){let inA=new Map;for(let set2 of a)for(let i=0;i<set2.chunk.length;i++)set2.chunk[i].maxPoint<=0&&inA.set(set2.chunk[i],set2.chunkPos[i]);let shared=new Set;for(let set2 of b)for(let i=0;i<set2.chunk.length;i++){let known=inA.get(set2.chunk[i]);null==known||(textDiff?textDiff.mapPos(known):known)!=set2.chunkPos[i]||(null==textDiff?void 0:textDiff.touchesRange(known,known+set2.chunk[i].length))||shared.add(set2.chunk[i])}return shared}class LayerCursor{constructor(layer,skip,minPoint,rank=0){this.layer=layer,this.skip=skip,this.minPoint=minPoint,this.rank=rank}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(pos,side=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(pos,side,!1),this}gotoInner(pos,side,forward){for(;this.chunkIndex<this.layer.chunk.length;){let next=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(next)||this.layer.chunkEnd(this.chunkIndex)<pos||next.maxPoint<this.minPoint))break;this.chunkIndex++,forward=!1}if(this.chunkIndex<this.layer.chunk.length){let rangeIndex=this.layer.chunk[this.chunkIndex].findIndex(pos-this.layer.chunkPos[this.chunkIndex],side,!0);(!forward||this.rangeIndex<rangeIndex)&&this.setRangeIndex(rangeIndex)}this.next()}forward(pos,side){(this.to-pos||this.endSide-side)<0&&this.gotoInner(pos,side,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let chunkPos=this.layer.chunkPos[this.chunkIndex],chunk=this.layer.chunk[this.chunkIndex],from=chunkPos+chunk.from[this.rangeIndex];if(this.from=from,this.to=chunkPos+chunk.to[this.rangeIndex],this.value=chunk.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(index2){if(index2==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=index2}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(other){return this.from-other.from||this.startSide-other.startSide||this.rank-other.rank||this.to-other.to||this.endSide-other.endSide}}class HeapCursor{constructor(heap){this.heap=heap}static from(sets,skip=null,minPoint=-1){let heap=[];for(let i=0;i<sets.length;i++)for(let cur=sets[i];!cur.isEmpty;cur=cur.nextLayer)cur.maxPoint>=minPoint&&heap.push(new LayerCursor(cur,skip,minPoint,i));return 1==heap.length?heap[0]:new HeapCursor(heap)}get startSide(){return this.value?this.value.startSide:0}goto(pos,side=-1e9){for(let cur of this.heap)cur.goto(pos,side);for(let i=this.heap.length>>1;i>=0;i--)heapBubble(this.heap,i);return this.next(),this}forward(pos,side){for(let cur of this.heap)cur.forward(pos,side);for(let i=this.heap.length>>1;i>=0;i--)heapBubble(this.heap,i);(this.to-pos||this.value.endSide-side)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let top=this.heap[0];this.from=top.from,this.to=top.to,this.value=top.value,this.rank=top.rank,top.value&&top.next(),heapBubble(this.heap,0)}}}function heapBubble(heap,index2){for(let cur=heap[index2];;){let childIndex=1+(index2<<1);if(childIndex>=heap.length)break;let child=heap[childIndex];if(childIndex+1<heap.length&&child.compare(heap[childIndex+1])>=0&&(child=heap[childIndex+1],childIndex++),cur.compare(child)<0)break;heap[childIndex]=cur,heap[index2]=child,index2=childIndex}}class SpanCursor{constructor(sets,skip,minPoint){this.minPoint=minPoint,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(sets,skip,minPoint)}goto(pos,side=-1e9){return this.cursor.goto(pos,side),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=pos,this.endSide=side,this.openStart=-1,this.next(),this}forward(pos,side){for(;this.minActive>-1&&(this.activeTo[this.minActive]-pos||this.active[this.minActive].endSide-side)<0;)this.removeActive(this.minActive);this.cursor.forward(pos,side)}removeActive(index2){remove(this.active,index2),remove(this.activeTo,index2),remove(this.activeRank,index2),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(trackOpen){let i=0,{value:value,to:to,rank:rank}=this.cursor;for(;i<this.activeRank.length&&(rank-this.activeRank[i]||to-this.activeTo[i])>0;)i++;insert(this.active,i,value),insert(this.activeTo,i,to),insert(this.activeRank,i,rank),trackOpen&&insert(trackOpen,i,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let from=this.to,wasPoint=this.point;this.point=null;let trackOpen=this.openStart<0?[]:null;for(;;){let a=this.minActive;if(a>-1&&(this.activeTo[a]-this.cursor.from||this.active[a].endSide-this.cursor.startSide)<0){if(this.activeTo[a]>from){this.to=this.activeTo[a],this.endSide=this.active[a].endSide;break}this.removeActive(a),trackOpen&&remove(trackOpen,a)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>from){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let nextVal=this.cursor.value;if(nextVal.point){if(!(wasPoint&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=nextVal,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=nextVal.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(trackOpen),this.cursor.next()}}}if(trackOpen){this.openStart=0;for(let i=trackOpen.length-1;i>=0&&trackOpen[i]<from;i--)this.openStart++}}activeForPoint(to){if(!this.active.length)return this.active;let active=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>to||this.activeTo[i]==to&&this.active[i].endSide>=this.point.endSide)&&active.push(this.active[i]);return active.reverse()}openEnd(to){let open=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>to;i--)open++;return open}}function compare(a,startA,b,startB,length,comparator){a.goto(startA),b.goto(startB);let endB=startB+length,pos=startB,dPos=startB-startA;for(;;){let dEnd=a.to+dPos-b.to,diff2=dEnd||a.endSide-b.endSide,end=diff2<0?a.to+dPos:b.to,clipEnd=Math.min(end,endB);if(a.point||b.point?a.point&&b.point&&(a.point==b.point||a.point.eq(b.point))&&sameValues(a.activeForPoint(a.to),b.activeForPoint(b.to))||comparator.comparePoint(pos,clipEnd,a.point,b.point):clipEnd>pos&&!sameValues(a.active,b.active)&&comparator.compareRange(pos,clipEnd,a.active,b.active),end>endB)break;(dEnd||a.openEnd!=b.openEnd)&&comparator.boundChange&&comparator.boundChange(end),pos=end,diff2<=0&&a.next(),diff2>=0&&b.next()}}function sameValues(a,b){if(a.length!=b.length)return!1;for(let i=0;i<a.length;i++)if(a[i]!=b[i]&&!a[i].eq(b[i]))return!1;return!0}function remove(array,index2){for(let i=index2,e=array.length-1;i<e;i++)array[i]=array[i+1];array.pop()}function insert(array,index2,value){for(let i=array.length-1;i>=index2;i--)array[i+1]=array[i];array[index2]=value}function findMinIndex(value,array){let found=-1,foundPos=1e9;for(let i=0;i<array.length;i++)(array[i]-foundPos||value[i].endSide-value[found].endSide)<0&&(found=i,foundPos=array[i]);return found}function parse(timelineString,cache2,now2){const parser={version:"0.15.0"};if(!timelineString)return __spreadProps(__spreadValues({},(DateTime$1.now(),{events:new EventGroup,ranges:[],foldables:[],ids:{},header:{dateFormat:"M/d/y"},parseMessages:[],documentMessages:[]})),{cache:cache2,parser:parser,parseMessages:[]});const{lines:lines,lengthAtIndex:lengthAtIndex}=(timelineString=>{const lines=timelineString instanceof Text?timelineString.toJSON():Array.isArray(timelineString)?timelineString:timelineString.split("\n");let lengthAtIndex=[];for(let i=0;i<lines.length;i++)0===i&&lengthAtIndex.push(0),lengthAtIndex.push((i===lines.length-1?0:1)+lines[i].length+lengthAtIndex[lengthAtIndex.length-1]||0);return{lines:lines,lengthAtIndex:lengthAtIndex}})(timelineString);return __spreadProps(__spreadValues({},function(lines,lengthAtIndex,cache2,now2){const context=new ParsingContext(now2,cache2),headerEndLineIndex=function(lines,lengthAtIndex,context){var _a2;let headerStartLineIndex=0,headerEndLineIndex=headerStartLineIndex,firstHeaderLineIndexWithText=-1,lastHeaderLineIndexWithText=-1,hasThreeDashStart=!1;const headerLines=[],headerRanges=[],threeDashRanges=[];let start,end,line=lines[headerStartLineIndex];for(;void 0!==line&&(hasThreeDashStart||!eventsStarted(line));){const isThreeDash=line.match(threeDashRegex);if(isThreeDash){const range2={type:RangeType.FrontmatterDelimiter,from:lengthAtIndex[headerEndLineIndex],to:lengthAtIndex[headerEndLineIndex]+4};if(threeDashRanges.push(range2),hasThreeDashStart){2===threeDashRanges.length&&(context.ranges.push(threeDashRanges[0]),context.ranges.push(threeDashRanges[1]));break}headerStartLineIndex=headerEndLineIndex,hasThreeDashStart=!0}const isComment=checkComments(line,headerEndLineIndex,lengthAtIndex,context);if(isComment||(line=checkHeaderTags(line,headerEndLineIndex,lengthAtIndex,context),headerLines.push(line)),!isComment&&!isThreeDash){const keyMatch=line.match(headerKeyRegex);keyMatch&&(headerRanges.push({type:RangeType.HeaderKey,from:lengthAtIndex[headerEndLineIndex],to:lengthAtIndex[headerEndLineIndex]+keyMatch[1].length}),headerRanges.push({type:RangeType.HeaderKeyColon,from:lengthAtIndex[headerEndLineIndex]+keyMatch[1].length,to:lengthAtIndex[headerEndLineIndex]+keyMatch[1].length+1}));const valueMatch=line.match(headerValueRegex);let index2;index2=valueMatch?keyMatch?keyMatch[0].length+line.substring(keyMatch[0].length).indexOf(valueMatch[2]):line.indexOf(valueMatch[2]):keyMatch?-1:0,index2>=0&&headerRanges.push({type:RangeType.HeaderValue,from:lengthAtIndex[headerEndLineIndex]+index2,to:lengthAtIndex[headerEndLineIndex]+index2+(valueMatch?valueMatch[2].length:line.length)})}line.length&&(-1===firstHeaderLineIndexWithText&&(firstHeaderLineIndexWithText=headerEndLineIndex),lastHeaderLineIndexWithText=headerEndLineIndex),headerEndLineIndex++,line=lines[headerEndLineIndex]}try{const parsedHeader=parse$2(headerLines.join("\n"));if(parsedHeader.dateFormat||(parsedHeader.dateFormat="d/M/y"===parsedHeader.dateFormat?"d/M/y":"M/d/y"),parsedHeader.view&&"string"==typeof parsedHeader.view&&(parsedHeader.view=stringEmailListToArray(parsedHeader.view)),parsedHeader.edit&&"string"==typeof parsedHeader.edit&&(parsedHeader.edit=stringEmailListToArray(parsedHeader.edit)),(void 0!==parsedHeader.timezone||void 0!==parsedHeader.tz)&&!parseZone(null!=(_a2=parsedHeader.timezone)?_a2:parsedHeader.tz,context.cache))for(let i=headerStartLineIndex;i<lines.length;i++){const timezoneDefs=["timezone:","tz:"];for(let j=0;j<timezoneDefs.length;j++){const timezoneDef=timezoneDefs[j];if(lines[i].startsWith(timezoneDef)){const specifiedTimezone=lines[i].substring(timezoneDef.length).trim(),start2=lengthAtIndex[i]+lines[i].indexOf(specifiedTimezone),end2=start2+specifiedTimezone.length;context.parseMessages.push({type:"error",pos:[start2,end2],message:`Invalid timezone "${specifiedTimezone}"`})}}}context.ranges.push(...headerRanges),context.header=parsedHeader}catch(e){e instanceof YAMLParseError&&context.parseMessages.push({type:"error",pos:e.pos,message:e.message}),context.header={dateFormat:"M/d/y"}}if(2===threeDashRanges.length){const index2=lengthAtIndex[headerStartLineIndex];start=index2,end=lengthAtIndex[headerEndLineIndex]-1,context.foldables[index2]={startLine:headerStartLineIndex,startIndex:start,endIndex:end,type:"header",foldStartIndex:2===threeDashRanges.length?index2+3:index2}}else if(firstHeaderLineIndexWithText>=0&&lastHeaderLineIndexWithText>=0&&lastHeaderLineIndexWithText!==firstHeaderLineIndexWithText){start=lengthAtIndex[firstHeaderLineIndexWithText],end=lengthAtIndex[lastHeaderLineIndexWithText+1]-1;const foldable={startLine:firstHeaderLineIndexWithText,startIndex:start,endIndex:end,type:"header",foldStartIndex:start};context.foldables[start]=foldable}const hasSomeText=lines.length>0||lines[0].length>0;return!context.header.timezone&&hasSomeText&&context.documentMessages.push({type:"warning",message:"Timezone not specified. Specifying a `timezone` in the header is highly recommended."}),headerEndLineIndex}(lines,lengthAtIndex,context);return function(from,context,lines,lengthAtIndex){let i=from;const upTo=lines.length;for(;i<lines.length&&i<upTo;){const line=lines[i];if(checkNonEvents(line,i,lengthAtIndex,context)){i++;continue}const possibleGroup=checkGroupStart(lines,i,lengthAtIndex,context);possibleGroup?i=possibleGroup.end:i=checkEvent(line,lines,i,lengthAtIndex,context)+1}{const lastLineIndex=i-1;for(;context.currentPath.length>1;)context.endCurrentGroup(lengthAtIndex[lastLineIndex]+lines[lastLineIndex].length,{line:lastLineIndex,index:lines[lastLineIndex].length})}}(headerEndLineIndex,context,lines,lengthAtIndex),context.toTimeline()}(lines,lengthAtIndex,cache2,now2)),{cache:cache2,parser:parser})}const expand=(dateRange,recurrence,limit2)=>{const instanceDuration=dateRange.toDateTime.diff(dateRange.fromDateTime);recurrence.dtstart=dateRange.fromDateTime.toISO();const rule=new RRule$1(function(recurrence){const until=recurrence.until?DateTime$1.fromISO(recurrence.until).toJSDate():void 0,dtstart=recurrence.dtstart?DateTime$1.fromISO(recurrence.dtstart).toJSDate():void 0;return __spreadProps(__spreadValues({},recurrence),{until:until,dtstart:dtstart})}(recurrence)),expansion=[];return rule.all((d,i)=>!(i>=limit2)&&(expansion.push(DateTime$1.fromJSDate(d)),!0)),expansion.length?expansion.map(dt=>({fromDateTime:dt,toDateTime:dt.plus(instanceDuration)})):[dateRange]};var COLORS=["22, 163, 76","2, 132, 199","212, 50, 56","242, 202, 45","80, 73, 229","145, 57, 234","214, 45, 123","234, 88, 11","168, 162, 157","255, 255, 255","0, 0, 0"],HUMAN_COLORS=["green","blue","red","yellow","indigo","purple","pink","orange","gray","white","black"];var colorMapAndRangesFromMarkwhen=function(timeline,colorIndex){var map2={},ranges=timeline.ranges.flatMap(function(r){var _r$content;if(r.type!==RangeType.Tag)return[];if(map2[r.content.tag])return r.content.color=map2[r.content.tag],[r];var tagColorDefintion,headerDefinition=(null===(_r$content=r.content)||void 0===_r$content?void 0:_r$content.tag)&&timeline.header[")"+r.content.tag];if(tagColorDefintion=!!headerDefinition&&("string"==typeof headerDefinition&&headerDefinition||"object"===_typeof(headerDefinition)&&headerDefinition.color)){var humanColorIndex=HUMAN_COLORS.indexOf(tagColorDefintion);if(-1===humanColorIndex){var rgb=function(hex){var isShortHex=3===(hex=hex.replace("#","").replace(")","")).length,r=parseInt(isShortHex?hex.slice(0,1).repeat(2):hex.slice(0,2),16);if(!isNaN(r)){var g=parseInt(isShortHex?hex.slice(1,2).repeat(2):hex.slice(2,4),16);if(!isNaN(g)){var b=parseInt(isShortHex?hex.slice(2,3).repeat(2):hex.slice(4,6),16);if(!isNaN(b))return"".concat(r,", ").concat(g,", ").concat(b)}}}(tagColorDefintion);r.content.color=rgb||COLORS[colorIndex++%COLORS.length]}else r.content.color=COLORS[humanColorIndex]}else r.content.color=COLORS[colorIndex++%COLORS.length];return map2[r.content.tag]=r.content.color,[r]});return[map2,ranges,colorIndex]},useColors=function(markwhen){return computed(function(){for(var colorIndex=0,colorMap={},_i=0,_arr=[["default",markwhen]];_i<_arr.length;_i++){var _arr$_i=_slicedToArray(_arr[_i],2),path=_arr$_i[0],timeline=_arr$_i[1],_colorMapAndRangesFro2=_slicedToArray(colorMapAndRangesFromMarkwhen(timeline,colorIndex),3),map22=_colorMapAndRangesFro2[0];_colorMapAndRangesFro2[1];var index2=_colorMapAndRangesFro2[2];colorMap[path]=map22,colorIndex=index2}return colorMap})},useLpc=function(listeners){var socket,calls=new Map,wssUrl="undefined"!=typeof window&&window.__markwhen_wss_url,hasConnected=!1;if(wssUrl)try{(socket=new WebSocket(wssUrl)).onopen=function(){hasConnected=!0,console.debug("WebSocket connected to:",wssUrl),postRequest("appState"),postRequest("markwhenState")},socket.onerror=function(error){console.debug("WebSocket connection failed:",error),hasConnected=!1},socket.onclose=function(){console.debug("WebSocket connection closed"),hasConnected=!1}}catch(error){console.debug("Failed to create WebSocket connection:",error)}var vscApi=void 0,post=function(message){if(socket&&hasConnected)socket.send(JSON.stringify(message));else if("undefined"!=typeof acquireVsCodeApi){var _vscode;null===(_vscode=vscApi||(vscApi=acquireVsCodeApi()))||void 0===_vscode||_vscode.postMessage(message)}else"undefined"!=typeof window&&void 0!==window.parent&&window.parent!==window.self?window.parent.postMessage(message,"*"):console.debug("No communication channel available, message ignored:",message.type)},postRequest=function(type,params){var id="markwhen_".concat(function(){for(var text="",possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<32;i++)text+=possible.charAt(Math.floor(62*Math.random()));return text}());return new Promise(function(resolve,reject){calls.set(id,{resolve:resolve,reject:reject}),post({type:type,request:!0,id:id,params:params})})},messageListener=function(e){if(e.data.id&&e.data.id.startsWith("markwhen")){var _calls$get,data=e.data;if(data.response)null===(_calls$get=calls.get(data.id))||void 0===_calls$get||_calls$get.resolve(data),calls.delete(data.id);else if(data.request){var _listeners$data$type,result=null==listeners||null===(_listeners$data$type=listeners[data.type])||void 0===_listeners$data$type?void 0:_listeners$data$type.call(listeners,data.params);Promise.resolve(result).then(function(resp){var id,type;id=data.id,type=data.type,post({type:type,response:!0,id:id,params:resp})})}else console.error("Not a request or response",data)}};socket?socket.onmessage=function(event){var messageClone=new MessageEvent("message",{data:JSON.parse(event.data)});messageListener(messageClone)}:"undefined"!=typeof window&&window.addEventListener("message",messageListener);var initialState="undefined"!=typeof window&&window.__markwhen_initial_state;if(initialState&&listeners&&listeners.markwhenState){var _listeners$appState,colorMap=useColors(initialState.parsed).value;listeners.markwhenState(initialState),null===(_listeners$appState=listeners.appState)||void 0===_listeners$appState||_listeners$appState.call(listeners,{colorMap:colorMap})}return{postRequest:postRequest,getConnectionStatus:function(){return socket&&hasConnected?{type:"websocket",connected:!0,url:wssUrl}:"undefined"!=typeof acquireVsCodeApi?{type:"vscode",connected:!0}:"undefined"!=typeof window&&void 0!==window.parent&&window.parent!==window.self?{type:"parent-window",connected:!0}:{type:"none",connected:!1}}}};const isBrowser="undefined"!=typeof document;function isRouteComponent(component){return"object"==typeof component||"displayName"in component||"props"in component||"__vccOpts"in component}const assign=Object.assign;function applyToParams(fn,params){const newParams={};for(const key in params){const value=params[key];newParams[key]=isArray(value)?value.map(fn):fn(value)}return newParams}const noop$1=()=>{},isArray=Array.isArray,HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(text){return encodeURI(""+text).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeQueryValue(text){return commonEncode(text).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(text){return encodeQueryValue(text).replace(EQUAL_RE,"%3D")}function encodeParam(text){return null==text?"":function(text){return commonEncode(text).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}(text).replace(SLASH_RE,"%2F")}function decode(text){try{return decodeURIComponent(""+text)}catch(err){}return""+text}const TRAILING_SLASH_RE=/\/$/;function parseURL(parseQuery2,location2,currentLocation="/"){let path,query={},searchString="",hash="";const hashPos=location2.indexOf("#");let searchPos=location2.indexOf("?");return hashPos<searchPos&&hashPos>=0&&(searchPos=-1),searchPos>-1&&(path=location2.slice(0,searchPos),searchString=location2.slice(searchPos+1,hashPos>-1?hashPos:location2.length),query=parseQuery2(searchString)),hashPos>-1&&(path=path||location2.slice(0,hashPos),hash=location2.slice(hashPos,location2.length)),path=function(to,from){if(to.startsWith("/"))return to;if(!to)return from;const fromSegments=from.split("/"),toSegments=to.split("/"),lastToSegment=toSegments[toSegments.length-1];".."!==lastToSegment&&"."!==lastToSegment||toSegments.push("");let toPosition,segment,position=fromSegments.length-1;for(toPosition=0;toPosition<toSegments.length;toPosition++)if(segment=toSegments[toPosition],"."!==segment){if(".."!==segment)break;position>1&&position--}return fromSegments.slice(0,position).join("/")+"/"+toSegments.slice(toPosition).join("/")}(null!=path?path:location2,currentLocation),{fullPath:path+(searchString&&"?")+searchString+hash,path:path,query:query,hash:decode(hash)}}function stripBase(pathname,base){return base&&pathname.toLowerCase().startsWith(base.toLowerCase())?pathname.slice(base.length)||"/":pathname}function isSameRouteRecord(a,b){return(a.aliasOf||a)===(b.aliasOf||b)}function isSameRouteLocationParams(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(const key in a)if(!isSameRouteLocationParamsValue(a[key],b[key]))return!1;return!0}function isSameRouteLocationParamsValue(a,b){return isArray(a)?isEquivalentArray(a,b):isArray(b)?isEquivalentArray(b,a):a===b}function isEquivalentArray(a,b){return isArray(b)?a.length===b.length&&a.every((value,i)=>value===b[i]):1===a.length&&a[0]===b}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var NavigationType,NavigationType2,NavigationDirection,NavigationDirection2;function normalizeBase(base){if(!base)if(isBrowser){const baseEl=document.querySelector("base");base=(base=baseEl&&baseEl.getAttribute("href")||"/").replace(/^\w+:\/\/[^\/]+/,"")}else base="/";return"/"!==base[0]&&"#"!==base[0]&&(base="/"+base),base.replace(TRAILING_SLASH_RE,"")}(NavigationType2=NavigationType||(NavigationType={})).pop="pop",NavigationType2.push="push",(NavigationDirection2=NavigationDirection||(NavigationDirection={})).back="back",NavigationDirection2.forward="forward",NavigationDirection2.unknown="";const BEFORE_HASH_RE=/^[^#]+#/;function createHref(base,location2){return base.replace(BEFORE_HASH_RE,"#")+location2}const computeScrollPosition=()=>({left:window.scrollX,top:window.scrollY});function scrollToPosition(position){let scrollToOptions;if("el"in position){const positionEl=position.el,isIdSelector="string"==typeof positionEl&&positionEl.startsWith("#"),el="string"==typeof positionEl?isIdSelector?document.getElementById(positionEl.slice(1)):document.querySelector(positionEl):positionEl;if(!el)return;scrollToOptions=function(el,offset2){const docRect=document.documentElement.getBoundingClientRect(),elRect=el.getBoundingClientRect();return{behavior:offset2.behavior,left:elRect.left-docRect.left-(offset2.left||0),top:elRect.top-docRect.top-(offset2.top||0)}}(el,position)}else scrollToOptions=position;"scrollBehavior"in document.documentElement.style?window.scrollTo(scrollToOptions):window.scrollTo(null!=scrollToOptions.left?scrollToOptions.left:window.scrollX,null!=scrollToOptions.top?scrollToOptions.top:window.scrollY)}function getScrollKey(path,delta){return(history.state?history.state.position-delta:-1)+path}const scrollPositions=new Map;function createCurrentLocation(base,location2){const{pathname:pathname,search:search,hash:hash}=location2,hashPos=base.indexOf("#");if(hashPos>-1){let slicePos=hash.includes(base.slice(hashPos))?base.slice(hashPos).length:1,pathFromHash=hash.slice(slicePos);return"/"!==pathFromHash[0]&&(pathFromHash="/"+pathFromHash),stripBase(pathFromHash,"")}return stripBase(pathname,base)+search+hash}function buildState(back,current,forward,replaced=!1,computeScroll=!1){return{back:back,current:current,forward:forward,replaced:replaced,position:window.history.length,scroll:computeScroll?computeScrollPosition():null}}function useHistoryStateNavigation(base){const{history:history2,location:location2}=window,currentLocation={value:createCurrentLocation(base,location2)},historyState={value:history2.state};function changeLocation(to,state,replace2){const hashIndex=base.indexOf("#"),url=hashIndex>-1?(location2.host&&document.querySelector("base")?base:base.slice(hashIndex))+to:location.protocol+"//"+location.host+base+to;try{history2[replace2?"replaceState":"pushState"](state,"",url),historyState.value=state}catch(err){console.error(err),location2[replace2?"replace":"assign"](url)}}return historyState.value||changeLocation(currentLocation.value,{back:null,current:currentLocation.value,forward:null,position:history2.length-1,replaced:!0,scroll:null},!0),{location:currentLocation,state:historyState,push:function(to,data){const currentState=assign({},historyState.value,history2.state,{forward:to,scroll:computeScrollPosition()});changeLocation(currentState.current,currentState,!0),changeLocation(to,assign({},buildState(currentLocation.value,to,null),{position:currentState.position+1},data),!1),currentLocation.value=to},replace:function(to,data){changeLocation(to,assign({},history2.state,buildState(historyState.value.back,to,historyState.value.forward,!0),data,{position:historyState.value.position}),!0),currentLocation.value=to}}}function isRouteName(name){return"string"==typeof name||"symbol"==typeof name}const NavigationFailureSymbol=Symbol("");var NavigationFailureType,NavigationFailureType2;function createRouterError(type,params){return assign(new Error,{type:type,[NavigationFailureSymbol]:!0},params)}function isNavigationFailure(error,type){return error instanceof Error&&NavigationFailureSymbol in error&&(null==type||!!(error.type&type))}(NavigationFailureType2=NavigationFailureType||(NavigationFailureType={}))[NavigationFailureType2.aborted=4]="aborted",NavigationFailureType2[NavigationFailureType2.cancelled=8]="cancelled",NavigationFailureType2[NavigationFailureType2.duplicated=16]="duplicated";const BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function compareScoreArray(a,b){let i=0;for(;i<a.length&&i<b.length;){const diff2=b[i]-a[i];if(diff2)return diff2;i++}return a.length<b.length?1===a.length&&80===a[0]?-1:1:a.length>b.length?1===b.length&&80===b[0]?1:-1:0}function comparePathParserScore(a,b){let i=0;const aScore=a.score,bScore=b.score;for(;i<aScore.length&&i<bScore.length;){const comp=compareScoreArray(aScore[i],bScore[i]);if(comp)return comp;i++}if(1===Math.abs(bScore.length-aScore.length)){if(isLastScoreNegative(aScore))return 1;if(isLastScoreNegative(bScore))return-1}return bScore.length-aScore.length}function isLastScoreNegative(score){const last=score[score.length-1];return score.length>0&&last[last.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function createRouteRecordMatcher(record,parent,options){const parser=function(segments,extraOptions){const options=assign({},BASE_PATH_PARSER_OPTIONS,extraOptions),score=[];let pattern=options.start?"^":"";const keys=[];for(const segment of segments){const segmentScores=segment.length?[]:[90];options.strict&&!segment.length&&(pattern+="/");for(let tokenIndex=0;tokenIndex<segment.length;tokenIndex++){const token=segment[tokenIndex];let subSegmentScore=40+(options.sensitive?.25:0);if(0===token.type)tokenIndex||(pattern+="/"),pattern+=token.value.replace(REGEX_CHARS_RE,"\\$&"),subSegmentScore+=40;else if(1===token.type){const{value:value,repeatable:repeatable,optional:optional,regexp:regexp}=token;keys.push({name:value,repeatable:repeatable,optional:optional});const re2=regexp||"[^/]+?";if("[^/]+?"!==re2){subSegmentScore+=10;try{new RegExp(`(${re2})`)}catch(err){throw new Error(`Invalid custom RegExp for param "${value}" (${re2}): `+err.message)}}let subPattern=repeatable?`((?:${re2})(?:/(?:${re2}))*)`:`(${re2})`;tokenIndex||(subPattern=optional&&segment.length<2?`(?:/${subPattern})`:"/"+subPattern),optional&&(subPattern+="?"),pattern+=subPattern,subSegmentScore+=20,optional&&(subSegmentScore+=-8),repeatable&&(subSegmentScore+=-20),".*"===re2&&(subSegmentScore+=-50)}segmentScores.push(subSegmentScore)}score.push(segmentScores)}if(options.strict&&options.end){const i=score.length-1;score[i][score[i].length-1]+=.7000000000000001}options.strict||(pattern+="/?"),options.end?pattern+="$":options.strict&&(pattern+="(?:/|$)");const re=new RegExp(pattern,options.sensitive?"":"i");return{re:re,score:score,keys:keys,parse:function(path){const match2=path.match(re),params={};if(!match2)return null;for(let i=1;i<match2.length;i++){const value=match2[i]||"",key=keys[i-1];params[key.name]=value&&key.repeatable?value.split("/"):value}return params},stringify:function(params){let path="",avoidDuplicatedSlash=!1;for(const segment of segments){avoidDuplicatedSlash&&path.endsWith("/")||(path+="/"),avoidDuplicatedSlash=!1;for(const token of segment)if(0===token.type)path+=token.value;else if(1===token.type){const{value:value,repeatable:repeatable,optional:optional}=token,param=value in params?params[value]:"";if(isArray(param)&&!repeatable)throw new Error(`Provided param "${value}" is an array but it is not repeatable (* or + modifiers)`);const text=isArray(param)?param.join("/"):param;if(!text){if(!optional)throw new Error(`Missing required param "${value}"`);segment.length<2&&(path.endsWith("/")?path=path.slice(0,-1):avoidDuplicatedSlash=!0)}path+=text}}return path||"/"}}}(function(path){if(!path)return[[]];if("/"===path)return[[ROOT_TOKEN]];if(!path.startsWith("/"))throw new Error(`Invalid path "${path}"`);function crash(message){throw new Error(`ERR (${state})/"${buffer}": ${message}`)}let state=0,previousState=state;const tokens=[];let segment;function finalizeSegment(){segment&&tokens.push(segment),segment=[]}let char,i=0,buffer="",customRe="";function consumeBuffer(){buffer&&(0===state?segment.push({type:0,value:buffer}):1===state||2===state||3===state?(segment.length>1&&("*"===char||"+"===char)&&crash(`A repeatable param (${buffer}) must be alone in its segment. eg: '/:ids+.`),segment.push({type:1,value:buffer,regexp:customRe,repeatable:"*"===char||"+"===char,optional:"*"===char||"?"===char})):crash("Invalid state to consume buffer"),buffer="")}function addCharToBuffer(){buffer+=char}for(;i<path.length;)if(char=path[i++],"\\"!==char||2===state)switch(state){case 0:"/"===char?(buffer&&consumeBuffer(),finalizeSegment()):":"===char?(consumeBuffer(),state=1):addCharToBuffer();break;case 4:addCharToBuffer(),state=previousState;break;case 1:"("===char?state=2:VALID_PARAM_RE.test(char)?addCharToBuffer():(consumeBuffer(),state=0,"*"!==char&&"?"!==char&&"+"!==char&&i--);break;case 2:")"===char?"\\"==customRe[customRe.length-1]?customRe=customRe.slice(0,-1)+char:state=3:customRe+=char;break;case 3:consumeBuffer(),state=0,"*"!==char&&"?"!==char&&"+"!==char&&i--,customRe="";break;default:crash("Unknown state")}else previousState=state,state=4;return 2===state&&crash(`Unfinished custom RegExp for param "${buffer}"`),consumeBuffer(),finalizeSegment(),tokens}(record.path),options),matcher=assign(parser,{record:record,parent:parent,children:[],alias:[]});return parent&&!matcher.record.aliasOf==!parent.record.aliasOf&&parent.children.push(matcher),matcher}function createRouterMatcher(routes,globalOptions){const matchers=[],matcherMap=new Map;function addRoute(record,parent,originalRecord){const isRootAdd=!originalRecord,mainNormalizedRecord=normalizeRouteRecord(record);mainNormalizedRecord.aliasOf=originalRecord&&originalRecord.record;const options=mergeOptions(globalOptions,record),normalizedRecords=[mainNormalizedRecord];if("alias"in record){const aliases="string"==typeof record.alias?[record.alias]:record.alias;for(const alias of aliases)normalizedRecords.push(normalizeRouteRecord(assign({},mainNormalizedRecord,{components:originalRecord?originalRecord.record.components:mainNormalizedRecord.components,path:alias,aliasOf:originalRecord?originalRecord.record:mainNormalizedRecord})))}let matcher,originalMatcher;for(const normalizedRecord of normalizedRecords){const{path:path}=normalizedRecord;if(parent&&"/"!==path[0]){const parentPath=parent.record.path,connectingSlash="/"===parentPath[parentPath.length-1]?"":"/";normalizedRecord.path=parent.record.path+(path&&connectingSlash+path)}if(matcher=createRouteRecordMatcher(normalizedRecord,parent,options),originalRecord?originalRecord.alias.push(matcher):(originalMatcher=originalMatcher||matcher,originalMatcher!==matcher&&originalMatcher.alias.push(matcher),isRootAdd&&record.name&&!isAliasRecord(matcher)&&removeRoute(record.name)),isMatchable(matcher)&&insertMatcher(matcher),mainNormalizedRecord.children){const children=mainNormalizedRecord.children;for(let i=0;i<children.length;i++)addRoute(children[i],matcher,originalRecord&&originalRecord.children[i])}originalRecord=originalRecord||matcher}return originalMatcher?()=>{removeRoute(originalMatcher)}:noop$1}function removeRoute(matcherRef){if(isRouteName(matcherRef)){const matcher=matcherMap.get(matcherRef);matcher&&(matcherMap.delete(matcherRef),matchers.splice(matchers.indexOf(matcher),1),matcher.children.forEach(removeRoute),matcher.alias.forEach(removeRoute))}else{const index2=matchers.indexOf(matcherRef);index2>-1&&(matchers.splice(index2,1),matcherRef.record.name&&matcherMap.delete(matcherRef.record.name),matcherRef.children.forEach(removeRoute),matcherRef.alias.forEach(removeRoute))}}function insertMatcher(matcher){const index2=function(matcher,matchers){let lower=0,upper=matchers.length;for(;lower!==upper;){const mid=lower+upper>>1;comparePathParserScore(matcher,matchers[mid])<0?upper=mid:lower=mid+1}const insertionAncestor=function(matcher){let ancestor=matcher;for(;ancestor=ancestor.parent;)if(isMatchable(ancestor)&&0===comparePathParserScore(matcher,ancestor))return ancestor;return}(matcher);insertionAncestor&&(upper=matchers.lastIndexOf(insertionAncestor,upper-1));return upper}(matcher,matchers);matchers.splice(index2,0,matcher),matcher.record.name&&!isAliasRecord(matcher)&&matcherMap.set(matcher.record.name,matcher)}return globalOptions=mergeOptions({strict:!1,end:!0,sensitive:!1},globalOptions),routes.forEach(route=>addRoute(route)),{addRoute:addRoute,resolve:function(location2,currentLocation){let matcher,path,name,params={};if("name"in location2&&location2.name){if(matcher=matcherMap.get(location2.name),!matcher)throw createRouterError(1,{location:location2});name=matcher.record.name,params=assign(paramsFromLocation(currentLocation.params,matcher.keys.filter(k=>!k.optional).concat(matcher.parent?matcher.parent.keys.filter(k=>k.optional):[]).map(k=>k.name)),location2.params&&paramsFromLocation(location2.params,matcher.keys.map(k=>k.name))),path=matcher.stringify(params)}else if(null!=location2.path)path=location2.path,matcher=matchers.find(m=>m.re.test(path)),matcher&&(params=matcher.parse(path),name=matcher.record.name);else{if(matcher=currentLocation.name?matcherMap.get(currentLocation.name):matchers.find(m=>m.re.test(currentLocation.path)),!matcher)throw createRouterError(1,{location:location2,currentLocation:currentLocation});name=matcher.record.name,params=assign({},currentLocation.params,location2.params),path=matcher.stringify(params)}const matched=[];let parentMatcher=matcher;for(;parentMatcher;)matched.unshift(parentMatcher.record),parentMatcher=parentMatcher.parent;return{name:name,path:path,params:params,matched:matched,meta:mergeMetaFields(matched)}},removeRoute:removeRoute,clearRoutes:function(){matchers.length=0,matcherMap.clear()},getRoutes:function(){return matchers},getRecordMatcher:function(name){return matcherMap.get(name)}}}function paramsFromLocation(params,keys){const newParams={};for(const key of keys)key in params&&(newParams[key]=params[key]);return newParams}function normalizeRouteRecord(record){const normalized={path:record.path,redirect:record.redirect,name:record.name,meta:record.meta||{},aliasOf:record.aliasOf,beforeEnter:record.beforeEnter,props:normalizeRecordProps(record),children:record.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in record?record.components||null:record.component&&{default:record.component}};return Object.defineProperty(normalized,"mods",{value:{}}),normalized}function normalizeRecordProps(record){const propsObject={},props=record.props||!1;if("component"in record)propsObject.default=props;else for(const name in record.components)propsObject[name]="object"==typeof props?props[name]:props;return propsObject}function isAliasRecord(record){for(;record;){if(record.record.aliasOf)return!0;record=record.parent}return!1}function mergeMetaFields(matched){return matched.reduce((meta,record)=>assign(meta,record.meta),{})}function mergeOptions(defaults,partialOptions){const options={};for(const key in defaults)options[key]=key in partialOptions?partialOptions[key]:defaults[key];return options}function isMatchable({record:record}){return!!(record.name||record.components&&Object.keys(record.components).length||record.redirect)}function parseQuery(search){const query={};if(""===search||"?"===search)return query;const searchParams=("?"===search[0]?search.slice(1):search).split("&");for(let i=0;i<searchParams.length;++i){const searchParam=searchParams[i].replace(PLUS_RE," "),eqPos=searchParam.indexOf("="),key=decode(eqPos<0?searchParam:searchParam.slice(0,eqPos)),value=eqPos<0?null:decode(searchParam.slice(eqPos+1));if(key in query){let currentValue=query[key];isArray(currentValue)||(currentValue=query[key]=[currentValue]),currentValue.push(value)}else query[key]=value}return query}function stringifyQuery(query){let search="";for(let key in query){const value=query[key];if(key=encodeQueryKey(key),null==value){void 0!==value&&(search+=(search.length?"&":"")+key);continue}(isArray(value)?value.map(v=>v&&encodeQueryValue(v)):[value&&encodeQueryValue(value)]).forEach(value2=>{void 0!==value2&&(search+=(search.length?"&":"")+key,null!=value2&&(search+="="+value2))})}return search}function normalizeQuery(query){const normalizedQuery={};for(const key in query){const value=query[key];void 0!==value&&(normalizedQuery[key]=isArray(value)?value.map(v=>null==v?null:""+v):null==value?value:""+value)}return normalizedQuery}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let handlers=[];return{add:function(handler){return handlers.push(handler),()=>{const i=handlers.indexOf(handler);i>-1&&handlers.splice(i,1)}},list:()=>handlers.slice(),reset:function(){handlers=[]}}}function guardToPromiseFn(guard,to,from,record,name,runWithContext=fn=>fn()){const enterCallbackArray=record&&(record.enterCallbacks[name]=record.enterCallbacks[name]||[]);return()=>new Promise((resolve,reject)=>{const next=valid=>{var route;!1===valid?reject(createRouterError(4,{from:from,to:to})):valid instanceof Error?reject(valid):"string"==typeof(route=valid)||route&&"object"==typeof route?reject(createRouterError(2,{from:to,to:valid})):(enterCallbackArray&&record.enterCallbacks[name]===enterCallbackArray&&"function"==typeof valid&&enterCallbackArray.push(valid),resolve())},guardReturn=runWithContext(()=>guard.call(record&&record.instances[name],to,from,next));let guardCall=Promise.resolve(guardReturn);guard.length<3&&(guardCall=guardCall.then(next)),guardCall.catch(err=>reject(err))})}function extractComponentsGuards(matched,guardType,to,from,runWithContext=fn=>fn()){const guards=[];for(const record of matched)for(const name in record.components){let rawComponent=record.components[name];if("beforeRouteEnter"===guardType||record.instances[name])if(isRouteComponent(rawComponent)){const guard=(rawComponent.__vccOpts||rawComponent)[guardType];guard&&guards.push(guardToPromiseFn(guard,to,from,record,name,runWithContext))}else{let componentPromise=rawComponent();guards.push(()=>componentPromise.then(resolved=>{if(!resolved)throw new Error(`Couldn't resolve component "${name}" at "${record.path}"`);const resolvedComponent=(obj=resolved).__esModule||"Module"===obj[Symbol.toStringTag]||obj.default&&isRouteComponent(obj.default)?resolved.default:resolved;var obj;record.mods[name]=resolved,record.components[name]=resolvedComponent;const guard=(resolvedComponent.__vccOpts||resolvedComponent)[guardType];return guard&&guardToPromiseFn(guard,to,from,record,name,runWithContext)()}))}}return guards}function useLink(props){const router2=inject(routerKey),currentRoute=inject(routeLocationKey),route=computed(()=>{const to=unref(props.to);return router2.resolve(to)}),activeRecordIndex=computed(()=>{const{matched:matched}=route.value,{length:length}=matched,routeMatched=matched[length-1],currentMatched=currentRoute.matched;if(!routeMatched||!currentMatched.length)return-1;const index2=currentMatched.findIndex(isSameRouteRecord.bind(null,routeMatched));if(index2>-1)return index2;const parentRecordPath=getOriginalPath(matched[length-2]);return length>1&&getOriginalPath(routeMatched)===parentRecordPath&&currentMatched[currentMatched.length-1].path!==parentRecordPath?currentMatched.findIndex(isSameRouteRecord.bind(null,matched[length-2])):index2}),isActive=computed(()=>activeRecordIndex.value>-1&&function(outer,inner){for(const key in inner){const innerValue=inner[key],outerValue=outer[key];if("string"==typeof innerValue){if(innerValue!==outerValue)return!1}else if(!isArray(outerValue)||outerValue.length!==innerValue.length||innerValue.some((value,i)=>value!==outerValue[i]))return!1}return!0}(currentRoute.params,route.value.params)),isExactActive=computed(()=>activeRecordIndex.value>-1&&activeRecordIndex.value===currentRoute.matched.length-1&&isSameRouteLocationParams(currentRoute.params,route.value.params));return{route:route,href:computed(()=>route.value.href),isActive:isActive,isExactActive:isExactActive,navigate:function(e={}){return function(e){if(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)return;if(e.defaultPrevented)return;if(void 0!==e.button&&0!==e.button)return;if(e.currentTarget&&e.currentTarget.getAttribute){const target=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(target))return}e.preventDefault&&e.preventDefault();return!0}(e)?router2[unref(props.replace)?"replace":"push"](unref(props.to)).catch(noop$1):Promise.resolve()}}}const RouterLink=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:useLink,setup(props,{slots:slots}){const link=reactive(useLink(props)),{options:options}=inject(routerKey),elClass=computed(()=>({[getLinkClass(props.activeClass,options.linkActiveClass,"router-link-active")]:link.isActive,[getLinkClass(props.exactActiveClass,options.linkExactActiveClass,"router-link-exact-active")]:link.isExactActive}));return()=>{const children=slots.default&&slots.default(link);return props.custom?children:h("a",{"aria-current":link.isExactActive?props.ariaCurrentValue:null,href:link.href,onClick:link.navigate,class:elClass.value},children)}}});function getOriginalPath(record){return record?record.aliasOf?record.aliasOf.path:record.path:""}const getLinkClass=(propClass,globalClass,defaultClass)=>null!=propClass?propClass:null!=globalClass?globalClass:defaultClass;function normalizeSlot(slot,data){if(!slot)return null;const slotContent=slot(data);return 1===slotContent.length?slotContent[0]:slotContent}const RouterView=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(props,{attrs:attrs,slots:slots}){const injectedRoute=inject(routerViewLocationKey),routeToDisplay=computed(()=>props.route||injectedRoute.value),injectedDepth=inject(viewDepthKey,0),depth=computed(()=>{let initialDepth=unref(injectedDepth);const{matched:matched}=routeToDisplay.value;let matchedRoute;for(;(matchedRoute=matched[initialDepth])&&!matchedRoute.components;)initialDepth++;return initialDepth}),matchedRouteRef=computed(()=>routeToDisplay.value.matched[depth.value]);provide(viewDepthKey,computed(()=>depth.value+1)),provide(matchedRouteKey,matchedRouteRef),provide(routerViewLocationKey,routeToDisplay);const viewRef=ref();return watch(()=>[viewRef.value,matchedRouteRef.value,props.name],([instance,to,name],[oldInstance,from,oldName])=>{to&&(to.instances[name]=instance,from&&from!==to&&instance&&instance===oldInstance&&(to.leaveGuards.size||(to.leaveGuards=from.leaveGuards),to.updateGuards.size||(to.updateGuards=from.updateGuards))),!instance||!to||from&&isSameRouteRecord(to,from)&&oldInstance||(to.enterCallbacks[name]||[]).forEach(callback=>callback(instance))},{flush:"post"}),()=>{const route=routeToDisplay.value,currentName=props.name,matchedRoute=matchedRouteRef.value,ViewComponent=matchedRoute&&matchedRoute.components[currentName];if(!ViewComponent)return normalizeSlot(slots.default,{Component:ViewComponent,route:route});const routePropsOption=matchedRoute.props[currentName],routeProps=routePropsOption?!0===routePropsOption?route.params:"function"==typeof routePropsOption?routePropsOption(route):routePropsOption:null,component=h(ViewComponent,assign({},routeProps,attrs,{onVnodeUnmounted:vnode=>{vnode.component.isUnmounted&&(matchedRoute.instances[currentName]=null)},ref:viewRef}));return normalizeSlot(slots.default,{Component:component,route:route})||component}}});var useMarkwhenStore=defineStore("markwhen",function(){var route=inject(routeLocationKey),app2=ref({colorMap:{default:{}}}),markwhen=ref(),showEditButton=ref(!1),showCopyLinkButton=ref(!0),onJumpToPath=ref(function(path){}),onJumpToRange=ref(function(range2){}),onGetSvg=ref(function(params){}),hadInitialState=ref("undefined"!=typeof window&&window.__markwhen_initial_state),hash=computed(function(){var _markwhen$value;if(null!==(_markwhen$value=markwhen.value)&&void 0!==_markwhen$value&&_markwhen$value.rawText)try{var _markwhen$value2;return btoa(null===(_markwhen$value2=markwhen.value)||void 0===_markwhen$value2?void 0:_markwhen$value2.rawText)}catch(e){return""}return""}),pathOrHash=computed(function(){var _app$value,_route$params=route.params,user=_route$params.user,timeline=_route$params.timeline;return!route.path.includes(".html")&&user?"/".concat(user)+(timeline?"/".concat(timeline):""):null!==(_app$value=app2.value)&&void 0!==_app$value&&_app$value.path&&"/"!==app2.value.path?app2.value.path:"#mw=".concat(hash.value)}),editorLink=computed(function(){return"https://meridiem.markwhen.com".concat(pathOrHash.value)}),timelineLink=computed(function(){return"https://timeline.markwhen.com".concat(pathOrHash.value)}),embedLink=computed(function(){return'<iframe src="'.concat(timelineLink.value,'" />')});watchEffect(_asyncToGenerator(_regenerator().m(function _callee(){var _route$params2,user,timeline,url,resp,text,mw,decoded,_mw,_resp,_text,_mw2,_t2;return _regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:if(_route$params2=route.params,user=_route$params2.user,timeline=_route$params2.timeline,!user){_context.n=7;break}return _context.p=1,url=timeline?"https://meridiem.markwhen.com/".concat(user,"/").concat(timeline,".mw"):"https://meridiem.markwhen.com/".concat(user,".mw"),_context.n=2,fetch(url).catch(function(){});case 2:if(!(resp=_context.v)){_context.n=4;break}if(resp.redirected&&(window.location.href=resp.url),!resp.ok){_context.n=4;break}return _context.n=3,resp.text();case 3:text=_context.v,mw=parse(text),app2.value={isDark:!1,colorMap:useColors(mw).value},markwhen.value={rawText:text,parsed:mw,transformed:mw.events},showEditButton.value=!0,showCopyLinkButton.value=!1;case 4:_context.n=6;break;case 5:_context.p=5,_context.v;case 6:_context.n=13;break;case 7:if(!route.hash||!route.hash.startsWith("#mw=")){_context.n=8;break}decoded=atob(route.hash.substring(4)),_mw=parse(decoded),app2.value={isDark:!1,colorMap:useColors(_mw).value},markwhen.value={rawText:decoded,parsed:_mw,transformed:_mw.events},showEditButton.value=!0,showCopyLinkButton.value=!1,_context.n=13;break;case 8:return _context.p=8,_context.n=9,fetch("/sample.mw");case 9:if(!(_resp=_context.v).ok){_context.n=11;break}return _context.n=10,_resp.text();case 10:_text=_context.v,_mw2=parse(_text),app2.value={isDark:!1,colorMap:useColors(_mw2).value},markwhen.value={rawText:_text,parsed:_mw2,transformed:_mw2.events},showEditButton.value=!1,showCopyLinkButton.value=!0;case 11:_context.n=13;break;case 12:_context.p=12,_t2=_context.v,console.debug("Could not load sample data:",_t2);case 13:return _context.a(2)}},_callee,null,[[8,12],[1,5]])})));var _useLpc=useLpc({appState:function(s2){showEditButton.value=!1,showCopyLinkButton.value=!0,app2.value=s2},markwhenState:function(s2){markwhen.value=s2},jumpToPath:function(_ref2){var _onJumpToPath$value,path=_ref2.path;null===(_onJumpToPath$value=onJumpToPath.value)||void 0===_onJumpToPath$value||_onJumpToPath$value.call(onJumpToPath,path)},jumpToRange:function(_ref3){var _onJumpToRange$value,dateRangeIso=_ref3.dateRangeIso;null===(_onJumpToRange$value=onJumpToRange.value)||void 0===_onJumpToRange$value||_onJumpToRange$value.call(onJumpToRange,dateRangeIso)},getSvg:function(params){var _onGetSvg$value;return null===(_onGetSvg$value=onGetSvg.value)||void 0===_onGetSvg$value?void 0:_onGetSvg$value.call(onGetSvg,params)}}),postRequest=_useLpc.postRequest,getConnectionStatus=_useLpc.getConnectionStatus,requestStateUpdate=function(){postRequest("markwhenState"),postRequest("appState")};return requestStateUpdate(),{app:app2,markwhen:markwhen,hadInitialState:hadInitialState,onJumpToPath:onJumpToPath,onJumpToRange:onJumpToRange,onGetSvg:onGetSvg,requestStateUpdate:requestStateUpdate,setHoveringPath:function(path){postRequest("setHoveringPath",path)},setDetailEventPath:function(path){postRequest("setDetailPath",path)},isDetailEventPath:function(path){var _app$value2;return!!path&&equivalentPaths(path,null===(_app$value2=app2.value)||void 0===_app$value2?void 0:_app$value2.detailPath)},setText:function(text,at){postRequest("setText",{text:text,at:at})},showInEditor:function(path){postRequest("showInEditor",path)},createEventFromRange:function(dateRangeIso,granularity){postRequest("newEvent",{dateRangeIso:dateRangeIso,granularity:granularity,immediate:!(arguments.length>2&&void 0!==arguments[2])||arguments[2]})},editEventDateRange:function(path,dateRangeIso,scale,preferredInterpolationFormat){postRequest("editEventDateRange",{path:path,range:dateRangeIso,scale:scale,preferredInterpolationFormat:preferredInterpolationFormat})},showEditButton:showEditButton,showCopyLinkButton:showCopyLinkButton,showEmbedButton:showCopyLinkButton,timelineLink:timelineLink,editorLink:editorLink,embedLink:embedLink,getConnectionStatus:getConnectionStatus}}),Weight=function(Weight2){return Weight2[Weight2.SECOND=0]="SECOND",Weight2[Weight2.QUARTER_MINUTE=1]="QUARTER_MINUTE",Weight2[Weight2.MINUTE=2]="MINUTE",Weight2[Weight2.QUARTER_HOUR=3]="QUARTER_HOUR",Weight2[Weight2.HOUR=4]="HOUR",Weight2[Weight2.DAY=5]="DAY",Weight2[Weight2.MONTH=6]="MONTH",Weight2[Weight2.YEAR=7]="YEAR",Weight2[Weight2.DECADE=8]="DECADE",Weight2[Weight2.CENT=9]="CENT",Weight2}(Weight||{}),useMarkersStore=defineStore("markers",function(){var timelineStore=useTimelineStore(),hoveringMarker=ref(),range2=ref(),markers=computed(function(){var markers2=[],scale=timelineStore.scaleOfViewportDateInterval,baselineLeftmostDate=timelineStore.baselineLeftmostDate,baselineRightmostDate=timelineStore.baselineRightmostDate,nextLeft=ceilDateTime(baselineLeftmostDate,scale),rightmost=ceilDateTime(baselineRightmostDate,scale),acc=timelineStore.scalelessDistanceBetweenDates(baselineLeftmostDate,nextLeft);for(markers2.push({dateTime:baselineLeftmostDate,size:acc,ts:baselineLeftmostDate.toMillis(),accumulated:acc});nextLeft<rightmost&&markers2.length<1024;){markers2.push({dateTime:nextLeft,size:0,ts:nextLeft.toMillis(),accumulated:acc}),nextLeft="cent"===scale?nextLeft.plus({years:100}):"decade"===scale?nextLeft.plus({years:10}):"quarterhour"===scale?nextLeft.plus({minutes:15}):"quarterminute"===scale?nextLeft.plus({seconds:15}):nextLeft.plus(_defineProperty({},scale,1));var size2=timelineStore.scalelessDistanceBetweenDates(markers2[markers2.length-1].dateTime,nextLeft);acc+=size2,markers2[markers2.length-1].size=size2,markers2[markers2.length-1].accumulated=acc}return markers2[markers2.length-1].size=timelineStore.scalelessDistanceBetweenDates(markers2[markers2.length-1].dateTime,rightmost),markers2}),rangeFromOffsetLeft=computed(function(){return function(offset2){var offsetDate=timelineStore.dateFromClientLeft(offset2),scale=timelineStore.scaleOfViewportDateInterval,floored=floorDateTime(offsetDate,scale),ceiled=ceilDateTime(offsetDate,scale);return[{dateTime:floored,left:timelineStore.distanceFromBaselineLeftmostDate(floored)},{dateTime:ceiled,left:timelineStore.distanceFromBaselineLeftmostDate(ceiled)}]}}),nextMostGranularScaleOfViewportDateInterval=computed(function(){for(var i=0;i<timelineStore.weights.length;i++)if(timelineStore.weights[i]>.05)return scales[i];return"decade"});return{hoveringMarker:hoveringMarker,range:range2,markers:markers,rangeFromOffsetLeft:rangeFromOffsetLeft,nextMostGranularScaleOfViewportDateInterval:nextMostGranularScaleOfViewportDateInterval,setHoveringMarker:function(marker){hoveringMarker.value=marker},setRange:function(r){range2.value=r}}}),scales=["second","quarterminute","minute","quarterhour","hour","day","month","year","decade","cent"];function dateScale(dateTime){return 0===dateTime.second?0===dateTime.minute?0===dateTime.hour?1===dateTime.day?1===dateTime.month?dateTime.year%100==0?Weight.CENT:dateTime.year%10==0?Weight.DECADE:Weight.YEAR:Weight.MONTH:Weight.DAY:Weight.HOUR:dateTime.minute%15==0?Weight.QUARTER_HOUR:Weight.MINUTE:dateTime.second%15==0?Weight.QUARTER_MINUTE:Weight.SECOND}function floorDateTime(dateTime,toScale){var year2=dateTime.year;if("cent"===toScale){var roundedYear=year2-year2%100;return DateTime$1.fromObject({year:roundedYear})}if("decade"===toScale){var _roundedYear=year2-year2%10;return DateTime$1.fromObject({year:_roundedYear})}if("year"===toScale)return DateTime$1.fromObject({year:year2});var month=dateTime.month;if("month"===toScale)return DateTime$1.fromObject({year:year2,month:month});var day=dateTime.day;if("day"===toScale)return DateTime$1.fromObject({year:year2,month:month,day:day});var hour=dateTime.hour;if("hour"===toScale)return DateTime$1.fromObject({year:year2,month:month,day:day,hour:hour});var minute=dateTime.minute;if("quarterhour"===toScale)return DateTime$1.fromObject({year:year2,month:month,day:day,hour:hour,minute:minute-minute%15});var second=dateTime.second;return"quarterminute"===toScale?DateTime$1.fromObject({year:year2,month:month,day:day,hour:hour,minute:minute,second:second-second%15}):"minute"===toScale?DateTime$1.fromObject({year:year2,month:month,day:day,hour:hour,minute:minute}):DateTime$1.fromObject({year:year2,month:month,day:day,hour:hour,minute:minute,second:second})}function ceilDateTime(dateTime,toScale){var increment;return increment="cent"===toScale?{years:100}:"decade"===toScale?{years:10}:"quarterhour"===toScale?{minutes:15}:"quarterminute"===toScale?{seconds:15}:_defineProperty({},toScale,1),floorDateTime(dateTime,toScale).plus(increment)}var dateMidpoint=function(range2){return range2.fromDateTime.plus({seconds:range2.toDateTime.diff(range2.fromDateTime).as("seconds")/2})},cache=new LRUCache({max:1e3}),cacheAndReturn=function(cacheKey,dateRange){return cache.set(cacheKey,dateRange),dateRange},_ranges=function(root,recurrenceLimit2){if(root){if(isEvent(root)){var eRange=function(e,recurrenceLimit2){var cacheKey=JSON.stringify(e.dateRangeIso)+JSON.stringify(e.recurrence),cached=cache.get(cacheKey);if(cached)return cached;if(e.recurrence){var expanded=expand(toDateRange(e.dateRangeIso),e.recurrence,recurrenceLimit2);return cacheAndReturn(cacheKey,{fromDateTime:expanded[0].fromDateTime,toDateTime:expanded[expanded.length-1].toDateTime})}return cacheAndReturn(cacheKey,toDateRange(e.dateRangeIso))}(root,recurrenceLimit2);return _objectSpread2(_objectSpread2({},eRange),{},{maxFrom:eRange.fromDateTime})}return root.children.reduce(function(prev,curr){var currRange=_ranges(curr,recurrenceLimit2);return prev&&currRange?{fromDateTime:+currRange.fromDateTime<+prev.fromDateTime?currRange.fromDateTime:prev.fromDateTime,toDateTime:+currRange.toDateTime>+prev.toDateTime?currRange.toDateTime:prev.toDateTime,maxFrom:+currRange.maxFrom>+prev.maxFrom?currRange.maxFrom:prev.maxFrom}:currRange},void 0)}},scaleToGetDistance=function(distance,range2){return 24*distance/range2.toDateTime.diff(range2.fromDateTime).as("hours")};function initialPageSettings(timeline,viewport){if(viewport&&timeline){var earliestTime=DateTime$1.now().minus({years:1}).toISO(),latestTime=DateTime$1.now().plus({years:1}).toISO(),range2={fromDateTime:DateTime$1.fromISO(earliestTime),toDateTime:DateTime$1.fromISO(latestTime)},scale=scaleToGetDistance(viewport.width,range2)/3,midpoint=dateMidpoint(range2),bslmd=floorDateTime(DateTime$1.fromISO(earliestTime).minus({years:3}),"year"),fromLeft=midpoint.diff(bslmd).as("hours")*scale/24;return{scale:scale,viewportDateInterval:{fromDateTime:DateTime$1.now().minus({years:10}),toDateTime:DateTime$1.now().plus({years:10})},viewport:{height:viewport.height,top:0,width:viewport.width,left:fromLeft-viewport.width/2,offsetLeft:viewport.offsetLeft}}}return{scale:.3,viewportDateInterval:{fromDateTime:DateTime$1.now().minus({years:10}),toDateTime:DateTime$1.now().plus({years:10})},viewport:{left:0,width:0,top:0,height:0,offsetLeft:0}}}function hasLocalStorage(){return"undefined"!=typeof localStorage}var lsRef=function(key,defaultValue){var initialValue;if(hasLocalStorage()){var item=localStorage.getItem(key);initialValue=item?JSON.parse(item).value:defaultValue}else initialValue=defaultValue;var r=ref(initialValue);return watch(r,function(v){hasLocalStorage()&&localStorage.setItem(key,JSON.stringify({value:v}))}),r};function roundToTwoDecimalPlaces(n2){return Math.floor(100*n2)/100}function clamp(value){var min=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,max=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(max,Math.max(value,min))}var useTimelineStore=defineStore("timeline",function(){var _viewportGetter$value,_markwhenState$value,viewport,markwhenStore=useMarkwhenStore(),markwhenState=computed(function(){return markwhenStore.markwhen}),dateTimeDisplay=lsRef("dateTimeDisplay2","original"),progressDisplay=lsRef("progressDisplay2","on"),pageTimeline=computed(function(){return markwhenState.value.parsed}),pageTimelineMetadata=computed(function(){var now2=DateTime$1.now();if(!pageTimeline.value.events.children.length)return{earliestTime:now2.minus({years:2}),latestTime:now2.plus({years:2})};var _step,latestTime=DateTime$1.now().minus({years:10}),earliestTime=DateTime$1.now().plus({years:10}),_iterator=_createForOfIteratorHelper(iter$1(pageTimeline.value.events));try{for(_iterator.s();!(_step=_iterator.n()).done;){var eventy=_step.value.eventy;if(isEvent(eventy)){var dr=toDateRange(eventy.dateRangeIso);+dr.fromDateTime<+earliestTime&&(earliestTime=dr.fromDateTime),+dr.toDateTime>+latestTime&&(latestTime=dr.toDateTime)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return{earliestTime:earliestTime,latestTime:latestTime}}),tags=computed(function(){return Object.keys(pageTimeline.value.header).filter(function(entry){return entry.startsWith(")")}).reduce(function(prev,curr){return _objectSpread2(_objectSpread2({},prev),{},_defineProperty({},curr.replace(")",""),pageTimeline.value.header[curr]))},{})}),transformedEvents=computed(function(){return markwhenState.value.transformed}),darkMode=computed(function(){var _markwhenStore$app;return!(null===(_markwhenStore$app=markwhenStore.app)||void 0===_markwhenStore$app||!_markwhenStore$app.isDark)}),pageRange=computed(function(){return _ranges(transformedEvents.value,100)||{fromDateTime:DateTime$1.now().minus({years:5}),toDateTime:DateTime$1.now().plus({years:5})}}),hoveringEventPaths=computed(function(){var _markwhenStore$app2;return null===(_markwhenStore$app2=markwhenStore.app)||void 0===_markwhenStore$app2?void 0:_markwhenStore$app2.hoveringPath}),editEventDateRange=markwhenStore.editEventDateRange,setHoveringEvent=markwhenStore.setHoveringPath,setText=markwhenStore.setText,showInEditor=markwhenStore.showInEditor,createEventFromRange=markwhenStore.createEventFromRange,isDetailEventPath=markwhenStore.isDetailEventPath,setDetailEventPath=markwhenStore.setDetailEventPath,viewportGetter=ref(),pageSettings=ref((viewport=null===(_viewportGetter$value=viewportGetter.value)||void 0===_viewportGetter$value?void 0:_viewportGetter$value.call(viewportGetter),initialPageSettings(null===(_markwhenState$value=markwhenState.value)||void 0===_markwhenState$value?void 0:_markwhenState$value.parsed,viewport))),startedWidthChange=ref(!1),hideNowLine=ref(!1),goToNowSemaphore=ref(0),scrollToPath=ref(),shouldZoomWhenScrolling=ref(!0),mode=lsRef("preferredMode2","timeline"),ganttSidebarWidth=ref(200),ganttSidebarTempWidth=ref(0),autoCenterSemaphore=ref(0),leftInsetWidth=computed(function(){return"gantt"===mode.value?ganttSidebarTempWidth.value?ganttSidebarTempWidth.value:ganttSidebarWidth.value:0}),pageScale=computed(function(){return pageSettings.value.scale||1}),hoveringDate=ref(DateTime$1.now()),referenceDate=ref(DateTime$1.now()),diffAmount=computed(function(){return _defineProperty({},"hours",2.5*pageSettings.value.viewport.width/pageScale.value*24)}),baselineLeftmostDate=computed(function(){return referenceDate.value.minus(diffAmount.value)}),baselineRightmostDate=computed(function(){return referenceDate.value.plus(diffAmount.value)}),baseOffset=computed(function(){return 0}),distanceFromBaselineLeftmostDate=computed(function(){return function(dt){return dt.diff(baselineLeftmostDate.value).as("hours")*pageScale.value/24}}),dateIntervalFromViewport=computed(function(){return function(scrollLeft,width){return{fromDateTime:baselineLeftmostDate.value.plus(_defineProperty({},"hours",(scrollLeft+leftInsetWidth.value)/pageScale.value*24)),toDateTime:baselineLeftmostDate.value.plus(_defineProperty({},"hours",(width+scrollLeft+leftInsetWidth.value)/pageScale.value*24))}}}),distanceBetweenDates=computed(function(){return function(a,b){return b.diff(a).as("hours")*pageScale.value/24}}),scalelessDistanceFromReferenceDate=computed(function(){return function(a){return a.diff(referenceDate.value).as("hours")}}),distanceFromReferenceDate=computed(function(){return function(a){return a.diff(referenceDate.value).as("hours")*pageScale.value/24+pageSettings.value.viewport.width+baseOffset.value}}),dateFromClientLeft=computed(function(){return function(offset2){try{return baselineLeftmostDate.value.plus(_defineProperty({},"hours",(offset2+pageSettings.value.viewport.left)/pageScale.value*24))}catch(_unused){return DateTime$1.now()}}}),userRanges=computed(function(){var _markwhenStore$markwh,ranges2=null===(_markwhenStore$markwh=markwhenStore.markwhen)||void 0===_markwhenStore$markwh?void 0:_markwhenStore$markwh.parsed.header.ranges,parsedRanges=[];if(ranges2&&Array.isArray(ranges2))for(var now2=DateTime$1.now(),i=0;i<ranges2.length;i++){var r=ranges2[i],match2=new RegExp("^".concat(RECURRENCE_AMOUNT_REGEX.source,"$")).exec(r);if(match2){var amount=parseInt(match2[1]);if(isNaN(amount))continue;var duration=_defineProperty({},match2[3]?"milliseconds":match2[4]?"seconds":match2[5]?"minutes":match2[6]?"hours":match2[8]?"days":match2[9]?"weeks":match2[10]?"months":"years",amount/2);parsedRanges.push({title:r,fromDateTime:now2.minus(duration),toDateTime:now2.plus(duration)})}}return parsedRanges}),rangeToJumpTo=ref(),weights=computed(function(){var to=pageSettings.value.viewportDateInterval.toDateTime,from=pageSettings.value.viewportDateInterval.fromDateTime,denom=72e5*to.diff(from).as("hours")/(pageSettings.value.viewport.width+pageSettings.value.viewport.offsetLeft);return[clamp(roundToTwoDecimalPlaces(30/denom)),clamp(roundToTwoDecimalPlaces(300/denom)),clamp(roundToTwoDecimalPlaces(1800/denom)),clamp(roundToTwoDecimalPlaces(18e3/denom)),clamp(roundToTwoDecimalPlaces(108e3/denom)),clamp(roundToTwoDecimalPlaces(3456e3/denom)),clamp(roundToTwoDecimalPlaces(7776e4/denom)),clamp(roundToTwoDecimalPlaces(7776e5/denom)),clamp(roundToTwoDecimalPlaces(7776e6/denom)),clamp(roundToTwoDecimalPlaces(62208e6/denom)),clamp(roundToTwoDecimalPlaces(62208e7/denom))]}),scaleOfViewportDateInterval=computed(function(){for(var i=0;i<weights.value.length;i++)if(weights.value[i]>.25)return scales[i];return"cent"});return{referenceDate:referenceDate,pageSettings:pageSettings,startedWidthChange:startedWidthChange,hideNowLine:hideNowLine,scrollToPath:scrollToPath,shouldZoomWhenScrolling:shouldZoomWhenScrolling,mode:mode,ganttSidebarWidth:ganttSidebarWidth,ganttSidebarTempWidth:ganttSidebarTempWidth,autoCenterSemaphore:autoCenterSemaphore,dateTimeDisplay:dateTimeDisplay,progressDisplay:progressDisplay,colors:computed(function(){var _markwhenStore$app3;return null===(_markwhenStore$app3=markwhenStore.app)||void 0===_markwhenStore$app3?void 0:_markwhenStore$app3.colorMap}),baseOffset:baseOffset,hoveringDate:hoveringDate,baselineLeftmostDate:baselineLeftmostDate,baselineRightmostDate:baselineRightmostDate,diffAmount:diffAmount,userRanges:userRanges,darkMode:darkMode,pageTimeline:pageTimeline,tags:tags,pageTimelineMetadata:pageTimelineMetadata,pageRange:pageRange,transformedEvents:transformedEvents,pageScale:pageScale,pageScaleBy24:computed(function(){return pageScale.value/24}),scalelessDistanceBetweenDates:function(a,b){return b.diff(a).as("hours")},distanceBetweenDates:distanceBetweenDates,distanceFromViewportLeftDate:function(a){return a.diff(pageSettings.value.viewportDateInterval.fromDateTime).as("hours")*pageScale.value/24},distanceFromReferenceDate:distanceFromReferenceDate,dateFromClientLeft:dateFromClientLeft,scalelessDistanceFromReferenceDate:scalelessDistanceFromReferenceDate,scaleOfViewportDateInterval:scaleOfViewportDateInterval,weights:weights,leftInsetWidth:leftInsetWidth,hoveringEventPaths:hoveringEventPaths,isDetailEventPath:isDetailEventPath,distanceFromBaselineLeftmostDate:distanceFromBaselineLeftmostDate,setDetailEventPath:setDetailEventPath,createEventFromRange:createEventFromRange,showInEditor:showInEditor,setText:setText,setHoveringEvent:setHoveringEvent,clearHoveringEvent:function(){return markwhenStore.setHoveringPath()},editEventDateRange:editEventDateRange,setViewport:function(viewport){pageSettings.value.viewport=viewport,pageSettings.value.viewportDateInterval=dateIntervalFromViewport.value(viewport.left-viewport.offsetLeft,viewport.width+viewport.offsetLeft)},setViewportGetter:function(getter){viewportGetter.value=getter},setPageScale:function(s2){return pageSettings.value.scale=s2,!0},setStartedWidthChange:function(started){startedWidthChange.value=started},setHideNowLine:function(hide){hideNowLine.value=hide},setScrollToPaths:function(ep){scrollToPath.value=ep},setShouldZoomWhenScrolling:function(should){shouldZoomWhenScrolling.value=should},setMode:function(m){mode.value=m},setGanttSidebarWidth:function(width){ganttSidebarWidth.value=width},setGanttSidebarTempWidth:function(width){ganttSidebarTempWidth.value=width},autoCenter:function(){autoCenterSemaphore.value++},goToNow:function(){return goToNowSemaphore.value++},goToNowSemaphore:goToNowSemaphore,setRange:function(dr){rangeToJumpTo.value=dr},rangeToJumpTo:rangeToJumpTo}}),useEventColor=function(eventRef){var color=ref(),timelineStore=useTimelineStore();return watchEffect(function(){var node=unref(eventRef),ourTags=node.tags,source=node.source;color.value=ourTags?timelineStore.colors[source||"default"][ourTags[0]]:void 0}),{color:color}},useCollapseStore=defineStore("collapse",function(){var _markwhenStore$markwh,markwhenStore=useMarkwhenStore(),timelineStore=useTimelineStore(),collapsed=ref((null===(_markwhenStore$markwh=markwhenStore.markwhen)||void 0===_markwhenStore$markwh||_markwhenStore$markwh.parsed,new Set)),setCollapsed=function(path,shouldCollapse){var pathJoined="string"==typeof path?path:path.join(",");shouldCollapse?collapsed.value.add(pathJoined):collapsed.value.delete(pathJoined)};return{collapsed:collapsed,isCollapsed:function(path){var _step,pathJoined="string"==typeof path?path:path.join(","),_iterator=_createForOfIteratorHelper(collapsed.value.keys());try{for(_iterator.s();!(_step=_iterator.n()).done;){if(pathJoined===_step.value)return!0}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1},isCollapsedChild:function(path){var _step2,pathJoined="string"==typeof path?path:path.join(","),_iterator2=_createForOfIteratorHelper(collapsed.value.keys());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var entry=_step2.value;if(pathJoined!==entry&&pathJoined.startsWith("".concat(entry,",")))return!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return!1},isCollapsedChildOf:function(path){var _highest,highest,_step3,pathJoined="string"==typeof path?path:path.join(","),_iterator3=_createForOfIteratorHelper(collapsed.value.keys());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var entry=_step3.value;pathJoined!==entry&&pathJoined.startsWith("".concat(entry,","))&&(!highest||entry.length<highest.length)&&(highest=entry)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return null===(_highest=highest)||void 0===_highest?void 0:_highest.split(",").map(function(i){return parseInt(i)})},collapse:function(path){collapsed.value.add(path.join(","))},setCollapsed:setCollapsed,toggleCollapsed:function(path){var pathJoined=path.join(",");collapsed.value.has(pathJoined)?collapsed.value.delete(pathJoined):collapsed.value.add(pathJoined)},expand:function(path){collapsed.value.delete(path.join(","))},collapseAll:function(){var _step4,_iterator4=_createForOfIteratorHelper(iter$1(timelineStore.transformedEvents));try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_step4.value,path=_step4$value.path;isEvent(_step4$value.eventy)||setCollapsed(path,!0)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}},expandAll:function(){var _step5,_iterator5=_createForOfIteratorHelper(iter$1(timelineStore.transformedEvents));try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _step5$value=_step5.value,path=_step5$value.path;isEvent(_step5$value.eventy)||setCollapsed(path,!1)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}}}),useNodeStore=defineStore("nodes",function(){var timelineStore=useTimelineStore(),collapseStore=useCollapseStore(),nodes=computed(function(){return timelineStore.transformedEvents}),nodeArray=computed(function(){return(node=>{const array=[];for(const pathAndNode of iter$1(node))array.push(pathAndNode);return array})(timelineStore.transformedEvents)}),_numChildren2=function(node,path,childrenMap2){var pathJoined=path.join(","),saved=childrenMap2.get(pathJoined);if(saved)return saved;var cache2=function(childCount){return childrenMap2.set(pathJoined,childCount),childCount};return collapseStore.isCollapsed(pathJoined)||isEvent(node)?cache2(0):cache2(node.children.reduce(function(prev,curr,i){return prev+1+_numChildren2(curr,[].concat(_toConsumableArray(path),[i]),childrenMap2)},0))},eventNodeKey=0,eventNodeKeyMap=reactive(new Map),assignEventKeys=function(nodes2){var _step,visible=nodes2.map(function(p2){return p2.path.join(",")}),newlyAvailableKeys=[],_iterator=_createForOfIteratorHelper(eventNodeKeyMap.keys());try{for(_iterator.s();!(_step=_iterator.n()).done;){var hasKey=_step.value;visible.includes(hasKey)||(newlyAvailableKeys.push(eventNodeKeyMap.get(hasKey)),eventNodeKeyMap.delete(hasKey))}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,_iterator2=_createForOfIteratorHelper(visible);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var visibleNode=_step2.value;if(!eventNodeKeyMap.has(visibleNode)){var recycledKey=newlyAvailableKeys.pop();void 0!==recycledKey?eventNodeKeyMap.set(visibleNode,recycledKey):eventNodeKeyMap.set(visibleNode,eventNodeKey++)}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return nodes2.map(function(n2){return _objectSpread2(_objectSpread2({},n2),{},{key:""+eventNodeKeyMap.get(n2.path.join(","))})})},visibleNodes=computed(function(){var _step3,visibleEvents=[],visibleSections=[],_iterator3=_createForOfIteratorHelper(nodeArray.value);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_step3.value,path=_step3$value.path,eventy=_step3$value.eventy;if(!eventy)break;var joinedPath=path.join(",");if(isEvent(eventy)){var pAndN={eventy:eventy,path:path};if(timelineStore.scrollToPath&&equivalentPaths(path,timelineStore.scrollToPath))visibleEvents.push(pAndN);else{var _top=100+30*(predecessorMap.value.get(joinedPath)||0),_vp=timelineStore.pageSettings.viewport;if(_top>_vp.top-100&&_top<_vp.top+_vp.height+100)if("gantt"===timelineStore.mode)visibleEvents.push(pAndN);else{var range2=_ranges(pAndN.eventy,100),left=timelineStore.pageScaleBy24*timelineStore.scalelessDistanceFromReferenceDate(range2.fromDateTime),width=timelineStore.pageScaleBy24*timelineStore.scalelessDistanceBetweenDates(range2.fromDateTime,range2.toDateTime);(left<_vp.left+_vp.width+50||_vp.left<left+width+50)&&visibleEvents.push(pAndN)}}}else{if(collapseStore.isCollapsedChild(path))continue;if(path.length>0){var numAbove=predecessorMap.value.get(joinedPath)||0,children=childrenMap.value.get(joinedPath)||0,top=100+30*numAbove,height2=30+30*children,vp=timelineStore.pageSettings.viewport,bottomOfSection=top+height2,topOfSection=top,topOfVp=vp.top-100;if(topOfSection>vp.top+vp.height+100)continue;if(bottomOfSection<topOfVp)continue;visibleSections.push({path:path,eventy:eventy})}}}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return[assignEventKeys(visibleEvents),visibleSections]}),sectionNodeKeyMap=reactive(new Map),sectionKeys=computed(function(){var _step4,visible=visibleNodes.value[1].map(function(p2){return p2.path.join(",")}),newlyAvailableKeys=[],_iterator4=_createForOfIteratorHelper(sectionNodeKeyMap.keys());try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var hasKey=_step4.value;visible.includes(hasKey)||(newlyAvailableKeys.push(sectionNodeKeyMap.get(hasKey)),sectionNodeKeyMap.delete(hasKey))}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}var _step5,_iterator5=_createForOfIteratorHelper(visible);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var visibleNode=_step5.value;if(!sectionNodeKeyMap.has(visibleNode)){var recycledKey=newlyAvailableKeys.pop();void 0!==recycledKey?sectionNodeKeyMap.set(visibleNode,recycledKey):sectionNodeKeyMap.set(visibleNode,eventNodeKey++)}}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}return sectionNodeKeyMap}),childrenMap=computed(function(){var _step6,map2=new Map,_iterator6=_createForOfIteratorHelper(nodeArray.value);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _step6$value=_step6.value,path=_step6$value.path,eventy=_step6$value.eventy;_numChildren2(eventy,path,map2)}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return map2}),numPredecessors=function(eventy,path,map2,childrenMap2){var ourPathJoined=path.join(","),cache2=function(numPreds){return map2.set(ourPathJoined,numPreds),numPreds};if(!path.length)return cache2(0);var prev=map2.get(ourPathJoined);if(void 0!==prev)return prev;var prevPath=function(path){return 0===path[path.length-1]?path.slice(0,-1):[].concat(_toConsumableArray(path.slice(0,-1)),[path[path.length-1]-1])}(path).join(","),pred=1+map2.get(prevPath);return prevPath.length&&ourPathJoined.length&&prevPath.split(",").length===ourPathJoined.split(",").length&&(pred+=childrenMap2.get(prevPath)||0),cache2(pred)},predecessorMap=computed(function(){var _step7,map2=new Map,_iterator7=_createForOfIteratorHelper(nodeArray.value);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var _step7$value=_step7.value,path=_step7$value.path;_step7$value.eventy;numPredecessors(0,path,map2,childrenMap.value)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}return map2}),height=computed(function(){var _step8,max=0,_iterator8=_createForOfIteratorHelper(predecessorMap.value.values());try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var p2=_step8.value;p2>max&&(max=p2)}}catch(err){_iterator8.e(err)}finally{_iterator8.f()}return max}),viewHeight=computed(function(){return nodeArray.value.length?"".concat(30*nodeArray.value.length+500,"px"):"100%"});return{nodes:nodes,nodeArray:nodeArray,visibleNodes:visibleNodes,childrenMap:childrenMap,predecessorMap:predecessorMap,sectionKeys:sectionKeys,height:height,viewHeight:viewHeight}}),hourMinuteSecond=function(dt){return dt.toLocaleString(DateTime$1.TIME_24_WITH_SECONDS)},paddedHourMinute=function(dt){return dt.toLocaleString(DateTime$1.TIME_24_SIMPLE)},year=function(dt){return dt.year<0?"".concat(-dt.year," BCE"):dt.year},isoDate=function(dt){return dt.toISODate()},monthDayShort=function(dt){return"".concat(dt.day," ").concat(dt.monthShort)},full=function(dt){return dt.toLocaleString(DateTime$1.DATETIME_SHORT_WITH_SECONDS)},monthYear=function(dt){return"".concat(dt.monthShort," ").concat(dt.year)},empty=function(){return""},granularities=[[hourMinuteSecond,hourMinuteSecond,hourMinuteSecond,hourMinuteSecond,full,full,full,full,isoDate,year],[hourMinuteSecond,hourMinuteSecond,hourMinuteSecond,paddedHourMinute,paddedHourMinute,monthDayShort,isoDate,isoDate,isoDate,year],[function(dt){return dt.second},paddedHourMinute,paddedHourMinute,paddedHourMinute,paddedHourMinute,monthDayShort,isoDate,isoDate,isoDate,year],[function(dt){return dt.second},function(dt){return dt.minute},function(dt){return dt.minute},paddedHourMinute,paddedHourMinute,monthDayShort,isoDate,isoDate,isoDate,year],[empty,function(dt){return dt.minute},function(dt){return dt.minute},paddedHourMinute,paddedHourMinute,monthDayShort,isoDate,isoDate,isoDate,year],[empty,empty,empty,paddedHourMinute,function(dt){return dt.hour},function(dt){return dt.day},monthYear,monthYear,monthYear,year],[empty,empty,empty,paddedHourMinute,empty,function(dt){return dt.day},function(dt){return dt.monthShort},year,year,year],[empty,empty,empty,paddedHourMinute,empty,empty,function(dt){return dt.month},year,year,year],[empty,empty,empty,paddedHourMinute,empty,empty,empty,year,year,year],[empty,empty,empty,empty,empty,empty,empty,year,year,year]],_hoisted_1$h=["id"],_hoisted_2$c={key:0,class:"flex flex-row"},_hoisted_3$9={key:0,class:"whitespace-nowrap text-xs font-bold dark:bg-zinc-800 bg-white border-l p-1 dark:border-zinc-400 border-zinc-500"};const _sfc_main$z=defineComponent({__name:"TimeMarkersBack",setup:function(__props){var weekdayCache,markersStore=useMarkersStore(),timelineStore=useTimelineStore(),getWeekday2=(weekdayCache=new LRUCache({max:300}),{getWeekday:function(dateTime){var key="".concat(dateTime.year,"-").concat(dateTime.month,"-").concat(dateTime.day),cached=weekdayCache.get(key);if(cached)return cached;var weekday=gregorianToWeek(dateTime);return weekdayCache.set(key,weekday.weekday),weekday}}).getWeekday,dark=computed(function(){return timelineStore.darkMode}),nodeStore=useNodeStore(),backgroundColor=computed(function(){return function(tm){if(timelineStore.weights[Weight.DAY]>.3){var weekday=getWeekday2(tm.dateTime),a=Math.min(.3*timelineStore.weights[Weight.DAY],.5);if("number"==typeof weekday&&6===weekday||7===weekday||6===weekday.weekday||7===weekday.weekday)return dark.value?"rgba(113, 113, 122, ".concat(a,")"):"rgba(161, 161, 170, ".concat(a,")")}return"unset"}}),hovering=computed(function(){return function(tm){var h2=markersStore.hoveringMarker;return!!h2&&+tm.dateTime===+h2.dateTime}}),alpha=computed(function(){return function(tm){return timelineStore.weights[dateScale(tm.dateTime)]}}),borderColor=computed(function(){return function(tm){var a=hovering.value(tm)?1:2*(alpha.value(tm)-.3);return dark.value?"rgba(82, 82, 91, ".concat(a,")"):"rgba(200, 200, 200, ".concat(a,")")}}),eras2=computed(function(){var erasAndMilestoneEvents=[];if(!timelineStore.transformedEvents)return[];var _step,_iterator=_createForOfIteratorHelper(iter$1(timelineStore.transformedEvents));try{var _loop=function(){var _step$value=_step.value,eventy=_step$value.eventy,path=_step$value.path;if(isEvent(eventy)&&["era","milestone"].some(function(t){return eventy.tags.map(function(t2){return t2.toLowerCase()}).includes(t)})){var _toDateRange=toDateRange(eventy.dateRangeIso),fromDateTime=_toDateRange.fromDateTime,toDateTime=_toDateRange.toDateTime,color=useEventColor(eventy).color.value,isHovering2=equivalentPaths(timelineStore.hoveringEventPaths,path),styleObj={left:timelineStore.distanceFromBaselineLeftmostDate(fromDateTime),width:Math.max(2,timelineStore.distanceBetweenDates(fromDateTime,toDateTime))};color&&(styleObj.backgroundColor="rgba(".concat(color,", ").concat(isHovering2?.15:.1,")"),styleObj.borderColor="rgba(".concat(color,", ").concat(isHovering2?.75:.3,")")),erasAndMilestoneEvents.push(styleObj)}};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}return erasAndMilestoneEvents}),scaleForThisDate=computed(function(){return function(timeMarker){return dateScale(timeMarker.dateTime)}}),currentDateResolution=computed(function(){for(var i=0;i<timelineStore.weights.length;i++)if(timelineStore.weights[i]>.25)return i;return Weight.DECADE}),text=computed(function(){return function(timeMarker){return granularities[currentDateResolution.value][scaleForThisDate.value(timeMarker)](timeMarker.dateTime)}}),opacity=computed(function(){return function(timeMarker){return clamp(5*(alpha.value(timeMarker)-.45))}}),isHovering=computed(function(){return function(timeMarker){var _markersStore$hoverin;return markersStore.hoveringMarker&&+(null===(_markersStore$hoverin=markersStore.hoveringMarker)||void 0===_markersStore$hoverin?void 0:_markersStore$hoverin.dateTime)===+timeMarker.dateTime}}),hoveringText=computed(function(){return function(timeMarker){var dt=timeMarker.dateTime;return currentDateResolution.value>5?dt.year:currentDateResolution.value>3?dt.toLocaleString(DateTime$1.DATE_HUGE):dt.toLocaleString(DateTime$1.DATETIME_HUGE_WITH_SECONDS)}});return function(_ctx,_cache){return openBlock(),createElementBlock(Fragment,null,[_cache[1]||(_cache[1]=createBaseVNode("div",{class:"fixed top-0 left-0 right-0 h-6 bg-white/95 dark:bg-zinc-800/95 z-30 border-b dark:border-zinc-700"},null,-1)),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(markersStore).markers,function(timeMarker){return openBlock(),createElementBlock("div",{id:""+timeMarker.ts,key:timeMarker.ts,class:"h-full flex-shrink-0 absolute top-0 bottom-0 pointer-events-none",style:normalizeStyle({backgroundColor:backgroundColor.value(timeMarker),width:"".concat(unref(timelineStore).pageScaleBy24*timeMarker.size,"px"),left:"".concat(unref(timelineStore).pageScaleBy24*(timeMarker.accumulated-timeMarker.size),"px"),borderLeft:"1px ".concat(hovering.value(timeMarker)?"solid":"dashed"," ").concat(borderColor.value(timeMarker)),height:"max(".concat(unref(nodeStore).viewHeight,", 100%)")})},[createBaseVNode("div",{class:normalizeClass(["sticky top-0 -m-px",{"font-bold z-50 dark:border-zinc-400 border-zinc-500":isHovering.value(timeMarker),"z-40 dark:border-zinc-600":!isHovering.value(timeMarker)}])},[createBaseVNode("h6",{class:"timeMarkerTitle text-sm whitespace-nowrap dark:text-white text-black pl-1 border-l border-inherit",style:normalizeStyle({opacity:isHovering.value(timeMarker)?1:opacity.value(timeMarker)})},toDisplayString(text.value(timeMarker)),5),currentDateResolution.value<=6?(openBlock(),createElementBlock("div",_hoisted_2$c,[isHovering.value(timeMarker)?(openBlock(),createElementBlock("h6",_hoisted_3$9,toDisplayString(hoveringText.value(timeMarker)),1)):createCommentVNode("",!0),_cache[0]||(_cache[0]=createBaseVNode("h6",{class:"whitespace-nowrap text-xs font-bold"}," ",-1))])):createCommentVNode("",!0)],2)],12,_hoisted_1$h)}),128)),(openBlock(!0),createElementBlock(Fragment,null,renderList(eras2.value,function(era){return openBlock(),createElementBlock("div",{class:normalizeClass(["absolute top-0 bottom-0 h-full border-l border-r transition",era.backgroundColor?"":"bg-gray-300/50 dark:bg-gray-300/10 border-gray-500/50"]),style:normalizeStyle({left:"".concat(era.left,"px"),width:"max(".concat(era.width,"px, 10px)"),height:"max(".concat(unref(nodeStore).viewHeight,", 100%)"),backgroundColor:era.backgroundColor,borderColor:era.borderColor})},null,6)}),256))],64)}}});var useCanPanStore=defineStore("canPan",function(){return{canPan:ref(!0)}});const _sfc_main$y=defineComponent({__name:"NewEvent",setup:function(__props){var _useCreateEvent=function(){var timelineStore=useTimelineStore(),markersStore=useMarkersStore(),canPan=useCanPanStore(),startEventCreationRange=ref(),creatingEventRange=ref(),stopCreating=function(){startEventCreationRange.value=void 0,creatingEventRange.value=void 0,window.removeEventListener("mousemove",extendCreatingEvent),window.removeEventListener("mouseup",createEventFromRange),window.removeEventListener("keydown",stopCreatingKeyboardListener)},stopCreatingKeyboardListener=function(e){"Escape"===e.key&&stopCreating()},extendCreatingEvent=function(e){var clientX="undefined"!=typeof TouchEvent&&e instanceof TouchEvent?e.touches[0].clientX:e.clientX,range2=markersStore.rangeFromOffsetLeft(clientX),tempCreatingEventRange=[];tempCreatingEventRange.push(range2[0].left<startEventCreationRange.value[0].left?range2[0]:startEventCreationRange.value[0]),tempCreatingEventRange.push(range2[1].left>startEventCreationRange.value[1].left?range2[1]:startEventCreationRange.value[1]),creatingEventRange.value=tempCreatingEventRange},createEventFromRange=function(e){var rangeToCreate=creatingEventRange.value?creatingEventRange.value:startEventCreationRange.value;rangeToCreate&&timelineStore.createEventFromRange(toDateRangeIso({fromDateTime:rangeToCreate[0].dateTime,toDateTime:rangeToCreate[1].dateTime}),["quarterhour","quarterminute","second"].includes(timelineStore.scaleOfViewportDateInterval)?"instant":timelineStore.scaleOfViewportDateInterval),stopCreating()},newEventPosition=computed(function(){return creatingEventRange.value?creatingEventRange.value:markersStore.range}),creating=computed(function(){return!!startEventCreationRange.value});return watch(creating,function(c){canPan.canPan=!c}),{mouseDownTouchStartListener:function(e){startEventCreationRange.value=markersStore.range,window.addEventListener("touchmove",extendCreatingEvent),window.addEventListener("touchend",createEventFromRange),window.addEventListener("mousemove",extendCreatingEvent),window.addEventListener("mouseup",createEventFromRange),window.addEventListener("keydown",stopCreatingKeyboardListener)},newEventPosition:newEventPosition,creating:creating}}(),newEventPosition=_useCreateEvent.newEventPosition,mouseDownTouchStartListener=_useCreateEvent.mouseDownTouchStartListener,creating=_useCreateEvent.creating,timelineStore=useTimelineStore(),isGantt=computed(function(){return"gantt"===timelineStore.mode});return function(_ctx,_cache){return unref(newEventPosition)?(openBlock(),createElementBlock("button",{key:0,title:"Click and drag to create new event",class:normalizeClass(["h-[10px] border flex items-center justify-center flex-shrink-0 absolute border-transparent hover:border-zinc-100 text-zinc-600 hover:bg-zinc-50 hover:shadow dark:text-zinc-100 dark:hover:border-gray-600 dark:hover:bg-zinc-700 font-bold",unref(creating)?"dark:border-gray-600 dark:bg-zinc-600 bg-zinc-50 border-zinc-100 shadow":"bg-transparent"]),style:normalizeStyle("left: ".concat(unref(newEventPosition)[0].left,"px; width: ").concat(unref(newEventPosition)[1].left-unref(newEventPosition)[0].left,"px; top: 100px; height: ").concat(isGantt.value?"15px":"10px","; border-radius: ").concat(isGantt.value?"0.25rem":"99px")),onMousedown:_cache[0]||(_cache[0]=withModifiers(function(){return unref(mouseDownTouchStartListener)&&unref(mouseDownTouchStartListener).apply(void 0,arguments)},["prevent","stop"])),onTouchstart:_cache[1]||(_cache[1]=withModifiers(function(){return unref(mouseDownTouchStartListener)&&unref(mouseDownTouchStartListener).apply(void 0,arguments)},["prevent","stop"]))}," + ",38)):createCommentVNode("",!0)}}}),_sfc_main$x=defineComponent({__name:"DragHandle",props:{left:{},mouseDownTouchStartListener:{type:Function}},setup:function(__props){var props=__props,styleObj=computed(function(){return{left:"".concat(props.left,"px")}});return function(_ctx,_cache){return openBlock(),createElementBlock("button",{class:"absolute flex items-center justify-center cursor-ew-resize touch-none top-0 bottom-0 z-[4]",style:normalizeStyle(styleObj.value),onTouchstartPassive:_cache[0]||(_cache[0]=function(){return _ctx.mouseDownTouchStartListener&&_ctx.mouseDownTouchStartListener.apply(_ctx,arguments)}),onMousedown:_cache[1]||(_cache[1]=withModifiers(function(){return _ctx.mouseDownTouchStartListener&&_ctx.mouseDownTouchStartListener.apply(_ctx,arguments)},["prevent","stop"]))},_cache[2]||(_cache[2]=[createBaseVNode("div",{class:"absolute w-[2px] h-4 bg-gray-600 rounded dark:bg-gray-300"},null,-1),createBaseVNode("div",{class:"w-4 h-4 absolute flex items-center justify-center"},[createBaseVNode("div",{class:"w-2 h-2 rounded-full border border-white dark:border-gray-300 bg-gray-600 dark:bg-gray-900 shadow"})],-1)]),36)}}}),_export_sfc=(sfc,props)=>{const target=sfc.__vccOpts||sfc;for(const[key,val]of props)target[key]=val;return target},EventBar=_export_sfc(defineComponent({__name:"EventBar",props:{percent:{},tagColor:{},hovering:{type:Boolean},width:{},taskNumerator:{},taskDenominator:{},dragHandleListenerLeft:{type:Function},dragHandleListenerRight:{type:Function},editable:{type:Boolean},expandedRecurrence:{}},setup:function(__props){var timelineStore=useTimelineStore(),props=__props,isGantt=computed(function(){return"gantt"===timelineStore.mode}),color=computed(function(){return props.tagColor||null}),barHeight=computed(function(){return isGantt.value?15:10}),recurrencePercentBarStyleObj=function(left){var isGantt2="gantt"===timelineStore.mode,obj=_objectSpread2({minWidth:"10px"},color.value?{backgroundColor:"rgba(".concat(color.value,", 0.8)")}:{});return obj.width="".concat(props.percent*props.width/100,"px"),obj.borderRadius=isGantt2?"0.125rem":"5px",obj.left="".concat(left,"px"),obj},recurrenceTotalWidth=computed(function(){return props.expandedRecurrence[props.expandedRecurrence.length-1]+props.width});return function(_ctx,_cache){return openBlock(),createElementBlock("div",{class:"flex flex-row items-center eventBar",style:normalizeStyle("width: ".concat(recurrenceTotalWidth.value,"px"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(_ctx.expandedRecurrence,function(instance,i){return openBlock(),createElementBlock("div",{key:i,class:"relative items-center",style:normalizeStyle("height: ".concat(barHeight.value,"px;"))},[createBaseVNode("div",{class:normalizeClass({"eventBar transition shadow top-0 absolute":!0,"dark:bg-zinc-400 bg-zinc-700 opacity-30":!color.value}),style:normalizeStyle((left=instance,isGantt2="gantt"===timelineStore.mode,{left:"".concat(left,"px"),width:"".concat(props.width,"px"),backgroundColor:color.value?"rgba(".concat(color.value,", 0.3)"):"",border:color.value?"1px solid rgba(".concat(color.value,", 0.3)"):"",height:isGantt2?"15px":"10px",borderRadius:isGantt2?"0.125rem":"5px",flexShrink:0}))},null,6),createBaseVNode("div",{class:normalizeClass(["absolute top-0 bottom-0 percentBar transition",{"dark:bg-gray-400 bg-zinc-700 border border-gray-800 dark:border-gray-300":!color.value,"opacity-100 shadow-lg":_ctx.hovering,"opacity-60":!_ctx.hovering}]),style:normalizeStyle(recurrencePercentBarStyleObj(instance))},null,6),0===i?(openBlock(),createElementBlock(Fragment,{key:0},[withDirectives(createVNode(_sfc_main$x,{class:"pointer-events-auto",left:0,"mouse-down-touch-start-listener":_ctx.dragHandleListenerLeft},null,8,["mouse-down-touch-start-listener"]),[[vShow,_ctx.editable&&_ctx.hovering]]),withDirectives(createVNode(_sfc_main$x,{class:"pointer-events-auto",left:_ctx.width,"mouse-down-touch-start-listener":_ctx.dragHandleListenerRight},null,8,["left","mouse-down-touch-start-listener"]),[[vShow,_ctx.editable&&_ctx.hovering]])],64)):createCommentVNode("",!0)],4);var left,isGantt2}),128))],4)}}}),[["__scopeId","data-v-7e5263da"]]);var useResize=function(rangeFrom2,rangeTo2,done){var canPan=useCanPanStore(),tempFromIso=ref(),tempFrom=computed(function(){if(tempFromIso.value)return DateTime$1.fromISO(tempFromIso.value)}),tempToIso=ref(),tempTo=computed(function(){if(tempToIso.value)return DateTime$1.fromISO(tempToIso.value)}),diff2=ref(),markersStore=useMarkersStore(),timelineStore=useTimelineStore(),removeListeners=function(){document.removeEventListener("mousemove",moveListenerLeft),document.removeEventListener("mousemove",moveListenerRight),document.removeEventListener("mousemove",moveListener),document.removeEventListener("mouseup",upListener),document.removeEventListener("mouseup",moveEnd),document.removeEventListener("touchmove",moveListenerLeft),document.removeEventListener("touchmove",moveListenerRight),document.removeEventListener("touchmove",moveListener),document.removeEventListener("touchend",upListener),document.removeEventListener("touchend",moveEnd),document.removeEventListener("keydown",escapeListener)},delayedStop=function(){canPan.canPan=!0,removeListeners(),setTimeout(function(){tempFromIso.value=void 0,tempToIso.value=void 0},100)},escapeListener=function(e){"Escape"===e.key&&(canPan.canPan=!0,tempFromIso.value=void 0,tempToIso.value=void 0,removeListeners())},upListener=function(e){"undefined"!=typeof TouchEvent&&e instanceof TouchEvent||e.preventDefault(),null==done||done(tempFrom.value,tempTo.value),delayedStop()},moveListenerLeft=function(e){var x;"undefined"!=typeof TouchEvent&&e instanceof TouchEvent?x=e.touches[0].clientX:(x=e.clientX,e.preventDefault());var floored=floorDateTime(timelineStore.dateFromClientLeft(x),markersStore.nextMostGranularScaleOfViewportDateInterval);tempFromIso.value=floored.toISO()},moveListenerRight=function(e){var x;"undefined"!=typeof TouchEvent&&e instanceof TouchEvent?x=e.touches[0].clientX:(x=e.clientX,e.preventDefault());var floored=floorDateTime(timelineStore.dateFromClientLeft(x),markersStore.nextMostGranularScaleOfViewportDateInterval);tempToIso.value=floored.toISO()},moveListener=function(e){var x;canPan.canPan=!1,"undefined"!=typeof TouchEvent&&e instanceof TouchEvent?x=e.touches[0].clientX:(e.preventDefault(),x=e.clientX);var dateTime,toScale,up,down,upDiff,downDiff,date=timelineStore.dateFromClientLeft(x+18),rounded=(dateTime=date,toScale=markersStore.nextMostGranularScaleOfViewportDateInterval,up=ceilDateTime(dateTime,toScale),down=floorDateTime(dateTime,toScale),upDiff=dateTime.diff(up),downDiff=dateTime.diff(down),Math.abs(+upDiff)<Math.abs(+downDiff)?up:down);tempFromIso.value=rounded.toISO(),tempToIso.value=rounded.plus(_defineProperty({},"hours",diff2.value)).toISO()},moveEnd=function(e){"undefined"!=typeof TouchEvent&&e instanceof TouchEvent||e.preventDefault(),null==done||done(tempFrom.value,tempTo.value),delayedStop()};return{dragHandleListenerLeft:function(e){canPan.canPan=!1,document.addEventListener("mousemove",moveListenerLeft),document.addEventListener("mouseup",upListener),document.addEventListener("touchmove",moveListenerLeft),document.addEventListener("touchend",upListener),document.addEventListener("keydown",escapeListener)},dragHandleListenerRight:function(e){canPan.canPan=!1,document.addEventListener("mousemove",moveListenerRight),document.addEventListener("mouseup",upListener),document.addEventListener("touchmove",moveListenerRight),document.addEventListener("touchend",upListener),document.addEventListener("keydown",escapeListener)},moveHandleListener:function(e){var _tempTo$value;canPan.canPan=!1,tempFromIso.value=unref(rangeFrom2),tempToIso.value=unref(rangeTo2),diff2.value=null===(_tempTo$value=tempTo.value)||void 0===_tempTo$value?void 0:_tempTo$value.diff(tempFrom.value).as("hours"),document.addEventListener("mousemove",moveListener),document.addEventListener("touchmove",moveListener),document.addEventListener("mouseup",moveEnd),document.addEventListener("touchend",moveEnd),document.addEventListener("keydown",escapeListener)},tempFrom:tempFrom,tempTo:tempTo}},_hoisted_1$g={class:"text-xs font-mono font-bold flex flex-row items-center"},_hoisted_2$b={class:"h-4 w-4 mr-[2px]",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24",fill:"currentColor"},_hoisted_3$8={key:0,"stroke-width":"2",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"},_hoisted_4$3={key:1,d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"},_hoisted_5$2={key:2,d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"},_hoisted_6$1={key:0,class:"pt-px mr-1"};const _sfc_main$v=defineComponent({__name:"TaskCompletion",props:{taskNumerator:{},taskDenominator:{},completed:{type:Boolean}},setup:function(__props){return function(_ctx,_cache){return openBlock(),createElementBlock("div",_hoisted_1$g,[(openBlock(),createElementBlock("svg",_hoisted_2$b,[_ctx.completed||_ctx.taskNumerator>0&&_ctx.taskNumerator===_ctx.taskDenominator?(openBlock(),createElementBlock("path",_hoisted_3$8)):0===_ctx.taskNumerator||!_ctx.taskDenominator&&void 0!==_ctx.completed?(openBlock(),createElementBlock("path",_hoisted_4$3)):(openBlock(),createElementBlock("path",_hoisted_5$2))])),_ctx.taskDenominator?(openBlock(),createElementBlock("span",_hoisted_6$1,toDisplayString(_ctx.taskNumerator)+"/"+toDisplayString(_ctx.taskDenominator),1)):createCommentVNode("",!0)])}}});var _hoisted_1$f={class:"eventTitle whitespace-nowrap font-semibold text-sm py-1 flex flex-row"},_hoisted_2$a={class:"supplementalIndicators flex flex-row dark:text-gray-300 text-gray-500 gap-1 items-center justify-center pl-2"},_hoisted_3$7={class:"ml-px"},_hoisted_4$2=["innerHTML"],_hoisted_5$1={key:0};const _sfc_main$u=defineComponent({__name:"EventTitle",props:{showingMeta:{type:Boolean},isHovering:{type:Boolean},hasMeta:{type:Boolean},hasSupplemental:{type:Boolean},completed:{type:Boolean},taskDenominator:{},taskNumerator:{},titleHtml:{}},emits:["toggleMeta"],setup:function(__props,_ref){_ref.emit;var timelineStore=useTimelineStore();return function(_ctx,_cache){return openBlock(),createElementBlock("div",_hoisted_1$f,[createBaseVNode("div",_hoisted_2$a,["on"!==unref(timelineStore).progressDisplay||!_ctx.taskDenominator&&void 0===_ctx.completed?createCommentVNode("",!0):(openBlock(),createBlock(_sfc_main$v,{key:0,taskNumerator:_ctx.taskNumerator,taskDenominator:_ctx.taskDenominator,completed:_ctx.completed},null,8,["taskNumerator","taskDenominator","completed"]))]),createBaseVNode("p",_hoisted_3$7,[createBaseVNode("span",{innerHTML:_ctx.titleHtml,class:normalizeClass({"pointer-events-auto":_ctx.titleHtml.includes("underline")})},null,10,_hoisted_4$2),_ctx.hasSupplemental?(openBlock(),createElementBlock("span",_hoisted_5$1,"...")):createCommentVNode("",!0)])])}}});var _hoisted_1$e={class:"flex flex-row items-center justify-center"};const _sfc_main$t=defineComponent({__name:"MoveWidgets",props:{move:{type:Function},left:{}},emits:["edit"],setup:function(__props,_ref){var __emit=_ref.emit,props=__props,emit2=__emit,timelineStore=useTimelineStore(),adjustedLeft=computed(function(){return"gantt"===timelineStore.mode?props.left:0});return function(_ctx,_cache){return openBlock(),createElementBlock("div",{class:"flex flex-row text-gray-500 dark:text-gray-400 absolute mr-8 moveWidgets top-0 bottom-0 items-center justify-center p-2",style:normalizeStyle({left:"calc(".concat(adjustedLeft.value,"px - 3.6rem)")})},[createBaseVNode("div",_hoisted_1$e,[createBaseVNode("button",{title:"Edit event",class:"mr-1 transition dark:hover:text-zinc-100 hover:text-black rounded-sm p-px disabled:text-gray-300 disabled:dark:text-gray-600",onClick:_cache[0]||(_cache[0]=function($event){return emit2("edit")})},_cache[3]||(_cache[3]=[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[createBaseVNode("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)]))]),createBaseVNode("div",{title:"Drag to move",class:"handle flex items-center justify-center cursor-crosshair touch-none hover:text-black dark:hover:text-zinc-100 transition",onTouchstart:_cache[1]||(_cache[1]=function(){return _ctx.move&&_ctx.move.apply(_ctx,arguments)}),onMousedown:_cache[2]||(_cache[2]=withModifiers(function(){return _ctx.move&&_ctx.move.apply(_ctx,arguments)},["prevent","stop"]))},_cache[4]||(_cache[4]=[createBaseVNode("svg",{class:"w-4 h-4",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24",fill:"currentColor"},[createBaseVNode("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})],-1)]),32)],4)}}});const Fade=_export_sfc({},[["render",function(_ctx,_cache){return openBlock(),createBlock(Transition,{name:"fade"},{default:withCtx(function(){return[renderSlot(_ctx.$slots,"default",{},void 0,!0)]}),_:3})}],["__scopeId","data-v-39c803d6"]]);var useNodePosition=function(path){var collapseStore=useCollapseStore(),nodeStore=useNodeStore(),collapsedParent=computed(function(){return collapseStore.isCollapsedChildOf(unref(path))}),isCollapsed=computed(function(){return!!collapsedParent.value});return{top:computed(function(){return 100+30*nodeStore.predecessorMap.get(collapsedParent.value?collapsedParent.value.join(","):unref(path).join(","))}),isCollapsed:isCollapsed}},_hoisted_1$d={key:1,class:"absolute top-0 bottom-0 flex items-center pr-4 text-xs text-gray-400 source",style:{transform:"translateX(-100%)"}},_hoisted_2$9={class:"eventItem pointer-events-none"},_hoisted_3$6={class:"flex h-full"};const EventRow=_export_sfc(defineComponent({__name:"EventRow",props:{path:{},tags:{},dateText:{},supplemental:{},matchedListItems:{},hovering:{type:Boolean},percent:{},rangeFrom:{},rangeTo:{},titleHtml:{},color:{},isDetailEvent:{type:Boolean},numAbove:{},completed:{type:Boolean},recurrence:{},source:{}},emits:["editDateRange","hover"],setup:function(__props,_ref){var __emit=_ref.emit,props=__props,emit2=__emit,timelineStore=useTimelineStore(),eventBar=ref(),showingMeta=ref(!1),hasMeta=computed(function(){return!!props.supplemental.length}),toggleMeta=function(e){e.target instanceof HTMLAnchorElement||(e.preventDefault(),showingMeta.value=!showingMeta.value)},taskNumerator=computed(function(){return props.supplemental.filter(function(block){return"checkbox"===block.type&&block.value}).length}),taskDenominator=computed(function(){return props.supplemental.filter(function(block){return"checkbox"===block.type}).length});computed(function(){return!!props.supplemental.length&&showingMeta.value});var _useResize=useResize(computed(function(){return props.rangeFrom}),computed(function(){return props.rangeTo}),function(){return emit2("editDateRange",range2.value)}),dragHandleListenerLeft=_useResize.dragHandleListenerLeft,dragHandleListenerRight=_useResize.dragHandleListenerRight,moveHandleListener=_useResize.moveHandleListener,tempFrom=_useResize.tempFrom,tempTo=_useResize.tempTo,hoveringWidgets=ref(!1),elementHover=ref(!1);watch(elementHover,function(hovering){return emit2("hover",hovering)});var isHovering=computed(function(){return elementHover.value||!!tempFrom.value||!!tempTo.value||hoveringWidgets.value||props.hovering}),range2=computed(function(){var eventRange2=toDateRange({fromDateTimeIso:props.rangeFrom,toDateTimeIso:props.rangeTo});return tempFrom.value||tempTo.value?tempFrom.value?tempTo.value?{fromDateTime:+tempFrom.value<+tempTo.value?tempFrom.value:tempTo.value,toDateTime:+tempFrom.value<+tempTo.value?tempTo.value:tempFrom.value}:+tempFrom.value<+eventRange2.toDateTime?{fromDateTime:tempFrom.value,toDateTime:eventRange2.toDateTime}:{fromDateTime:eventRange2.toDateTime,toDateTime:tempFrom.value}:+tempTo.value>+eventRange2.fromDateTime?{fromDateTime:eventRange2.fromDateTime,toDateTime:tempTo.value}:{fromDateTime:tempTo.value,toDateTime:eventRange2.fromDateTime}:eventRange2}),expandedRecurrence=computed(function(){return(props.recurrence?expand(range2.value,props.recurrence,100):[range2.value]).map(function(dr){return timelineStore.distanceBetweenDates(range2.value.fromDateTime,dr.fromDateTime)})}),dimensions=computed(function(){var left2=timelineStore.distanceFromBaselineLeftmostDate(range2.value.fromDateTime),width=timelineStore.distanceBetweenDates(range2.value.fromDateTime,range2.value.toDateTime);return{left:left2,width:Math.max(10,width)}}),left=computed(function(){return dimensions.value.left}),clickStart=ref(),percent=computed(function(){var p2=props.percent;return isNaN(p2)?!isNaN(taskNumerator.value)&&taskDenominator.value>0?taskNumerator.value/taskDenominator.value*100:100:p2}),_useNodePosition=useNodePosition(computed(function(){return props.path})),top=_useNodePosition.top,isCollapsed=_useNodePosition.isCollapsed,edit=function(){return timelineStore.showInEditor(props.path)},isGantt=computed(function(){return"gantt"===timelineStore.mode}),styleObj=computed(function(){var obj={top:"".concat(top.value,"px"),height:"30px",transition:"top 200ms cubic-bezier(0.4, 0, 0.2, 1)"};return obj.left=isGantt.value?"0px":"".concat(left.value,"px"),isGantt.value&&(obj.right="-350%"),obj}),classObj=computed(function(){return isGantt.value?{"dark:bg-gray-900 bg-white":props.isDetailEvent,"dark:border-gray-400 border-black":props.hovering&&!props.isDetailEvent,"dark:border-indigo-600 border-indigo-500":props.isDetailEvent,"border-transparent":!props.hovering&&!props.isDetailEvent,"dark:bg-zinc-400/10  bg-zinc-400/10":props.hovering}:{"pointer-events-none":isCollapsed.value}}),barAndTitleClass=computed(function(){return isGantt.value?{}:{"dark:bg-gray-800 bg-white shadow-lg":isHovering.value&&hasMeta.value,"dark:bg-gray-900 bg-white shadow-lg":props.isDetailEvent,"ring-1 dark:ring-gray-400 ring-black":props.hovering&&!props.isDetailEvent,"ring-1 dark:ring-indigo-600 ring-indigo-500":props.isDetailEvent,"pointer-events-auto cursor-pointer":!isCollapsed.value}}),mousedown=function(e){var x=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,y=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;clickStart.value={x:x,y:y}},mouseup=function(e){var _clickStart$value,x=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,y=e instanceof MouseEvent?e.clientY:e.touches[0].clientY;(null===(_clickStart$value=clickStart.value)||void 0===_clickStart$value?void 0:_clickStart$value.x)===x&&clickStart.value.y===y&&timelineStore.setDetailEventPath(props.path)},ganttTitleStyle=computed(function(){var styleObj2={};return props.color&&(styleObj2.backgroundColor="rgba(".concat(props.color,", 0.5)")),styleObj2.width="".concat(timelineStore.ganttSidebarTempWidth?timelineStore.ganttSidebarTempWidth:timelineStore.ganttSidebarWidth,"px"),styleObj2});return function(_ctx,_cache){return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:normalizeClass(["eventRow absolute",classObj.value]),style:normalizeStyle(styleObj.value),onMouseenterPassive:_cache[2]||(_cache[2]=function($event){return!unref(isCollapsed)&&(elementHover.value=!0)}),onMouseleavePassive:_cache[3]||(_cache[3]=function($event){return elementHover.value=!1})},[unref(isCollapsed)||"default"!==_ctx.source?!unref(isCollapsed)&&isHovering.value?(openBlock(),createElementBlock("div",_hoisted_1$d,toDisplayString(_ctx.source),1)):createCommentVNode("",!0):withDirectives((openBlock(),createBlock(_sfc_main$t,{key:0,move:unref(moveHandleListener),left:left.value,onMouseenterPassive:_cache[0]||(_cache[0]=function($event){return hoveringWidgets.value=!0}),onMouseleavePassive:_cache[1]||(_cache[1]=function($event){return hoveringWidgets.value=!1}),onEdit:edit},null,8,["move","left"])),[[vShow,isHovering.value]]),createBaseVNode("div",{class:"flex flex-row eventContent items-center h-full",style:normalizeStyle(isGantt.value?"margin-left: ".concat(left.value,"px"):"")},[createBaseVNode("div",_hoisted_2$9,[createBaseVNode("div",mergeProps({class:["flex flex-row rounded -mx-2 px-2 eventBarAndTitle",barAndTitleClass.value]},toHandlers(unref(isCollapsed)?{}:{mousedown:mousedown,mouseup:mouseup})),null,16),createVNode(EventBar,{ref_key:"eventBar",ref:eventBar,tagColor:_ctx.color,percent:percent.value,hovering:isHovering.value||_ctx.hovering,width:dimensions.value.width,taskNumerator:taskNumerator.value,taskDenominator:taskDenominator.value,"drag-handle-listener-left":unref(dragHandleListenerLeft),"drag-handle-listener-right":unref(dragHandleListenerRight),editable:!unref(isCollapsed)&&"default"===_ctx.source,expandedRecurrence:expandedRecurrence.value},null,8,["tagColor","percent","hovering","width","taskNumerator","taskDenominator","drag-handle-listener-left","drag-handle-listener-right","editable","expandedRecurrence"]),createVNode(Fade,null,{default:withCtx(function(){return[withDirectives(createBaseVNode("p",{class:normalizeClass(["eventDate text-sm whitespace-nowrap py-1",_ctx.recurrence?"dark:text-orange-300 text-orange-500":"text-gray-400"])},toDisplayString(_ctx.dateText),3),[[vShow,!unref(isCollapsed)&&"original"===unref(timelineStore).dateTimeDisplay]])]}),_:1}),createVNode(Fade,null,{default:withCtx(function(){return["timeline"===unref(timelineStore).mode?withDirectives((openBlock(),createBlock(_sfc_main$u,{key:0,"showing-meta":showingMeta.value,"is-hovering":isHovering.value,"has-meta":hasMeta.value,"has-supplemental":!!_ctx.supplemental.length,"task-denominator":taskDenominator.value,"task-numerator":taskNumerator.value,completed:_ctx.completed,"title-html":_ctx.titleHtml,onToggleMeta:toggleMeta},null,8,["showing-meta","is-hovering","has-meta","has-supplemental","task-denominator","task-numerator","completed","title-html"])),[[vShow,!unref(isCollapsed)]]):createCommentVNode("",!0)]}),_:1})])],4)],38),"gantt"!==unref(timelineStore).mode||unref(isCollapsed)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,class:"absolute left-0 h-[30px] pointer-events-none",style:normalizeStyle({top:"".concat(unref(top),"px"),right:"-350%"}),onMouseenterPassive:_cache[4]||(_cache[4]=function($event){return elementHover.value=!0}),onMouseleavePassive:_cache[5]||(_cache[5]=function($event){return elementHover.value=!1})},[createBaseVNode("div",_hoisted_3$6,[createBaseVNode("div",{class:normalizeClass(["sticky left-0 z-10 h-full",{"dark:bg-zinc-400/10 bg-zinc-400/25":_ctx.hovering,"bg-white dark:bg-zinc-800":!_ctx.hovering}])},[createBaseVNode("div",{class:normalizeClass(["h-full pointer-events-auto",{"border-transparent":!_ctx.hovering&&!_ctx.isDetailEvent,"dark:border-indigo-600 border-indigo-600":_ctx.isDetailEvent}]),style:normalizeStyle([{"text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden",cursor:"pointer"},ganttTitleStyle.value]),onMousedownPassive:mousedown,onMouseupPassive:mouseup},[createVNode(_sfc_main$u,{class:"px-2 h-full","showing-meta":showingMeta.value,"is-hovering":isHovering.value,"has-meta":hasMeta.value,"has-supplemental":!!_ctx.supplemental.length,"task-denominator":taskDenominator.value,"task-numerator":taskNumerator.value,completed:_ctx.completed,"title-html":_ctx.titleHtml,onToggleMeta:toggleMeta},null,8,["showing-meta","is-hovering","has-meta","has-supplemental","task-denominator","task-numerator","completed","title-html"])],38)],2)])],36))],64)}}}),[["__scopeId","data-v-633ec2f2"]]);var dateRangeIsoComparator=function(a,b){return dateTimeIsoComparator(a.fromDateTimeIso,b.fromDateTimeIso)&&dateTimeIsoComparator(a.toDateTimeIso,b.toDateTimeIso)},dateTimeIsoComparator=function(a,b){return a===b},stringArrayComparator=function(a,b){return a.length===b.length&&a.every(function(s2,i){return s2===b[i]})},matchedListItemsComparator=function(a,b){return a.length==b.length&&a.every(function(r,i){return function(a,b){return a.type===b.type&&a.content===b.content&&a.from===b.from&&a.to===b.to}(r,b[i])})},supplementalComparator=function(a,b){return a.length===b.length&&a.every(function(s2,i){return markdownBlockComparator(s2,b[i])})},markdownBlockComparator=function(a,b){return a.type===b.type&&(a.type===BlockType.IMAGE?a.altText===b.altText&&a.link===b.link:a.raw===b.raw&&a.value===b.value)},recurrenceComparator=function(a,b){return deepCompare(a,b)};function deepCompare(obj1,obj2){if("object"!==_typeof(obj1)||"object"!==_typeof(obj2)||null===obj1||null===obj2)return obj1===obj2;var keys1=Object.keys(obj1),keys2=Object.keys(obj2);if(keys1.length!==keys2.length)return!1;for(var _i=0,_keys=keys1;_i<_keys.length;_i++){var key=_keys[_i];if(!obj2.hasOwnProperty(key)||!deepCompare(obj1[key],obj2[key]))return!1}return!0}function toInnerHtml(s2){return s2.replace(/<|>/g,function(match2){return"<"===match2?"<span><</span>":"<span>></span>"}).replace(LINK_REGEX,function(substring,linkText,link){return'<a class="underline" href="'.concat(function(s2){if(s2.startsWith("http://")||s2.startsWith("https://")||s2.startsWith("/"))return s2;return"http://".concat(s2)}(link),'">').concat(linkText,"</a>")}).replace(/&/g,"&amp;").replace(AT_REGEX,function(substring,at){return'<a class="underline" href="/'.concat(at,'">@').concat(at,"</a>")})}var cachedComputed=function(val,comparator,defaultValue){var r=ref(defaultValue||void 0);return watchEffect(function(){var value=val();void 0===value?r.value=void 0:r.value&&comparator(r.value,value)||(r.value=value)}),r},useEventRefs=function(eventNode){var timelineStore=useTimelineStore(),cachedEventComputed=function(val){var comparator=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(a,b){return a===b};return cachedComputed(val,function(a,b){return function(a,b){return void 0===a&&void 0===b||void 0!==a&&void 0!==b}(a,b)&&comparator(a,b)},arguments.length>2?arguments[2]:void 0)},event=computed(function(){return eventNode.value}),source=cachedComputed(function(){return eventNode.value.source},function(a,b){return a===b},"default"),eventRange2=cachedEventComputed(function(){return unref(event).dateRangeIso},dateRangeIsoComparator),completed=cachedEventComputed(function(){var _unref;return null===(_unref=unref(event))||void 0===_unref?void 0:_unref.completed}),supplemental=cachedEventComputed(function(){var _unref2;return(null===(_unref2=unref(event))||void 0===_unref2?void 0:_unref2.supplemental)||[]},supplementalComparator),percent=cachedEventComputed(function(){var _unref3;return null===(_unref3=unref(event))||void 0===_unref3?void 0:_unref3.percent}),matchedListItems=cachedEventComputed(function(){var _unref4;return(null===(_unref4=unref(event))||void 0===_unref4?void 0:_unref4.matchedListItems)||[]},matchedListItemsComparator),tags=cachedEventComputed(function(){var _unref5;return(null===(_unref5=unref(event))||void 0===_unref5?void 0:_unref5.tags)||[]},stringArrayComparator),color=ref();watchEffect(function(){var _tags$value,_timelineStore$colors,eventColor=null!==(_tags$value=tags.value)&&void 0!==_tags$value&&_tags$value.length?null===(_timelineStore$colors=timelineStore.colors[source.value||"default"])||void 0===_timelineStore$colors?void 0:_timelineStore$colors[tags.value[0]]:void 0;color.value!==eventColor&&(color.value=eventColor)});var dateText=cachedEventComputed(function(){var _e$textRanges,_e$firstLine,e=unref(event);return null!=e&&null!==(_e$textRanges=e.textRanges)&&void 0!==_e$textRanges&&null!==(_e$textRanges=_e$textRanges.recurrence)&&void 0!==_e$textRanges&&_e$textRanges.content?e.textRanges.recurrence.content:toInnerHtml((null==e||null===(_e$firstLine=e.firstLine)||void 0===_e$firstLine?void 0:_e$firstLine.datePart)||"")}),titleHtml=cachedEventComputed(function(){var _unref6,ed=null===(_unref6=unref(event))||void 0===_unref6||null===(_unref6=_unref6.firstLine)||void 0===_unref6?void 0:_unref6.restTrimmed;return ed?toInnerHtml(ed.replace(COMPLETION_REGEX,function(a,b){return a.substring(b.length)})):""}),recurrence=cachedEventComputed(function(){var _unref7;return null===(_unref7=unref(event))||void 0===_unref7?void 0:_unref7.recurrence},recurrenceComparator);return{eventRange:eventRange2,supplemental:supplemental,percent:percent,matchedListItems:matchedListItems,tags:tags,color:color,dateText:dateText,titleHtml:titleHtml,completed:completed,recurrence:recurrence,source:source}};const _sfc_main$q=defineComponent({__name:"EventNodeRow",props:{eventy:{},path:{},numAbove:{},numChildren:{}},setup:function(__props){var props=__props,timelineStore=useTimelineStore(),editEventDateRange=timelineStore.editEventDateRange,pathArray=computed(function(){return props.path.split(",").map(function(i){return parseInt(i)})});computed(function(){return isEvent(props.eventy)});var hoveringPath=computed(function(){return timelineStore.hoveringEventPaths}),_useEventRefs=useEventRefs(computed(function(){return props.eventy})),eventRange2=_useEventRefs.eventRange,supplemental=_useEventRefs.supplemental,percent=_useEventRefs.percent,matchedListItems=_useEventRefs.matchedListItems,tags=_useEventRefs.tags,color=_useEventRefs.color,dateText=_useEventRefs.dateText,titleHtml=_useEventRefs.titleHtml,completed=_useEventRefs.completed,recurrence=_useEventRefs.recurrence,source=_useEventRefs.source,eventPath=computed(function(){return pathArray.value}),scale=computed(function(){return timelineStore.scaleOfViewportDateInterval}),editDateRange=function(range2){return editEventDateRange(pathArray.value,toDateRangeIso(range2),scale.value)},hover=function(hovering){hovering?timelineStore.setHoveringEvent(props.path.split(",").map(function(i){return parseInt(i)})):timelineStore.clearHoveringEvent()},isDetailEvent=computed(function(){return timelineStore.isDetailEventPath(eventPath.value)});return function(_ctx,_cache){return openBlock(),createBlock(EventRow,{source:unref(source)||"default",supplemental:unref(supplemental)||[],"matched-list-items":unref(matchedListItems)||[],rangeFrom:unref(eventRange2).fromDateTimeIso,rangeTo:unref(eventRange2).toDateTimeIso,tags:unref(tags)||[],color:unref(color),path:eventPath.value,percent:unref(percent),dateText:unref(dateText)||"",titleHtml:unref(titleHtml)||"",completed:unref(completed),recurrence:unref(recurrence),onEditDateRange:editDateRange,onHover:hover,"is-detail-event":isDetailEvent.value,hovering:unref(equivalentPaths)(hoveringPath.value,eventPath.value),numAbove:_ctx.numAbove},null,8,["source","supplemental","matched-list-items","rangeFrom","rangeTo","tags","color","path","percent","dateText","titleHtml","completed","recurrence","is-detail-event","hovering","numAbove"])}}});var _hoisted_1$c={class:"fixed left-0 right-0 top-0 h-full pointer-events-none z-20"},_hoisted_2$8={class:"flex w-full h-full"},_hoisted_3$5={class:"h-full w-full"};const _sfc_main$p=defineComponent({__name:"GanttSidebar",setup:function(__props){var timelineStore=useTimelineStore(),width=computed(function(){return timelineStore.ganttSidebarWidth}),_usePanelResize=function(isLeft,currentWidth,setNewWidth){var resizeXStarted=ref(!1),resizeStartX=ref(0),tempWidth=ref(0),pageX=function(e){return e instanceof MouseEvent?e.pageX:e.touches[0].pageX},stop=function(){document.removeEventListener("mouseup",resizeMouseUp),document.removeEventListener("touchend",resizeMouseUp),document.removeEventListener("mousemove",resizeMouseMove),document.removeEventListener("touchmove",resizeMouseMove),document.removeEventListener("keydown",escapeListener)},escapeListener=function(e){"Escape"===e.key&&(resizeXStarted.value=!1,tempWidth.value=0,stop())},resizeMouseMove=function(e){resizeXStarted.value&&(unref(isLeft)?tempWidth.value=Math.max(unref(currentWidth)-resizeStartX.value+pageX(e),150):tempWidth.value=Math.max(unref(currentWidth)+resizeStartX.value-pageX(e),150))},resizeMouseUp=function(e){resizeXStarted.value=!1,tempWidth.value&&(setNewWidth(Math.max(tempWidth.value,50)),tempWidth.value=0),stop()},isResizing=computed(function(){return resizeXStarted.value});return watch(isResizing,function(r){useCanPanStore().canPan=!r}),{tempWidth:tempWidth,resizeMouseDown:function(e){resizeXStarted.value=!0,resizeStartX.value=pageX(e),document.addEventListener("mousemove",resizeMouseMove),document.addEventListener("mouseup",resizeMouseUp),document.addEventListener("touchmove",resizeMouseMove),document.addEventListener("touchend",resizeMouseUp),document.addEventListener("keydown",escapeListener)},isResizing:isResizing}}(!0,width,function(w){return timelineStore.setGanttSidebarWidth(w)}),tempWidth=_usePanelResize.tempWidth,resizeMouseDown=_usePanelResize.resizeMouseDown;watchEffect(function(){timelineStore.setGanttSidebarTempWidth(tempWidth.value)});var currentWidth=computed(function(){return tempWidth.value?tempWidth.value:width.value});return function(_ctx,_cache){return withDirectives((openBlock(),createElementBlock("div",_hoisted_1$c,[createBaseVNode("div",_hoisted_2$8,[createBaseVNode("div",{class:"sticky left-0 relative flex flex-col",style:normalizeStyle("width: ".concat(currentWidth.value,"px"))},[createBaseVNode("div",_hoisted_3$5,[createBaseVNode("div",{class:normalizeClass(["pointer-events-auto sticky hover:w-1 right-0 inline-flex items-center justify-center hover:transition hover:bg-indigo-600 dark:hover:bg-indigo-600 top-0 bottom-0 z-[5]",{"bg-indigo-600 w-1":unref(tempWidth),"bg-zinc-200 dark:bg-zinc-900 w-px":!unref(tempWidth)}]),style:normalizeStyle([{cursor:"ew-resize"},"height: ".concat(unref(timelineStore).pageSettings.viewport.height,"px; left: ").concat(currentWidth.value,"px")]),onMousedown:_cache[0]||(_cache[0]=withModifiers(function(){return unref(resizeMouseDown)&&unref(resizeMouseDown).apply(void 0,arguments)},["prevent","stop"])),onTouchstart:_cache[1]||(_cache[1]=withModifiers(function(){return unref(resizeMouseDown)&&unref(resizeMouseDown).apply(void 0,arguments)},["prevent","stop"]))},null,38)])],4)])],512)),[[vShow,"gantt"===unref(timelineStore).mode]])}}}),_sfc_main$o=defineComponent({__name:"ExpandedSectionBackground",props:{hovering:{type:Boolean},style:{},eventy:{},left:{},fullWidth:{},path:{},height:{}},setup:function(__props){var props=__props,color=useEventColor(computed$1(function(){return props.eventy})).color,timelineStore=useTimelineStore(),isGroupStyle=computed$1(function(){return"group"===props.style}),computedPath=computed$1(function(){return props.path.split(",").map(function(i){return parseInt(i)})}),isDetailEvent=computed$1(function(){return timelineStore.isDetailEventPath(computedPath.value)}),isDeep=computed$1(function(){return props.path.split(",").length>4}),styleObject=computed$1(function(){var obj={height:"".concat(props.height,"px"),transition:"height 200ms cubic-bezier(0.4, 0, 0.2, 1)"};if(color.value){props.hovering||isDetailEvent.value?obj.backgroundColor="rgba(".concat(color.value,", 0.1"):isDeep.value||(obj.backgroundColor="rgba(".concat(color.value,", 0.05)"));var border="1px solid rgba(".concat(color.value,", ").concat(isDetailEvent.value?"0.95":props.hovering?"0.75":"0.12",")");obj.borderTop=border,obj.borderBottom=border,isGroupStyle.value&&(obj.borderLeft=border,obj.borderRight=border)}return isGroupStyle.value&&(obj.marginLeft="".concat(timelineStore.pageScaleBy24*props.left-8,"px"),obj.width="".concat(timelineStore.pageScaleBy24*props.fullWidth+24,"px")),obj});return function(_ctx,_cache){return openBlock(),createElementBlock("div",{class:normalizeClass(["absolute h-full flex flex-row items-center dark:text-gray-400 pointer-events-none",{"dark:bg-opacity-30 bg-opacity-20":_ctx.hovering||!unref(color)&&unref(isDetailEvent),"dark:bg-opacity-20 bg-opacity-10":!_ctx.hovering&&!unref(isDeep),"border-t border-b":!unref(color),"border-l border-r":unref(isGroupStyle),"dark:border-gray-900/25 border-gray-400/25":!unref(color)&&unref(isDeep),"bg-gray-400 dark:bg-gray-600":!unref(color)&&!unref(isDeep),"dark:border-gray-400/25 border-gray-400/25":!unref(color)&&!_ctx.hovering,"dark:border-gray-400 border-gray-600":!unref(color)&&(_ctx.hovering||unref(isDetailEvent)),"ml-0 w-full":!unref(isGroupStyle),"rounded-[14px]":unref(isGroupStyle)}]),style:normalizeStyle(unref(styleObject))},null,6)}}});var _hoisted_1$b={key:0,class:"mr-[2px] flex flex-row items-center"},_hoisted_2$7={xmlns:"http://www.w3.org/2000/svg",class:"w-1 h-2",width:"40",height:"40",viewBox:"0 0 16 20","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},_hoisted_3$4={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-1 h-2",width:"40",height:"40",viewBox:"0 0 16 20","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"};const _sfc_main$n=defineComponent({__name:"DepthIndicator",props:{depth:{}},setup:function(__props){var props=__props,numEven=computed$1(function(){return Math.floor((props.depth-1)/2)}),isOdd=computed$1(function(){return(props.depth-1)%2==1});return function(_ctx,_cache){return _ctx.depth>1?(openBlock(),createElementBlock("div",_hoisted_1$b,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(numEven),function(i){return openBlock(),createElementBlock("svg",_hoisted_2$7,_cache[0]||(_cache[0]=[createBaseVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),createBaseVNode("circle",{cx:"8",cy:"4",r:"4",fill:"currentColor"},null,-1),createBaseVNode("circle",{cx:"8",cy:"18",r:"4",fill:"currentColor"},null,-1)]))}),256)),unref(isOdd)?(openBlock(),createElementBlock("svg",_hoisted_3$4,_cache[1]||(_cache[1]=[createBaseVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),createBaseVNode("circle",{cx:"8",cy:"11",r:"4",fill:"currentColor"},null,-1)]))):createCommentVNode("",!0)])):createCommentVNode("",!0)}}});var _hoisted_1$a={xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 ml-auto",viewBox:"0 0 20 20",fill:"currentColor"};const UpCaret=_export_sfc({},[["render",function(_ctx,_cache){return openBlock(),createElementBlock("svg",_hoisted_1$a,_cache[0]||(_cache[0]=[createBaseVNode("path",{"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z","clip-rule":"evenodd"},null,-1)]))}]]);var _hoisted_1$9={class:"flex flex-row flex-grow items-center justify-center"},_hoisted_2$6=["innerHTML"],_hoisted_3$3={key:1,class:"eventTitle text-sm font-semibold whitespace-nowrap ml-1"};const SectionTitleButton=_export_sfc(defineComponent({__name:"SectionTitleButton",props:{color:{},titleHtml:{},expanded:{type:Boolean},numChildren:{},groupStyle:{},path:{}},emits:["click","hovering"],setup:function(__props,_ref){var __emit=_ref.emit,props=__props,button=ref(),emit2=__emit,styleObject=computed(function(){return props.color?{backgroundColor:"rgba(".concat(props.color,", 0.5)")}:{}});return function(_ctx,_cache){return openBlock(),createElementBlock("button",{ref_key:"button",ref:button,class:normalizeClass(["flex flex-row items-center dark:bg-opacity-60 bg-opacity-50",{"bg-gray-500 dark:bg-gray-900":!_ctx.color,"rounded-full px-2 py-px":"group"===_ctx.groupStyle,"px-1":"group"!==_ctx.groupStyle}]),style:normalizeStyle(styleObject.value),onMouseoverPassive:_cache[0]||(_cache[0]=function($event){return emit2("hovering",!0)}),onMouseleavePassive:_cache[1]||(_cache[1]=function($event){return emit2("hovering",!1)})},[createVNode(_sfc_main$n,{depth:_ctx.path.split(",").length},null,8,["depth"]),createBaseVNode("div",_hoisted_1$9,[_ctx.titleHtml?(openBlock(),createElementBlock("span",{key:0,class:"eventTitle text-sm font-semibold whitespace-nowrap",innerHTML:_ctx.titleHtml},null,8,_hoisted_2$6)):createCommentVNode("",!0),_ctx.expanded?createCommentVNode("",!0):(openBlock(),createElementBlock("span",_hoisted_3$3,"("+toDisplayString(_ctx.numChildren)+")",1))]),_ctx.expanded?(openBlock(),createBlock(UpCaret,{key:0})):createCommentVNode("",!0)],38)}}}),[["__scopeId","data-v-a5548532"]]),_sfc_main$k=defineComponent({__name:"SectionHeader",props:{path:{},expanded:{type:Boolean},titleHtml:{},color:{},numChildren:{},groupStyle:{},fullWidth:{},left:{},hovering:{type:Boolean}},emits:["toggle","hover"],setup:function(__props,_ref){var timeout,__emit=_ref.emit,timelineStore=useTimelineStore(),collapseStore=useCollapseStore(),props=__props,emit2=__emit,events=computed(function(){return{click:function(e){return emit2("toggle",e)},mouseover:function(e){return emit2("hover",!0)},mouseleave:function(e){return emit2("hover",!1)}}}),isCollapsed=computed(function(){return collapseStore.isCollapsed(props.path)}),transitioning=ref(!1);watch(isCollapsed,function(){transitioning.value=!0,isNaN(timeout)||clearTimeout(timeout),timeout=setTimeout(function(){transitioning.value=!1},200)});var width=computed(function(){return timelineStore.pageScaleBy24*props.fullWidth}),styleObject=computed(function(){var obj={order:-9999,top:"".concat(3+1.2*props.path.slice(1).length,"rem"),zIndex:"gantt"===timelineStore.mode?3:0,height:"30px"};return"group"===props.groupStyle&&(obj.width="".concat(width.value,"px"),obj.marginLeft="".concat(timelineStore.pageScaleBy24*props.left,"px")),obj}),click=function(e){return emit2("toggle",e)},titleStyle=computed(function(){var styleObj={left:"1rem"};return"gantt"===timelineStore.mode&&(styleObj.width="calc(".concat(timelineStore.ganttSidebarTempWidth?timelineStore.ganttSidebarTempWidth:timelineStore.ganttSidebarWidth,"px - 0.5rem)"),styleObj.overflow="auto"),styleObj}),titleClass=computed(function(){return"gantt"===timelineStore.mode?props.hovering?"border dark:border-gray-400 border-black":"border border-transparent":""}),childStyleObj=computed(function(){var obj={};return transitioning.value&&(obj.transition=transitioning.value?"margin-left 200ms cubic-bezier(0.4, 0, 0.2, 1)":""),"group"===props.groupStyle&&isCollapsed.value?obj.marginLeft="calc(".concat(width.value,"px + 0.75rem)"):obj.marginLeft=0,obj});return function(_ctx,_cache){return openBlock(),createElementBlock("div",mergeProps({class:"flex items-center cursor-pointer",style:styleObject.value},toHandlers(events.value)),[createBaseVNode("div",{class:"sticky flex items-center left-2",style:normalizeStyle(childStyleObj.value)},[createBaseVNode("div",{class:normalizeClass(["h-[30px] flex flex-row items-center",titleClass.value]),style:normalizeStyle(titleStyle.value)},[createVNode(SectionTitleButton,{"title-html":_ctx.titleHtml,color:_ctx.color,"num-children":_ctx.numChildren,expanded:_ctx.expanded,"group-style":_ctx.groupStyle,path:_ctx.path,onClick:click},null,8,["title-html","color","num-children","expanded","group-style","path"])],6)],4)],16)}}});var _hoisted_1$8={class:"relative flex flex-col"};const _sfc_main$j=defineComponent({__name:"Section",props:{eventy:{},path:{},numChildren:{},numAbove:{},groupStyle:{}},setup:function(__props){var timelineStore=useTimelineStore(),collapseStore=useCollapseStore(),setHoveringEvent=timelineStore.setHoveringEvent,clearHoveringEvent=timelineStore.clearHoveringEvent,props=__props,scalelessDistanceBetweenDates=timelineStore.scalelessDistanceBetweenDates;timelineStore.scalelessDistanceFromReferenceDate;var collapsed=computed({get:function(){return collapseStore.isCollapsed(props.path)},set:function(val){return collapseStore.setCollapsed(props.path,val)}}),hovering=ref(!1),hoveringPath=computed(function(){return timelineStore.hoveringEventPaths}),ourPath=computed(function(){return props.path.split(",").map(function(i){return parseInt(i)})}),toggle=function(e){e.target instanceof HTMLAnchorElement||(e.preventDefault(),collapsed.value=!collapsed.value)},sectionRange=computed(function(){return _ranges(props.eventy,100)}),left=computed(function(){return props.eventy&&sectionRange.value?scalelessDistanceBetweenDates(timelineStore.baselineLeftmostDate,sectionRange.value.fromDateTime):10}),color=useEventColor(computed(function(){return props.eventy})).color,fullWidth=computed(function(){return props.eventy&&sectionRange.value?scalelessDistanceBetweenDates(sectionRange.value.fromDateTime,sectionRange.value.toDateTime):100}),titleHtml=computed(function(){return toInnerHtml(props.eventy.title||"")}),hover=function(isHovering){hovering.value=isHovering};watch(hovering,function(h2){h2?setHoveringEvent(props.path.split(",").map(function(i){return parseInt(i)})):clearHoveringEvent()});var groupStyle=computed(function(){return props.groupStyle?props.groupStyle:"gantt"===timelineStore.mode||"section"===props.eventy.style?"section":"group"}),width=computed(function(){return"".concat(timelineStore.pageScaleBy24*fullWidth.value,"px")}),top=computed(function(){return 100+30*props.numAbove}),height=computed(function(){return 30+30*props.numChildren}),styleObject=computed(function(){return _objectSpread2({top:"".concat(top.value,"px"),transition:"top 200ms cubic-bezier(0.4, 0, 0.2, 1)",display:collapseStore.isCollapsedChild(props.path)?"none":"block"},"section"===groupStyle.value?{left:0,right:"-350%"}:{})}),hovered=computed(function(){return hovering.value||equivalentPaths(hoveringPath.value,ourPath.value)});return function(_ctx,_cache){return openBlock(),createElementBlock("div",{class:"absolute",style:normalizeStyle(styleObject.value)},[createBaseVNode("div",_hoisted_1$8,[createVNode(_sfc_main$o,{hovering:hovered.value,style:normalizeStyle(groupStyle.value),eventy:_ctx.eventy,left:left.value,height:height.value,"full-width":fullWidth.value,path:_ctx.path},null,8,["hovering","style","eventy","left","height","full-width","path"]),createBaseVNode("div",{class:"sticky top-0 cursor-pointer",style:normalizeStyle({width:width.value})},null,4),createVNode(_sfc_main$k,{path:_ctx.path,onToggle:toggle,onHover:hover,hovering:hovered.value,expanded:!collapsed.value,titleHtml:titleHtml.value,color:unref(color),"num-children":_ctx.eventy.children.length,"group-style":groupStyle.value,left:left.value,"full-width":fullWidth.value},null,8,["path","hovering","expanded","titleHtml","color","num-children","group-style","left","full-width"])])],4)}}}),_sfc_main$i=defineComponent({__name:"Events",setup:function(__props){var timelineStore=useTimelineStore(),nodeStore=useNodeStore();computed(function(){var nodeArray=nodeStore.nodeArray;return nodeArray.length?"".concat(30*nodeArray.length+500,"px"):"100%"});var props=function(path,eventy){return{eventy:eventy,path:path.join(","),numChildren:nodeStore.childrenMap.get(path.join(",")),numAbove:nodeStore.predecessorMap.get(path.join(","))||0}},currentWidth=computed(function(){return timelineStore.ganttSidebarTempWidth?timelineStore.ganttSidebarTempWidth:timelineStore.ganttSidebarWidth});return computed(function(){return 7*timelineStore.pageSettings.viewport.width}),function(_ctx,_cache){return openBlock(),createElementBlock(Fragment,null,["gantt"===unref(timelineStore).mode?(openBlock(),createElementBlock("div",{key:0,class:"sticky left-0 relative flex flex-col bg-white dark:bg-zinc-800 top-0 bottom-0 z-[2] h-full",style:normalizeStyle("width: ".concat(currentWidth.value,"px;"))},null,4)):createCommentVNode("",!0),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(nodeStore).visibleNodes[1],function(_ref){var path=_ref.path,eventy=_ref.eventy;return openBlock(),createBlock(_sfc_main$j,mergeProps({key:unref(nodeStore).sectionKeys.get(path.join(",")),ref_for:!0},props(path,eventy)),null,16)}),128)),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(nodeStore).visibleNodes[0],function(_ref2){var path=_ref2.path,eventy=_ref2.eventy,key=_ref2.key;return openBlock(),createBlock(_sfc_main$q,mergeProps({key:key,ref_for:!0},props(path,eventy)),null,16)}),128)),createVNode(_sfc_main$y),createVNode(_sfc_main$p)],64)}}});function limit(delta,max_delta){return Math.sign(delta)*Math.min(max_delta,Math.abs(delta))}function zoomer(container,opts){function noop2(){}var timer,options=opts||{},startGesture=options.startGesture||noop2,doGesture=options.doGesture||noop2,endGesture=options.endGesture||noop2,wheel_gesture=null;function end(){wheel_gesture&&(endGesture(wheel_gesture),wheel_gesture=null)}if(container.addEventListener("wheel",function(e){if(wheel_gesture||e.ctrlKey){!1!==e.cancelable&&e.preventDefault();var _normalizeWheel=function(e){var dx=e.deltaX,dy=e.deltaY;if(e.shiftKey&&0===dx){var _ref=[dy,dx];dx=_ref[0],dy=_ref[1]}return e.deltaMode===WheelEvent.DOM_DELTA_LINE?(dx*=8,dy*=8):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(dx*=24,dy*=24),[limit(dx,24),limit(dy,24)]}(e),_normalizeWheel2=_slicedToArray(_normalizeWheel,2),dx=_normalizeWheel2[0],dy=_normalizeWheel2[1];if(wheel_gesture||(wheel_gesture={origin:{x:e.clientX,y:e.clientY},scale:1,translation:{x:0,y:0}},startGesture(wheel_gesture)),e.ctrlKey){var factor=dy<=0?1-2*dy/100:1/(1+2*dy/100);wheel_gesture={origin:{x:e.clientX,y:e.clientY},scale:wheel_gesture.scale*factor,translation:wheel_gesture.translation}}else wheel_gesture={origin:{x:e.clientX,y:e.clientY},scale:wheel_gesture.scale,translation:{x:wheel_gesture.translation.x-2*dx,y:wheel_gesture.translation.y-2*dy}};doGesture(wheel_gesture),timer&&window.clearTimeout(timer),timer=window.setTimeout(end,200)}},{passive:!1}),"undefined"!=typeof GestureEvent&&"undefined"==typeof TouchEvent){var in_gesture=!1;container.addEventListener("gesturestart",function(e){in_gesture||(startGesture({translation:{x:0,y:0},scale:e.scale,rotation:e.rotation,origin:{x:e.clientX,y:e.clientY}}),in_gesture=!0),!1!==e.cancelable&&e.preventDefault()},{passive:!1}),container.addEventListener("gesturechange",function(e){in_gesture&&doGesture({translation:{x:0,y:0},scale:e.scale,rotation:e.rotation,origin:{x:e.clientX,y:e.clientY}}),!1!==e.cancelable&&e.preventDefault()},{passive:!1}),container.addEventListener("gestureend",function(e){in_gesture&&(endGesture({translation:{x:0,y:0},scale:e.scale,rotation:e.rotation,origin:{x:e.clientX,y:e.clientY}}),in_gesture=!1)})}return end}function tryOnScopeDispose(fn){return!!getCurrentScope()&&(onScopeDispose(fn),!0)}function toValue(r){return"function"==typeof r?r():unref(r)}const isClient="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const noop=()=>{};function createFilterWrapper(filter,fn){return function(...args){return new Promise((resolve,reject)=>{Promise.resolve(filter(()=>fn.apply(this,args),{fn:fn,thisArg:this,args:args})).then(resolve).catch(reject)})}}function useDebounceFn(fn,ms=200,options={}){return createFilterWrapper(function(ms,options={}){let timer,maxTimer,lastRejector=noop;const _clearTimeout=timer2=>{clearTimeout(timer2),lastRejector(),lastRejector=noop};return invoke2=>{const duration=toValue(ms),maxDuration=toValue(options.maxWait);return timer&&_clearTimeout(timer),duration<=0||void 0!==maxDuration&&maxDuration<=0?(maxTimer&&(_clearTimeout(maxTimer),maxTimer=null),Promise.resolve(invoke2())):new Promise((resolve,reject)=>{lastRejector=options.rejectOnCancel?reject:resolve,maxDuration&&!maxTimer&&(maxTimer=setTimeout(()=>{timer&&_clearTimeout(timer),maxTimer=null,resolve(invoke2())},maxDuration)),timer=setTimeout(()=>{maxTimer&&_clearTimeout(maxTimer),maxTimer=null,resolve(invoke2())},duration)})}}(ms,options),fn)}function useThrottleFn(fn,ms=200,trailing=!1,leading=!0,rejectOnCancel=!1){return createFilterWrapper(function(...args){let timer,lastValue,ms,trailing,leading,rejectOnCancel,lastExec=0,isLeading=!0,lastRejector=noop;isRef(args[0])||"object"!=typeof args[0]?[ms,trailing=!0,leading=!0,rejectOnCancel=!1]=args:({delay:ms,trailing:trailing=!0,leading:leading=!0,rejectOnCancel:rejectOnCancel=!1}=args[0]);const clear2=()=>{timer&&(clearTimeout(timer),timer=void 0,lastRejector(),lastRejector=noop)};return _invoke=>{const duration=toValue(ms),elapsed=Date.now()-lastExec,invoke2=()=>lastValue=_invoke();return clear2(),duration<=0?(lastExec=Date.now(),invoke2()):(elapsed>duration&&(leading||!isLeading)?(lastExec=Date.now(),invoke2()):trailing&&(lastValue=new Promise((resolve,reject)=>{lastRejector=rejectOnCancel?reject:resolve,timer=setTimeout(()=>{lastExec=Date.now(),isLeading=!0,resolve(invoke2()),clear2()},Math.max(0,duration-elapsed))})),leading||timer||(timer=setTimeout(()=>isLeading=!0,duration)),isLeading=!1,lastValue)}}(ms,trailing,leading,rejectOnCancel),fn)}function unrefElement(elRef){var _a2;const plain=toValue(elRef);return null!=(_a2=null==plain?void 0:plain.$el)?_a2:plain}const defaultWindow=isClient?window:void 0;function useSupported(callback){const isMounted=function(){const isMounted=ref(!1),instance=getCurrentInstance();return instance&&onMounted(()=>{isMounted.value=!0},instance),isMounted}();return computed(()=>(isMounted.value,Boolean(callback())))}function useMediaQuery(query,options={}){const{window:window2=defaultWindow}=options,isSupported=useSupported(()=>window2&&"matchMedia"in window2&&"function"==typeof window2.matchMedia);let mediaQuery;const matches=ref(!1),handler=event=>{matches.value=event.matches},cleanup=()=>{mediaQuery&&("removeEventListener"in mediaQuery?mediaQuery.removeEventListener("change",handler):mediaQuery.removeListener(handler))},stopWatch=watchEffect(()=>{isSupported.value&&(cleanup(),mediaQuery=window2.matchMedia(toValue(query)),"addEventListener"in mediaQuery?mediaQuery.addEventListener("change",handler):mediaQuery.addListener(handler),matches.value=mediaQuery.matches)});return tryOnScopeDispose(()=>{stopWatch(),cleanup(),mediaQuery=void 0}),matches}var Hammer=(void 0)("@squadette/hammerjs"),useGestures=function(el){var pinchStartScrollTop,pinchStartScrollLeft,pinchStartCenterX,pinchStartCenterY,mc,onSetScale=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},timelineStore=useTimelineStore(),endGesture=function(){},isZooming=ref(!1),startingZoom=null,panStartX=ref(),panStartY=void 0,panStartScrollLeft=void 0,panStartScrollTop=void 0,canPan=useCanPanStore(),isPanning=computed(function(){return void 0!==panStartX.value}),pinchEnd=function(e){e.preventDefault(),isZooming.value=!1,startingZoom=null,pinchStartScrollLeft=null,pinchStartScrollTop=null,pinchStartCenterX=null,pinchStartCenterY=null},gestures={startGesture:function(wg){if(isZooming.value=!0,!startingZoom){startingZoom=timelineStore.pageScale,pinchStartScrollTop=el.value.scrollTop,pinchStartScrollLeft=el.value.scrollLeft,pinchStartCenterX=wg.origin.x-(el.value.offsetLeft+timelineStore.leftInsetWidth),pinchStartCenterY=wg.origin.y;var newReferenceDate=timelineStore.dateFromClientLeft(wg.origin.x),d=timelineStore.distanceBetweenDates(newReferenceDate,timelineStore.referenceDate);timelineStore.referenceDate=newReferenceDate,el.value.scrollLeft=el.value.scrollLeft+d}},doGesture:function(wg){var scale=startingZoom*wg.scale;if(!(scale>3e7)){if(isZooming.value=!0,timelineStore.setPageScale(scale)){var newScrollTop=pinchStartScrollTop+pinchStartCenterY-wg.origin.y;el.value.scrollTop=newScrollTop,onSetScale()}startingZoom=null,pinchStartScrollLeft=null,pinchStartScrollTop=null,pinchStartCenterX=null,pinchStartCenterY=null,isZooming.value=!1,endGesture()}}},touchStart=function(e){e.touches.length>=2&&(mc.get("pinch").set({enable:!0}),e.preventDefault())},touchEnd=function(e){e.touches.length<=2&&mc.get("pinch").set({enable:!1})},panStart=function(e){canPan.canPan&&void 0===panStartX.value&&(e.preventDefault(),panStartScrollLeft=el.value.scrollLeft,panStartScrollTop=el.value.scrollTop,panStartX.value=e.srcEvent.clientX,panStartY=e.srcEvent.clientY)},pan=function(e){e.maxPointers>=2||canPan.canPan&&panStartX.value&&!e.isFinal&&(el.value.scrollLeft=panStartScrollLeft+panStartX.value-e.srcEvent.clientX,el.value.scrollTop=panStartScrollTop+panStartY-e.srcEvent.clientY)},panEnd=function(e){panStartX.value=void 0,panStartY=void 0,panStartScrollLeft=void 0,panStartScrollTop=void 0},setupHammer=function(){(mc=new Hammer.Manager(el.value,{recognizers:[[Hammer.Pinch,{enable:!0,touchAction:"pan-x pan-y"}],[Hammer.Pan,{enable:!0}]]})).on("pinch",useThrottleFn(function(e){return function(e){if(e.preventDefault(),el.value.offsetLeft,el.value.scrollLeft,startingZoom){var newScrollTop=pinchStartScrollTop+pinchStartCenterY-e.center.y,scale=e.scale;if(startingZoom*scale>3e7&&(scale=1),1!==scale&&timelineStore.setPageScale(startingZoom*e.scale)){var newScrollLeft=pinchStartScrollLeft+pinchStartCenterX-e.center.x;el.value.scrollLeft=newScrollLeft,el.value.scrollTop=newScrollTop,onSetScale()}}else{isZooming.value=!0,startingZoom=timelineStore.pageScale,pinchStartScrollTop=el.value.scrollTop,pinchStartScrollLeft=el.value.scrollLeft,pinchStartCenterX=e.center.x,pinchStartCenterY=e.center.y;var newReferenceDate=timelineStore.dateFromClientLeft(pinchStartCenterX),d=timelineStore.distanceBetweenDates(newReferenceDate,timelineStore.referenceDate);timelineStore.referenceDate=newReferenceDate,pinchStartScrollLeft=el.value.scrollLeft+d,el.value.scrollLeft=pinchStartScrollLeft}}(e)},20,!1,!0)),mc.on("pinchend",pinchEnd),mc.on("panstart",panStart),mc.on("pan",pan),mc.on("panend",panEnd)};return onMounted(function(){endGesture=zoomer(el.value,gestures),setupHammer()}),onUnmounted(function(){var _el$value,_el$value2;null===(_el$value=el.value)||void 0===_el$value||_el$value.removeEventListener("touchstart",touchStart),null===(_el$value2=el.value)||void 0===_el$value2||_el$value2.removeEventListener("touchend",touchEnd)}),{isZooming:isZooming,isPanning:isPanning}},_hoisted_1$7=["d","fill","stroke","stroke-width"],_hoisted_2$5=["x","y"],_hoisted_3$2={key:0,class:"svgDateText"},_hoisted_4$1={key:1,class:"svgEventTitle"};const _sfc_main$h=defineComponent({__name:"EventRowSvg",props:{eventy:{},path:{},numChildren:{},numAbove:{},totalHeight:{},totalWidth:{},height:{},earliestTime:{},latestTime:{},heightUnit:{},dark:{type:Boolean},scale:{},showDateText:{type:Boolean},showEventTitles:{type:Boolean},rowHeight:{},roundedLeft:{type:Boolean},roundedRight:{type:Boolean}},setup:function(__props,_ref){var __expose=_ref.expose,props=__props,dist=useTimelineStore().scalelessDistanceBetweenDates,_useEventRefs=useEventRefs(computed(function(){return props.eventy})),color=_useEventRefs.color,eventRange2=_useEventRefs.eventRange,dateText=_useEventRefs.dateText,range2=computed(function(){return toDateRange(eventRange2.value)}),recurrence=computed(function(){return props.eventy.recurrence}),expandedRecurrence=computed(function(){return(recurrence.value?expand(range2.value,recurrence.value,100):[range2.value]).map(function(dr){return dist(props.earliestTime,dr.fromDateTime)*props.scale})}),width=computed(function(){return dist(range2.value.fromDateTime,range2.value.toDateTime)*props.scale}),bottom=computed(function(){return props.height/props.totalHeight*props.totalWidth}),top=computed(function(){return bottom.value+props.totalWidth/props.totalHeight}),barBottomY=computed(function(){return top.value-props.heightUnit/(4*props.rowHeight/3)}),barTopY=computed(function(){return bottom.value+props.heightUnit/(4*props.rowHeight/3)}),d=function(left){var arcRadius=(barBottomY.value-barTopY.value)/2,rightLineCap=props.roundedRight?"A ".concat(arcRadius," ").concat(arcRadius," 0 0 0"):"L",leftLineCap=props.roundedLeft?"A ".concat(arcRadius," ").concat(arcRadius," 0 0 0"):"L";return"M ".concat(left+width.value," ").concat(barBottomY.value," ").concat(rightLineCap," ").concat(left+width.value," ").concat(barTopY.value," L ").concat(left," ").concat(barTopY.value," ").concat(leftLineCap," ").concat(left," ").concat(barBottomY.value," Z")},barsRightmostX=computed(function(){return expandedRecurrence.value[expandedRecurrence.value.length-1]+width.value}),text=ref(),strokeWidth=computed(function(){return props.heightUnit/10});return __expose({getRightmostX:function(){var _text$value;return barsRightmostX.value+((null===(_text$value=text.value)||void 0===_text$value?void 0:_text$value.getComputedTextLength())||0)}}),function(_ctx,_cache){var _ctx$eventy$firstLine;return openBlock(),createElementBlock(Fragment,null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(expandedRecurrence.value,function(left){return openBlock(),createElementBlock("path",{"fill-rule":"evenodd",d:d(left),fill:"rgba(".concat(unref(color)||(_ctx.dark?"255, 255, 255":"0, 0, 0"),", 0.8)"),stroke:"rgb(".concat(unref(color)||(_ctx.dark?"255, 255, 255":"0, 0, 0"),")"),"stroke-width":strokeWidth.value},null,8,_hoisted_1$7)}),256)),createBaseVNode("text",{x:barsRightmostX.value,y:barBottomY.value,ref_key:"text",ref:text},[_cache[0]||(_cache[0]=createBaseVNode("tspan",{class:"svgDateText"},"  ",-1)),_ctx.showDateText?(openBlock(),createElementBlock("tspan",_hoisted_3$2,"  "+toDisplayString(unref(dateText)),1)):createCommentVNode("",!0),_ctx.showEventTitles?(openBlock(),createElementBlock("tspan",_hoisted_4$1,"  "+toDisplayString(null===(_ctx$eventy$firstLine=_ctx.eventy.firstLine)||void 0===_ctx$eventy$firstLine?void 0:_ctx$eventy$firstLine.restTrimmed),1)):createCommentVNode("",!0)],8,_hoisted_2$5)],64)}}});var _hoisted_1$6=["stroke","stroke-dasharray","stroke-width","d"],_hoisted_2$4=["x","y"];const _sfc_main$g=defineComponent({__name:"MarkersSvg",props:{showMarkers:{},earliestTime:{},latestTime:{},scale:{},totalWidth:{},heightUnit:{},startY:{},dark:{type:Boolean}},setup:function(__props){var props=__props,dist=useTimelineStore().scalelessDistanceBetweenDates,x=function(dt){return dist(props.earliestTime,dt)*props.scale},mostGranular=computed(function(){return props.showMarkers&&["minute","quarterhour","hour","day","month","year","decade"].find(function(marker){var _props$showMarkers$ma,_props$showMarkers$ma2;return!!props.showMarkers[marker]&&((null===(_props$showMarkers$ma=props.showMarkers[marker])||void 0===_props$showMarkers$ma?void 0:_props$showMarkers$ma.label)||(null===(_props$showMarkers$ma2=props.showMarkers[marker])||void 0===_props$showMarkers$ma2?void 0:_props$showMarkers$ma2.marker))})}),markers=computed(function(){if(mostGranular.value){for(var earliestTime=floorDateTime(props.earliestTime,mostGranular.value),latestTime=ceilDateTime(props.latestTime,mostGranular.value),marker=earliestTime,range2=[marker];+marker<+latestTime&&range2.length<256;){var amountToAdd=_defineProperty({},mostGranular.value,1);"decade"===mostGranular.value?amountToAdd={years:10}:"quarterhour"===mostGranular.value&&(amountToAdd={minutes:15}),marker=marker.plus(amountToAdd),range2.push(marker)}return range2}}),bottomY=computed(function(){return props.totalWidth+4*props.heightUnit});return function(_ctx,_cache){return openBlock(!0),createElementBlock(Fragment,null,renderList(markers.value,function(marker){return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("path",{stroke:"rgba(".concat(_ctx.dark?"200, 200, 200":"100, 100, 100",", 0.15)"),"stroke-dasharray":"".concat(_ctx.heightUnit/5,",").concat(_ctx.heightUnit/10),"stroke-width":_ctx.heightUnit/10,d:"M ".concat(x(marker)," ").concat(_ctx.startY," L ").concat(x(marker)," ").concat(bottomY.value)},null,8,_hoisted_1$6),createBaseVNode("text",{class:"svgMarkerText",x:x(marker)+_ctx.heightUnit/4,y:1.5*_ctx.startY+_ctx.heightUnit/4},toDisplayString((dt=marker,granularities[(showMarker=mostGranular.value,["minute","quarterhour","hour","day","month","year","decade"].indexOf(showMarker)+2)][dateScale(dt)](dt))),9,_hoisted_2$4)],64);var dt,showMarker}),256)}}});var _hoisted_1$5=["viewBox"],_hoisted_2$3=["x","width","height","fill"];const _sfc_main$f=defineComponent({__name:"SvgView",props:{diffScale:{},dark:{type:Boolean},bg:{},showViewport:{type:Boolean},scale:{},showDateText:{type:Boolean},showEventTitles:{type:Boolean},rowHeight:{},roundedRight:{type:Boolean},roundedLeft:{type:Boolean},showMarkers:{},eras:{}},setup:function(__props,_ref){var __expose=_ref.expose,nodeStore=useNodeStore(),collapseStore=useCollapseStore(),dist=function(a,b){var diffScale2=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hours";return b.diff(a).as(diffScale2)},ourProps=__props,computedEras=computed(function(){return(ourProps.eras||[]).map(function(era){return{left:"left"in era?era.left:dist(earliestTime.value,era.dateRange.fromDateTime),width:"width"in era?era.width:dist(era.dateRange.fromDateTime,era.dateRange.toDateTime)}})}),scale=computed(function(){return ourProps.scale||1}),totalRange=computed(function(){return _ranges(nodeStore.nodes,100)||{fromDateTime:DateTime$1.now(),toDateTime:DateTime$1.now()}}),totalWidth=computed(function(){return dist(totalRange.value.fromDateTime,totalRange.value.toDateTime)}),viewBoxWidth=ref(totalWidth.value),heightUnit=computed(function(){return totalWidth.value/nodeStore.height}),earliestTime=computed(function(){return totalRange.value.fromDateTime}),latestTime=computed(function(){return totalRange.value.toDateTime}),props=function(path,eventy){return{eventy:eventy,path:path.join(","),numChildren:nodeStore.childrenMap.get(path.join(","))||0,numAbove:nodeStore.predecessorMap.get(path.join(","))||0,totalHeight:nodeStore.height,totalWidth:totalWidth.value,height:nodeStore.predecessorMap.get(path.join(","))+1,heightUnit:heightUnit.value,earliestTime:earliestTime.value,latestTime:latestTime.value,dark:ourProps.dark,scale:scale.value,showDateText:ourProps.showDateText,showEventTitles:ourProps.showEventTitles,rowHeight:ourProps.rowHeight,roundedLeft:ourProps.roundedLeft,roundedRight:ourProps.roundedRight}},rows=ref(),getRightmostX=function(){if(!rows.value)return 0;for(var max=0,i=0;i<rows.value.length;i++){var rowMaxX=rows.value[i].getRightmostX();rowMaxX>max&&(max=rowMaxX)}return max};__expose({getRightmostX:getRightmostX});var setWidth=function(){viewBoxWidth.value=getRightmostX()+2*heightUnit.value};watch(ourProps,function(p2){nextTick(function(){return setWidth()})});var textFontSize=computed(function(){return heightUnit.value/1.5*ourProps.rowHeight/3}),startX=computed(function(){return-heightUnit.value}),startY=computed(function(){return heightUnit.value});return onMounted(function(){return setWidth()}),function(_ctx,_cache){return openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"".concat(startX.value," ").concat(startY.value," ").concat(viewBoxWidth.value," ").concat((_ctx.rowHeight+2)*unref(nodeStore).height),fill:"currentColor",preserveAspectRatio:"xMinYMin meet",class:"w-full h-full"},[createBaseVNode("svg:style",null," .svgDateText { font: bold "+toDisplayString(textFontSize.value)+"px system-ui; fill: #93979a; } .svgEventTitle { font: normal "+toDisplayString(textFontSize.value)+"px system-ui; fill: "+toDisplayString(_ctx.dark?"white":"black")+"; } .svgMarkerText { font: normal "+toDisplayString(textFontSize.value)+"px system-ui; fill: #93979a; } ",1),createVNode(_sfc_main$g,{showMarkers:_ctx.showMarkers,earliestTime:earliestTime.value,latestTime:latestTime.value,scale:scale.value,totalWidth:totalWidth.value,heightUnit:heightUnit.value,startY:startY.value,dark:_ctx.dark},null,8,["showMarkers","earliestTime","latestTime","scale","totalWidth","heightUnit","startY","dark"]),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(nodeStore).nodeArray,function(_ref2,index2){var _eventy$firstLine,path=_ref2.path,eventy=_ref2.eventy;return openBlock(),createElementBlock(Fragment,null,[unref(isEvent)(eventy)&&!unref(collapseStore).isCollapsedChild(path)?(openBlock(),createBlock(_sfc_main$h,mergeProps({ref_for:!0,ref_key:"rows",ref:rows,key:path.join(",")+(null===(_eventy$firstLine=eventy.firstLine)||void 0===_eventy$firstLine?void 0:_eventy$firstLine.datePart)},props(path,eventy)),null,16)):createCommentVNode("",!0)],64)}),256)),(openBlock(!0),createElementBlock(Fragment,null,renderList(computedEras.value,function(era){return openBlock(),createElementBlock("rect",{x:era.left,y:0,width:era.width,height:heightUnit.value*(unref(nodeStore).height+4),fill:"rgba(".concat(_ctx.dark?"255, 255, 255":"0, 0, 0",", 0.1)")},null,8,_hoisted_2$3)}),256))],8,_hoisted_1$5)}}});var _hoisted_1$4={key:0,class:"hintRight absolute -right-2 top-0 bottom-0 whitespace-nowrap flex items-center justify-center ml-2 bg-indigo-600 shadow-lg rounded px-2 font-bold text-white pointer-events-none",style:{transform:"translateX(100%)"}},_hoisted_2$2={class:"z-10"},_hoisted_3$1={class:"z-10"};const HoverHint=_export_sfc(defineComponent({__name:"HoverHint",props:{hovering:{type:Boolean},shortcut:{},hoverPosition:{default:"right"},left:{default:0}},setup:function(__props){return function(_ctx,_cache){return openBlock(),createBlock(Transition,null,{default:withCtx(function(){return[_ctx.hovering&&"right"===_ctx.hoverPosition?(openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("div",_hoisted_2$2,[_ctx.$slots.default?renderSlot(_ctx.$slots,"default",{key:0},void 0,!0):createCommentVNode("",!0)]),_cache[0]||(_cache[0]=createBaseVNode("div",{class:"absolute top-0 bottom-0 -left-[2px] rotate-45 bg-indigo-600 h-1/2 aspect-square translate-y-2/4 rounded shadow-sm"},null,-1))])):_ctx.hovering&&"top"===_ctx.hoverPosition?(openBlock(),createElementBlock("div",{key:1,class:"hintTop absolute -top-1 whitespace-nowrap flex items-center justify-center mb-2 bg-indigo-600 shadow-lg rounded px-2 font-bold text-white pointer-events-none",style:normalizeStyle({transform:"translateY(-100%)",left:"".concat(_ctx.left?_ctx.left:2,"px")})},[createBaseVNode("div",_hoisted_3$1,[_ctx.$slots.default?renderSlot(_ctx.$slots,"default",{key:0},void 0,!0):createCommentVNode("",!0)]),_cache[1]||(_cache[1]=createBaseVNode("div",{class:"absolute left-0 -bottom-[2px] rotate-45 bg-indigo-600 h-1/2 aspect-square translate-x-2/4 rounded shadow-sm"},null,-1))],4)):createCommentVNode("",!0)]}),_:3})}}}),[["__scopeId","data-v-dd7c9a39"]]);var _hoisted_1$3={key:1};const _sfc_main$d=defineComponent({__name:"SettingsButton",props:{hoverHintTitle:{},hoverHintShortcut:{},selected:{type:Boolean},hoverHintLeft:{}},emits:["click"],setup:function(__props,_ref){var emit2=_ref.emit,hovering=ref(!1),events={isTouchscreen:useMediaQuery("(pointer: course)"),canHover:useMediaQuery("(hover)")}.canHover.value?{mouseover:function(){hovering.value=!0},mouseleave:function(){hovering.value=!1}}:{},click=function(){hovering.value=!1,emit2("click")};return function(_ctx,_cache){return openBlock(),createElementBlock("button",mergeProps({onClick:click,class:"p-1 flex flex-row items-center hover:bg-zinc-200 transition dark:border-gray-900 dark:hover:bg-zinc-600 dark:hover:text-gray-100 text-sm lg:text-base font-bold relative shrink-0"},toHandlers(unref(events)),{onMousedown:_cache[0]||(_cache[0]=withModifiers(function(){},["stop"])),onTouchstart:_cache[1]||(_cache[1]=withModifiers(function(){},["stop"])),class:{"text-indigo-600 outline-2 outline outline-indigo-600 dark:text-indigo-400 dark:outline-indigo-400":_ctx.selected}}),[renderSlot(_ctx.$slots,"default"),createVNode(HoverHint,{"hover-position":"top",hovering:hovering.value,shortcut:_ctx.hoverHintShortcut,left:_ctx.hoverHintLeft},{default:withCtx(function(){return[_ctx.$slots.hoverHint?renderSlot(_ctx.$slots,"hoverHint",{key:0}):(openBlock(),createElementBlock("span",_hoisted_1$3,toDisplayString(_ctx.hoverHintTitle),1))]}),_:3},8,["hovering","shortcut","left"])],16)}}});var _hoisted_1$2={class:"flex-col hidden lg:flex items-center justify-center flex-shrink px-1"},_hoisted_2$1=["value"];const TimelineScale=_export_sfc(defineComponent({__name:"TimelineScale",setup:function(__props){var timelineStore=useTimelineStore();function calculateScaledPosition(width2){var minWidth=Math.log(.002),scale=(Math.log(3e7)-minWidth)/1e3;return(Math.log(width2)-minWidth)/scale+0}var width=ref(calculateScaledPosition(timelineStore.pageScale));watch(function(){return timelineStore.pageSettings.scale},function(scale){return width.value=calculateScaledPosition(scale)});var inTimer,outTimer,changed=function(e){var w,value=parseInt(e.target.value),minWidth=Math.log(.002),scale=(Math.log(3e7)-minWidth)/1e3,newScale=Math.exp(minWidth+scale*(value-0));w=newScale,timelineStore.setPageScale(w)},startYearWidthChange=function(){return timelineStore.setStartedWidthChange(!0)},endYearWidthChange=function(){return timelineStore.setStartedWidthChange(!1)},zoomingIn=ref(!1),zoomingOut=ref(!1);watch(zoomingIn,function(zooming){if(zooming){timelineStore.setStartedWidthChange(!0);var _zoomIn=function(){nextTick(function(){timelineStore.setPageScale(1.05*timelineStore.pageScale)}),inTimer=setTimeout(_zoomIn,10)};_zoomIn()}else clearTimeout(inTimer),timelineStore.setStartedWidthChange(!1)}),watch(zoomingOut,function(out){if(out){timelineStore.setStartedWidthChange(!0);var _zoomOut=function(){nextTick(function(){timelineStore.setPageScale(.95*timelineStore.pageScale)}),outTimer=setTimeout(_zoomOut,10)};_zoomOut()}else clearTimeout(outTimer),timelineStore.setStartedWidthChange(!1)});var mouseDownOut=function(e){zoomingOut.value=!0,zoomingIn.value=!1},mouseUpOut=function(e){zoomingOut.value=!1,zoomingIn.value=!1},mouseDownIn=function(e){zoomingIn.value=!0,zoomingOut.value=!1},mouseUpIn=function(e){zoomingOut.value=!1,zoomingIn.value=!1};return function(_ctx,_cache){return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$d,{onMousedown:withModifiers(mouseDownOut,["stop"]),onTouchstart:withModifiers(mouseDownOut,["stop"]),onMouseup:mouseUpOut,onTouchend:mouseUpOut,onMouseout:mouseUpOut,onMouseleave:mouseUpOut,"hover-hint-title":"Zoom out"},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-4 h-4","stroke-width":"1",stroke:"currentColor"},[createBaseVNode("path",{"fill-rule":"evenodd",d:"M3 10a.75.75 0 01.75-.75h10.5a.75.75 0 010 1.5H3.75A.75.75 0 013 10z","clip-rule":"evenodd"})],-1)])}),_:1}),createVNode(_sfc_main$d,{onMousedown:withModifiers(mouseDownIn,["stop"]),onTouchstart:withModifiers(mouseDownIn,["stop"]),onMouseup:mouseUpIn,onTouchend:mouseUpIn,onMouseout:mouseUpIn,onMouseleave:mouseUpIn,"hover-hint-title":"Zoom in"},{default:withCtx(function(){return _cache[1]||(_cache[1]=[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-4 h-4","stroke-width":"1",stroke:"currentColor"},[createBaseVNode("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1)])}),_:1}),createBaseVNode("div",_hoisted_1$2,[createBaseVNode("input",{type:"range",min:"0",max:"800",style:{width:"5rem",height:"1.125rem"},value:width.value,onInput:changed,class:"bg-transparent flex-shrink",onMousedown:withModifiers(startYearWidthChange,["stop"]),onMouseup:withModifiers(endYearWidthChange,["stop"]),onTouchstart:withModifiers(startYearWidthChange,["stop"]),"on:touchEnd":withModifiers(endYearWidthChange,["stop"])},null,40,_hoisted_2$1)])],64)}}}),[["__scopeId","data-v-8aa586c7"]]),_sfc_main$b=defineComponent({__name:"AutoCenter",setup:function(__props){var autoCenter=useTimelineStore().autoCenter;return function(_ctx,_cache){return openBlock(),createBlock(_sfc_main$d,{onClick:unref(autoCenter),"hover-hint-title":"Center"},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",width:"40",height:"40",viewBox:"0 0 24 24",stroke:"currentColor",fill:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1"},[createBaseVNode("path",{d:"m 3 5 v 3 c 0 0.55 0.45 1 1 1 s 1 -0.45 1 -1 v -2 c 0 -0.55 0.45 -1 1 -1 h 2 c 0.55 0 1 -0.45 1 -1 s -0.45 -1 -1 -1 h -3 c -1.1 0 -2 0.9 -2 2 z m 1 10 c -0.55 0 -1 0.45 -1 1 v 3 c 0 1.1 0.9 2 2 2 h 3 c 0.55 0 1 -0.45 1 -1 s -0.45 -1 -1 -1 h -2 c -0.55 0 -1 -0.45 -1 -1 v -2 c 0 -0.55 -0.45 -1 -1 -1 z m 15 3 c 0 0.55 -0.45 1 -1 1 h -2 c -0.55 0 -1 0.45 -1 1 s 0.45 1 1 1 h 3 c 1.1 0 2 -0.9 2 -2 v -3 c 0 -0.55 -0.45 -1 -1 -1 s -1 0.45 -1 1 v 2 z m 0 -15 h -3 c -0.55 0 -1 0.45 -1 1 s 0.45 1 1 1 h 2 c 0.55 0 1 0.45 1 1 v 2 c 0 0.55 0.45 1 1 1 s 1 -0.45 1 -1 v -3 c 0 -1.1 -0.9 -2 -2 -2 z"}),createBaseVNode("rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",fill:"currentColor"})],-1)])}),_:1},8,["onClick"])}}}),_sfc_main$a=defineComponent({__name:"CollapseAll",setup:function(__props){var collapseStore=useCollapseStore(),click=function(){return collapseStore.collapseAll()};return function(_ctx,_cache){return openBlock(),createBlock(_sfc_main$d,{"hover-hint-title":"Collapse all",onClick:click},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{class:"h-4 w-4",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24",fill:"currentColor","stroke-width":"1",stroke:"currentColor"},[createBaseVNode("path",{d:"M8.12 19.3c.39.39 1.02.39 1.41 0L12 16.83l2.47 2.47c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41l-3.17-3.17a.9959.9959 0 0 0-1.41 0l-3.17 3.17c-.4.38-.4 1.02-.01 1.41zm7.76-14.6a.9959.9959 0 0 0-1.41 0L12 7.17 9.53 4.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.03 0 1.42l3.17 3.17c.39.39 1.02.39 1.41 0l3.17-3.17c.4-.39.4-1.03.01-1.42z"})],-1)])}),_:1})}}}),_sfc_main$9=defineComponent({__name:"ExpandAll",setup:function(__props){var collapseStore=useCollapseStore(),click=function(){return collapseStore.expandAll()};return function(_ctx,_cache){return openBlock(),createBlock(_sfc_main$d,{"hover-hint-title":"Expand all",onClick:click},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{class:"h-4 w-4",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor","stroke-width":"1"},[createBaseVNode("path",{d:"m12 5.83 2.46 2.46c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 3.7a.9959.9959 0 0 0-1.41 0L8.12 6.88c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 5.83zm0 12.34-2.46-2.46a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l3.17 3.18c.39.39 1.02.39 1.41 0l3.17-3.17c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L12 18.17z"})],-1)])}),_:1})}}}),_sfc_main$8=defineComponent({__name:"ToggleMode",setup:function(__props){var timelineStore=useTimelineStore(),toggle=function(){timelineStore.mode="gantt"===timelineStore.mode?"timeline":"gantt"};return function(_ctx,_cache){return openBlock(),createBlock(_sfc_main$d,{"hover-hint-title":"Gantt",onClick:toggle,selected:"gantt"===unref(timelineStore).mode},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",class:"h-4 w-4"},[createBaseVNode("path",{fill:"currentColor",d:"m 14 13 h -3 c -0.55 0 -1 -0.45 -1 -1 s 0.45 -1 1 -1 h 3 c 0.55 0 1 0.45 1 1 s -0.45 1 -1 1 z m 0 -4 h -5 c -0.55 0 -1 -0.45 -1 -1 s 0.45 -1 1 -1 h 5 c 0.55 0 1 0.45 1 1 s -0.45 1 -1 1 z m -6 -4 h -1 c -0.55 0 -1 -0.45 -1 -1 s 0.45 -1 1 -1 h 2 c 0.55 0 1 0.45 1 1 s -0.45 1 -1 1 z M 2 4 L 2 12.5 A 1 1 0 0 0 3 13.5 L 3.5 13.5 A 1 1 0 0 0 4.5 12.5 L 4.5 3.5 A 1 1 0 0 0 3.5 2.5 L 3 2.5 A 1 1 0 0 0 2 3.5 Z"})],-1)])}),_:1},8,["selected"])}}}),_sfc_main$7=defineComponent({__name:"ToggleNowLine",setup:function(__props){var timelineStore=useTimelineStore(),toggleHideNowLine=function(){timelineStore.setHideNowLine(!timelineStore.hideNowLine)};return function(_ctx,_cache){return openBlock(),createBlock(_sfc_main$d,{title:"Toggle now line",hoverHintTitle:"Toggle now line",onClick:toggleHideNowLine},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 2 17 12",class:"h-4 w-4"},[createBaseVNode("path",{d:"m 2 3 a 1 1 0 0 0 0 2 h 11 a 1 1 0 1 0 0 -2 h -11 z m 1 4 a 1 1 0 0 0 0 2 h 11 a 1 1 0 0 0 0 -2 h -11 z m 1 4 a 1 1 0 1 0 0 2 h 11 a 1 1 0 1 0 0 -2 h -11 z",fill:"currentColor"}),createBaseVNode("path",{d:"M 9 1 L 9 15 L 11 15 L 11 1 L 11 1 Z",fill:"currentColor"})],-1)])}),_:1})}}}),_sfc_main$6=defineComponent({__name:"ToggleDateTimeDisplay",setup:function(__props){var timelineStore=useTimelineStore(),click=function(){timelineStore.dateTimeDisplay="off"===timelineStore.dateTimeDisplay?"original":"off"};return function(_ctx,_cache){return openBlock(),createBlock(_sfc_main$d,{onClick:click,"hover-hint-title":"Toggle date ranges"},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",width:"40",height:"40",viewBox:"0 0 24 24","stroke-width":"2.5",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[createBaseVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),createBaseVNode("path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0"}),createBaseVNode("path",{d:"M12 7v5l3 3"})],-1)])}),_:1})}}}),_sfc_main$5=defineComponent({__name:"ToggleShowProgress",setup:function(__props){var timelineStore=useTimelineStore(),click=function(){timelineStore.progressDisplay="off"===timelineStore.progressDisplay?"on":"off"};return function(_ctx,_cache){return openBlock(),createBlock(_sfc_main$d,{onClick:click,"hover-hint-title":"Toggle progress indicator"},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",width:"40",height:"40",viewBox:"0 0 24 24","stroke-width":"2.5",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[createBaseVNode("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),createBaseVNode("path",{d:"M9 11l3 3l8 -8"}),createBaseVNode("path",{d:"M20 12v6a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h9"})],-1)])}),_:1})}}});var _hoisted_1$1={class:"text-xs mt-px shrink-0"};const _sfc_main$4=defineComponent({__name:"UserRanges",setup:function(__props){var timelineStore=useTimelineStore();return onMounted(function(){timelineStore.userRanges.length&&timelineStore.setRange(timelineStore.userRanges[0])}),function(_ctx,_cache){return openBlock(!0),createElementBlock(Fragment,null,renderList(unref(timelineStore).userRanges,function(range2){return openBlock(),createBlock(_sfc_main$d,{onClick:function($event){return unref(timelineStore).setRange(range2)}},{default:withCtx(function(){return[createBaseVNode("span",_hoisted_1$1,toDisplayString(range2.title),1)]}),_:2},1032,["onClick"])}),256)}}});var _hoisted_1={class:"flex flex-row-items-center overflow-scroll noScrollBar relative"},_hoisted_2={class:"flex flex-row gap-2 pt-16"},_hoisted_3={class:"dark:bg-zinc-800 bg-white flex flex-row gap-2 px-2"},_hoisted_4={class:"flex flex row overflow-visible p-[2px] pointer-events-auto",style:{"grid-area":"gantt"}},_hoisted_5={class:"flex flex-row pointer-events-auto shrink-0"},_hoisted_6={class:"flex flex row overflow-visible p-[2px] pointer-events-auto"},_hoisted_7={class:"overflow-visible p-[2px] pointer-events-auto flex flex-row"},_hoisted_8={class:"overflow-visible p-[2px] pointer-events-auto flex flex-row"},_hoisted_9={class:"flex flex row overflow-visible p-[2px] pointer-events-auto link"},_hoisted_10={class:"pr-1 font-mono text-xs",style:{"white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden","max-width":"32ch"}},_hoisted_11=["href"];const _sfc_main$3=defineComponent({__name:"Settings",setup:function(__props){var timelineStore=useTimelineStore(),markwhenStore=useMarkwhenStore(),styleLeftInset=computed(function(){var inset=timelineStore.pageSettings.viewport.offsetLeft;return"gantt"===timelineStore.mode?inset+(timelineStore.ganttSidebarTempWidth?timelineStore.ganttSidebarTempWidth:timelineStore.ganttSidebarWidth):inset}),copyToClipboard=function(){var _ref=_asyncToGenerator(_regenerator().m(function _callee(s2,description){var _t;return _regenerator().w(function(_context){for(;;)switch(_context.p=_context.n){case 0:if(navigator.clipboard){_context.n=1;break}return _context.a(2,alert("Clipboard not available :/"));case 1:return _context.p=1,_context.n=2,navigator.clipboard.writeText(s2);case 2:alert("Copied ".concat(description,"to clipboard.")),_context.n=4;break;case 3:_context.p=3,_t=_context.v,console.error(_t),alert("Unable to copy to clipboard:"+_t);case 4:return _context.a(2)}},_callee,null,[[1,3]])}));return function(_x,_x2){return _ref.apply(this,arguments)}}(),copyTimelineLink=function(){var _ref2=_asyncToGenerator(_regenerator().m(function _callee2(){return _regenerator().w(function(_context2){for(;;)if(0===_context2.n)return _context2.a(2,copyToClipboard(markwhenStore.timelineLink,"link "))},_callee2)}));return function(){return _ref2.apply(this,arguments)}}(),copyEmbedLink=function(){var _ref3=_asyncToGenerator(_regenerator().m(function _callee3(){return _regenerator().w(function(_context3){for(;;)if(0===_context3.n)return _context3.a(2,copyToClipboard(markwhenStore.embedLink,"embed code "))},_callee3)}));return function(){return _ref3.apply(this,arguments)}}(),goToNow=function(){return timelineStore.goToNow()};return function(_ctx,_cache){return openBlock(),createElementBlock("div",{class:"fixed hover:text-zinc-700 dark:text-zinc-400 text-zinc-500 dark:hover:text-zinc-300",style:normalizeStyle("left: ".concat(styleLeftInset.value,"px; bottom: 0rem; right: 0;"))},[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createVNode(_sfc_main$8)]),createBaseVNode("div",_hoisted_5,[createVNode(_sfc_main$d,{class:"gap-1",onClick:goToNow},{default:withCtx(function(){return _cache[0]||(_cache[0]=[createBaseVNode("svg",{class:"h-4 w-4",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"ModeStandbyIcon",fill:"currentColor",stroke:"currentColor","stroke-width":"0.4"},[createBaseVNode("path",{d:"M12 2C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3-8c0 1.66-1.34 3-3 3s-3-1.34-3-3 1.34-3 3-3 3 1.34 3 3z"})],-1),createBaseVNode("span",{class:"text-xs mt-px"},"Now",-1)])}),_:1}),createVNode(_sfc_main$4),createVNode(_sfc_main$b)]),createBaseVNode("div",_hoisted_6,[createVNode(TimelineScale)]),createBaseVNode("div",_hoisted_7,[createVNode(_sfc_main$6),createVNode(_sfc_main$5)]),createBaseVNode("div",_hoisted_8,[createVNode(_sfc_main$9),createVNode(_sfc_main$a),createVNode(_sfc_main$7)]),createBaseVNode("div",_hoisted_9,[unref(markwhenStore).showCopyLinkButton?(openBlock(),createBlock(_sfc_main$d,{key:0,"hover-hint-left":-1,onClick:copyTimelineLink},{hoverHint:withCtx(function(){return _cache[1]||(_cache[1]=[createBaseVNode("div",{class:"flex flex-col items-start"},[createBaseVNode("span",null,"Copy view link"),createBaseVNode("span",null,"Timeline text is encoded in link - not uploaded")],-1)])}),default:withCtx(function(){return[_cache[2]||(_cache[2]=createBaseVNode("svg",{class:"w-3 h-3 mr-1","aria-hidden":"true",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor","stroke-width":"1"},[createBaseVNode("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"})],-1)),createBaseVNode("p",_hoisted_10,toDisplayString(unref(markwhenStore).timelineLink.substring(8)),1)]}),_:1})):createCommentVNode("",!0),unref(markwhenStore).showEmbedButton?(openBlock(),createBlock(_sfc_main$d,{key:1,onClick:copyEmbedLink,"hover-hint-left":1,"hover-hint-title":"Copy embed code"},{default:withCtx(function(){return _cache[3]||(_cache[3]=[createBaseVNode("svg",{class:"h-4 w-4",focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"CodeIcon",fill:"currentColor",stroke:"currentColor","stroke-width":"1"},[createBaseVNode("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"})],-1)])}),_:1})):createCommentVNode("",!0),unref(markwhenStore).showEditButton?(openBlock(),createElementBlock("a",{key:2,href:unref(markwhenStore).editorLink,target:"_blank",class:"h-6 flex flex-row items-center rounded hover:bg-zinc-200 transition dark:border-gray-900 dark:hover:bg-gray-900 dark:hover:text-gray-100 px-1 text-sm lg:text-base font-bold relative"},_cache[4]||(_cache[4]=[createBaseVNode("svg",{class:"h-4 w-4 md:mr-1",focusable:"false",viewBox:"0 0 24 24","aria-hidden":"true",fill:"currentColor"},[createBaseVNode("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})],-1),createBaseVNode("span",{class:"hidden md:block"},"Open editor",-1)]),8,_hoisted_11)):createCommentVNode("",!0)])])])])],4)}}}),_sfc_main$2=defineComponent({__name:"NowLine",setup:function(__props){var timelineStore=useTimelineStore(),nodeStore=useNodeStore(),now2=ref(DateTime$1.now()),_setNow=function(){now2.value=DateTime$1.now(),setTimeout(function(){return _setNow()},6e3)};onMounted(function(){_setNow()});var left=computed(function(){return Math.min(Math.max(0,timelineStore.distanceFromBaselineLeftmostDate(now2.value)),6*timelineStore.pageSettings.viewport.width)});return function(_ctx,_cache){return unref(timelineStore).hideNowLine?createCommentVNode("",!0):(openBlock(),createElementBlock("div",{key:0,class:"absolute dark:bg-zinc-400 bg-blue-300 top-0 bottom-0",style:normalizeStyle("width: 1px; left: ".concat(left.value,"px; height: max(").concat(unref(nodeStore).viewHeight,", 100%);"))},null,4))}}});var useDoubleTap=function(setViewport){var timeout,last={time:0,x:0,y:0},timelineStore=useTimelineStore(),initialScale2=0,initialX=0,initialY=0;return function(e){if("touch"===e.pointerType){var currentTime=(new Date).getTime(),tapLength=currentTime-last.time;if(tapLength<500&&tapLength>0&&Math.abs(e.clientX-last.x)<10&&Math.abs(e.clientY-last.y)<10){e.preventDefault(),initialX=e.clientX,initialY=e.clientY,initialScale2=timelineStore.pageScale;var element=e.target,newReferenceDate=timelineStore.dateFromClientLeft(initialX),d=timelineStore.distanceBetweenDates(newReferenceDate,timelineStore.referenceDate);timelineStore.referenceDate=newReferenceDate,element.scrollLeft=element.scrollLeft+d,function(element){var pointerMove=function(moveEvent){var yDiff=initialY-moveEvent.clientY,newScale=yDiff<0?(yDiff-10)/-10:10/(yDiff+10);timelineStore.setPageScale(Math.max(initialScale2*newScale,.01)),setViewport(),moveEvent.stopPropagation(),moveEvent.stopImmediatePropagation(),moveEvent.preventDefault()};element.addEventListener("pointermove",pointerMove),element.addEventListener("pointerup",function pointerUp(){console.log("pointer up"),element.removeEventListener("pointermove",pointerMove),element.removeEventListener("pointerup",pointerUp)})}(element)}else timeout=setTimeout(function(){clearTimeout(timeout)},500),last={time:currentTime,x:e.clientX,y:e.clientY}}}};const _sfc_main$1=defineComponent({__name:"Timeline",setup:function(__props){var timelineStore=useTimelineStore(),markwhenStore=useMarkwhenStore();markwhenStore.onJumpToRange=function(range2){scrollToDateRangeImmediate(toDateRange(range2))},watch(function(){return timelineStore.rangeToJumpTo},function(dr){return scrollToDateRangeImmediate(dr,!1)}),markwhenStore.onJumpToPath=function(path){var node=function(path){var timelineStore=useTimelineStore(),transformedEvents=computed(function(){return timelineStore.transformedEvents}),event=ref();return watchEffect(function(){if(path){var node,eventPath=unref(path);eventPath?(node=transformedEvents.value,event.value=node?get(node,eventPath):void 0):event.value=void 0}else event.value=void 0}),event}(path).value;if(node){var range2=isEvent(node)?node.dateRangeIso:_ranges(node,100);if(range2&&(scrollToDateRangeImmediate("fromDateTimeIso"in range2?toDateRange(range2):range2),timelineElement.value&&path)){var nodeTop=timelineElement.value.scrollTop=useNodePosition(path).top.value;timelineElement.value.scrollTop=nodeTop-viewport.value.height/2}}},watch(function(){return timelineStore.autoCenterSemaphore},function(){setInitialScrollAndScale()});var timelineElement=ref(),getViewport=function(){return timelineElement.value?{left:timelineElement.value.scrollLeft,width:timelineElement.value.clientWidth,top:timelineElement.value.scrollTop,height:timelineElement.value.clientHeight,offsetLeft:timelineElement.value.offsetLeft}:{left:0,width:0,top:0,height:0,offsetLeft:0}},setViewport=function(v){timelineElement.value&&(timelineElement.value.scrollLeft=v.left,timelineElement.value.scrollTop=v.top)};watch(function(){return timelineStore.pageSettings},function(settings){var vp=_objectSpread2({},settings.viewport);nextTick(function(){return setViewport(vp)})});var widthChangeStartScrollLeft=ref(null),widthChangeStartYearWidth=ref(null);watch(function(){return timelineStore.startedWidthChange},function(started){var _timelineElement$valu,scrollLeft=(null===(_timelineElement$valu=timelineElement.value)||void 0===_timelineElement$valu?void 0:_timelineElement$valu.scrollLeft)||0;widthChangeStartScrollLeft.value=started&&null!=scrollLeft?scrollLeft:null,widthChangeStartYearWidth.value=timelineStore.pageSettings.scale}),watch(function(){return timelineStore.pageSettings},function(settings){timelineStore.startedWidthChange&&timelineElement.value&&(widthChangeStartScrollLeft.value,timelineElement.value.clientWidth,settings.scale,widthChangeStartYearWidth.value)},{deep:!0}),watch([function(){return timelineStore.pageTimelineMetadata.earliestTime},function(){return timelineStore.pageTimelineMetadata.latestTime}],function(){nextTick(setViewportDateInterval)}),function(target,callback,options={}){const _a2=options,{window:window2=defaultWindow}=_a2,observerOptions=__objRest(_a2,["window"]);let observer;const isSupported=useSupported(()=>window2&&"ResizeObserver"in window2),cleanup=()=>{observer&&(observer.disconnect(),observer=void 0)},stopWatch=watch(computed(()=>Array.isArray(target)?target.map(el=>unrefElement(el)):[unrefElement(target)]),els=>{if(cleanup(),isSupported.value&&window2){observer=new ResizeObserver(callback);for(const _el of els)_el&&observer.observe(_el,observerOptions)}},{immediate:!0,flush:"post"}),stop=()=>{cleanup(),stopWatch()};tryOnScopeDispose(stop)}(timelineElement,useDebounceFn(function(entries){var middle=(entries[0].target.clientLeft||0)+(entries[0].target.clientWidth/2||0);timelineStore.referenceDate=timelineStore.dateFromClientLeft(middle),timelineElement.value.scrollLeft=2*timelineElement.value.clientWidth,nextTick(setViewportDateInterval)},250,{}));var setViewportDateInterval=function(){return timelineStore.setViewport(getViewport())},_useHoveringMarker=function(el){var markersStore=useMarkersStore(),timelineStore=useTimelineStore(),x=ref(0),mouseMove=function(e){x.value=e.clientX},findHovering=function(mouseX){var range2=markersStore.rangeFromOffsetLeft(mouseX),hovering=markersStore.markers.find(function(m){return+range2[0].dateTime===+m.dateTime});markersStore.setHoveringMarker(hovering),markersStore.setRange(range2)};watch(x,findHovering);var trigger2=function(){return findHovering(x.value)};return watch(function(){return timelineStore.pageScale},trigger2),onMounted(function(){var _el$value;return null===(_el$value=el.value)||void 0===_el$value?void 0:_el$value.addEventListener("mousemove",mouseMove)}),onUnmounted(function(){var _el$value2;return null===(_el$value2=el.value)||void 0===_el$value2?void 0:_el$value2.removeEventListener("mousemove",mouseMove)}),{trigger:trigger2}}(timelineElement),trigger2=_useHoveringMarker.trigger,scroll=function(){};useGestures(timelineElement,function(){setViewportDateInterval()});var scrollToDate=function(dateTime){timelineStore.referenceDate=dateTime,timelineElement.value.scrollLeft=2*timelineElement.value.clientWidth},scrollToDateRangeImmediate=function(dateRange){var buffered=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(dateRange){var width=getViewport().width,scale=scaleToGetDistance(width,dateRange)/(buffered?3:1);timelineStore.setPageScale(scale),nextTick(function(){scrollToDate(dateMidpoint(dateRange)),setViewportDateInterval()})}};watch([function(){return timelineStore.hideNowLine},function(){return timelineStore.goToNowSemaphore}],function(){return scrollToDate(DateTime$1.now())});var viewport=computed(function(){return timelineStore.pageSettings.viewport});onActivated(function(){var _timelineElement$valu2,viewportWithOffset={left:viewport.value.left,top:viewport.value.top,width:viewport.value.width,height:viewport.value.height,offsetLeft:(null===(_timelineElement$valu2=timelineElement.value)||void 0===_timelineElement$valu2?void 0:_timelineElement$valu2.offsetLeft)||0};nextTick(function(){return setViewport(viewportWithOffset)})});var setInitialScrollAndScale=function(){return scrollToDateRangeImmediate(timelineStore.pageRange)};onMounted(function(){timelineStore.setViewportGetter(getViewport);var te=timelineElement.value;te.scrollLeft=2*te.clientWidth,scroll=function(){var scrollLeft=te.scrollLeft,amount=_defineProperty({},"hours",1.5*te.clientWidth/timelineStore.pageScale*24);scrollLeft<te.clientWidth/2?(timelineStore.referenceDate=timelineStore.referenceDate.minus(amount),te.scrollLeft=2*te.clientWidth):scrollLeft>3.5*te.clientWidth&&(timelineStore.referenceDate=timelineStore.referenceDate.plus(amount),te.scrollLeft=2*te.clientWidth),setViewportDateInterval(),trigger2()}});var svgParams=ref(),svgHolder=ref(),svgView=ref(),totalWidth=computed(function(){var range2=_ranges(timelineStore.transformedEvents,100)||{fromDateTime:DateTime$1.now(),toDateTime:DateTime$1.now()};return timelineStore.scalelessDistanceBetweenDates(range2.fromDateTime,range2.toDateTime)});markwhenStore.onGetSvg=function(params){return svgParams.value=_objectSpread2({diffScale:"hours",showViewport:!1},params),new Promise(function(resolve,reject){setTimeout(function(){var _svgHolder$value;if(null!==(_svgHolder$value=svgHolder.value)&&void 0!==_svgHolder$value&&_svgHolder$value.firstChild){var ratio=svgView.value.getRightmostX()/totalWidth.value,data=(new XMLSerializer).serializeToString(svgHolder.value.firstChild);resolve({svg:data,ratio:ratio})}resolve(null)},500)})};var pointerdown=useDoubleTap(setViewportDateInterval);return function(_ctx,_cache){return openBlock(),createElementBlock("div",{class:normalizeClass(["flex flex-row w-full h-full",unref(timelineStore).darkMode?"dark":""])},[createBaseVNode("div",{id:"timeline",class:"relative overflow-auto w-full dark:text-white text-gray-900 bg-white dark:bg-zinc-800 noScrollBar",ref_key:"timelineElement",ref:timelineElement,onScroll:_cache[0]||(_cache[0]=function(){return unref(scroll)&&unref(scroll).apply(void 0,arguments)}),"on:gestureChange":_cache[1]||(_cache[1]=function(){return unref(scroll)&&unref(scroll).apply(void 0,arguments)}),onPointerdown:_cache[2]||(_cache[2]=function(){return unref(pointerdown)&&unref(pointerdown).apply(void 0,arguments)})},[createVNode(_sfc_main$z),createVNode(_sfc_main$2),createCommentVNode("",!0),createVNode(_sfc_main$i),createVNode(_sfc_main$3),createBaseVNode("div",{ref_key:"svgHolder",ref:svgHolder,style:{width:"0",height:"0"}},[svgParams.value?(openBlock(),createBlock(_sfc_main$f,mergeProps({key:0},svgParams.value,{ref_key:"svgView",ref:svgView}),null,16)):createCommentVNode("",!0)],512)],544)],2)}}}),_sfc_main=defineComponent({__name:"App",setup:function(__props){var markwhenStore=useMarkwhenStore();return function(_ctx,_cache){return unref(markwhenStore).markwhen?(openBlock(),createBlock(_sfc_main$1,{key:0})):createCommentVNode("",!0)}}});var router=function(options){const matcher=createRouterMatcher(options.routes,options),parseQuery$1=options.parseQuery||parseQuery,stringifyQuery$1=options.stringifyQuery||stringifyQuery,routerHistory=options.history,beforeGuards=useCallbacks(),beforeResolveGuards=useCallbacks(),afterGuards=useCallbacks(),currentRoute=createRef(START_LOCATION_NORMALIZED,!0);let pendingLocation=START_LOCATION_NORMALIZED;isBrowser&&options.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const normalizeParams=applyToParams.bind(null,paramValue=>""+paramValue),encodeParams=applyToParams.bind(null,encodeParam),decodeParams=applyToParams.bind(null,decode);function resolve(rawLocation,currentLocation){if(currentLocation=assign({},currentLocation||currentRoute.value),"string"==typeof rawLocation){const locationNormalized=parseURL(parseQuery$1,rawLocation,currentLocation.path),matchedRoute2=matcher.resolve({path:locationNormalized.path},currentLocation),href2=routerHistory.createHref(locationNormalized.fullPath);return assign(locationNormalized,matchedRoute2,{params:decodeParams(matchedRoute2.params),hash:decode(locationNormalized.hash),redirectedFrom:void 0,href:href2})}let matcherLocation;if(null!=rawLocation.path)matcherLocation=assign({},rawLocation,{path:parseURL(parseQuery$1,rawLocation.path,currentLocation.path).path});else{const targetParams=assign({},rawLocation.params);for(const key in targetParams)null==targetParams[key]&&delete targetParams[key];matcherLocation=assign({},rawLocation,{params:encodeParams(targetParams)}),currentLocation.params=encodeParams(currentLocation.params)}const matchedRoute=matcher.resolve(matcherLocation,currentLocation),hash=rawLocation.hash||"";matchedRoute.params=normalizeParams(decodeParams(matchedRoute.params));const fullPath=function(stringifyQuery2,location2){const query=location2.query?stringifyQuery2(location2.query):"";return location2.path+(query&&"?")+query+(location2.hash||"")}(stringifyQuery$1,assign({},rawLocation,{hash:(text=hash,commonEncode(text).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")),path:matchedRoute.path}));var text;const href=routerHistory.createHref(fullPath);return assign({fullPath:fullPath,hash:hash,query:stringifyQuery$1===stringifyQuery?normalizeQuery(rawLocation.query):rawLocation.query||{}},matchedRoute,{redirectedFrom:void 0,href:href})}function locationAsObject(to){return"string"==typeof to?parseURL(parseQuery$1,to,currentRoute.value.path):assign({},to)}function checkCanceledNavigation(to,from){if(pendingLocation!==to)return createRouterError(8,{from:from,to:to})}function push2(to){return pushWithRedirect(to)}function handleRedirectRecord(to){const lastMatched=to.matched[to.matched.length-1];if(lastMatched&&lastMatched.redirect){const{redirect:redirect}=lastMatched;let newTargetLocation="function"==typeof redirect?redirect(to):redirect;return"string"==typeof newTargetLocation&&(newTargetLocation=newTargetLocation.includes("?")||newTargetLocation.includes("#")?newTargetLocation=locationAsObject(newTargetLocation):{path:newTargetLocation},newTargetLocation.params={}),assign({query:to.query,hash:to.hash,params:null!=newTargetLocation.path?{}:to.params},newTargetLocation)}}function pushWithRedirect(to,redirectedFrom){const targetLocation=pendingLocation=resolve(to),from=currentRoute.value,data=to.state,force=to.force,replace2=!0===to.replace,shouldRedirect=handleRedirectRecord(targetLocation);if(shouldRedirect)return pushWithRedirect(assign(locationAsObject(shouldRedirect),{state:"object"==typeof shouldRedirect?assign({},data,shouldRedirect.state):data,force:force,replace:replace2}),redirectedFrom||targetLocation);const toLocation=targetLocation;let failure;return toLocation.redirectedFrom=redirectedFrom,!force&&function(stringifyQuery2,a,b){const aLastIndex=a.matched.length-1,bLastIndex=b.matched.length-1;return aLastIndex>-1&&aLastIndex===bLastIndex&&isSameRouteRecord(a.matched[aLastIndex],b.matched[bLastIndex])&&isSameRouteLocationParams(a.params,b.params)&&stringifyQuery2(a.query)===stringifyQuery2(b.query)&&a.hash===b.hash}(stringifyQuery$1,from,targetLocation)&&(failure=createRouterError(16,{to:toLocation,from:from}),handleScroll(from,from,!0,!1)),(failure?Promise.resolve(failure):navigate(toLocation,from)).catch(error=>isNavigationFailure(error)?isNavigationFailure(error,2)?error:markAsReady(error):triggerError(error,toLocation,from)).then(failure2=>{if(failure2){if(isNavigationFailure(failure2,2))return pushWithRedirect(assign({replace:replace2},locationAsObject(failure2.to),{state:"object"==typeof failure2.to?assign({},data,failure2.to.state):data,force:force}),redirectedFrom||toLocation)}else failure2=finalizeNavigation(toLocation,from,!0,replace2,data);return triggerAfterEach(toLocation,from,failure2),failure2})}function checkCanceledNavigationAndReject(to,from){const error=checkCanceledNavigation(to,from);return error?Promise.reject(error):Promise.resolve()}function runWithContext(fn){const app2=installedApps.values().next().value;return app2&&"function"==typeof app2.runWithContext?app2.runWithContext(fn):fn()}function navigate(to,from){let guards;const[leavingRecords,updatingRecords,enteringRecords]=function(to,from){const leavingRecords=[],updatingRecords=[],enteringRecords=[],len=Math.max(from.matched.length,to.matched.length);for(let i=0;i<len;i++){const recordFrom=from.matched[i];recordFrom&&(to.matched.find(record=>isSameRouteRecord(record,recordFrom))?updatingRecords.push(recordFrom):leavingRecords.push(recordFrom));const recordTo=to.matched[i];recordTo&&(from.matched.find(record=>isSameRouteRecord(record,recordTo))||enteringRecords.push(recordTo))}return[leavingRecords,updatingRecords,enteringRecords]}(to,from);guards=extractComponentsGuards(leavingRecords.reverse(),"beforeRouteLeave",to,from);for(const record of leavingRecords)record.leaveGuards.forEach(guard=>{guards.push(guardToPromiseFn(guard,to,from))});const canceledNavigationCheck=checkCanceledNavigationAndReject.bind(null,to,from);return guards.push(canceledNavigationCheck),runGuardQueue(guards).then(()=>{guards=[];for(const guard of beforeGuards.list())guards.push(guardToPromiseFn(guard,to,from));return guards.push(canceledNavigationCheck),runGuardQueue(guards)}).then(()=>{guards=extractComponentsGuards(updatingRecords,"beforeRouteUpdate",to,from);for(const record of updatingRecords)record.updateGuards.forEach(guard=>{guards.push(guardToPromiseFn(guard,to,from))});return guards.push(canceledNavigationCheck),runGuardQueue(guards)}).then(()=>{guards=[];for(const record of enteringRecords)if(record.beforeEnter)if(isArray(record.beforeEnter))for(const beforeEnter of record.beforeEnter)guards.push(guardToPromiseFn(beforeEnter,to,from));else guards.push(guardToPromiseFn(record.beforeEnter,to,from));return guards.push(canceledNavigationCheck),runGuardQueue(guards)}).then(()=>(to.matched.forEach(record=>record.enterCallbacks={}),guards=extractComponentsGuards(enteringRecords,"beforeRouteEnter",to,from,runWithContext),guards.push(canceledNavigationCheck),runGuardQueue(guards))).then(()=>{guards=[];for(const guard of beforeResolveGuards.list())guards.push(guardToPromiseFn(guard,to,from));return guards.push(canceledNavigationCheck),runGuardQueue(guards)}).catch(err=>isNavigationFailure(err,8)?err:Promise.reject(err))}function triggerAfterEach(to,from,failure){afterGuards.list().forEach(guard=>runWithContext(()=>guard(to,from,failure)))}function finalizeNavigation(toLocation,from,isPush,replace2,data){const error=checkCanceledNavigation(toLocation,from);if(error)return error;const isFirstNavigation=from===START_LOCATION_NORMALIZED,state=isBrowser?history.state:{};isPush&&(replace2||isFirstNavigation?routerHistory.replace(toLocation.fullPath,assign({scroll:isFirstNavigation&&state&&state.scroll},data)):routerHistory.push(toLocation.fullPath,data)),currentRoute.value=toLocation,handleScroll(toLocation,from,isPush,isFirstNavigation),markAsReady()}let removeHistoryListener;function setupListeners(){removeHistoryListener||(removeHistoryListener=routerHistory.listen((to,_from,info)=>{if(!router2.listening)return;const toLocation=resolve(to),shouldRedirect=handleRedirectRecord(toLocation);if(shouldRedirect)return void pushWithRedirect(assign(shouldRedirect,{replace:!0}),toLocation).catch(noop$1);pendingLocation=toLocation;const from=currentRoute.value;var key,scrollPosition;isBrowser&&(key=getScrollKey(from.fullPath,info.delta),scrollPosition=computeScrollPosition(),scrollPositions.set(key,scrollPosition)),navigate(toLocation,from).catch(error=>isNavigationFailure(error,12)?error:isNavigationFailure(error,2)?(pushWithRedirect(error.to,toLocation).then(failure=>{isNavigationFailure(failure,20)&&!info.delta&&info.type===NavigationType.pop&&routerHistory.go(-1,!1)}).catch(noop$1),Promise.reject()):(info.delta&&routerHistory.go(-info.delta,!1),triggerError(error,toLocation,from))).then(failure=>{(failure=failure||finalizeNavigation(toLocation,from,!1))&&(info.delta&&!isNavigationFailure(failure,8)?routerHistory.go(-info.delta,!1):info.type===NavigationType.pop&&isNavigationFailure(failure,20)&&routerHistory.go(-1,!1)),triggerAfterEach(toLocation,from,failure)}).catch(noop$1)}))}let ready,readyHandlers=useCallbacks(),errorListeners=useCallbacks();function triggerError(error,to,from){markAsReady(error);const list=errorListeners.list();return list.length?list.forEach(handler=>handler(error,to,from)):console.error(error),Promise.reject(error)}function markAsReady(err){return ready||(ready=!err,setupListeners(),readyHandlers.list().forEach(([resolve2,reject])=>err?reject(err):resolve2()),readyHandlers.reset()),err}function handleScroll(to,from,isPush,isFirstNavigation){const{scrollBehavior:scrollBehavior}=options;if(!isBrowser||!scrollBehavior)return Promise.resolve();const scrollPosition=!isPush&&function(key){const scroll=scrollPositions.get(key);return scrollPositions.delete(key),scroll}(getScrollKey(to.fullPath,0))||(isFirstNavigation||!isPush)&&history.state&&history.state.scroll||null;return nextTick().then(()=>scrollBehavior(to,from,scrollPosition)).then(position=>position&&scrollToPosition(position)).catch(err=>triggerError(err,to,from))}const go=delta=>routerHistory.go(delta);let started;const installedApps=new Set,router2={currentRoute:currentRoute,listening:!0,addRoute:function(parentOrRoute,route){let parent,record;return isRouteName(parentOrRoute)?(parent=matcher.getRecordMatcher(parentOrRoute),record=route):record=parentOrRoute,matcher.addRoute(record,parent)},removeRoute:function(name){const recordMatcher=matcher.getRecordMatcher(name);recordMatcher&&matcher.removeRoute(recordMatcher)},clearRoutes:matcher.clearRoutes,hasRoute:function(name){return!!matcher.getRecordMatcher(name)},getRoutes:function(){return matcher.getRoutes().map(routeMatcher=>routeMatcher.record)},resolve:resolve,options:options,push:push2,replace:function(to){return push2(assign(locationAsObject(to),{replace:!0}))},go:go,back:()=>go(-1),forward:()=>go(1),beforeEach:beforeGuards.add,beforeResolve:beforeResolveGuards.add,afterEach:afterGuards.add,onError:errorListeners.add,isReady:function(){return ready&&currentRoute.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((resolve2,reject)=>{readyHandlers.add([resolve2,reject])})},install(app2){app2.component("RouterLink",RouterLink),app2.component("RouterView",RouterView),app2.config.globalProperties.$router=this,Object.defineProperty(app2.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(currentRoute)}),isBrowser&&!started&&currentRoute.value===START_LOCATION_NORMALIZED&&(started=!0,push2(routerHistory.location).catch(err=>{}));const reactiveRoute={};for(const key in START_LOCATION_NORMALIZED)Object.defineProperty(reactiveRoute,key,{get:()=>currentRoute.value[key],enumerable:!0});app2.provide(routerKey,this),app2.provide(routeLocationKey,shallowReactive(reactiveRoute)),app2.provide(routerViewLocationKey,currentRoute);const unmountApp=app2.unmount;installedApps.add(app2),app2.unmount=function(){installedApps.delete(app2),installedApps.size<1&&(pendingLocation=START_LOCATION_NORMALIZED,removeHistoryListener&&removeHistoryListener(),removeHistoryListener=null,currentRoute.value=START_LOCATION_NORMALIZED,started=!1,ready=!1),unmountApp()}}};function runGuardQueue(guards){return guards.reduce((promise,guard)=>promise.then(()=>runWithContext(guard)),Promise.resolve())}return router2}({history:function(base){const historyNavigation=useHistoryStateNavigation(base=normalizeBase(base)),historyListeners=function(base,historyState,currentLocation,replace){let listeners=[],teardowns=[],pauseState=null;const popStateHandler=({state:state})=>{const to=createCurrentLocation(base,location),from=currentLocation.value,fromState=historyState.value;let delta=0;if(state){if(currentLocation.value=to,historyState.value=state,pauseState&&pauseState===from)return void(pauseState=null);delta=fromState?state.position-fromState.position:0}else replace(to);listeners.forEach(listener=>{listener(currentLocation.value,from,{delta:delta,type:NavigationType.pop,direction:delta?delta>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function beforeUnloadListener(){const{history:history2}=window;history2.state&&history2.replaceState(assign({},history2.state,{scroll:computeScrollPosition()}),"")}return window.addEventListener("popstate",popStateHandler),window.addEventListener("beforeunload",beforeUnloadListener,{passive:!0}),{pauseListeners:function(){pauseState=currentLocation.value},listen:function(callback){listeners.push(callback);const teardown=()=>{const index2=listeners.indexOf(callback);index2>-1&&listeners.splice(index2,1)};return teardowns.push(teardown),teardown},destroy:function(){for(const teardown of teardowns)teardown();teardowns=[],window.removeEventListener("popstate",popStateHandler),window.removeEventListener("beforeunload",beforeUnloadListener)}}}(base,historyNavigation.state,historyNavigation.location,historyNavigation.replace),routerHistory=assign({location:"",base:base,go:function(delta,triggerListeners=!0){triggerListeners||historyListeners.pauseListeners(),history.go(delta)},createHref:createHref.bind(null,base)},historyNavigation,historyListeners);return Object.defineProperty(routerHistory,"location",{enumerable:!0,get:()=>historyNavigation.location.value}),Object.defineProperty(routerHistory,"state",{enumerable:!0,get:()=>historyNavigation.state.value}),routerHistory}("/"),routes:[{path:"/:user?/:timeline?",name:"home",component:_sfc_main}]});"undefined"==typeof window||window.__markwhen_initial_state||(window.__markwhen_initial_state={initialized:!1,data:null});var app=((...args)=>{const app2=(renderer||(renderer=createRenderer(rendererOptions))).createApp(...args),{mount:mount}=app2;return app2.mount=containerOrSelector=>{const container=function(container){if(isString$1(container)){return document.querySelector(container)}return container}(containerOrSelector);if(!container)return;const component=app2._component;isFunction(component)||component.render||component.template||(component.template=container.innerHTML),1===container.nodeType&&(container.textContent="");const proxy=mount(container,!1,function(container){if(container instanceof SVGElement)return"svg";if("function"==typeof MathMLElement&&container instanceof MathMLElement)return"mathml"}(container));return container instanceof Element&&(container.removeAttribute("v-cloak"),container.setAttribute("data-v-app","")),proxy},app2})(_sfc_main),pinia=function(){const scope=effectScope(!0),state=scope.run(()=>ref({}));let _p=[],toBeInstalled=[];const pinia2=markRaw({install(app2){setActivePinia(pinia2),pinia2._a=app2,app2.provide(piniaSymbol,pinia2),app2.config.globalProperties.$pinia=pinia2,toBeInstalled.forEach(plugin=>_p.push(plugin)),toBeInstalled=[]},use(plugin){return this._a?_p.push(plugin):toBeInstalled.push(plugin),this},_p:_p,_a:null,_e:scope,_s:new Map,state:state});return pinia2}();app.use(router),app.use(pinia),app.mount("#app"),"undefined"!=typeof window&&(window.__markwhen_initial_state.initialized=!0)}();

</script>